{"version":3,"sources":["webpack://@askvortsov/flarum-rich-text/webpack/bootstrap","webpack://@askvortsov/flarum-rich-text/./node_modules/orderedmap/index.es.js","webpack://@askvortsov/flarum-rich-text/../src/fragment.js","webpack://@askvortsov/flarum-rich-text/../src/diff.js","webpack://@askvortsov/flarum-rich-text/../src/comparedeep.js","webpack://@askvortsov/flarum-rich-text/../src/mark.js","webpack://@askvortsov/flarum-rich-text/../src/replace.js","webpack://@askvortsov/flarum-rich-text/../src/resolvedpos.js","webpack://@askvortsov/flarum-rich-text/../src/node.js","webpack://@askvortsov/flarum-rich-text/../src/content.js","webpack://@askvortsov/flarum-rich-text/../src/schema.js","webpack://@askvortsov/flarum-rich-text/../src/from_dom.js","webpack://@askvortsov/flarum-rich-text/../src/to_dom.js","webpack://@askvortsov/flarum-rich-text/../src/selection.js","webpack://@askvortsov/flarum-rich-text/../src/transaction.js","webpack://@askvortsov/flarum-rich-text/../src/state.js","webpack://@askvortsov/flarum-rich-text/../src/plugin.js","webpack://@askvortsov/flarum-rich-text/../src/commands.js","webpack://@askvortsov/flarum-rich-text/./node_modules/tiptap-commands/dist/commands.esm.js","webpack://@askvortsov/flarum-rich-text/../src/map.js","webpack://@askvortsov/flarum-rich-text/../src/transform.js","webpack://@askvortsov/flarum-rich-text/../src/step.js","webpack://@askvortsov/flarum-rich-text/../src/replace_step.js","webpack://@askvortsov/flarum-rich-text/../src/structure.js","webpack://@askvortsov/flarum-rich-text/../src/mark_step.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/common/utils.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/utils.js","webpack://@askvortsov/flarum-rich-text/../src/inputrules.js","webpack://@askvortsov/flarum-rich-text/../src/rules.js","webpack://@askvortsov/flarum-rich-text/../src/rulebuilders.js","webpack://@askvortsov/flarum-rich-text/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@askvortsov/flarum-rich-text/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@askvortsov/flarum-rich-text/../src/from_markdown.js","webpack://@askvortsov/flarum-rich-text/../src/to_markdown.js","webpack://@askvortsov/flarum-rich-text/../src/schema-list.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/components/Tooltip']\"","webpack://@askvortsov/flarum-rich-text/./src/common/components/CommandButton.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@askvortsov/flarum-rich-text/./node_modules/tiptap-utils/dist/utils.esm.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/MarkButton.js","webpack://@askvortsov/flarum-rich-text/./node_modules/w3c-keyname/index.es.js","webpack://@askvortsov/flarum-rich-text/../src/keymap.js","webpack://@askvortsov/flarum-rich-text/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/utils/Stream']\"","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/components/Button']\"","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/components/Dropdown']\"","webpack://@askvortsov/flarum-rich-text/./src/common/components/SafariModalHack.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/FormDropdown.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/extend']\"","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/categories/P/regex.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/ListButton.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/components/TextEditor']\"","webpack://@askvortsov/flarum-rich-text/./node_modules/mdurl/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/MarkdownSerializerBuilder.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/SchemaBuilder.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/Component']\"","webpack://@askvortsov/flarum-rich-text/./src/common/components/NodeTypeDropdown.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/InsertImageDropdown.js","webpack://@askvortsov/flarum-rich-text/./src/common/states/MenuState.js","webpack://@askvortsov/flarum-rich-text/./node_modules/rope-sequence/dist/index.es.js","webpack://@askvortsov/flarum-rich-text/../src/history.js","webpack://@askvortsov/flarum-rich-text/../src/browser.js","webpack://@askvortsov/flarum-rich-text/../src/dom.js","webpack://@askvortsov/flarum-rich-text/../src/domcoords.js","webpack://@askvortsov/flarum-rich-text/../src/viewdesc.js","webpack://@askvortsov/flarum-rich-text/../src/capturekeys.js","webpack://@askvortsov/flarum-rich-text/../src/domchange.js","webpack://@askvortsov/flarum-rich-text/../src/clipboard.js","webpack://@askvortsov/flarum-rich-text/../src/domobserver.js","webpack://@askvortsov/flarum-rich-text/../src/input.js","webpack://@askvortsov/flarum-rich-text/../src/decoration.js","webpack://@askvortsov/flarum-rich-text/../src/index.js","webpack://@askvortsov/flarum-rich-text/../src/dropcursor.js","webpack://@askvortsov/flarum-rich-text/../src/gapcursor.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/plugins/disableBase64PastePlugin.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/plugins/toggleSpoiler.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/inputrules.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/ProseMirrorEditorDriver.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/plugins/placeholderPlugin.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/plugins/menuPlugin.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/key-bindings.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/plugins/disabledPlugin.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/markdown-it/altText.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/markdown-it/blockSpoiler.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/markdown-it/inlineSpoilerBars.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/markdown-it/inlineSpoilerTags.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/MarkdownParserBuilder.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/HiddenItemsDropdown.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/ProseMirrorMenu.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/commands/insertHr.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/InsertLinkDropdown.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/commands/insertLink.js","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/properties/Any/regex.js","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/categories/Cc/regex.js","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/categories/Z/regex.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/ruler.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/token.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/ruler.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/token.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/entities.js","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/html_re.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/strikethrough.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/emphasis.js","webpack://@askvortsov/flarum-rich-text/./node_modules/punycode/punycode.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/common/entities.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/common/html_re.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/strikethrough.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/emphasis.js","webpack://@askvortsov/flarum-rich-text/./src/common/components/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/commands/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/commands/updateToggleMark.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/proseMirror/markdown/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/states/index.js","webpack://@askvortsov/flarum-rich-text/./src/common/applyEditor.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/utils/classList']\"","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it-sub/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it-sup/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it-latex2img/index.js","webpack://@askvortsov/flarum-rich-text/external \"flarum.core.compat['common/components/Modal']\"","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/mdurl/encode.js","webpack://@askvortsov/flarum-rich-text/./node_modules/mdurl/decode.js","webpack://@askvortsov/flarum-rich-text/./node_modules/mdurl/format.js","webpack://@askvortsov/flarum-rich-text/./node_modules/mdurl/parse.js","webpack://@askvortsov/flarum-rich-text/./node_modules/uc.micro/categories/Cf/regex.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_label.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_destination.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_title.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/renderer.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_core.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/normalize.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/linkify.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/replacements.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/smartquotes.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/state_core.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/table.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/code.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/fence.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/blockquote.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/hr.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/list.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/reference.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/html_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/html_blocks.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/heading.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/lheading.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/paragraph.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/state_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/text.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/newline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/escape.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/backticks.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/link.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/image.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/autolink.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/html_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/entity.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/balance_pairs.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/text_collapse.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/state_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/linkify-it/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/linkify-it/lib/re.js","webpack://@askvortsov/flarum-rich-text/(webpack)/buildin/module.js","webpack://@askvortsov/flarum-rich-text/(webpack)/buildin/global.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/default.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/zero.js","webpack://@askvortsov/flarum-rich-text/./node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/commonmark.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/helpers/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/helpers/parse_link_label.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/helpers/parse_link_destination.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/helpers/parse_link_title.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/renderer.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/parser_core.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/normalize.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/linkify.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/replacements.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/smartquotes.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_core/state_core.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/parser_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/table.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/code.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/fence.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/blockquote.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/hr.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/list.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/reference.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/heading.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/lheading.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/html_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/common/html_blocks.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/paragraph.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_block/state_block.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/parser_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/text.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/newline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/escape.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/backticks.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/link.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/image.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/autolink.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/html_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/entity.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/balance_pairs.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/text_collapse.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/rules_inline/state_inline.js","webpack://@askvortsov/flarum-rich-text/./node_modules/linkify-it/index.js","webpack://@askvortsov/flarum-rich-text/./node_modules/linkify-it/lib/re.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/presets/default.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/presets/zero.js","webpack://@askvortsov/flarum-rich-text/./node_modules/markdown-it/lib/presets/commonmark.js","webpack://@askvortsov/flarum-rich-text/./src/admin/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","OrderedMap","content","this","constructor","find","length","found","undefined","update","newKey","self","remove","slice","push","splice","addToStart","concat","addToEnd","addBefore","place","without","forEach","f","prepend","map","from","size","subtract","append","result","prop","orderedmap","Fragment","let","nodeSize","nodesBetween","to","nodeStart","parent","pos","child","end","start","Math","max","min","descendants","textBetween","blockSeparator","leafText","text","separated","node","isText","isLeaf","isBlock","other","last","lastChild","first","firstChild","sameMarkup","withText","cut","cutByIndex","empty","replaceChild","index","current","copy","eq","prototypeAccessors","childCount","RangeError","maybeChild","findDiffStart","a","b","childA","childB","j","inner","findDiffEnd","otherPos","posA","posB","iA","iB","same","minSize","findIndex","round","retIndex","curPos","toString","toStringInner","join","toJSON","fromJSON","schema","Array","isArray","nodeFromJSON","fromArray","array","joined","nodes","attrs","const","offset","compareDeep","Mark","type","ReplaceError","message","err","Error","__proto__","addToSet","set","placed","excludes","rank","removeFromSet","isInSet","obj","_","json","marks","sameSet","setFrom","none","sort","Slice","openStart","openEnd","replace","$from","$to","depth","replaceOuter","$along","extra","resolveNoCache","prepareSliceForReplace","close","replaceThreeWay","$start","$end","joinable","addRange","checkJoin","addNode","replaceTwoWay","parentOffset","main","sub","compatibleContent","$before","$after","target","startIndex","endIndex","textOffset","nodeAfter","nodeBefore","validContent","insertAt","fragment","insertInto","dist","insert","canReplace","removeBetween","removeRange","offsetTo","indexTo","maxOpen","openIsolating","spec","isolating","ResolvedPos","path","resolveDepth","val","doc","indexAfter","before","after","dOff","posAtIndex","tmp","inclusive","marksAcross","isInline","next","sharedDepth","blockRange","pred","inlineContent","NodeRange","sameParent","str","resolve","rem","resolveCached","resolveCache","cached","resolveCachePos","resolveCacheSize","prototypeAccessors$1","emptyAttrs","Node","startPos","textContent","hasMarkup","defaultAttrs","mark","includeParents","nodeAt","childAfter","childBefore","rangeHasMark","isTextblock","isAtom","toDebugString","wrapMarks","contentMatchAt","match","contentMatch","matchFragment","replacement","one","two","validEnd","allowsMarks","canReplaceWith","matchType","canAppend","check","markFromJSON","nodeType","TextNode","super","JSON","stringify","base","ContentMatch","wrapCache","parse","string","nodeTypes","stream","TokenStream","expr","parseExpr","nfa","labeled","explore","states","out","term","known","indexOf","nullFrom","state","cmp","dfa","connect","compile","exprs","reduce","loop","edge","cur","edges","work","dead","hasRequiredAttrs","checkForDeadEnds","frag","defaultType","compatible","fillBefore","toEnd","seen","search","types","finished","tp","createAndFill","findWrapping","computed","computeWrapping","active","via","shift","reverse","edgeCount","scan","inline","tokens","split","pop","parseExprSeq","eat","parseExprSubscript","test","typeName","groups","resolveName","parseExprAtom","parseExprRange","parseNum","Number","defaults","attrName","attr","hasDefault","computeAttrs","built","given","initAttrs","Attribute","tok","SyntaxError","NodeType","group","markSet","atom","whitespace","code","isRequired","createChecked","allowsMarkType","markType","allowedMarks","topType","topNode","options","MarkType","excluded","instance","Schema","contentExprCache","contentExpr","markExpr","gatherMarks","excl","topNodeType","wrappings","ok","DOMParser","rules","tags","styles","rule","tag","style","normalizeLists","some","dom","context","ParseContext","addAll","finish","parseSlice","matchTag","matches","namespace","namespaceURI","matchesContext","getAttrs","matchStyle","charCodeAt","schemaRules","priority","parseDOM","fromSchema","domParser","blockTags","address","article","aside","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","noscript","ol","output","pre","section","table","tfoot","ul","ignoreTags","head","script","title","listTags","wsOptionsFor","preserveWhitespace","OPT_PRESERVE_WS","NodeContext","pendingMarks","solid","activeMarks","stashMarks","fill","wrap","exec","popFromStashMark","applyPending","nextType","pending","markMayApply","inlineContext","parentNode","nodeName","toLowerCase","parser","open","isOpen","topContext","topOptions","topMatch","findPositions","needsBlock","selector","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","v","top","addDOM","addTextNode","getAttribute","readStyles","re","trim","parseStyles","addPendingMark","addElement","removePendingMark","nodeValue","domNodeBefore","previousSibling","insertNode","findInText","findInside","matchAfter","ruleID","prevItem","nextSibling","appendChild","normalizeList","ruleFromNode","ignore","ignoreFallback","skip","closeParent","sync","oldNeedsBlock","leafFallback","addElementByRule","consuming","ownerDocument","createTextNode","findPlace","continueAfter","enter","startIn","getContent","contentDOM","contentElement","querySelector","findAround","childNodes","findAtPoint","route","cx","enterInner","block","textblockFromContext","closeExtra","preserveWS","topOpen","currentPos","contains","compareDocumentPosition","textNode","parts","option","useRoot","minDepth","part","$context","deflt","findSameMarkInSet","upto","level","lastIndexOf","stashMark","DOMSerializer","gatherToDOM","toDOM","document","window","serializeFragment","createDocumentFragment","keep","rendered","spanning","add","markDOM","serializeMark","serializeNodeInner","renderSpec","onContent","serializeNode","structure","xmlNS","tagName","space","createElementNS","createElement","setAttributeNS","setAttribute","innerContent","domSerializer","nodesFromSchema","marksFromSchema","classesById","Selection","$anchor","$head","ranges","SelectionRange","anchor","tr","lastNode","lastParent","mapFrom","steps","mapping","replaceRange","selectionToInsertionEnd","replaceWith","deleteRange","replaceRangeWith","findFrom","$pos","dir","textOnly","TextSelection","findSelectionIn","near","bias","AllSelection","atStart","atEnd","cls","jsonID","id","selectionClass","getBookmark","between","visible","$cursor","ensureMarks","TextBookmark","dPos","NodeSelection","mapResult","deleted","NodeBookmark","isSelectable","selectable","sel","selection","setSelection","AllBookmark","startLen","step","ReplaceStep","ReplaceAroundStep","maps","_from","_to","_newFrom","newTo","Transaction","time","Date","now","curSelection","curSelectionFor","storedMarks","updated","meta","selectionSet","setStoredMarks","addStoredMark","removeStoredMark","storedMarksSet","addStep","setTime","replaceSelection","replaceSelectionWith","inheritMarks","deleteSelection","insertText","setMeta","getMeta","isGeneric","scrollIntoView","scrolledIntoView","Transform","FieldDesc","desc","init","apply","baseFields","config","_marks","_old","prev","Configuration","plugins","fields","pluginsByKey","plugin","EditorState","applyTransaction","filterTransaction","rootTr","transactions","trs","newState","applyInner","haveNew","appendTransaction","oldState","newInstance","field","applyListeners","$config","reconfigure","pluginFields","addApplyListener","removeApplyListener","Plugin","props","bindProps","Function","createKey","getState","keys","PluginKey","dispatch","textblockAt","side","only","findCutBefore","findCutAfter","newlineInCode","defaultBlockAt","exitCode","above","splitBlock","canSplit","can","$first","setNodeMarkup","deleteBarrier","$cut","conn","canJoin","clearIncompatible","joinMaybeClear","canDelAfter","joinAt","selAfter","range","liftTarget","lift","at","afterText","afterDepth","selectTextblockSide","selectTextblockStart","selectTextblockEnd","wrapIn","wrapping","setBlockType","applicable","toggleMark","markApplies","has","removeMark","spaceStart","spaceEnd","addMark","chainCommands","view","commands","backspace","endOfTextblock","delStep","replaceStep","del","pcBaseKeymap","macBaseKeymap","Home","End","baseKeymap","navigator","platform","os","markInputRule","regexp","InputRule","markEnd","markStart","matchStart","matchEnd","textStart","textEnd","getMarksBetween","filter","item","nodeInputRule","getMarkRange","toggleBlockType","toggletype","nodeIsActive","isList","bullet_list","ordered_list","todo_list","toggleList","listType","itemType","parentList","findParentNode","liftListItem","wrapInList","toggleWrap","updateMark","ref$1","factor16","pow","recoverIndex","MapResult","recover","StepMap","inverted","diff","recoverOffset","assoc","_map","simple","oldIndex","newIndex","oldSize","newSize","touches","oldStart","newStart","invert","Mapping","mirror","TransformError","appendMap","mirrors","setMirror","appendMapping","startSize","mirr","getMirror","appendMappingInverted","totalSize","inverse","corr","docs","mustOverride","maybeStep","failed","docChanged","getMap","stepsByID","Step","_doc","_mapping","merge","_other","stepType","stepClass","StepResult","fail","fromReplace","e","contentBetween","gapFrom","gapTo","gap","inserted","canCut","innerRange","around","outer","findWrappingOutside","inside","innerMatch","findWrappingInside","withAttrs","typesAfter","innerType","rest","baseType","joinPoint","dropPoint","pass","insertPos","fits","mapFragment","mapped","gapStart","gapEnd","splitting","wrappers","canChangeType","startM","endM","newNode","typeAfter","AddMarkStep","oldSlice","RemoveMarkStep","fitsTrivially","Fitter","fit","removed","added","removing","adding","newSet","matched","toRemove","parentType","delSteps","allowed","unplaced","frontier","dropFromFragment","count","addToFragment","contentAt","closeNodeStart","contentAfterFits","invalidMarks","closeFragment","oldOpen","newOpen","coveredDepths","findFittable","placeNodes","openMore","dropNode","moveInline","mustMoveInline","placedSize","sliceDepth","frontierDepth","inject","openAtEnd","closeFrontierNode","openFrontierNode","taken","openEndCount","findCloseLevel","dropInner","move","targetDepths","preferredTarget","unshift","defining","preferredTargetIndex","leftNodes","preferredDepth","openDepth","targetDepth","expand","startSteps","point","insertPoint","covered","_hasOwnProperty","isValidEntityCode","fromCodePoint","surrogate1","surrogate2","String","fromCharCode","UNESCAPE_MD_RE","UNESCAPE_ALL_RE","RegExp","source","DIGITAL_ENTITY_TEST_RE","entities","require","HTML_ESCAPE_TEST_RE","HTML_ESCAPE_REPLACE_RE","HTML_REPLACEMENTS","replaceUnsafeChar","ch","REGEXP_ESCAPE_RE","UNICODE_PUNCT_RE","lib","mdurl","ucmicro","assign","sources","arguments","TypeError","isString","_class","unescapeMd","unescapeAll","escaped","entity","parseInt","replaceEntityPattern","escapeHtml","arrayReplaceAt","src","newElements","isSpace","isWhiteSpace","isMdAsciiPunct","isPunctChar","escapeRE","normalizeReference","toUpperCase","handler","cutOff","inputRules","ref","stored","handleTextInput","run","handleDOMEvents","compositionend","setTimeout","isInputRules","composing","textBefore","transform","undoInputRule","undoable","toUndo","ellipsis","wrappingInputRule","joinPredicate","textblockTypeInputRule","_setPrototypeOf","setPrototypeOf","_inheritsLoose","subClass","superClass","paragraph","horizontal_rule","heading","default","code_block","params","order","tight","hasAttribute","list_item","image","alt","draggable","hard_break","em","strong","link","href","MarkdownParseState","tokenHandlers","stack","token","noCloseToken","withoutTrailingNewline","noOp","elt","addText","merged","maybeMerge","openMark","closeMark","parseTokens","toks","openNode","closeNode","info","MarkdownParser","tokenizer","handlers","children","softbreak","listIsTight","hidden","defaultMarkdownParser","markdownit","html","attrGet","fence","hardbreak","code_inline","MarkdownSerializer","serialize","MarkdownSerializerState","renderContent","defaultMarkdownSerializer","wrapBlock","write","ensureNewLine","closeBlock","repeat","renderInline","markup","renderList","bullet","maxW","nStr","esc","mixable","expelEnclosingWhitespace","_state","isPlainURL","_mark","backticksFor","escape","ticks","len","delim","closed","inTightList","tightLists","flushClose","atBlank","delimMin","firstDelim","old","lines","startOfLine","render","trailing","progress","leading","lead","trail","noEsc","markString","isTight","prevTight","escapeExtraCharacters","quote","getEnclosingWhitespace","doJoin","outerRange","$insert","joinBefore","splitDepth","splitPos","doWrapInList","splitListItem","grandParent","depthBefore","depthAfter","endOfList","liftToOuterList","list","indexBefore","liftOutOfList","sinkListItem","nestedBefore","flarum","core","compat","CommandButton","oninit","vnode","addItem","command","onEditorUpdate","extractText","tooltip","className","onclick","click","onkeydown","keydown","icon","preventDefault","app","translator","trans","Component","predicate","findParentNodeClosestToPos","findSelectedNodeOfType","isNodeSelection","equalNodeType","getMarkAttrs","markItem","endPos","markIsActive","MarkButton","$","toggleClass","markActive","8","9","10","12","13","16","17","18","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","106","107","108","109","110","111","144","145","160","161","162","163","164","165","173","186","187","188","189","190","191","192","219","220","221","222","229","48","49","50","51","52","53","54","55","56","57","chrome","userAgent","safari","vendor","gecko","mac","ie","brokenModifierNames","normalizeKeyName","ctrl","mod","modifiers","event","altKey","ctrlKey","metaKey","shiftKey","keymap","bindings","handleKeyDown","keydownHandler","normalize","baseName","keyCode","keyName","isChar","direct","fromCode","withShift","_extends","SafariModalHack","oncreate","on","modal","onsubmit","vnodeContent","Modal","FormDropdown","buttonClassName","is","show","toArray","stopPropagation","focus","select","getButtonContent","getMenu","items","ItemList","trigger","composer","editor","Dropdown","ListButton","nodeActive","encode","decode","format","genMarkupAwareMarkConfig","error","MarkdownSerializerBuilder","buildNodes","spoiler","math_block","buildMarks","spoiler_inline","strike","sup","math_inline","build","genHtmlInlineMarkSpec","spoilerNodeSpec","class","mathBlockNodeSpec","SchemaBuilder","NodeTypeDropdown","getNodeTypeButtons","getButton","data-toggle","activeIndex","element","innerText","InsertImageDropdown","Stream","placeholder","bidi","required","MenuState","attachEditorView","editorView","getSchema","destroy","markAttrs","selectionEmpty","transaction","RopeSequence","leafAppend","leafPrepend","appendInner","Append","sliceInner","getInner","forEachInner","forEachInvertedInner","values","Leaf","configurable","flatten","defineProperties","left","right","leftLen","ropeSequence","Branch","eventCount","popEvent","preserveItems","remap","remapping","remaining","addAfter","Item","addTransform","histOptions","newItems","oldItems","lastItem","cutPoint","overflow","DEPTH_OVERFLOW","mirrorPos","mirrorOffset","addMaps","rebased","rebasedTransform","rebasedCount","rebasedItems","newUntil","iRebased","newMaps","branch","emptyItemCount","compress","events","newItem","HistoryState","done","undone","prevRanges","prevTime","rangesFor","mapRanges","histTransaction","history","redo","mustPreserveItems","historyKey","newHist","historyState","cachedPreserveItems","cachedPreserveItemsPlugins","historyPreserveItems","closeHistoryKey","newGroupDelay","hist","historyTr","appended","newGroup","adjacent","isAdjacentTo","beforeinput","handled","inputType","undo","ie_edge","ie_upto10","ie_11up","ie_version","documentMode","gecko_version","chrome_version","ios","maxTouchPoints","android","webkit","documentElement","webkit_version","domIndex","assignedSlot","host","reusedRange","textRange","createRange","setEnd","setStart","isEquivalentPosition","off","targetNode","targetOff","scanFor","atomElements","hasBlockDesc","contentEditable","pmViewDesc","selectionCollapsed","domSel","collapsed","isCollapsed","browser","rangeCount","getRangeAt","keyEvent","createEvent","initEvent","windowRect","clientWidth","bottom","clientHeight","getSide","clientRect","rect","getBoundingClientRect","scaleX","width","offsetWidth","scaleY","height","offsetHeight","scrollRectIntoView","startDOM","scrollThreshold","someProp","scrollMargin","atTop","body","bounding","moveX","moveY","defaultView","scrollBy","startX","scrollLeft","startY","scrollTop","dX","dY","scrollStack","restoreScrollStack","dTop","preventScrollSupported","findOffsetInNode","coords","closest","coordsClosest","dxClosest","rowBot","rowTop","childIndex","rects","getClientRects","dx","singleRect","inRect","findOffsetInText","posAtCoords","caretPositionFromPoint","caretRangeFromPoint","assign$1","root","elementFromPoint","box","startI","floor","targetKludge","outside","docView","nearestDesc","posBefore","posAfter","posFromDOM","posFromCaret","posFromElement","posAtStart","border","BIDI","coordsAtPos","domFromPos","supportEmptyRange","takeSide","flattenV","rectBefore","rectAfter","flattenH","ignoreForCoords","x","y","withFlushedState","viewState","activeElement","updateState","maybeRTL","cachedState","cachedDir","cachedResult","nearest","boxes","endOfTextblockVertical","getSelection","modify","oldRange","oldNode","focusNode","oldOff","focusOffset","oldBidiLevel","caretBidiLevel","domAfterPos","removeAllRanges","endOfTextblockHorizontal","ViewDesc","dirty","matchesWidget","matchesMark","matchesNode","matchesHack","_nodeName","parseRule","stopEvent","posBeforeChild","posAtEnd","localPosFromDOM","domBefore","domAfter","onlyNodes","getDesc","nodeDOM","descAt","TrailingHackViewDesc","WidgetViewDesc","widget","domAtom","parseRange","fromOffset","toOffset","childBase","emptyChildAt","force","anchorDOM","headDOM","brKludge","anchorNode","anchorOffset","domSelExtended","extend","collapse","DOMException","ignoreMutation","mutation","contentLost","markDirty","startInside","endInside","markParentsDirty","nothing","raw","classList","stop","ignoreSelection","CompositionViewDesc","textDOM","prototypeAccessors$2","mut","oldValue","MarkViewDesc","custom","nodeViews","reparseInView","replaceNodes","NodeViewDesc","outerDeco","innerDeco","updateChildren","descObj","applyOuterDeco","CustomNodeViewDesc","TextViewDesc","sameOuterDeco","prototypeAccessors$3","composition","localCompositionInfo","localComposition","compositionInChild","updater","ViewTreeUpdater","deco","onWidget","onNode","locals","forChild","decoIndex","restNode","parentIndex","widgets","compareSide","cutAt","iterDeco","insideNode","syncToMarks","placeWidget","compIndex","findNodeMatch","findIndexWithChild","updateNodeAt","updateNextNode","addTextblockHacks","destroyRest","changed","protectLocalComposition","renderDescs","parentDOM","descs","written","childDOM","rm","insertBefore","trackWrites","oldCSS","cssText","getComputedStyle","listStyle","iosHacks","nearbyTextNode","textPos","childStart","findTextInFragment","removeChild","compositionNodes","updateInner","updateOuterDeco","needsWrap","oldDOM","patchOuterDeco","computeOuterDeco","selectNode","deselectNode","removeAttribute","docViewDesc","pmIsDeco","inParent","prototypeAccessors$4","prototypeAccessors$5","OuterDecoLevel","noDeco","outerDOM","prevComputed","curComputed","curDOM","patchAttributes","prevList","Boolean","curList","removeProperty","lockedNode","lock","preMatch","parentDesc","curDesc","descI","fI","Map","selectionFromDOM","origin","inWidget","isOnEdge","selectionBetween","editorOwnsSelection","editable","hasFocus","hasSelection","selectionToDOM","syncNodeSelection","mouseDown","allowDefault","curSel","domObserver","currentSelection","delayedSelectionSync","setCurSelection","disconnectSelection","cursorWrapper","img","disabled","selectCursorWrapper","resetEditableFrom","resetEditableTo","brokenSelectBetweenUneditable","temporarilyEditableNear","resetEditable","removeEventListener","hideSelectionGuard","addEventListener","removeClassOnSelectionChange","connectSelection","destroyBetween","maxKeep","markDesc","targetDesc","domNode","nextDOM","addHackNode","setEditable","wasDraggable","lastSelectedViewDesc","clearNodeSelection","moveSelectionBlock","$side","selectHorizontally","mods","nodePos","nodeLen","isIgnorable","skipIgnoredNodesLeft","moveNode","moveOffset","isBlockNode","setSelFocus","skipIgnoredNodesRight","selectVertically","beyond","stopNativeHorizontalDelete","nextNode","switchEditable","captureKeyDown","getMods","safariDownArrowBug","readDOMChange","typeOver","addedNodes","lastSelectionTime","lastSelectionOrigin","newSel","shared","from_","to_","lastKeyCode","startDoc","editableContent","parseBetween","preferredPos","preferredSide","compare","lastKeyCodeTime","change","endA","endB","adjust","findDiff","lastIOSEnter","resolveSelection","domChangeCount","nextSel","inlineChange","$newStart","$newEnd","skipClosingAndOpening","$next","looksLikeJoin","suppressSelectionUpdates","toB","lastAndroidDelete","markChange","$from1","chFrom","chTo","curMarks","prevMarks","isMarkChange","parsedSel","fromEnd","mayOpen","serializeForClipboard","serializer","detachedDoc","wrapMap","wrapper","parseFromClipboard","plainText","inCode","asText","parsed","metas","firstTag","innerHTML","readHTML","querySelectorAll","restoreReplacedSpaces","contextNode","sliceData","inlineParents","addContext","closeSlice","lastWrap","inLast","addToSibling","sibling","withWrappers","closeRight","wrapped","normalizeSiblings","closeRange","thead","tbody","caption","colgroup","col","td","th","_detachedDoc","implementation","createHTMLDocument","observeOptions","childList","characterData","characterDataOldValue","attributes","attributeOldValue","subtree","useCharData","SelectionState","DOMObserver","handleDOMChange","queue","flushingSoon","observer","MutationObserver","mutations","removedNodes","flushSoon","flush","onCharData","prevValue","onSelectionChange","suppressingSelectionUpdates","forceFlush","clearTimeout","observe","take","takeRecords","disconnect","ignoreSelectionChange","container","commonAncestorContainer","registerMutation","brs","cssChecked","whiteSpace","console","checkCSS","attributeName","editHandlers","setSelectionOrigin","ensureListeners","currentHandlers","eventHandlers","runCustomHandler","defaultPrevented","eventCoords","clientX","clientY","runHandlerOnContext","propName","updateSelection","focused","handleSingleClick","selectedNode","selectAt","selectClickedNode","selectClickedLeaf","handleDoubleClick","handleTripleClick","button","defaultTripleClick","forceDOMFlush","endComposition","inOrNearComposition","lastIOSEnterFallbackTimeout","keyup","keypress","charCode","selectNodeModifier","mousedown","flushed","lastClick","dy","isNear","MouseDown","targetPos","mightDrag","addAttr","setUneditable","up","abs","timeStamp","compositionEndedAt","buttons","touchdown","contextmenu","timeoutComposition","scheduleComposeEnd","delay","composingTimeout","clearComposition","forceUpdate","compositionstart","compositionupdate","markCursor","brokenClipboardAPI","doPaste","singleNode","sliceSingleNode","data","clipboardData","clearData","setData","selectNodeContents","blur","captureCopy","paste","getData","capturePaste","Dragging","dragCopyModifier","dragstart","dataTransfer","effectAllowed","dragging","dragend","dragover","dragenter","drop","eventPos","$mouse","isNode","beforeInsert","relatedTarget","compareObjs","WidgetType","noSpec","span","oldOffset","Decoration","valid","InlineType","inclusiveStart","inclusiveEnd","DecorationSet","local","decorations","buildTree","findInner","childOff","mapInner","newLocal","onRemove","oldChildren","oldEnd","newEnd","dSize","mustRebuild","fromLocal","toLocal","childOffset","childNode","gather","mapAndGatherRemainingDecorations","byPos","mapChildren","addInner","baseOffset","takeSpansForNode","moveSpans","withoutNulls","removeInner","dec","localSet","DecorationGroup","removeOverlap","localsInner","members","spans","hasNulls","localStart","working","insertAhead","viewDecorations","mappedDecos","member","sorted","EditorView","_props","directPlugins","checkStateComponent","_root","mount","mounted","getEditable","updateCursorWrapper","buildNodeViews","computeDocDeco","bubbles","eventBelongsToView","initInput","prevDirectPlugins","pluginViews","updatePluginViews","contenteditable","translate","updateStateInner","setProps","reconfigured","redraw","updateSel","nA","nB","changedNodeViews","scroll","scrollToSelection","updateDoc","sel1","sel2","newRefTop","oldScrollPos","overflowAnchor","refDOM","refTop","innerHeight","localRect","storeScrollPos","forceSelUpdate","chromeKludge","destroyPluginViews","prevState","pluginView","setActive","preventScroll","focusPreventScroll","getPrototypeOf","domAtPos","posAtDOM","destroyInput","isDestroyed","dispatchEvent","dispatchTransaction","DropCursorView","color","cursorPos","timeout","setCursor","updateOverlay","nodeRect","parentLeft","parentTop","offsetParent","position","pageXOffset","pageYOffset","scheduleRemoval","disableDropCursor","dragleave","GapCursor","GapBookmark","closedBefore","closedAfter","override","allowGapCursor","mustMove","$cur","arrow","axis","dirStr","$found","handleClick","drawGapCursor","dataImageRegex","onClick","orderedListRule","bulletListRule","codeBlockRule","headingRule","maxLevel","blockSpoilerRule","ProseMirrorEditorDriver","MarkdownParserBuilder","buildEditorStateConfig","buildEditorProps","classNames","callInputListeners","inputListeners","listener","oninput","onkeyup","parseInitialValue","buildPluginItems","menuState","buildInputRules","Escape","insertHardBreak","enterCommands","emojiDropdown","mentionsDropdown","session","user","preferences","richTextCompactParagraphs","handleEnter","Backspace","Enter","richTextKeymap","disabled$","curr","transformPastedHTML","parseFromString","outerHTML","createSelectionBetween","_view","handleClickOn","handleDoubleClickOn","newDoc","newDocPlaintext","serializeContent","moveCursorTo","setSelectionRange","getSelectionRange","getLastNChars","insertAtCursor","insertBetween","trailingNewLines","parsedText","OFFSET_TO_REMOVE_PREFIX_NEWLINE","endsWith","replaceBeforeCursor","getCaretCoordinates","viewportCoords","editorViewportOffset","isTerminatorChar","tokenize","silent","posMax","md","ruler","disable","blockquoteExt","startLine","endLine","adjustTab","initial","lastLineEmpty","nextLine","oldBMarks","oldBSCount","oldIndent","oldParentType","oldSCount","oldTShift","spaceAfterMarker","terminate","terminatorRules","wasOutdented","oldLineMax","lineMax","bMarks","tShift","eMarks","sCount","blkIndent","followingCharRegex","bsCount","foundExclamation","foundOpen","oldPos","getRules","line","spoilerFn","blockquoteFn","blockSpoiler","__rules__","bqIndex","postProcess","delimiters","loneMarkers","startDelim","marker","endDelim","tokenO","nesting","tokenC","frontPriorMode","scanned","scanDelims","isOdd","jump","can_open","can_close","ruler2","tokens_meta","tokenizerParams","buildTokenizer","enable","use","altText","latexPlugin","subPlugin","supPlugin","inlineSpoilerBars","inlineSpoilerTags","buildTokens","HiddenItemsDropdown","ProseMirrorMenu","modifierKey","component","InsertLinkDropdown","hiddenItems","linkAttrs","Ruler","__cache__","__find__","__compile__","chains","enabled","altName","chain","fn","opt","beforeName","ruleName","afterName","ignoreInvalid","idx","enableOnly","chainName","Token","attrIndex","attrPush","attrData","attrSet","attrJoin","Any","Cc","Cf","P","Z","open_tag","close_tag","HTML_TAG_RE","HTML_OPEN_CLOSE_TAG_RE","isStrong","freeGlobal","global","punycode","maxInt","regexPunycode","regexNonASCII","regexSeparators","errors","stringFromCharCode","mapDomain","ucs2decode","counter","ucs2encode","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","baseMinusTMin","input","basic","oldi","w","baseMinusT","codePoint","inputLength","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","define","components","updateToggleMark","proseMirror","markdown","applyEditor","TextEditor","forum","attribute","Button","useRichTextEditor","savePreferences","then","buildEditor","original","buildEditorParams","UNESCAPE_RE","subscript","skipToken","superscript","isValidDelim","prevChar","nextChar","firstLine","lastLine","lastPos","getLines","server","purifiedURL","latex","encodeURIComponent","renderer","Inline","Block","utils","helpers","Renderer","ParserCore","ParserBlock","ParserInline","LinkifyIt","zero","commonmark","BAD_PROTO_RE","GOOD_DATA_RE","validateLink","url","RECODE_HOSTNAME_FOR","normalizeLink","hostname","protocol","toASCII","er","normalizeLinkText","toUnicode","defaultChars","MarkdownIt","presetName","linkify","configure","presets","rules2","missed","args","env","State","process","parseInline","inlineMode","encodeCache","exclude","keepEscaped","nextCode","cache","getEncodeCache","componentChars","decodeCache","getDecodeCache","seq","b1","b2","b3","b4","chr","slashes","auth","port","pathname","hash","Url","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","hostlessProtocol","slashedProtocol","slashesDenoteHost","lowerProto","hec","simplePath","proto","substr","atSign","hostEnd","parseHost","ipv6Hostname","hostparts","newpart","validParts","notHost","bit","qm","u","parseLinkLabel","parseLinkDestination","parseLinkTitle","disableNested","prevPos","labelEnd","default_rules","slf","renderAttrs","highlighted","arr","tmpAttrs","tmpToken","langName","langAttrs","highlight","langPrefix","renderInlineAsText","renderToken","xhtmlOut","breaks","html_block","html_inline","nextToken","needLf","_rules","Core","NEWLINES_RE","NULL_RE","isLinkClose","currentToken","ln","htmlLinkLevel","fullUrl","urlText","links","blockTokens","pretest","lastIndex","RARE_RE","SCOPED_ABBR_TEST_RE","SCOPED_ABBR_RE","SCOPED_ABBR","tm","replaceFn","replace_scoped","inlineTokens","inside_autolink","replace_rare","blkIdx","typographer","QUOTE_TEST_RE","QUOTE_RE","replaceAt","process_inlines","thisLevel","lastChar","isLastPunctChar","isNextPunctChar","isLastWhiteSpace","isNextWhiteSpace","canOpen","canClose","isSingle","openQuote","closeQuote","OUTER","single","quotes","StateCore","hasEmptyLines","maxNesting","skipEmptyLines","isEmpty","outTokens","getLine","escapedSplit","isEscaped","substring","lineText","columns","columnCount","aligns","tableLines","tbodyLines","firstCh","secondCh","mem","haveEndMarker","skipChars","skipSpaces","isOutdented","cnt","skipBulletListMarker","skipOrderedListMarker","contentStart","indent","indentAfterMarker","isOrdered","itemLines","listLines","listTokIdx","markerCharCode","markerValue","oldListIndent","oldTight","posAfterMarker","prevEmptyEnd","isTerminatingParagraph","listIndent","markTightParagraphs","_endLine","destEndPos","destEndLineNo","label","res","references","block_names","HTML_SEQUENCES","skipSpacesBack","skipCharsBack","StateBlock","indent_found","ddIndent","begin","keepLastLF","lineIndent","lineStart","_rules2","pushPending","pmax","ws","ESCAPED","openerLength","closerLength","backticksScanned","backticks","labelStart","parseReference","EMAIL_RE","AUTOLINK_RE","lc","isLetter","DIGITAL_RE","NAMED_RE","processDelimiters","closerIdx","openerIdx","closer","opener","minOpenerIdx","newMinOpenerIdx","isOddMatch","lastJump","openersBottom","headerIdx","lastTokenIdx","jumps","StateInline","pendingLevel","_prev_delimiters","token_meta","canSplitWord","left_flanking","right_flanking","isFunction","defaultOptions","fuzzyLink","fuzzyEmail","fuzzyIP","defaultSchemas","validate","tail","http","src_auth","src_host_port_strict","src_path","no_http","src_domain","src_domain_root","src_port","src_host_terminator","mailto","src_email_name","src_host_strict","tlds_default","__opts__","tlds","__tlds__","untpl","tpl","src_tlds","onCompile","__tlds_replaced__","src_xn","email_fuzzy","tpl_email_fuzzy","link_fuzzy","tpl_link_fuzzy","link_no_ip_fuzzy","tpl_link_no_ip_fuzzy","host_fuzzy_test","tpl_host_fuzzy_test","aliases","schemaError","__compiled__","__schemas__","compiled","isRegExp","createValidator","alias","slist","schema_test","src_ZPCc","schema_search","__index__","__text_cache__","resetScanCache","Match","__last_index__","__schema__","createMatch","schemas","acc","definition","ml","me","tld_pos","testSchemaAt","keepOld","el","opts","src_Any","src_Cc","src_Z","src_P","src_ZCc","src_pseudo_letter","src_ip4","src_host","tpl_host_fuzzy","tpl_host_no_ip_fuzzy","tpl_host_fuzzy_strict","tpl_host_port_fuzzy_strict","tpl_host_port_no_ip_fuzzy_strict","webpackPolyfill","deprecate","paths","g","escapes","backTicked","lastBackTick","linkMatch","emailMatch","initializers","extensionData","registerSetting","setting"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 170);\n","// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string) → ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string) → OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string) → OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any) → OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>) → OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","import {findDiffStart, findDiffEnd} from \"./diff\"\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nexport class Fragment {\n  constructor(content, size) {\n    this.content = content\n    // :: number\n    // The size of the fragment, which is the total of the size of its\n    // content nodes.\n    this.size = size || 0\n    if (size == null) for (let i = 0; i < content.length; i++)\n      this.size += content[i].nodeSize\n  }\n\n  // :: (number, number, (node: Node, start: number, parent: Node, index: number) → ?bool, ?number)\n  // Invoke a callback for all descendant nodes between the given two\n  // positions (relative to start of this fragment). Doesn't descend\n  // into a node when the callback returns `false`.\n  nodesBetween(from, to, f, nodeStart = 0, parent) {\n    for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n        let start = pos + 1\n        child.nodesBetween(Math.max(0, from - start),\n                           Math.min(child.content.size, to - start),\n                           f, nodeStart + start)\n      }\n      pos = end\n    }\n  }\n\n  // :: ((node: Node, pos: number, parent: Node) → ?bool)\n  // Call the given callback for every descendant node. The callback\n  // may return `false` to prevent traversal of a given node's children.\n  descendants(f) {\n    this.nodesBetween(0, this.size, f)\n  }\n\n  // :: (number, number, ?string, ?union<string, (leafNode: Node) → string>) → string\n  // Extract the text between `from` and `to`. See the same method on\n  // [`Node`](#model.Node.textBetween).\n  textBetween(from, to, blockSeparator, leafText) {\n    let text = \"\", separated = true\n    this.nodesBetween(from, to, (node, pos) => {\n      if (node.isText) {\n        text += node.text.slice(Math.max(from, pos) - pos, to - pos)\n        separated = !blockSeparator\n      } else if (node.isLeaf && leafText) {\n        text += typeof leafText === 'function' ? leafText(node): leafText\n        separated = !blockSeparator\n      } else if (!separated && node.isBlock) {\n        text += blockSeparator\n        separated = true\n      }\n    }, 0)\n    return text\n  }\n\n  // :: (Fragment) → Fragment\n  // Create a new fragment containing the combined content of this\n  // fragment and the other.\n  append(other) {\n    if (!other.size) return this\n    if (!this.size) return other\n    let last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0\n    if (last.isText && last.sameMarkup(first)) {\n      content[content.length - 1] = last.withText(last.text + first.text)\n      i = 1\n    }\n    for (; i < other.content.length; i++) content.push(other.content[i])\n    return new Fragment(content, this.size + other.size)\n  }\n\n  // :: (number, ?number) → Fragment\n  // Cut out the sub-fragment between the two given positions.\n  cut(from, to) {\n    if (to == null) to = this.size\n    if (from == 0 && to == this.size) return this\n    let result = [], size = 0\n    if (to > from) for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from) {\n        if (pos < from || end > to) {\n          if (child.isText)\n            child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos))\n          else\n            child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1))\n        }\n        result.push(child)\n        size += child.nodeSize\n      }\n      pos = end\n    }\n    return new Fragment(result, size)\n  }\n\n  cutByIndex(from, to) {\n    if (from == to) return Fragment.empty\n    if (from == 0 && to == this.content.length) return this\n    return new Fragment(this.content.slice(from, to))\n  }\n\n  // :: (number, Node) → Fragment\n  // Create a new fragment in which the node at the given index is\n  // replaced by the given node.\n  replaceChild(index, node) {\n    let current = this.content[index]\n    if (current == node) return this\n    let copy = this.content.slice()\n    let size = this.size + node.nodeSize - current.nodeSize\n    copy[index] = node\n    return new Fragment(copy, size)\n  }\n\n  // : (Node) → Fragment\n  // Create a new fragment by prepending the given node to this\n  // fragment.\n  addToStart(node) {\n    return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n  }\n\n  // : (Node) → Fragment\n  // Create a new fragment by appending the given node to this\n  // fragment.\n  addToEnd(node) {\n    return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n  }\n\n  // :: (Fragment) → bool\n  // Compare this fragment to another one.\n  eq(other) {\n    if (this.content.length != other.content.length) return false\n    for (let i = 0; i < this.content.length; i++)\n      if (!this.content[i].eq(other.content[i])) return false\n    return true\n  }\n\n  // :: ?Node\n  // The first child of the fragment, or `null` if it is empty.\n  get firstChild() { return this.content.length ? this.content[0] : null }\n\n  // :: ?Node\n  // The last child of the fragment, or `null` if it is empty.\n  get lastChild() { return this.content.length ? this.content[this.content.length - 1] : null }\n\n  // :: number\n  // The number of child nodes in this fragment.\n  get childCount() { return this.content.length }\n\n  // :: (number) → Node\n  // Get the child node at the given index. Raise an error when the\n  // index is out of range.\n  child(index) {\n    let found = this.content[index]\n    if (!found) throw new RangeError(\"Index \" + index + \" out of range for \" + this)\n    return found\n  }\n\n  // :: (number) → ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) {\n    return this.content[index]\n  }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) {\n    for (let i = 0, p = 0; i < this.content.length; i++) {\n      let child = this.content[i]\n      f(child, p, i)\n      p += child.nodeSize\n    }\n  }\n\n  // :: (Fragment) → ?number\n  // Find the first position at which this fragment and another\n  // fragment differ, or `null` if they are the same.\n  findDiffStart(other, pos = 0) {\n    return findDiffStart(this, other, pos)\n  }\n\n  // :: (Fragment) → ?{a: number, b: number}\n  // Find the first position, searching from the end, at which this\n  // fragment and the given fragment differ, or `null` if they are the\n  // same. Since this position will not be the same in both nodes, an\n  // object with two separate positions is returned.\n  findDiffEnd(other, pos = this.size, otherPos = other.size) {\n    return findDiffEnd(this, other, pos, otherPos)\n  }\n\n  // : (number, ?number) → {index: number, offset: number}\n  // Find the index and inner offset corresponding to a given relative\n  // position in this fragment. The result object will be reused\n  // (overwritten) the next time the function is called. (Not public.)\n  findIndex(pos, round = -1) {\n    if (pos == 0) return retIndex(0, pos)\n    if (pos == this.size) return retIndex(this.content.length, pos)\n    if (pos > this.size || pos < 0) throw new RangeError(`Position ${pos} outside of fragment (${this})`)\n    for (let i = 0, curPos = 0;; i++) {\n      let cur = this.child(i), end = curPos + cur.nodeSize\n      if (end >= pos) {\n        if (end == pos || round > 0) return retIndex(i + 1, end)\n        return retIndex(i, curPos)\n      }\n      curPos = end\n    }\n  }\n\n  // :: () → string\n  // Return a debugging string that describes this fragment.\n  toString() { return \"<\" + this.toStringInner() + \">\" }\n\n  toStringInner() { return this.content.join(\", \") }\n\n  // :: () → ?Object\n  // Create a JSON-serializeable representation of this fragment.\n  toJSON() {\n    return this.content.length ? this.content.map(n => n.toJSON()) : null\n  }\n\n  // :: (Schema, ?Object) → Fragment\n  // Deserialize a fragment from its JSON representation.\n  static fromJSON(schema, value) {\n    if (!value) return Fragment.empty\n    if (!Array.isArray(value)) throw new RangeError(\"Invalid input for Fragment.fromJSON\")\n    return new Fragment(value.map(schema.nodeFromJSON))\n  }\n\n  // :: ([Node]) → Fragment\n  // Build a fragment from an array of nodes. Ensures that adjacent\n  // text nodes with the same marks are joined together.\n  static fromArray(array) {\n    if (!array.length) return Fragment.empty\n    let joined, size = 0\n    for (let i = 0; i < array.length; i++) {\n      let node = array[i]\n      size += node.nodeSize\n      if (i && node.isText && array[i - 1].sameMarkup(node)) {\n        if (!joined) joined = array.slice(0, i)\n        joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text)\n      } else if (joined) {\n        joined.push(node)\n      }\n    }\n    return new Fragment(joined || array, size)\n  }\n\n  // :: (?union<Fragment, Node, [Node]>) → Fragment\n  // Create a fragment from something that can be interpreted as a set\n  // of nodes. For `null`, it returns the empty fragment. For a\n  // fragment, the fragment itself. For a node or array of nodes, a\n  // fragment containing those nodes.\n  static from(nodes) {\n    if (!nodes) return Fragment.empty\n    if (nodes instanceof Fragment) return nodes\n    if (Array.isArray(nodes)) return this.fromArray(nodes)\n    if (nodes.attrs) return new Fragment([nodes], nodes.nodeSize)\n    throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                         (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n  }\n}\n\nconst found = {index: 0, offset: 0}\nfunction retIndex(index, offset) {\n  found.index = index\n  found.offset = offset\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0)\n","export function findDiffStart(a, b, pos) {\n  for (let i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      return a.childCount == b.childCount ? null : pos\n\n    let childA = a.child(i), childB = b.child(i)\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) return pos\n\n    if (childA.isText && childA.text != childB.text) {\n      for (let j = 0; childA.text[j] == childB.text[j]; j++)\n        pos++\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffStart(childA.content, childB.content, pos + 1)\n      if (inner != null) return inner\n    }\n    pos += childA.nodeSize\n  }\n}\n\nexport function findDiffEnd(a, b, posA, posB) {\n  for (let iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      return iA == iB ? null : {a: posA, b: posB}\n\n    let childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize\n    if (childA == childB) {\n      posA -= size; posB -= size\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) return {a: posA, b: posB}\n\n    if (childA.isText && childA.text != childB.text) {\n      let same = 0, minSize = Math.min(childA.text.length, childB.text.length)\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1)\n      if (inner) return inner\n    }\n    posA -= size; posB -= size\n  }\n}\n","export function compareDeep(a, b) {\n  if (a === b) return true\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) return false\n  let array = Array.isArray(a)\n  if (Array.isArray(b) != array) return false\n  if (array) {\n    if (a.length != b.length) return false\n    for (let i = 0; i < a.length; i++) if (!compareDeep(a[i], b[i])) return false\n  } else {\n    for (let p in a) if (!(p in b) || !compareDeep(a[p], b[p])) return false\n    for (let p in b) if (!(p in a)) return false\n  }\n  return true\n}\n","import {MarkType, Slice, Fragment} from \"prosemirror-model\"\n\nimport {Transform} from \"./transform\"\nimport {AddMarkStep, RemoveMarkStep} from \"./mark_step\"\nimport {ReplaceStep} from \"./replace_step\"\n\n// :: (number, number, Mark) → this\n// Add the given mark to the inline content between `from` and `to`.\nTransform.prototype.addMark = function(from, to, mark) {\n  let removed = [], added = [], removing = null, adding = null\n  this.doc.nodesBetween(from, to, (node, pos, parent) => {\n    if (!node.isInline) return\n    let marks = node.marks\n    if (!mark.isInSet(marks) && parent.type.allowsMarkType(mark.type)) {\n      let start = Math.max(pos, from), end = Math.min(pos + node.nodeSize, to)\n      let newSet = mark.addToSet(marks)\n\n      for (let i = 0; i < marks.length; i++) {\n        if (!marks[i].isInSet(newSet)) {\n          if (removing && removing.to == start && removing.mark.eq(marks[i]))\n            removing.to = end\n          else\n            removed.push(removing = new RemoveMarkStep(start, end, marks[i]))\n        }\n      }\n\n      if (adding && adding.to == start)\n        adding.to = end\n      else\n        added.push(adding = new AddMarkStep(start, end, mark))\n    }\n  })\n\n  removed.forEach(s => this.step(s))\n  added.forEach(s => this.step(s))\n  return this\n}\n\n// :: (number, number, ?union<Mark, MarkType>) → this\n// Remove marks from inline nodes between `from` and `to`. When `mark`\n// is a single mark, remove precisely that mark. When it is a mark type,\n// remove all marks of that type. When it is null, remove all marks of\n// any type.\nTransform.prototype.removeMark = function(from, to, mark = null) {\n  let matched = [], step = 0\n  this.doc.nodesBetween(from, to, (node, pos) => {\n    if (!node.isInline) return\n    step++\n    let toRemove = null\n    if (mark instanceof MarkType) {\n      let set = node.marks, found\n      while (found = mark.isInSet(set)) {\n        ;(toRemove || (toRemove = [])).push(found)\n        set = found.removeFromSet(set)\n      }\n    } else if (mark) {\n      if (mark.isInSet(node.marks)) toRemove = [mark]\n    } else {\n      toRemove = node.marks\n    }\n    if (toRemove && toRemove.length) {\n      let end = Math.min(pos + node.nodeSize, to)\n      for (let i = 0; i < toRemove.length; i++) {\n        let style = toRemove[i], found\n        for (let j = 0; j < matched.length; j++) {\n          let m = matched[j]\n          if (m.step == step - 1 && style.eq(matched[j].style)) found = m\n        }\n        if (found) {\n          found.to = end\n          found.step = step\n        } else {\n          matched.push({style, from: Math.max(pos, from), to: end, step})\n        }\n      }\n    }\n  })\n  matched.forEach(m => this.step(new RemoveMarkStep(m.from, m.to, m.style)))\n  return this\n}\n\n// :: (number, NodeType, ?ContentMatch) → this\n// Removes all marks and nodes from the content of the node at `pos`\n// that don't match the given new parent node type. Accepts an\n// optional starting [content match](#model.ContentMatch) as third\n// argument.\nTransform.prototype.clearIncompatible = function(pos, parentType, match = parentType.contentMatch) {\n  let node = this.doc.nodeAt(pos)\n  let delSteps = [], cur = pos + 1\n  for (let i = 0; i < node.childCount; i++) {\n    let child = node.child(i), end = cur + child.nodeSize\n    let allowed = match.matchType(child.type, child.attrs)\n    if (!allowed) {\n      delSteps.push(new ReplaceStep(cur, end, Slice.empty))\n    } else {\n      match = allowed\n      for (let j = 0; j < child.marks.length; j++) if (!parentType.allowsMarkType(child.marks[j].type))\n        this.step(new RemoveMarkStep(cur, end, child.marks[j]))\n    }\n    cur = end\n  }\n  if (!match.validEnd) {\n    let fill = match.fillBefore(Fragment.empty, true)\n    this.replace(cur, cur, new Slice(fill, 0, 0))\n  }\n  for (let i = delSteps.length - 1; i >= 0; i--) this.step(delSteps[i])\n  return this\n}\n","import {Fragment, Slice} from \"prosemirror-model\"\n\nimport {ReplaceStep, ReplaceAroundStep} from \"./replace_step\"\nimport {Transform} from \"./transform\"\nimport {insertPoint} from \"./structure\"\n\n// :: (Node, number, ?number, ?Slice) → ?Step\n// ‘Fit’ a slice into a given position in the document, producing a\n// [step](#transform.Step) that inserts it. Will return null if\n// there's no meaningful way to insert the slice here, or inserting it\n// would be a no-op (an empty slice over an empty range).\nexport function replaceStep(doc, from, to = from, slice = Slice.empty) {\n  if (from == to && !slice.size) return null\n\n  let $from = doc.resolve(from), $to = doc.resolve(to)\n  // Optimization -- avoid work if it's obvious that it's not needed.\n  if (fitsTrivially($from, $to, slice)) return new ReplaceStep(from, to, slice)\n  return new Fitter($from, $to, slice).fit()\n}\n\n// :: (number, ?number, ?Slice) → this\n// Replace the part of the document between `from` and `to` with the\n// given `slice`.\nTransform.prototype.replace = function(from, to = from, slice = Slice.empty) {\n  let step = replaceStep(this.doc, from, to, slice)\n  if (step) this.step(step)\n  return this\n}\n\n// :: (number, number, union<Fragment, Node, [Node]>) → this\n// Replace the given range with the given content, which may be a\n// fragment, node, or array of nodes.\nTransform.prototype.replaceWith = function(from, to, content) {\n  return this.replace(from, to, new Slice(Fragment.from(content), 0, 0))\n}\n\n// :: (number, number) → this\n// Delete the content between the given positions.\nTransform.prototype.delete = function(from, to) {\n  return this.replace(from, to, Slice.empty)\n}\n\n// :: (number, union<Fragment, Node, [Node]>) → this\n// Insert the given content at the given position.\nTransform.prototype.insert = function(pos, content) {\n  return this.replaceWith(pos, pos, content)\n}\n\nfunction fitsTrivially($from, $to, slice) {\n  return !slice.openStart && !slice.openEnd && $from.start() == $to.start() &&\n    $from.parent.canReplace($from.index(), $to.index(), slice.content)\n}\n\n// Algorithm for 'placing' the elements of a slice into a gap:\n//\n// We consider the content of each node that is open to the left to be\n// independently placeable. I.e. in <p(\"foo\"), p(\"bar\")>, when the\n// paragraph on the left is open, \"foo\" can be placed (somewhere on\n// the left side of the replacement gap) independently from p(\"bar\").\n//\n// This class tracks the state of the placement progress in the\n// following properties:\n//\n//  - `frontier` holds a stack of `{type, match}` objects that\n//    represent the open side of the replacement. It starts at\n//    `$from`, then moves forward as content is placed, and is finally\n//    reconciled with `$to`.\n//\n//  - `unplaced` is a slice that represents the content that hasn't\n//    been placed yet.\n//\n//  - `placed` is a fragment of placed content. Its open-start value\n//    is implicit in `$from`, and its open-end value in `frontier`.\nclass Fitter {\n  constructor($from, $to, slice) {\n    this.$to = $to\n    this.$from = $from\n    this.unplaced = slice\n\n    this.frontier = []\n    for (let i = 0; i <= $from.depth; i++) {\n      let node = $from.node(i)\n      this.frontier.push({\n        type: node.type,\n        match: node.contentMatchAt($from.indexAfter(i))\n      })\n    }\n\n    this.placed = Fragment.empty\n    for (let i = $from.depth; i > 0; i--)\n      this.placed = Fragment.from($from.node(i).copy(this.placed))\n  }\n\n  get depth() { return this.frontier.length - 1 }\n\n  fit() {\n    // As long as there's unplaced content, try to place some of it.\n    // If that fails, either increase the open score of the unplaced\n    // slice, or drop nodes from it, and then try again.\n    while (this.unplaced.size) {\n      let fit = this.findFittable()\n      if (fit) this.placeNodes(fit)\n      else this.openMore() || this.dropNode()\n    }\n    // When there's inline content directly after the frontier _and_\n    // directly after `this.$to`, we must generate a `ReplaceAround`\n    // step that pulls that content into the node after the frontier.\n    // That means the fitting must be done to the end of the textblock\n    // node after `this.$to`, not `this.$to` itself.\n    let moveInline = this.mustMoveInline(), placedSize = this.placed.size - this.depth - this.$from.depth\n    let $from = this.$from, $to = this.close(moveInline < 0 ? this.$to : $from.doc.resolve(moveInline))\n    if (!$to) return null\n\n    // If closing to `$to` succeeded, create a step\n    let content = this.placed, openStart = $from.depth, openEnd = $to.depth\n    while (openStart && openEnd && content.childCount == 1) { // Normalize by dropping open parent nodes\n      content = content.firstChild.content\n      openStart--; openEnd--\n    }\n    let slice = new Slice(content, openStart, openEnd)\n    if (moveInline > -1)\n      return new ReplaceAroundStep($from.pos, moveInline, this.$to.pos, this.$to.end(), slice, placedSize)\n    if (slice.size || $from.pos != this.$to.pos) // Don't generate no-op steps\n      return new ReplaceStep($from.pos, $to.pos, slice)\n  }\n\n  // Find a position on the start spine of `this.unplaced` that has\n  // content that can be moved somewhere on the frontier. Returns two\n  // depths, one for the slice and one for the frontier.\n  findFittable() {\n    // Only try wrapping nodes (pass 2) after finding a place without\n    // wrapping failed.\n    for (let pass = 1; pass <= 2; pass++) {\n      for (let sliceDepth = this.unplaced.openStart; sliceDepth >= 0; sliceDepth--) {\n        let fragment, parent\n        if (sliceDepth) {\n          parent = contentAt(this.unplaced.content, sliceDepth - 1).firstChild\n          fragment = parent.content\n        } else {\n          fragment = this.unplaced.content\n        }\n        let first = fragment.firstChild\n        for (let frontierDepth = this.depth; frontierDepth >= 0; frontierDepth--) {\n          let {type, match} = this.frontier[frontierDepth], wrap, inject\n          // In pass 1, if the next node matches, or there is no next\n          // node but the parents look compatible, we've found a\n          // place.\n          if (pass == 1 && (first ? match.matchType(first.type) || (inject = match.fillBefore(Fragment.from(first), false))\n                            : type.compatibleContent(parent.type)))\n            return {sliceDepth, frontierDepth, parent, inject}\n          // In pass 2, look for a set of wrapping nodes that make\n          // `first` fit here.\n          else if (pass == 2 && first && (wrap = match.findWrapping(first.type)))\n            return {sliceDepth, frontierDepth, parent, wrap}\n          // Don't continue looking further up if the parent node\n          // would fit here.\n          if (parent && match.matchType(parent.type)) break\n        }\n      }\n    }\n  }\n\n  openMore() {\n    let {content, openStart, openEnd} = this.unplaced\n    let inner = contentAt(content, openStart)\n    if (!inner.childCount || inner.firstChild.isLeaf) return false\n    this.unplaced = new Slice(content, openStart + 1,\n                              Math.max(openEnd, inner.size + openStart >= content.size - openEnd ? openStart + 1 : 0))\n    return true\n  }\n\n  dropNode() {\n    let {content, openStart, openEnd} = this.unplaced\n    let inner = contentAt(content, openStart)\n    if (inner.childCount <= 1 && openStart > 0) {\n      let openAtEnd = content.size - openStart <= openStart + inner.size\n      this.unplaced = new Slice(dropFromFragment(content, openStart - 1, 1), openStart - 1,\n                                openAtEnd ? openStart - 1 : openEnd)\n    } else {\n      this.unplaced = new Slice(dropFromFragment(content, openStart, 1), openStart, openEnd)\n    }\n  }\n\n  // : ({sliceDepth: number, frontierDepth: number, parent: ?Node, wrap: ?[NodeType], inject: ?Fragment})\n  // Move content from the unplaced slice at `sliceDepth` to the\n  // frontier node at `frontierDepth`. Close that frontier node when\n  // applicable.\n  placeNodes({sliceDepth, frontierDepth, parent, inject, wrap}) {\n    while (this.depth > frontierDepth) this.closeFrontierNode()\n    if (wrap) for (let i = 0; i < wrap.length; i++) this.openFrontierNode(wrap[i])\n\n    let slice = this.unplaced, fragment = parent ? parent.content : slice.content\n    let openStart = slice.openStart - sliceDepth\n    let taken = 0, add = []\n    let {match, type} = this.frontier[frontierDepth]\n    if (inject) {\n      for (let i = 0; i < inject.childCount; i++) add.push(inject.child(i))\n      match = match.matchFragment(inject)\n    }\n    // Computes the amount of (end) open nodes at the end of the\n    // fragment. When 0, the parent is open, but no more. When\n    // negative, nothing is open.\n    let openEndCount = (fragment.size + sliceDepth) - (slice.content.size - slice.openEnd)\n    // Scan over the fragment, fitting as many child nodes as\n    // possible.\n    while (taken < fragment.childCount) {\n      let next = fragment.child(taken), matches = match.matchType(next.type)\n      if (!matches) break\n      taken++\n      if (taken > 1 || openStart == 0 || next.content.size) { // Drop empty open nodes\n        match = matches\n        add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)), taken == 1 ? openStart : 0,\n                                taken == fragment.childCount ? openEndCount : -1))\n      }\n    }\n    let toEnd = taken == fragment.childCount\n    if (!toEnd) openEndCount = -1\n\n    this.placed = addToFragment(this.placed, frontierDepth, Fragment.from(add))\n    this.frontier[frontierDepth].match = match\n\n    // If the parent types match, and the entire node was moved, and\n    // it's not open, close this frontier node right away.\n    if (toEnd && openEndCount < 0 && parent && parent.type == this.frontier[this.depth].type && this.frontier.length > 1)\n      this.closeFrontierNode()\n\n    // Add new frontier nodes for any open nodes at the end.\n    for (let i = 0, cur = fragment; i < openEndCount; i++) {\n      let node = cur.lastChild\n      this.frontier.push({type: node.type, match: node.contentMatchAt(node.childCount)})\n      cur = node.content\n    }\n\n    // Update `this.unplaced`. Drop the entire node from which we\n    // placed it we got to its end, otherwise just drop the placed\n    // nodes.\n    this.unplaced = !toEnd ? new Slice(dropFromFragment(slice.content, sliceDepth, taken), slice.openStart, slice.openEnd)\n      : sliceDepth == 0 ? Slice.empty\n      : new Slice(dropFromFragment(slice.content, sliceDepth - 1, 1),\n                  sliceDepth - 1, openEndCount < 0 ? slice.openEnd : sliceDepth - 1)\n  }\n\n  mustMoveInline() {\n    if (!this.$to.parent.isTextblock || this.$to.end() == this.$to.pos) return -1\n    let top = this.frontier[this.depth], level\n    if (!top.type.isTextblock || !contentAfterFits(this.$to, this.$to.depth, top.type, top.match, false) ||\n        (this.$to.depth == this.depth && (level = this.findCloseLevel(this.$to)) && level.depth == this.depth)) return -1\n\n    let {depth} = this.$to, after = this.$to.after(depth)\n    while (depth > 1 && after == this.$to.end(--depth)) ++after\n    return after\n  }\n\n  findCloseLevel($to) {\n    scan: for (let i = Math.min(this.depth, $to.depth); i >= 0; i--) {\n      let {match, type} = this.frontier[i]\n      let dropInner = i < $to.depth && $to.end(i + 1) == $to.pos + ($to.depth - (i + 1))\n      let fit = contentAfterFits($to, i, type, match, dropInner)\n      if (!fit) continue\n      for (let d = i - 1; d >= 0; d--) {\n        let {match, type} = this.frontier[d]\n        let matches = contentAfterFits($to, d, type, match, true)\n        if (!matches || matches.childCount) continue scan\n      }\n      return {depth: i, fit, move: dropInner ? $to.doc.resolve($to.after(i + 1)) : $to}\n    }\n  }\n\n  close($to) {\n    let close = this.findCloseLevel($to)\n    if (!close) return null\n\n    while (this.depth > close.depth) this.closeFrontierNode()\n    if (close.fit.childCount) this.placed = addToFragment(this.placed, close.depth, close.fit)\n    $to = close.move\n    for (let d = close.depth + 1; d <= $to.depth; d++) {\n      let node = $to.node(d), add = node.type.contentMatch.fillBefore(node.content, true, $to.index(d))\n      this.openFrontierNode(node.type, node.attrs, add)\n    }\n    return $to\n  }\n\n  openFrontierNode(type, attrs, content) {\n    let top = this.frontier[this.depth]\n    top.match = top.match.matchType(type)\n    this.placed = addToFragment(this.placed, this.depth, Fragment.from(type.create(attrs, content)))\n    this.frontier.push({type, match: type.contentMatch})\n  }\n\n  closeFrontierNode() {\n    let open = this.frontier.pop()\n    let add = open.match.fillBefore(Fragment.empty, true)\n    if (add.childCount) this.placed = addToFragment(this.placed, this.frontier.length, add)\n  }\n}\n\nfunction dropFromFragment(fragment, depth, count) {\n  if (depth == 0) return fragment.cutByIndex(count)\n  return fragment.replaceChild(0, fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content, depth - 1, count)))\n}\n\nfunction addToFragment(fragment, depth, content) {\n  if (depth == 0) return fragment.append(content)\n  return fragment.replaceChild(fragment.childCount - 1,\n                               fragment.lastChild.copy(addToFragment(fragment.lastChild.content, depth - 1, content)))\n}\n\nfunction contentAt(fragment, depth) {\n  for (let i = 0; i < depth; i++) fragment = fragment.firstChild.content\n  return fragment\n}\n\nfunction closeNodeStart(node, openStart, openEnd) {\n  if (openStart <= 0) return node\n  let frag = node.content\n  if (openStart > 1)\n    frag = frag.replaceChild(0, closeNodeStart(frag.firstChild, openStart - 1, frag.childCount == 1 ? openEnd - 1 : 0))\n  if (openStart > 0) {\n    frag = node.type.contentMatch.fillBefore(frag).append(frag)\n    if (openEnd <= 0) frag = frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty, true))\n  }\n  return node.copy(frag)\n}\n\nfunction contentAfterFits($to, depth, type, match, open) {\n  let node = $to.node(depth), index = open ? $to.indexAfter(depth) : $to.index(depth)\n  if (index == node.childCount && !type.compatibleContent(node.type)) return null\n  let fit = match.fillBefore(node.content, true, index)\n  return fit && !invalidMarks(type, node.content, index) ? fit : null\n}\n\nfunction invalidMarks(type, fragment, start) {\n  for (let i = start; i < fragment.childCount; i++)\n    if (!type.allowsMarks(fragment.child(i).marks)) return true\n  return false\n}\n\n// :: (number, number, Slice) → this\n// Replace a range of the document with a given slice, using `from`,\n// `to`, and the slice's [`openStart`](#model.Slice.openStart) property\n// as hints, rather than fixed start and end points. This method may\n// grow the replaced area or close open nodes in the slice in order to\n// get a fit that is more in line with WYSIWYG expectations, by\n// dropping fully covered parent nodes of the replaced region when\n// they are marked [non-defining](#model.NodeSpec.defining), or\n// including an open parent node from the slice that _is_ marked as\n// [defining](#model.NodeSpec.defining).\n//\n// This is the method, for example, to handle paste. The similar\n// [`replace`](#transform.Transform.replace) method is a more\n// primitive tool which will _not_ move the start and end of its given\n// range, and is useful in situations where you need more precise\n// control over what happens.\nTransform.prototype.replaceRange = function(from, to, slice) {\n  if (!slice.size) return this.deleteRange(from, to)\n\n  let $from = this.doc.resolve(from), $to = this.doc.resolve(to)\n  if (fitsTrivially($from, $to, slice))\n    return this.step(new ReplaceStep(from, to, slice))\n\n  let targetDepths = coveredDepths($from, this.doc.resolve(to))\n  // Can't replace the whole document, so remove 0 if it's present\n  if (targetDepths[targetDepths.length - 1] == 0) targetDepths.pop()\n  // Negative numbers represent not expansion over the whole node at\n  // that depth, but replacing from $from.before(-D) to $to.pos.\n  let preferredTarget = -($from.depth + 1)\n  targetDepths.unshift(preferredTarget)\n  // This loop picks a preferred target depth, if one of the covering\n  // depths is not outside of a defining node, and adds negative\n  // depths for any depth that has $from at its start and does not\n  // cross a defining node.\n  for (let d = $from.depth, pos = $from.pos - 1; d > 0; d--, pos--) {\n    let spec = $from.node(d).type.spec\n    if (spec.defining || spec.isolating) break\n    if (targetDepths.indexOf(d) > -1) preferredTarget = d\n    else if ($from.before(d) == pos) targetDepths.splice(1, 0, -d)\n  }\n  // Try to fit each possible depth of the slice into each possible\n  // target depth, starting with the preferred depths.\n  let preferredTargetIndex = targetDepths.indexOf(preferredTarget)\n\n  let leftNodes = [], preferredDepth = slice.openStart\n  for (let content = slice.content, i = 0;; i++) {\n    let node = content.firstChild\n    leftNodes.push(node)\n    if (i == slice.openStart) break\n    content = node.content\n  }\n  // Back up if the node directly above openStart, or the node above\n  // that separated only by a non-defining textblock node, is defining.\n  if (preferredDepth > 0 && leftNodes[preferredDepth - 1].type.spec.defining &&\n      $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 1].type)\n    preferredDepth -= 1\n  else if (preferredDepth >= 2 && leftNodes[preferredDepth - 1].isTextblock && leftNodes[preferredDepth - 2].type.spec.defining &&\n           $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 2].type)\n    preferredDepth -= 2\n\n  for (let j = slice.openStart; j >= 0; j--) {\n    let openDepth = (j + preferredDepth + 1) % (slice.openStart + 1)\n    let insert = leftNodes[openDepth]\n    if (!insert) continue\n    for (let i = 0; i < targetDepths.length; i++) {\n      // Loop over possible expansion levels, starting with the\n      // preferred one\n      let targetDepth = targetDepths[(i + preferredTargetIndex) % targetDepths.length], expand = true\n      if (targetDepth < 0) { expand = false; targetDepth = -targetDepth }\n      let parent = $from.node(targetDepth - 1), index = $from.index(targetDepth - 1)\n      if (parent.canReplaceWith(index, index, insert.type, insert.marks))\n        return this.replace($from.before(targetDepth), expand ? $to.after(targetDepth) : to,\n                            new Slice(closeFragment(slice.content, 0, slice.openStart, openDepth),\n                                      openDepth, slice.openEnd))\n    }\n  }\n\n  let startSteps = this.steps.length\n  for (let i = targetDepths.length - 1; i >= 0; i--) {\n    this.replace(from, to, slice)\n    if (this.steps.length > startSteps) break\n    let depth = targetDepths[i]\n    if (depth < 0) continue\n    from = $from.before(depth); to = $to.after(depth)\n  }\n  return this\n}\n\nfunction closeFragment(fragment, depth, oldOpen, newOpen, parent) {\n  if (depth < oldOpen) {\n    let first = fragment.firstChild\n    fragment = fragment.replaceChild(0, first.copy(closeFragment(first.content, depth + 1, oldOpen, newOpen, first)))\n  }\n  if (depth > newOpen) {\n    let match = parent.contentMatchAt(0)\n    let start = match.fillBefore(fragment).append(fragment)\n    fragment = start.append(match.matchFragment(start).fillBefore(Fragment.empty, true))\n  }\n  return fragment\n}\n\n// :: (number, number, Node) → this\n// Replace the given range with a node, but use `from` and `to` as\n// hints, rather than precise positions. When from and to are the same\n// and are at the start or end of a parent node in which the given\n// node doesn't fit, this method may _move_ them out towards a parent\n// that does allow the given node to be placed. When the given range\n// completely covers a parent node, this method may completely replace\n// that parent node.\nTransform.prototype.replaceRangeWith = function(from, to, node) {\n  if (!node.isInline && from == to && this.doc.resolve(from).parent.content.size) {\n    let point = insertPoint(this.doc, from, node.type)\n    if (point != null) from = to = point\n  }\n  return this.replaceRange(from, to, new Slice(Fragment.from(node), 0, 0))\n}\n\n// :: (number, number) → this\n// Delete the given range, expanding it to cover fully covered\n// parent nodes until a valid replace is found.\nTransform.prototype.deleteRange = function(from, to) {\n  let $from = this.doc.resolve(from), $to = this.doc.resolve(to)\n  let covered = coveredDepths($from, $to)\n  for (let i = 0; i < covered.length; i++) {\n    let depth = covered[i], last = i == covered.length - 1\n    if ((last && depth == 0) || $from.node(depth).type.contentMatch.validEnd)\n      return this.delete($from.start(depth), $to.end(depth))\n    if (depth > 0 && (last || $from.node(depth - 1).canReplace($from.index(depth - 1), $to.indexAfter(depth - 1))))\n      return this.delete($from.before(depth), $to.after(depth))\n  }\n  for (let d = 1; d <= $from.depth && d <= $to.depth; d++) {\n    if (from - $from.start(d) == $from.depth - d && to > $from.end(d) && $to.end(d) - to != $to.depth - d)\n      return this.delete($from.before(d), to)\n  }\n  return this.delete(from, to)\n}\n\n// : (ResolvedPos, ResolvedPos) → [number]\n// Returns an array of all depths for which $from - $to spans the\n// whole content of the nodes at that depth.\nfunction coveredDepths($from, $to) {\n  let result = [], minDepth = Math.min($from.depth, $to.depth)\n  for (let d = minDepth; d >= 0; d--) {\n    let start = $from.start(d)\n    if (start < $from.pos - ($from.depth - d) ||\n        $to.end(d) > $to.pos + ($to.depth - d) ||\n        $from.node(d).type.spec.isolating ||\n        $to.node(d).type.spec.isolating) break\n    if (start == $to.start(d) ||\n        (d == $from.depth && d == $to.depth && $from.parent.inlineContent && $to.parent.inlineContent &&\n         d && $to.start(d - 1) == start - 1))\n      result.push(d)\n  }\n  return result\n}\n","import {Mark} from \"./mark\"\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nexport class ResolvedPos {\n  constructor(pos, path, parentOffset) {\n    // :: number The position that was resolved.\n    this.pos = pos\n    this.path = path\n    // :: number\n    // The number of levels the parent node is from the root. If this\n    // position points directly into the root node, it is 0. If it\n    // points into a top-level paragraph, 1, and so on.\n    this.depth = path.length / 3 - 1\n    // :: number The offset this position has into its parent node.\n    this.parentOffset = parentOffset\n  }\n\n  resolveDepth(val) {\n    if (val == null) return this.depth\n    if (val < 0) return this.depth + val\n    return val\n  }\n\n  // :: Node\n  // The parent node that the position points into. Note that even if\n  // a position points into a text node, that node is not considered\n  // the parent—text nodes are ‘flat’ in this model, and have no content.\n  get parent() { return this.node(this.depth) }\n\n  // :: Node\n  // The root node in which the position was resolved.\n  get doc() { return this.node(0) }\n\n  // :: (?number) → Node\n  // The ancestor node at the given level. `p.node(p.depth)` is the\n  // same as `p.parent`.\n  node(depth) { return this.path[this.resolveDepth(depth) * 3] }\n\n  // :: (?number) → number\n  // The index into the ancestor at the given level. If this points at\n  // the 3rd node in the 2nd paragraph on the top level, for example,\n  // `p.index(0)` is 1 and `p.index(1)` is 2.\n  index(depth) { return this.path[this.resolveDepth(depth) * 3 + 1] }\n\n  // :: (?number) → number\n  // The index pointing after this position into the ancestor at the\n  // given level.\n  indexAfter(depth) {\n    depth = this.resolveDepth(depth)\n    return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n  }\n\n  // :: (?number) → number\n  // The (absolute) position at the start of the node at the given\n  // level.\n  start(depth) {\n    depth = this.resolveDepth(depth)\n    return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n  }\n\n  // :: (?number) → number\n  // The (absolute) position at the end of the node at the given\n  // level.\n  end(depth) {\n    depth = this.resolveDepth(depth)\n    return this.start(depth) + this.node(depth).content.size\n  }\n\n  // :: (?number) → number\n  // The (absolute) position directly before the wrapping node at the\n  // given level, or, when `depth` is `this.depth + 1`, the original\n  // position.\n  before(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position before the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n  }\n\n  // :: (?number) → number\n  // The (absolute) position directly after the wrapping node at the\n  // given level, or the original position when `depth` is `this.depth + 1`.\n  after(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position after the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n  }\n\n  // :: number\n  // When this position points into a text node, this returns the\n  // distance between the position and the start of the text node.\n  // Will be zero for positions that point between nodes.\n  get textOffset() { return this.pos - this.path[this.path.length - 1] }\n\n  // :: ?Node\n  // Get the node directly after the position, if any. If the position\n  // points into a text node, only the part of that node after the\n  // position is returned.\n  get nodeAfter() {\n    let parent = this.parent, index = this.index(this.depth)\n    if (index == parent.childCount) return null\n    let dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index)\n    return dOff ? parent.child(index).cut(dOff) : child\n  }\n\n  // :: ?Node\n  // Get the node directly before the position, if any. If the\n  // position points into a text node, only the part of that node\n  // before the position is returned.\n  get nodeBefore() {\n    let index = this.index(this.depth)\n    let dOff = this.pos - this.path[this.path.length - 1]\n    if (dOff) return this.parent.child(index).cut(0, dOff)\n    return index == 0 ? null : this.parent.child(index - 1)\n  }\n\n  // :: (number, ?number) → number\n  // Get the position at the given index in the parent node at the\n  // given depth (which defaults to `this.depth`).\n  posAtIndex(index, depth) {\n    depth = this.resolveDepth(depth)\n    let node = this.path[depth * 3], pos = depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n    for (let i = 0; i < index; i++) pos += node.child(i).nodeSize\n    return pos\n  }\n\n  // :: () → [Mark]\n  // Get the marks at this position, factoring in the surrounding\n  // marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n  // position is at the start of a non-empty node, the marks of the\n  // node after it (if any) are returned.\n  marks() {\n    let parent = this.parent, index = this.index()\n\n    // In an empty parent, return the empty array\n    if (parent.content.size == 0) return Mark.none\n\n    // When inside a text node, just return the text node's marks\n    if (this.textOffset) return parent.child(index).marks\n\n    let main = parent.maybeChild(index - 1), other = parent.maybeChild(index)\n    // If the `after` flag is true of there is no node before, make\n    // the node after this position the main reference.\n    if (!main) { let tmp = main; main = other; other = tmp }\n\n    // Use all marks in the main node, except those that have\n    // `inclusive` set to false and are not present in the other node.\n    let marks = main.marks\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n        marks = marks[i--].removeFromSet(marks)\n\n    return marks\n  }\n\n  // :: (ResolvedPos) → ?[Mark]\n  // Get the marks after the current position, if any, except those\n  // that are non-inclusive and not present at position `$end`. This\n  // is mostly useful for getting the set of marks to preserve after a\n  // deletion. Will return `null` if this position is at the end of\n  // its parent node or its parent node isn't a textblock (in which\n  // case no marks should be preserved).\n  marksAcross($end) {\n    let after = this.parent.maybeChild(this.index())\n    if (!after || !after.isInline) return null\n\n    let marks = after.marks, next = $end.parent.maybeChild($end.index())\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n        marks = marks[i--].removeFromSet(marks)\n    return marks\n  }\n\n  // :: (number) → number\n  // The depth up to which this position and the given (non-resolved)\n  // position share the same parent nodes.\n  sharedDepth(pos) {\n    for (let depth = this.depth; depth > 0; depth--)\n      if (this.start(depth) <= pos && this.end(depth) >= pos) return depth\n    return 0\n  }\n\n  // :: (?ResolvedPos, ?(Node) → bool) → ?NodeRange\n  // Returns a range based on the place where this position and the\n  // given position diverge around block content. If both point into\n  // the same textblock, for example, a range around that textblock\n  // will be returned. If they point into different blocks, the range\n  // around those blocks in their shared ancestor is returned. You can\n  // pass in an optional predicate that will be called with a parent\n  // node to see if a range into that parent is acceptable.\n  blockRange(other = this, pred) {\n    if (other.pos < this.pos) return other.blockRange(this)\n    for (let d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n      if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n        return new NodeRange(this, other, d)\n  }\n\n  // :: (ResolvedPos) → bool\n  // Query whether the given position shares the same parent node.\n  sameParent(other) {\n    return this.pos - this.parentOffset == other.pos - other.parentOffset\n  }\n\n  // :: (ResolvedPos) → ResolvedPos\n  // Return the greater of this and the given position.\n  max(other) {\n    return other.pos > this.pos ? other : this\n  }\n\n  // :: (ResolvedPos) → ResolvedPos\n  // Return the smaller of this and the given position.\n  min(other) {\n    return other.pos < this.pos ? other : this\n  }\n\n  toString() {\n    let str = \"\"\n    for (let i = 1; i <= this.depth; i++)\n      str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1)\n    return str + \":\" + this.parentOffset\n  }\n\n  static resolve(doc, pos) {\n    if (!(pos >= 0 && pos <= doc.content.size)) throw new RangeError(\"Position \" + pos + \" out of range\")\n    let path = []\n    let start = 0, parentOffset = pos\n    for (let node = doc;;) {\n      let {index, offset} = node.content.findIndex(parentOffset)\n      let rem = parentOffset - offset\n      path.push(node, index, start + offset)\n      if (!rem) break\n      node = node.child(index)\n      if (node.isText) break\n      parentOffset = rem - 1\n      start += offset + 1\n    }\n    return new ResolvedPos(pos, path, parentOffset)\n  }\n\n  static resolveCached(doc, pos) {\n    for (let i = 0; i < resolveCache.length; i++) {\n      let cached = resolveCache[i]\n      if (cached.pos == pos && cached.doc == doc) return cached\n    }\n    let result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos)\n    resolveCachePos = (resolveCachePos + 1) % resolveCacheSize\n    return result\n  }\n}\n\nlet resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nexport class NodeRange {\n  // :: (ResolvedPos, ResolvedPos, number)\n  // Construct a node range. `$from` and `$to` should point into the\n  // same node until at least the given `depth`, since a node range\n  // denotes an adjacent set of nodes in a single parent node.\n  constructor($from, $to, depth) {\n    // :: ResolvedPos A resolved position along the start of the\n    // content. May have a `depth` greater than this object's `depth`\n    // property, since these are the positions that were used to\n    // compute the range, not re-resolved positions directly at its\n    // boundaries.\n    this.$from = $from\n    // :: ResolvedPos A position along the end of the content. See\n    // caveat for [`$from`](#model.NodeRange.$from).\n    this.$to = $to\n    // :: number The depth of the node that this range points into.\n    this.depth = depth\n  }\n\n  // :: number The position at the start of the range.\n  get start() { return this.$from.before(this.depth + 1) }\n  // :: number The position at the end of the range.\n  get end() { return this.$to.after(this.depth + 1) }\n\n  // :: Node The parent node that the range points into.\n  get parent() { return this.$from.node(this.depth) }\n  // :: number The start index of the range in the parent node.\n  get startIndex() { return this.$from.index(this.depth) }\n  // :: number The end index of the range in the parent node.\n  get endIndex() { return this.$to.indexAfter(this.depth) }\n}\n","import {Fragment} from \"./fragment\"\nimport {Mark} from \"./mark\"\nimport {Slice, replace} from \"./replace\"\nimport {ResolvedPos} from \"./resolvedpos\"\nimport {compareDeep} from \"./comparedeep\"\n\nconst emptyAttrs = Object.create(null)\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nexport class Node {\n  constructor(type, attrs, content, marks) {\n    // :: NodeType\n    // The type of node that this is.\n    this.type = type\n\n    // :: Object\n    // An object mapping attribute names to values. The kind of\n    // attributes allowed and required are\n    // [determined](#model.NodeSpec.attrs) by the node type.\n    this.attrs = attrs\n\n    // :: Fragment\n    // A container holding the node's children.\n    this.content = content || Fragment.empty\n\n    // :: [Mark]\n    // The marks (things like whether it is emphasized or part of a\n    // link) applied to this node.\n    this.marks = marks || Mark.none\n  }\n\n  // text:: ?string\n  // For text nodes, this contains the node's text content.\n\n  // :: number\n  // The size of this node, as defined by the integer-based [indexing\n  // scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n  // amount of characters. For other leaf nodes, it is one. For\n  // non-leaf nodes, it is the size of the content plus two (the start\n  // and end token).\n  get nodeSize() { return this.isLeaf ? 1 : 2 + this.content.size }\n\n  // :: number\n  // The number of children that the node has.\n  get childCount() { return this.content.childCount }\n\n  // :: (number) → Node\n  // Get the child node at the given index. Raises an error when the\n  // index is out of range.\n  child(index) { return this.content.child(index) }\n\n  // :: (number) → ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) { return this.content.maybeChild(index) }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) { this.content.forEach(f) }\n\n  // :: (number, number, (node: Node, pos: number, parent: Node, index: number) → ?bool, ?number)\n  // Invoke a callback for all descendant nodes recursively between\n  // the given two positions that are relative to start of this node's\n  // content. The callback is invoked with the node, its\n  // parent-relative position, its parent node, and its child index.\n  // When the callback returns false for a given node, that node's\n  // children will not be recursed over. The last parameter can be\n  // used to specify a starting position to count from.\n  nodesBetween(from, to, f, startPos = 0) {\n    this.content.nodesBetween(from, to, f, startPos, this)\n  }\n\n  // :: ((node: Node, pos: number, parent: Node, index: number) → ?bool)\n  // Call the given callback for every descendant node. Doesn't\n  // descend into a node when the callback returns `false`.\n  descendants(f) {\n    this.nodesBetween(0, this.content.size, f)\n  }\n\n  // :: string\n  // Concatenates all the text nodes found in this fragment and its\n  // children.\n  get textContent() { return this.textBetween(0, this.content.size, \"\") }\n\n  // :: (number, number, ?string, ?union<string, ?(leafNode: Node) -> string>) → string\n  // Get all text between positions `from` and `to`. When\n  // `blockSeparator` is given, it will be inserted to separate text\n  // from different block nodes. When `leafText` is given, it'll be\n  // inserted for every non-text leaf node encountered.\n  textBetween(from, to, blockSeparator, leafText) {\n    return this.content.textBetween(from, to, blockSeparator, leafText)\n  }\n\n  // :: ?Node\n  // Returns this node's first child, or `null` if there are no\n  // children.\n  get firstChild() { return this.content.firstChild }\n\n  // :: ?Node\n  // Returns this node's last child, or `null` if there are no\n  // children.\n  get lastChild() { return this.content.lastChild }\n\n  // :: (Node) → bool\n  // Test whether two nodes represent the same piece of document.\n  eq(other) {\n    return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n  }\n\n  // :: (Node) → bool\n  // Compare the markup (type, attributes, and marks) of this node to\n  // those of another. Returns `true` if both have the same markup.\n  sameMarkup(other) {\n    return this.hasMarkup(other.type, other.attrs, other.marks)\n  }\n\n  // :: (NodeType, ?Object, ?[Mark]) → bool\n  // Check whether this node's markup correspond to the given type,\n  // attributes, and marks.\n  hasMarkup(type, attrs, marks) {\n    return this.type == type &&\n      compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n      Mark.sameSet(this.marks, marks || Mark.none)\n  }\n\n  // :: (?Fragment) → Node\n  // Create a new node with the same markup as this node, containing\n  // the given content (or empty, if no content is given).\n  copy(content = null) {\n    if (content == this.content) return this\n    return new this.constructor(this.type, this.attrs, content, this.marks)\n  }\n\n  // :: ([Mark]) → Node\n  // Create a copy of this node, with the given set of marks instead\n  // of the node's own marks.\n  mark(marks) {\n    return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n  }\n\n  // :: (number, ?number) → Node\n  // Create a copy of this node with only the content between the\n  // given positions. If `to` is not given, it defaults to the end of\n  // the node.\n  cut(from, to) {\n    if (from == 0 && to == this.content.size) return this\n    return this.copy(this.content.cut(from, to))\n  }\n\n  // :: (number, ?number) → Slice\n  // Cut out the part of the document between the given positions, and\n  // return it as a `Slice` object.\n  slice(from, to = this.content.size, includeParents = false) {\n    if (from == to) return Slice.empty\n\n    let $from = this.resolve(from), $to = this.resolve(to)\n    let depth = includeParents ? 0 : $from.sharedDepth(to)\n    let start = $from.start(depth), node = $from.node(depth)\n    let content = node.content.cut($from.pos - start, $to.pos - start)\n    return new Slice(content, $from.depth - depth, $to.depth - depth)\n  }\n\n  // :: (number, number, Slice) → Node\n  // Replace the part of the document between the given positions with\n  // the given slice. The slice must 'fit', meaning its open sides\n  // must be able to connect to the surrounding content, and its\n  // content nodes must be valid children for the node they are placed\n  // into. If any of this is violated, an error of type\n  // [`ReplaceError`](#model.ReplaceError) is thrown.\n  replace(from, to, slice) {\n    return replace(this.resolve(from), this.resolve(to), slice)\n  }\n\n  // :: (number) → ?Node\n  // Find the node directly after the given position.\n  nodeAt(pos) {\n    for (let node = this;;) {\n      let {index, offset} = node.content.findIndex(pos)\n      node = node.maybeChild(index)\n      if (!node) return null\n      if (offset == pos || node.isText) return node\n      pos -= offset + 1\n    }\n  }\n\n  // :: (number) → {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node after the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childAfter(pos) {\n    let {index, offset} = this.content.findIndex(pos)\n    return {node: this.content.maybeChild(index), index, offset}\n  }\n\n  // :: (number) → {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node before the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childBefore(pos) {\n    if (pos == 0) return {node: null, index: 0, offset: 0}\n    let {index, offset} = this.content.findIndex(pos)\n    if (offset < pos) return {node: this.content.child(index), index, offset}\n    let node = this.content.child(index - 1)\n    return {node, index: index - 1, offset: offset - node.nodeSize}\n  }\n\n  // :: (number) → ResolvedPos\n  // Resolve the given position in the document, returning an\n  // [object](#model.ResolvedPos) with information about its context.\n  resolve(pos) { return ResolvedPos.resolveCached(this, pos) }\n\n  resolveNoCache(pos) { return ResolvedPos.resolve(this, pos) }\n\n  // :: (number, number, union<Mark, MarkType>) → bool\n  // Test whether a given mark or mark type occurs in this document\n  // between the two given positions.\n  rangeHasMark(from, to, type) {\n    let found = false\n    if (to > from) this.nodesBetween(from, to, node => {\n      if (type.isInSet(node.marks)) found = true\n      return !found\n    })\n    return found\n  }\n\n  // :: bool\n  // True when this is a block (non-inline node)\n  get isBlock() { return this.type.isBlock }\n\n  // :: bool\n  // True when this is a textblock node, a block node with inline\n  // content.\n  get isTextblock() { return this.type.isTextblock }\n\n  // :: bool\n  // True when this node allows inline content.\n  get inlineContent() { return this.type.inlineContent }\n\n  // :: bool\n  // True when this is an inline node (a text node or a node that can\n  // appear among text).\n  get isInline() { return this.type.isInline }\n\n  // :: bool\n  // True when this is a text node.\n  get isText() { return this.type.isText }\n\n  // :: bool\n  // True when this is a leaf node.\n  get isLeaf() { return this.type.isLeaf }\n\n  // :: bool\n  // True when this is an atom, i.e. when it does not have directly\n  // editable content. This is usually the same as `isLeaf`, but can\n  // be configured with the [`atom` property](#model.NodeSpec.atom) on\n  // a node's spec (typically used when the node is displayed as an\n  // uneditable [node view](#view.NodeView)).\n  get isAtom() { return this.type.isAtom }\n\n  // :: () → string\n  // Return a string representation of this node for debugging\n  // purposes.\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    let name = this.type.name\n    if (this.content.size)\n      name += \"(\" + this.content.toStringInner() + \")\"\n    return wrapMarks(this.marks, name)\n  }\n\n  // :: (number) → ContentMatch\n  // Get the content match in this node at the given index.\n  contentMatchAt(index) {\n    let match = this.type.contentMatch.matchFragment(this.content, 0, index)\n    if (!match) throw new Error(\"Called contentMatchAt on a node with invalid content\")\n    return match\n  }\n\n  // :: (number, number, ?Fragment, ?number, ?number) → bool\n  // Test whether replacing the range between `from` and `to` (by\n  // child index) with the given replacement fragment (which defaults\n  // to the empty fragment) would leave the node's content valid. You\n  // can optionally pass `start` and `end` indices into the\n  // replacement fragment.\n  canReplace(from, to, replacement = Fragment.empty, start = 0, end = replacement.childCount) {\n    let one = this.contentMatchAt(from).matchFragment(replacement, start, end)\n    let two = one && one.matchFragment(this.content, to)\n    if (!two || !two.validEnd) return false\n    for (let i = start; i < end; i++) if (!this.type.allowsMarks(replacement.child(i).marks)) return false\n    return true\n  }\n\n  // :: (number, number, NodeType, ?[Mark]) → bool\n  // Test whether replacing the range `from` to `to` (by index) with a\n  // node of the given type would leave the node's content valid.\n  canReplaceWith(from, to, type, marks) {\n    if (marks && !this.type.allowsMarks(marks)) return false\n    let start = this.contentMatchAt(from).matchType(type)\n    let end = start && start.matchFragment(this.content, to)\n    return end ? end.validEnd : false\n  }\n\n  // :: (Node) → bool\n  // Test whether the given node's content could be appended to this\n  // node. If that node is empty, this will only return true if there\n  // is at least one node type that can appear in both nodes (to avoid\n  // merging completely incompatible nodes).\n  canAppend(other) {\n    if (other.content.size) return this.canReplace(this.childCount, this.childCount, other.content)\n    else return this.type.compatibleContent(other.type)\n  }\n\n  // :: ()\n  // Check whether this node and its descendants conform to the\n  // schema, and raise error when they do not.\n  check() {\n    if (!this.type.validContent(this.content))\n      throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0, 50)}`)\n    let copy = Mark.none\n    for (let i = 0; i < this.marks.length; i++) copy = this.marks[i].addToSet(copy)\n    if (!Mark.sameSet(copy, this.marks))\n      throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(m => m.type.name)}`)\n    this.content.forEach(node => node.check())\n  }\n\n  // :: () → Object\n  // Return a JSON-serializeable representation of this node.\n  toJSON() {\n    let obj = {type: this.type.name}\n    for (let _ in this.attrs) {\n      obj.attrs = this.attrs\n      break\n    }\n    if (this.content.size)\n      obj.content = this.content.toJSON()\n    if (this.marks.length)\n      obj.marks = this.marks.map(n => n.toJSON())\n    return obj\n  }\n\n  // :: (Schema, Object) → Node\n  // Deserialize a node from its JSON representation.\n  static fromJSON(schema, json) {\n    if (!json) throw new RangeError(\"Invalid input for Node.fromJSON\")\n    let marks = null\n    if (json.marks) {\n      if (!Array.isArray(json.marks)) throw new RangeError(\"Invalid mark data for Node.fromJSON\")\n      marks = json.marks.map(schema.markFromJSON)\n    }\n    if (json.type == \"text\") {\n      if (typeof json.text != \"string\") throw new RangeError(\"Invalid text node in JSON\")\n      return schema.text(json.text, marks)\n    }\n    let content = Fragment.fromJSON(schema, json.content)\n    return schema.nodeType(json.type).create(json.attrs, content, marks)\n  }\n}\n\nexport class TextNode extends Node {\n  constructor(type, attrs, content, marks) {\n    super(type, attrs, null, marks)\n\n    if (!content) throw new RangeError(\"Empty text nodes are not allowed\")\n\n    this.text = content\n  }\n\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  }\n\n  get textContent() { return this.text }\n\n  textBetween(from, to) { return this.text.slice(from, to) }\n\n  get nodeSize() { return this.text.length }\n\n  mark(marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  }\n\n  withText(text) {\n    if (text == this.text) return this\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  }\n\n  cut(from = 0, to = this.text.length) {\n    if (from == 0 && to == this.text.length) return this\n    return this.withText(this.text.slice(from, to))\n  }\n\n  eq(other) {\n    return this.sameMarkup(other) && this.text == other.text\n  }\n\n  toJSON() {\n    let base = super.toJSON()\n    base.text = this.text\n    return base\n  }\n}\n\nfunction wrapMarks(marks, str) {\n  for (let i = marks.length - 1; i >= 0; i--)\n    str = marks[i].type.name + \"(\" + str + \")\"\n  return str\n}\n","import {Fragment} from \"./fragment\"\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nexport class ContentMatch {\n  constructor(validEnd) {\n    // :: bool\n    // True when this match state represents a valid end of the node.\n    this.validEnd = validEnd\n    this.next = []\n    this.wrapCache = []\n  }\n\n  static parse(string, nodeTypes) {\n    let stream = new TokenStream(string, nodeTypes)\n    if (stream.next == null) return ContentMatch.empty\n    let expr = parseExpr(stream)\n    if (stream.next) stream.err(\"Unexpected trailing text\")\n    let match = dfa(nfa(expr))\n    checkForDeadEnds(match, stream)\n    return match\n  }\n\n  // :: (NodeType) → ?ContentMatch\n  // Match a node type, returning a match after that node if\n  // successful.\n  matchType(type) {\n    for (let i = 0; i < this.next.length; i += 2)\n      if (this.next[i] == type) return this.next[i + 1]\n    return null\n  }\n\n  // :: (Fragment, ?number, ?number) → ?ContentMatch\n  // Try to match a fragment. Returns the resulting match when\n  // successful.\n  matchFragment(frag, start = 0, end = frag.childCount) {\n    let cur = this\n    for (let i = start; cur && i < end; i++)\n      cur = cur.matchType(frag.child(i).type)\n    return cur\n  }\n\n  get inlineContent() {\n    let first = this.next[0]\n    return first ? first.isInline : false\n  }\n\n  // :: ?NodeType\n  // Get the first matching node type at this match position that can\n  // be generated.\n  get defaultType() {\n    for (let i = 0; i < this.next.length; i += 2) {\n      let type = this.next[i]\n      if (!(type.isText || type.hasRequiredAttrs())) return type\n    }\n  }\n\n  compatible(other) {\n    for (let i = 0; i < this.next.length; i += 2)\n      for (let j = 0; j < other.next.length; j += 2)\n        if (this.next[i] == other.next[j]) return true\n    return false\n  }\n\n  // :: (Fragment, bool, ?number) → ?Fragment\n  // Try to match the given fragment, and if that fails, see if it can\n  // be made to match by inserting nodes in front of it. When\n  // successful, return a fragment of inserted nodes (which may be\n  // empty if nothing had to be inserted). When `toEnd` is true, only\n  // return a fragment if the resulting match goes to the end of the\n  // content expression.\n  fillBefore(after, toEnd = false, startIndex = 0) {\n    let seen = [this]\n    function search(match, types) {\n      let finished = match.matchFragment(after, startIndex)\n      if (finished && (!toEnd || finished.validEnd))\n        return Fragment.from(types.map(tp => tp.createAndFill()))\n\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i], next = match.next[i + 1]\n        if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n          seen.push(next)\n          let found = search(next, types.concat(type))\n          if (found) return found\n        }\n      }\n    }\n\n    return search(this, [])\n  }\n\n  // :: (NodeType) → ?[NodeType]\n  // Find a set of wrapping node types that would allow a node of the\n  // given type to appear at this position. The result may be empty\n  // (when it fits directly) and will be null when no such wrapping\n  // exists.\n  findWrapping(target) {\n    for (let i = 0; i < this.wrapCache.length; i += 2)\n      if (this.wrapCache[i] == target) return this.wrapCache[i + 1]\n    let computed = this.computeWrapping(target)\n    this.wrapCache.push(target, computed)\n    return computed\n  }\n\n  computeWrapping(target) {\n    let seen = Object.create(null), active = [{match: this, type: null, via: null}]\n    while (active.length) {\n      let current = active.shift(), match = current.match\n      if (match.matchType(target)) {\n        let result = []\n        for (let obj = current; obj.type; obj = obj.via)\n          result.push(obj.type)\n        return result.reverse()\n      }\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i]\n        if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n          active.push({match: type.contentMatch, type, via: current})\n          seen[type.name] = true\n        }\n      }\n    }\n  }\n\n  // :: number\n  // The number of outgoing edges this node has in the finite\n  // automaton that describes the content expression.\n  get edgeCount() {\n    return this.next.length >> 1\n  }\n\n  // :: (number) → {type: NodeType, next: ContentMatch}\n  // Get the _n_​th outgoing edge from this node in the finite\n  // automaton that describes the content expression.\n  edge(n) {\n    let i = n << 1\n    if (i >= this.next.length) throw new RangeError(`There's no ${n}th edge in this content match`)\n    return {type: this.next[i], next: this.next[i + 1]}\n  }\n\n  toString() {\n    let seen = []\n    function scan(m) {\n      seen.push(m)\n      for (let i = 1; i < m.next.length; i += 2)\n        if (seen.indexOf(m.next[i]) == -1) scan(m.next[i])\n    }\n    scan(this)\n    return seen.map((m, i) => {\n      let out = i + (m.validEnd ? \"*\" : \" \") + \" \"\n      for (let i = 0; i < m.next.length; i += 2)\n        out += (i ? \", \" : \"\") + m.next[i].name + \"->\" + seen.indexOf(m.next[i + 1])\n      return out\n    }).join(\"\\n\")\n  }\n}\n\nContentMatch.empty = new ContentMatch(true)\n\nclass TokenStream {\n  constructor(string, nodeTypes) {\n    this.string = string\n    this.nodeTypes = nodeTypes\n    this.inline = null\n    this.pos = 0\n    this.tokens = string.split(/\\s*(?=\\b|\\W|$)/)\n    if (this.tokens[this.tokens.length - 1] == \"\") this.tokens.pop()\n    if (this.tokens[0] == \"\") this.tokens.shift()\n  }\n\n  get next() { return this.tokens[this.pos] }\n\n  eat(tok) { return this.next == tok && (this.pos++ || true) }\n\n  err(str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") }\n}\n\nfunction parseExpr(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSeq(stream)) }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n}\n\nfunction parseExprSeq(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSubscript(stream)) }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  let expr = parseExprAtom(stream)\n  for (;;) {\n    if (stream.eat(\"+\"))\n      expr = {type: \"plus\", expr}\n    else if (stream.eat(\"*\"))\n      expr = {type: \"star\", expr}\n    else if (stream.eat(\"?\"))\n      expr = {type: \"opt\", expr}\n    else if (stream.eat(\"{\"))\n      expr = parseExprRange(stream, expr)\n    else break\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) stream.err(\"Expected number, got '\" + stream.next + \"'\")\n  let result = Number(stream.next)\n  stream.pos++\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  let min = parseNum(stream), max = min\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") max = parseNum(stream)\n    else max = -1\n  }\n  if (!stream.eat(\"}\")) stream.err(\"Unclosed braced range\")\n  return {type: \"range\", min, max, expr}\n}\n\nfunction resolveName(stream, name) {\n  let types = stream.nodeTypes, type = types[name]\n  if (type) return [type]\n  let result = []\n  for (let typeName in types) {\n    let type = types[typeName]\n    if (type.groups.indexOf(name) > -1) result.push(type)\n  }\n  if (result.length == 0) stream.err(\"No node type or group '\" + name + \"' found\")\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    let expr = parseExpr(stream)\n    if (!stream.eat(\")\")) stream.err(\"Missing closing paren\")\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    let exprs = resolveName(stream, stream.next).map(type => {\n      if (stream.inline == null) stream.inline = type.isInline\n      else if (stream.inline != type.isInline) stream.err(\"Mixing inline and block content\")\n      return {type: \"name\", value: type}\n    })\n    stream.pos++\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\")\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object) → [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  let nfa = [[]]\n  connect(compile(expr, 0), node())\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    let edge = {term, to}\n    nfa[from].push(edge)\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(edge => edge.to = to) }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce((out, expr) => out.concat(compile(expr, from)), [])\n    } else if (expr.type == \"seq\") {\n      for (let i = 0;; i++) {\n        let next = compile(expr.exprs[i], from)\n        if (i == expr.exprs.length - 1) return next\n        connect(next, from = node())\n      }\n    } else if (expr.type == \"star\") {\n      let loop = node()\n      edge(from, loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      let loop = node()\n      connect(compile(expr.expr, from), loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      let cur = from\n      for (let i = 0; i < expr.min; i++) {\n        let next = node()\n        connect(compile(expr.expr, cur), next)\n        cur = next\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur)\n      } else {\n        for (let i = expr.min; i < expr.max; i++) {\n          let next = node()\n          edge(cur, next)\n          connect(compile(expr.expr, cur), next)\n          cur = next\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  let result = []\n  scan(node)\n  return result.sort(cmp)\n\n  function scan(node) {\n    let edges = nfa[node]\n    if (edges.length == 1 && !edges[0].term) return scan(edges[0].to)\n    result.push(node)\n    for (let i = 0; i < edges.length; i++) {\n      let {term, to} = edges[i]\n      if (!term && result.indexOf(to) == -1) scan(to)\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]]) → ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  let labeled = Object.create(null)\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    let out = []\n    states.forEach(node => {\n      nfa[node].forEach(({term, to}) => {\n        if (!term) return\n        let known = out.indexOf(term), set = known > -1 && out[known + 1]\n        nullFrom(nfa, to).forEach(node => {\n          if (!set) out.push(term, set = [])\n          if (set.indexOf(node) == -1) set.push(node)\n        })\n      })\n    })\n    let state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1)\n    for (let i = 0; i < out.length; i += 2) {\n      let states = out[i + 1].sort(cmp)\n      state.next.push(out[i], labeled[states.join(\",\")] || explore(states))\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (let i = 0, work = [match]; i < work.length; i++) {\n    let state = work[i], dead = !state.validEnd, nodes = []\n    for (let j = 0; j < state.next.length; j += 2) {\n      let node = state.next[j], next = state.next[j + 1]\n      nodes.push(node.name)\n      if (dead && !(node.isText || node.hasRequiredAttrs())) dead = false\n      if (work.indexOf(next) == -1) work.push(next)\n    }\n    if (dead) stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position (see https://prosemirror.net/docs/guide/#generatable)\")\n  }\n}\n","import {Schema} from \"prosemirror-model\"\n\n// ::Schema Document schema for the data model used by CommonMark.\nexport const schema = new Schema({\n  nodes: {\n    doc: {\n      content: \"block+\"\n    },\n\n    paragraph: {\n      content: \"inline*\",\n      group: \"block\",\n      parseDOM: [{tag: \"p\"}],\n      toDOM() { return [\"p\", 0] }\n    },\n\n    blockquote: {\n      content: \"block+\",\n      group: \"block\",\n      parseDOM: [{tag: \"blockquote\"}],\n      toDOM() { return [\"blockquote\", 0] }\n    },\n\n    horizontal_rule: {\n      group: \"block\",\n      parseDOM: [{tag: \"hr\"}],\n      toDOM() { return [\"div\", [\"hr\"]] }\n    },\n\n    heading: {\n      attrs: {level: {default: 1}},\n      content: \"(text | image)*\",\n      group: \"block\",\n      defining: true,\n      parseDOM: [{tag: \"h1\", attrs: {level: 1}},\n                 {tag: \"h2\", attrs: {level: 2}},\n                 {tag: \"h3\", attrs: {level: 3}},\n                 {tag: \"h4\", attrs: {level: 4}},\n                 {tag: \"h5\", attrs: {level: 5}},\n                 {tag: \"h6\", attrs: {level: 6}}],\n      toDOM(node) { return [\"h\" + node.attrs.level, 0] }\n    },\n\n    code_block: {\n      content: \"text*\",\n      group: \"block\",\n      code: true,\n      defining: true,\n      marks: \"\",\n      attrs: {params: {default: \"\"}},\n      parseDOM: [{tag: \"pre\", preserveWhitespace: \"full\", getAttrs: node => (\n        {params: node.getAttribute(\"data-params\") || \"\"}\n      )}],\n      toDOM(node) { return [\"pre\", node.attrs.params ? {\"data-params\": node.attrs.params} : {}, [\"code\", 0]] }\n    },\n\n    ordered_list: {\n      content: \"list_item+\",\n      group: \"block\",\n      attrs: {order: {default: 1}, tight: {default: false}},\n      parseDOM: [{tag: \"ol\", getAttrs(dom) {\n        return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1,\n                tight: dom.hasAttribute(\"data-tight\")}\n      }}],\n      toDOM(node) {\n        return [\"ol\", {start: node.attrs.order == 1 ? null : node.attrs.order,\n                       \"data-tight\": node.attrs.tight ? \"true\" : null}, 0]\n      }\n    },\n\n    bullet_list: {\n      content: \"list_item+\",\n      group: \"block\",\n      attrs: {tight: {default: false}},\n      parseDOM: [{tag: \"ul\", getAttrs: dom => ({tight: dom.hasAttribute(\"data-tight\")})}],\n      toDOM(node) { return [\"ul\", {\"data-tight\": node.attrs.tight ? \"true\" : null}, 0] }\n    },\n\n    list_item: {\n      content: \"paragraph block*\",\n      defining: true,\n      parseDOM: [{tag: \"li\"}],\n      toDOM() { return [\"li\", 0] }\n    },\n\n    text: {\n      group: \"inline\"\n    },\n\n    image: {\n      inline: true,\n      attrs: {\n        src: {},\n        alt: {default: null},\n        title: {default: null}\n      },\n      group: \"inline\",\n      draggable: true,\n      parseDOM: [{tag: \"img[src]\", getAttrs(dom) {\n        return {\n          src: dom.getAttribute(\"src\"),\n          title: dom.getAttribute(\"title\"),\n          alt: dom.getAttribute(\"alt\")\n        }\n      }}],\n      toDOM(node) { return [\"img\", node.attrs] }\n    },\n\n    hard_break: {\n      inline: true,\n      group: \"inline\",\n      selectable: false,\n      parseDOM: [{tag: \"br\"}],\n      toDOM() { return [\"br\"] }\n    }\n  },\n\n  marks: {\n    em: {\n      parseDOM: [{tag: \"i\"}, {tag: \"em\"},\n                 {style: \"font-style\", getAttrs: value => value == \"italic\" && null}],\n      toDOM() { return [\"em\"] }\n    },\n\n    strong: {\n      parseDOM: [{tag: \"b\"}, {tag: \"strong\"},\n                 {style: \"font-weight\", getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null}],\n      toDOM() { return [\"strong\"] }\n    },\n\n    link: {\n      attrs: {\n        href: {},\n        title: {default: null}\n      },\n      inclusive: false,\n      parseDOM: [{tag: \"a[href]\", getAttrs(dom) {\n        return {href: dom.getAttribute(\"href\"), title: dom.getAttribute(\"title\")}\n      }}],\n      toDOM(node) { return [\"a\", node.attrs] }\n    },\n\n    code: {\n      parseDOM: [{tag: \"code\"}],\n      toDOM() { return [\"code\"] }\n    }\n  }\n})\n","import {Fragment} from \"./fragment\"\nimport {Slice} from \"./replace\"\nimport {Mark} from \"./mark\"\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   property's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.) Rules\n//   matching styles may only produce [marks](#model.ParseRule.mark),\n//   not nodes.\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schema—when directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   consuming:: ?boolean\n//   By default, when a rule matches an element or style, no further\n//   rules get a chance to match it. By setting this to `false`, you\n//   indicate that even when this rule matches, other rules that come\n//   after it should also run.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   context—the parent nodes into which the content is being\n//   parsed—matches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a section—a double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   closeParent:: ?bool\n//   When true, finding an element that matches this rule will close\n//   the current node.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>) → ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node) → dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema) → Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nexport class DOMParser {\n  // :: (Schema, [ParseRule])\n  // Create a parser that targets the given schema, using the given\n  // parsing rules.\n  constructor(schema, rules) {\n    // :: Schema\n    // The schema into which the parser parses.\n    this.schema = schema\n    // :: [ParseRule]\n    // The set of [parse rules](#model.ParseRule) that the parser\n    // uses, in order of precedence.\n    this.rules = rules\n    this.tags = []\n    this.styles = []\n\n    rules.forEach(rule => {\n      if (rule.tag) this.tags.push(rule)\n      else if (rule.style) this.styles.push(rule)\n    })\n\n    // Only normalize list elements when lists in the schema can't directly contain themselves\n    this.normalizeLists = !this.tags.some(r => {\n      if (!/^(ul|ol)\\b/.test(r.tag) || !r.node) return false\n      let node = schema.nodes[r.node]\n      return node.contentMatch.matchType(node)\n    })\n  }\n\n  // :: (dom.Node, ?ParseOptions) → Node\n  // Parse a document from the content of a DOM node.\n  parse(dom, options = {}) {\n    let context = new ParseContext(this, options, false)\n    context.addAll(dom, null, options.from, options.to)\n    return context.finish()\n  }\n\n  // :: (dom.Node, ?ParseOptions) → Slice\n  // Parses the content of the given DOM node, like\n  // [`parse`](#model.DOMParser.parse), and takes the same set of\n  // options. But unlike that method, which produces a whole node,\n  // this one returns a slice that is open at the sides, meaning that\n  // the schema constraints aren't applied to the start of nodes to\n  // the left of the input and the end of nodes at the end.\n  parseSlice(dom, options = {}) {\n    let context = new ParseContext(this, options, true)\n    context.addAll(dom, null, options.from, options.to)\n    return Slice.maxOpen(context.finish())\n  }\n\n  matchTag(dom, context, after) {\n    for (let i = after ? this.tags.indexOf(after) + 1 : 0; i < this.tags.length; i++) {\n      let rule = this.tags[i]\n      if (matches(dom, rule.tag) &&\n          (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n          (!rule.context || context.matchesContext(rule.context))) {\n        if (rule.getAttrs) {\n          let result = rule.getAttrs(dom)\n          if (result === false) continue\n          rule.attrs = result\n        }\n        return rule\n      }\n    }\n  }\n\n  matchStyle(prop, value, context, after) {\n    for (let i = after ? this.styles.indexOf(after) + 1 : 0; i < this.styles.length; i++) {\n      let rule = this.styles[i]\n      if (rule.style.indexOf(prop) != 0 ||\n          rule.context && !context.matchesContext(rule.context) ||\n          // Test that the style string either precisely matches the prop,\n          // or has an '=' sign after the prop, followed by the given\n          // value.\n          rule.style.length > prop.length &&\n          (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n        continue\n      if (rule.getAttrs) {\n        let result = rule.getAttrs(value)\n        if (result === false) continue\n        rule.attrs = result\n      }\n      return rule\n    }\n  }\n\n  // : (Schema) → [ParseRule]\n  static schemaRules(schema) {\n    let result = []\n    function insert(rule) {\n      let priority = rule.priority == null ? 50 : rule.priority, i = 0\n      for (; i < result.length; i++) {\n        let next = result[i], nextPriority = next.priority == null ? 50 : next.priority\n        if (nextPriority < priority) break\n      }\n      result.splice(i, 0, rule)\n    }\n\n    for (let name in schema.marks) {\n      let rules = schema.marks[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.mark = name\n      })\n    }\n    for (let name in schema.nodes) {\n      let rules = schema.nodes[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.node = name\n      })\n    }\n    return result\n  }\n\n  // :: (Schema) → DOMParser\n  // Construct a DOM parser using the parsing rules listed in a\n  // schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n  // [priority](#model.ParseRule.priority).\n  static fromSchema(schema) {\n    return schema.cached.domParser ||\n      (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n  }\n}\n\n// : Object<bool> The block-level tags in HTML5\nconst blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n}\n\n// : Object<bool> The tags that we normally ignore.\nconst ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n}\n\n// : Object<bool> List tags.\nconst listTags = {ol: true, ul: true}\n\n// Using a bitfield for node context options\nconst OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4\n\nfunction wsOptionsFor(type, preserveWhitespace, base) {\n  if (preserveWhitespace != null) return (preserveWhitespace ? OPT_PRESERVE_WS : 0) |\n    (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0)\n  return type && type.whitespace == \"pre\" ? OPT_PRESERVE_WS | OPT_PRESERVE_WS_FULL : base & ~OPT_OPEN_LEFT\n}\n\nclass NodeContext {\n  constructor(type, attrs, marks, pendingMarks, solid, match, options) {\n    this.type = type\n    this.attrs = attrs\n    this.solid = solid\n    this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch)\n    this.options = options\n    this.content = []\n    // Marks applied to this node itself\n    this.marks = marks\n    // Marks applied to its children\n    this.activeMarks = Mark.none\n    // Marks that can't apply here, but will be used in children if possible\n    this.pendingMarks = pendingMarks\n    // Nested Marks with same type\n    this.stashMarks = []\n  }\n\n  findWrapping(node) {\n    if (!this.match) {\n      if (!this.type) return []\n      let fill = this.type.contentMatch.fillBefore(Fragment.from(node))\n      if (fill) {\n        this.match = this.type.contentMatch.matchFragment(fill)\n      } else {\n        let start = this.type.contentMatch, wrap\n        if (wrap = start.findWrapping(node.type)) {\n          this.match = start\n          return wrap\n        } else {\n          return null\n        }\n      }\n    }\n    return this.match.findWrapping(node.type)\n  }\n\n  finish(openEnd) {\n    if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n      let last = this.content[this.content.length - 1], m\n      if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n        if (last.text.length == m[0].length) this.content.pop()\n        else this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length))\n      }\n    }\n    let content = Fragment.from(this.content)\n    if (!openEnd && this.match)\n      content = content.append(this.match.fillBefore(Fragment.empty, true))\n    return this.type ? this.type.create(this.attrs, content, this.marks) : content\n  }\n\n  popFromStashMark(mark) {\n    for (let i = this.stashMarks.length - 1; i >= 0; i--)\n      if (mark.eq(this.stashMarks[i])) return this.stashMarks.splice(i, 1)[0]\n  }\n\n  applyPending(nextType) {\n    for (let i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n      let mark = pending[i]\n      if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n          !mark.isInSet(this.activeMarks)) {\n        this.activeMarks = mark.addToSet(this.activeMarks)\n        this.pendingMarks = mark.removeFromSet(this.pendingMarks)\n      }\n    }\n  }\n\n  inlineContext(node) {\n    if (this.type) return this.type.inlineContent\n    if (this.content.length) return this.content[0].isInline\n    return node.parentNode && !blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())\n  }\n}\n\nclass ParseContext {\n  // : (DOMParser, Object)\n  constructor(parser, options, open) {\n    // : DOMParser The parser we are using.\n    this.parser = parser\n    // : Object The options passed to this parse.\n    this.options = options\n    this.isOpen = open\n    let topNode = options.topNode, topContext\n    let topOptions = wsOptionsFor(null, options.preserveWhitespace, 0) | (open ? OPT_OPEN_LEFT : 0)\n    if (topNode)\n      topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                   options.topMatch || topNode.type.contentMatch, topOptions)\n    else if (open)\n      topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions)\n    else\n      topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions)\n    this.nodes = [topContext]\n    // : [Mark] The current set of marks\n    this.open = 0\n    this.find = options.findPositions\n    this.needsBlock = false\n  }\n\n  get top() {\n    return this.nodes[this.open]\n  }\n\n  // : (dom.Node)\n  // Add a DOM node to the content. Text is inserted as text node,\n  // otherwise, the node is passed to `addElement` or, if it has a\n  // `style` attribute, `addElementWithStyles`.\n  addDOM(dom) {\n    if (dom.nodeType == 3) {\n      this.addTextNode(dom)\n    } else if (dom.nodeType == 1) {\n      let style = dom.getAttribute(\"style\")\n      let marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.addPendingMark(marks[i])\n      this.addElement(dom)\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.removePendingMark(marks[i], top)\n    }\n  }\n\n  addTextNode(dom) {\n    let value = dom.nodeValue\n    let top = this.top\n    if (top.options & OPT_PRESERVE_WS_FULL ||\n        top.inlineContext(dom) ||\n        /[^ \\t\\r\\n\\u000c]/.test(value)) {\n      if (!(top.options & OPT_PRESERVE_WS)) {\n        value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \")\n        // If this starts with whitespace, and there is no node before it, or\n        // a hard break, or a text node that ends with whitespace, strip the\n        // leading space.\n        if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n          let nodeBefore = top.content[top.content.length - 1]\n          let domNodeBefore = dom.previousSibling\n          if (!nodeBefore ||\n              (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n              (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n            value = value.slice(1)\n        }\n      } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n        value = value.replace(/\\r?\\n|\\r/g, \" \")\n      } else {\n        value = value.replace(/\\r\\n?/g, \"\\n\")\n      }\n      if (value) this.insertNode(this.parser.schema.text(value))\n      this.findInText(dom)\n    } else {\n      this.findInside(dom)\n    }\n  }\n\n  // : (dom.Element, ?ParseRule)\n  // Try to find a handler for the given tag and use that to parse. If\n  // none is found, the element's content nodes are added directly.\n  addElement(dom, matchAfter) {\n    let name = dom.nodeName.toLowerCase(), ruleID\n    if (listTags.hasOwnProperty(name) && this.parser.normalizeLists) normalizeList(dom)\n    let rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) ||\n        (ruleID = this.parser.matchTag(dom, this, matchAfter))\n    if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n      this.findInside(dom)\n      this.ignoreFallback(dom)\n    } else if (!rule || rule.skip || rule.closeParent) {\n      if (rule && rule.closeParent) this.open = Math.max(0, this.open - 1)\n      else if (rule && rule.skip.nodeType) dom = rule.skip\n      let sync, top = this.top, oldNeedsBlock = this.needsBlock\n      if (blockTags.hasOwnProperty(name)) {\n        sync = true\n        if (!top.type) this.needsBlock = true\n      } else if (!dom.firstChild) {\n        this.leafFallback(dom)\n        return\n      }\n      this.addAll(dom)\n      if (sync) this.sync(top)\n      this.needsBlock = oldNeedsBlock\n    } else {\n      this.addElementByRule(dom, rule, rule.consuming === false ? ruleID : null)\n    }\n  }\n\n  // Called for leaf DOM nodes that would otherwise be ignored\n  leafFallback(dom) {\n    if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n      this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\"))\n  }\n\n  // Called for ignored nodes\n  ignoreFallback(dom) {\n    // Ignored BR nodes should at least create an inline context\n    if (dom.nodeName == \"BR\" && (!this.top.type || !this.top.type.inlineContent))\n      this.findPlace(this.parser.schema.text(\"-\"))\n  }\n\n  // Run any style parser associated with the node's styles. Either\n  // return an array of marks, or null to indicate some of the styles\n  // had a rule with `ignore` set.\n  readStyles(styles) {\n    let marks = Mark.none\n    style: for (let i = 0; i < styles.length; i += 2) {\n      for (let after = null;;) {\n        let rule = this.parser.matchStyle(styles[i], styles[i + 1], this, after)\n        if (!rule) continue style\n        if (rule.ignore) return null\n        marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks)\n        if (rule.consuming === false) after = rule\n        else break\n      }\n    }\n    return marks\n  }\n\n  // : (dom.Element, ParseRule) → bool\n  // Look up a handler for the given node. If none are found, return\n  // false. Otherwise, apply it, use its return value to drive the way\n  // the node's content is wrapped, and return true.\n  addElementByRule(dom, rule, continueAfter) {\n    let sync, nodeType, markType, mark\n    if (rule.node) {\n      nodeType = this.parser.schema.nodes[rule.node]\n      if (!nodeType.isLeaf) {\n        sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace)\n      } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n        this.leafFallback(dom)\n      }\n    } else {\n      markType = this.parser.schema.marks[rule.mark]\n      mark = markType.create(rule.attrs)\n      this.addPendingMark(mark)\n    }\n    let startIn = this.top\n\n    if (nodeType && nodeType.isLeaf) {\n      this.findInside(dom)\n    } else if (continueAfter) {\n      this.addElement(dom, continueAfter)\n    } else if (rule.getContent) {\n      this.findInside(dom)\n      rule.getContent(dom, this.parser.schema).forEach(node => this.insertNode(node))\n    } else {\n      let contentDOM = rule.contentElement\n      if (typeof contentDOM == \"string\") contentDOM = dom.querySelector(contentDOM)\n      else if (typeof contentDOM == \"function\") contentDOM = contentDOM(dom)\n      if (!contentDOM) contentDOM = dom\n      this.findAround(dom, contentDOM, true)\n      this.addAll(contentDOM, sync)\n    }\n    if (sync) { this.sync(startIn); this.open-- }\n    if (mark) this.removePendingMark(mark, startIn)\n  }\n\n  // : (dom.Node, ?NodeBuilder, ?number, ?number)\n  // Add all child nodes between `startIndex` and `endIndex` (or the\n  // whole node, if not given). If `sync` is passed, use it to\n  // synchronize after every block element.\n  addAll(parent, sync, startIndex, endIndex) {\n    let index = startIndex || 0\n    for (let dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n             end = endIndex == null ? null : parent.childNodes[endIndex];\n         dom != end; dom = dom.nextSibling, ++index) {\n      this.findAtPoint(parent, index)\n      this.addDOM(dom)\n      if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n        this.sync(sync)\n    }\n    this.findAtPoint(parent, index)\n  }\n\n  // Try to find a way to fit the given node type into the current\n  // context. May add intermediate wrappers and/or leave non-solid\n  // nodes that we're in.\n  findPlace(node) {\n    let route, sync\n    for (let depth = this.open; depth >= 0; depth--) {\n      let cx = this.nodes[depth]\n      let found = cx.findWrapping(node)\n      if (found && (!route || route.length > found.length)) {\n        route = found\n        sync = cx\n        if (!found.length) break\n      }\n      if (cx.solid) break\n    }\n    if (!route) return false\n    this.sync(sync)\n    for (let i = 0; i < route.length; i++)\n      this.enterInner(route[i], null, false)\n    return true\n  }\n\n  // : (Node) → ?Node\n  // Try to insert the given node, adjusting the context when needed.\n  insertNode(node) {\n    if (node.isInline && this.needsBlock && !this.top.type) {\n      let block = this.textblockFromContext()\n      if (block) this.enterInner(block)\n    }\n    if (this.findPlace(node)) {\n      this.closeExtra()\n      let top = this.top\n      top.applyPending(node.type)\n      if (top.match) top.match = top.match.matchType(node.type)\n      let marks = top.activeMarks\n      for (let i = 0; i < node.marks.length; i++)\n        if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n          marks = node.marks[i].addToSet(marks)\n      top.content.push(node.mark(marks))\n      return true\n    }\n    return false\n  }\n\n  // : (NodeType, ?Object) → bool\n  // Try to start a node of the given type, adjusting the context when\n  // necessary.\n  enter(type, attrs, preserveWS) {\n    let ok = this.findPlace(type.create(attrs))\n    if (ok) this.enterInner(type, attrs, true, preserveWS)\n    return ok\n  }\n\n  // Open a node of the given type\n  enterInner(type, attrs, solid, preserveWS) {\n    this.closeExtra()\n    let top = this.top\n    top.applyPending(type)\n    top.match = top.match && top.match.matchType(type, attrs)\n    let options = wsOptionsFor(type, preserveWS, top.options)\n    if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) options |= OPT_OPEN_LEFT\n    this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options))\n    this.open++\n  }\n\n  // Make sure all nodes above this.open are finished and added to\n  // their parents\n  closeExtra(openEnd) {\n    let i = this.nodes.length - 1\n    if (i > this.open) {\n      for (; i > this.open; i--) this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd))\n      this.nodes.length = this.open + 1\n    }\n  }\n\n  finish() {\n    this.open = 0\n    this.closeExtra(this.isOpen)\n    return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n  }\n\n  sync(to) {\n    for (let i = this.open; i >= 0; i--) if (this.nodes[i] == to) {\n      this.open = i\n      return\n    }\n  }\n\n  get currentPos() {\n    this.closeExtra()\n    let pos = 0\n    for (let i = this.open; i >= 0; i--) {\n      let content = this.nodes[i].content\n      for (let j = content.length - 1; j >= 0; j--)\n        pos += content[j].nodeSize\n      if (i) pos++\n    }\n    return pos\n  }\n\n  findAtPoint(parent, offset) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == parent && this.find[i].offset == offset)\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findInside(parent) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findAround(parent, content, before) {\n    if (parent != content && this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n        let pos = content.compareDocumentPosition(this.find[i].node)\n        if (pos & (before ? 2 : 4))\n          this.find[i].pos = this.currentPos\n      }\n    }\n  }\n\n  findInText(textNode) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == textNode)\n        this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset)\n    }\n  }\n\n  // : (string) → bool\n  // Determines whether the given [context\n  // string](#ParseRule.context) matches this context.\n  matchesContext(context) {\n    if (context.indexOf(\"|\") > -1)\n      return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this)\n\n    let parts = context.split(\"/\")\n    let option = this.options.context\n    let useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type)\n    let minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1)\n    let match = (i, depth) => {\n      for (; i >= 0; i--) {\n        let part = parts[i]\n        if (part == \"\") {\n          if (i == parts.length - 1 || i == 0) continue\n          for (; depth >= minDepth; depth--)\n            if (match(i - 1, depth)) return true\n          return false\n        } else {\n          let next = depth > 0 || (depth == 0 && useRoot) ? this.nodes[depth].type\n              : option && depth >= minDepth ? option.node(depth - minDepth).type\n              : null\n          if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n            return false\n          depth--\n        }\n      }\n      return true\n    }\n    return match(parts.length - 1, this.open)\n  }\n\n  textblockFromContext() {\n    let $context = this.options.context\n    if ($context) for (let d = $context.depth; d >= 0; d--) {\n      let deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType\n      if (deflt && deflt.isTextblock && deflt.defaultAttrs) return deflt\n    }\n    for (let name in this.parser.schema.nodes) {\n      let type = this.parser.schema.nodes[name]\n      if (type.isTextblock && type.defaultAttrs) return type\n    }\n  }\n\n  addPendingMark(mark) {\n    let found = findSameMarkInSet(mark, this.top.pendingMarks)\n    if (found) this.top.stashMarks.push(found)\n    this.top.pendingMarks = mark.addToSet(this.top.pendingMarks)\n  }\n\n  removePendingMark(mark, upto) {\n    for (let depth = this.open; depth >= 0; depth--) {\n      let level = this.nodes[depth]\n      let found = level.pendingMarks.lastIndexOf(mark)\n      if (found > -1) {\n        level.pendingMarks = mark.removeFromSet(level.pendingMarks)\n      } else {\n        level.activeMarks = mark.removeFromSet(level.activeMarks)\n        let stashMark = level.popFromStashMark(mark)\n        if (stashMark && level.type && level.type.allowsMarkType(stashMark.type))\n          level.activeMarks = stashMark.addToSet(level.activeMarks)\n      }\n      if (level == upto) break\n    }\n  }\n}\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (let child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    let name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child)\n      child = prevItem\n    } else if (name == \"li\") {\n      prevItem = child\n    } else if (name) {\n      prevItem = null\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string) → [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  let re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = []\n  while (m = re.exec(style)) result.push(m[1], m[2].trim())\n  return result\n}\n\nfunction copy(obj) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  let nodes = nodeType.schema.nodes\n  for (let name in nodes) {\n    let parent = nodes[name]\n    if (!parent.allowsMarkType(markType)) continue\n    let seen = [], scan = match => {\n      seen.push(match)\n      for (let i = 0; i < match.edgeCount; i++) {\n        let {type, next} = match.edge(i)\n        if (type == nodeType) return true\n        if (seen.indexOf(next) < 0 && scan(next)) return true\n      }\n    }\n    if (scan(parent.contentMatch)) return true\n  }\n}\n\nfunction findSameMarkInSet(mark, set) {\n  for (let i = 0; i < set.length; i++) {\n    if (mark.eq(set[i])) return set[i]\n  }\n}\n","// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, a `{dom: Node, contentDOM: ?Node}` object, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a string—the name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced “hole”) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nexport class DOMSerializer {\n  // :: (Object<(node: Node) → DOMOutputSpec>, Object<?(mark: Mark, inline: bool) → DOMOutputSpec>)\n  // Create a serializer. `nodes` should map node names to functions\n  // that take a node and return a description of the corresponding\n  // DOM. `marks` does the same for mark names, but also gets an\n  // argument that tells it whether the mark's content is block or\n  // inline content (for typical use, it'll always be inline). A mark\n  // serializer may be `null` to indicate that marks of that type\n  // should not be serialized.\n  constructor(nodes, marks) {\n    // :: Object<(node: Node) → DOMOutputSpec>\n    // The node serialization functions.\n    this.nodes = nodes || {}\n    // :: Object<?(mark: Mark, inline: bool) → DOMOutputSpec>\n    // The mark serialization functions.\n    this.marks = marks || {}\n  }\n\n  // :: (Fragment, ?Object) → dom.DocumentFragment\n  // Serialize the content of this fragment to a DOM fragment. When\n  // not in the browser, the `document` option, containing a DOM\n  // document, should be passed so that the serializer can create\n  // nodes.\n  serializeFragment(fragment, options = {}, target) {\n    if (!target) target = doc(options).createDocumentFragment()\n\n    let top = target, active = null\n    fragment.forEach(node => {\n      if (active || node.marks.length) {\n        if (!active) active = []\n        let keep = 0, rendered = 0\n        while (keep < active.length && rendered < node.marks.length) {\n          let next = node.marks[rendered]\n          if (!this.marks[next.type.name]) { rendered++; continue }\n          if (!next.eq(active[keep]) || next.type.spec.spanning === false) break\n          keep += 2; rendered++\n        }\n        while (keep < active.length) {\n          top = active.pop()\n          active.pop()\n        }\n        while (rendered < node.marks.length) {\n          let add = node.marks[rendered++]\n          let markDOM = this.serializeMark(add, node.isInline, options)\n          if (markDOM) {\n            active.push(add, top)\n            top.appendChild(markDOM.dom)\n            top = markDOM.contentDOM || markDOM.dom\n          }\n        }\n      }\n      top.appendChild(this.serializeNodeInner(node, options))\n    })\n\n    return target\n  }\n\n  serializeNodeInner(node, options = {}) {\n    let {dom, contentDOM} =\n        DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node))\n    if (contentDOM) {\n      if (node.isLeaf)\n        throw new RangeError(\"Content hole not allowed in a leaf node spec\")\n      if (options.onContent)\n        options.onContent(node, contentDOM, options)\n      else\n        this.serializeFragment(node.content, options, contentDOM)\n    }\n    return dom\n  }\n\n  // :: (Node, ?Object) → dom.Node\n  // Serialize this node to a DOM node. This can be useful when you\n  // need to serialize a part of a document, as opposed to the whole\n  // document. To serialize a whole document, use\n  // [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n  // its [content](#model.Node.content).\n  serializeNode(node, options = {}) {\n    let dom = this.serializeNodeInner(node, options)\n    for (let i = node.marks.length - 1; i >= 0; i--) {\n      let wrap = this.serializeMark(node.marks[i], node.isInline, options)\n      if (wrap) {\n        ;(wrap.contentDOM || wrap.dom).appendChild(dom)\n        dom = wrap.dom\n      }\n    }\n    return dom\n  }\n\n  serializeMark(mark, inline, options = {}) {\n    let toDOM = this.marks[mark.type.name]\n    return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n  }\n\n  // :: (dom.Document, DOMOutputSpec) → {dom: dom.Node, contentDOM: ?dom.Node}\n  // Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n  // the spec has a hole (zero) in it, `contentDOM` will point at the\n  // node with the hole.\n  static renderSpec(doc, structure, xmlNS = null) {\n    if (typeof structure == \"string\")\n      return {dom: doc.createTextNode(structure)}\n    if (structure.nodeType != null)\n      return {dom: structure}\n    if (structure.dom && structure.dom.nodeType != null)\n      return structure\n    let tagName = structure[0], space = tagName.indexOf(\" \")\n    if (space > 0) {\n      xmlNS = tagName.slice(0, space)\n      tagName = tagName.slice(space + 1)\n    }\n    let contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName)\n    let attrs = structure[1], start = 1\n    if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n      start = 2\n      for (let name in attrs) if (attrs[name] != null) {\n        let space = name.indexOf(\" \")\n        if (space > 0) dom.setAttributeNS(name.slice(0, space), name.slice(space + 1), attrs[name])\n        else dom.setAttribute(name, attrs[name])\n      }\n    }\n    for (let i = start; i < structure.length; i++) {\n      let child = structure[i]\n      if (child === 0) {\n        if (i < structure.length - 1 || i > start)\n          throw new RangeError(\"Content hole must be the only child of its parent node\")\n        return {dom, contentDOM: dom}\n      } else {\n        let {dom: inner, contentDOM: innerContent} = DOMSerializer.renderSpec(doc, child, xmlNS)\n        dom.appendChild(inner)\n        if (innerContent) {\n          if (contentDOM) throw new RangeError(\"Multiple content holes\")\n          contentDOM = innerContent\n        }\n      }\n    }\n    return {dom, contentDOM}\n  }\n\n  // :: (Schema) → DOMSerializer\n  // Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n  // properties in a schema's node and mark specs.\n  static fromSchema(schema) {\n    return schema.cached.domSerializer ||\n      (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n  }\n\n  // : (Schema) → Object<(node: Node) → DOMOutputSpec>\n  // Gather the serializers in a schema's node specs into an object.\n  // This can be useful as a base to build a custom serializer from.\n  static nodesFromSchema(schema) {\n    let result = gatherToDOM(schema.nodes)\n    if (!result.text) result.text = node => node.text\n    return result\n  }\n\n  // : (Schema) → Object<(mark: Mark) → DOMOutputSpec>\n  // Gather the serializers in a schema's mark specs into an object.\n  static marksFromSchema(schema) {\n    return gatherToDOM(schema.marks)\n  }\n}\n\nfunction gatherToDOM(obj) {\n  let result = {}\n  for (let name in obj) {\n    let toDOM = obj[name].spec.toDOM\n    if (toDOM) result[name] = toDOM\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n","import {TextSelection, NodeSelection} from \"prosemirror-state\"\n\nimport browser from \"./browser\"\nimport {selectionCollapsed, isEquivalentPosition, domIndex, isOnEdge} from \"./dom\"\n\nexport function selectionFromDOM(view, origin) {\n  let domSel = view.root.getSelection(), doc = view.state.doc\n  if (!domSel.focusNode) return null\n  let nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0\n  let head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset)\n  if (head < 0) return null\n  let $head = doc.resolve(head), $anchor, selection\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head\n    while (nearestDesc && !nearestDesc.node) nearestDesc = nearestDesc.parent\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      let pos = nearestDesc.posBefore\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos))\n    }\n  } else {\n    let anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset)\n    if (anchor < 0) return null\n    $anchor = doc.resolve(anchor)\n  }\n\n  if (!selection) {\n    let bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1\n    selection = selectionBetween(view, $anchor, $head, bias)\n  }\n  return selection\n}\n\nfunction editorOwnsSelection(view) {\n  return view.editable ? view.hasFocus() :\n    hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom)\n}\n\nexport function selectionToDOM(view, force) {\n  let sel = view.state.selection\n  syncNodeSelection(view, sel)\n\n  if (!editorOwnsSelection(view)) return\n\n  // The delayed drag selection causes issues with Cell Selections\n  // in Safari. And the drag selection delay is to workarond issues\n  // which only present in Chrome.\n  if (!force && view.mouseDown && view.mouseDown.allowDefault && browser.chrome) {\n    let domSel = view.root.getSelection(), curSel = view.domObserver.currentSelection\n    if (domSel.anchorNode && isEquivalentPosition(domSel.anchorNode, domSel.anchorOffset,\n                                                  curSel.anchorNode, curSel.anchorOffset)) {\n      view.mouseDown.delayedSelectionSync = true\n      view.domObserver.setCurSelection()\n      return\n    }\n  }\n\n  view.domObserver.disconnectSelection()\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view)\n  } else {\n    let {anchor, head} = sel, resetEditableFrom, resetEditableTo\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        resetEditableFrom = temporarilyEditableNear(view, sel.from)\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        resetEditableTo = temporarilyEditableNear(view, sel.to)\n    }\n    view.docView.setSelection(anchor, head, view.root, force)\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) resetEditable(resetEditableFrom)\n      if (resetEditableTo) resetEditable(resetEditableTo)\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\")\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\")\n      if (\"onselectionchange\" in document) removeClassOnSelectionChange(view)\n    }\n  }\n\n  view.domObserver.setCurSelection()\n  view.domObserver.connectSelection()\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nconst brokenSelectBetweenUneditable = browser.safari || browser.chrome && browser.chrome_version < 63\n\nfunction temporarilyEditableNear(view, pos) {\n  let {node, offset} = view.docView.domFromPos(pos, 0)\n  let after = offset < node.childNodes.length ? node.childNodes[offset] : null\n  let before = offset ? node.childNodes[offset - 1] : null\n  if (browser.safari && after && after.contentEditable == \"false\") return setEditable(after)\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) return setEditable(after)\n    else if (before) return setEditable(before)\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\"\n  if (browser.safari && element.draggable) { element.draggable = false; element.wasDraggable = true }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\"\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  let doc = view.dom.ownerDocument\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard)\n  let domSel = view.root.getSelection()\n  let node = domSel.anchorNode, offset = domSel.anchorOffset\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = () => {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard)\n      setTimeout(() => {\n        if (!editorOwnsSelection(view) || view.state.selection.visible)\n          view.dom.classList.remove(\"ProseMirror-hideselection\")\n      }, 20)\n    }\n  })\n}\n\nfunction selectCursorWrapper(view) {\n  let domSel = view.root.getSelection(), range = document.createRange()\n  let node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\"\n  if (img) range.setEnd(node.parentNode, domIndex(node) + 1)\n  else range.setEnd(node, 0)\n  range.collapse(false)\n  domSel.removeAllRanges()\n  domSel.addRange(range)\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && browser.ie && browser.ie_version <= 11) {\n    node.disabled = true\n    node.disabled = false\n  }\n}\n\nexport function syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    let desc = view.docView.descAt(sel.from)\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view)\n      if (desc) desc.selectNode()\n      view.lastSelectedViewDesc = desc\n    }\n  } else {\n    clearNodeSelection(view)\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      view.lastSelectedViewDesc.deselectNode()\n    view.lastSelectedViewDesc = null\n  }\n}\n\nexport function selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", f => f(view, $anchor, $head))\n    || TextSelection.between($anchor, $head, bias)\n}\n\nexport function hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) return false\n  return hasSelection(view)\n}\n\nexport function hasSelection(view) {\n  let sel = view.root.getSelection()\n  if (!sel.anchorNode) return false\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nexport function anchorInRightPlace(view) {\n  let anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0)\n  let domSel = view.root.getSelection()\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n","import {Transform} from \"prosemirror-transform\"\nimport {Mark} from \"prosemirror-model\"\nimport {Selection} from \"./selection\"\n\nconst UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nexport class Transaction extends Transform {\n  constructor(state) {\n    super(state.doc)\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now()\n    this.curSelection = state.selection\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null)\n  }\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  get selection() {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor))\n      this.curSelectionFor = this.steps.length\n    }\n    return this.curSelection\n  }\n\n  // :: (Selection) → Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  setSelection(selection) {\n    if (selection.$from.doc != this.doc)\n      throw new RangeError(\"Selection passed to setSelection must point at the current document\")\n    this.curSelection = selection\n    this.curSelectionFor = this.steps.length\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS\n    this.storedMarks = null\n    return this\n  }\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  get selectionSet() {\n    return (this.updated & UPDATED_SEL) > 0\n  }\n\n  // :: (?[Mark]) → Transaction\n  // Set the current stored marks.\n  setStoredMarks(marks) {\n    this.storedMarks = marks\n    this.updated |= UPDATED_MARKS\n    return this\n  }\n\n  // :: ([Mark]) → Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  ensureMarks(marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      this.setStoredMarks(marks)\n    return this\n  }\n\n  // :: (Mark) → Transaction\n  // Add a mark to the set of stored marks.\n  addStoredMark(mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: (union<Mark, MarkType>) → Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  removeStoredMark(mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  get storedMarksSet() {\n    return (this.updated & UPDATED_MARKS) > 0\n  }\n\n  addStep(step, doc) {\n    super.addStep(step, doc)\n    this.updated = this.updated & ~UPDATED_MARKS\n    this.storedMarks = null\n  }\n\n  // :: (number) → Transaction\n  // Update the timestamp for the transaction.\n  setTime(time) {\n    this.time = time\n    return this\n  }\n\n  // :: (Slice) → Transaction\n  // Replace the current selection with the given slice.\n  replaceSelection(slice) {\n    this.selection.replace(this, slice)\n    return this\n  }\n\n  // :: (Node, ?bool) → Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  replaceSelectionWith(node, inheritMarks) {\n    let selection = this.selection\n    if (inheritMarks !== false)\n      node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none)))\n    selection.replaceWith(this, node)\n    return this\n  }\n\n  // :: () → Transaction\n  // Delete the selection.\n  deleteSelection() {\n    this.selection.replace(this)\n    return this\n  }\n\n  // :: (string, from: ?number, to: ?number) → Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  insertText(text, from, to = from) {\n    let schema = this.doc.type.schema\n    if (from == null) {\n      if (!text) return this.deleteSelection()\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) return this.deleteRange(from, to)\n      let marks = this.storedMarks\n      if (!marks) {\n        let $from = this.doc.resolve(from)\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to))\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks))\n      if (!this.selection.empty) this.setSelection(Selection.near(this.selection.$to))\n      return this\n    }\n  }\n\n  // :: (union<string, Plugin, PluginKey>, any) → Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  setMeta(key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value\n    return this\n  }\n\n  // :: (union<string, Plugin, PluginKey>) → any\n  // Retrieve a metadata property for a given name or plugin.\n  getMeta(key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  }\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  get isGeneric() {\n    for (let _ in this.meta) return false\n    return true\n  }\n\n  // :: () → Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  scrollIntoView() {\n    this.updated |= UPDATED_SCROLL\n    return this\n  }\n\n  get scrolledIntoView() {\n    return (this.updated & UPDATED_SCROLL) > 0\n  }\n}\n","import {Node} from \"prosemirror-model\"\n\nimport {Selection} from \"./selection\"\nimport {Transaction} from \"./transaction\"\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nclass FieldDesc {\n  constructor(name, desc, self) {\n    this.name = name\n    this.init = bind(desc.init, self)\n    this.apply = bind(desc.apply, self)\n  }\n}\n\nconst baseFields = [\n  new FieldDesc(\"doc\", {\n    init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init(config) { return config.storedMarks || null },\n    apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init() { return 0 },\n    apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n]\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nclass Configuration {\n  constructor(schema, plugins) {\n    this.schema = schema\n    this.fields = baseFields.concat()\n    this.plugins = []\n    this.pluginsByKey = Object.create(null)\n    if (plugins) plugins.forEach(plugin => {\n      if (this.pluginsByKey[plugin.key])\n        throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\")\n      this.plugins.push(plugin)\n      this.pluginsByKey[plugin.key] = plugin\n      if (plugin.spec.state)\n        this.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin))\n    })\n  }\n}\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structure—it isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nexport class EditorState {\n  constructor(config) {\n    this.config = config\n  }\n\n  // doc:: Node\n  // The current document.\n\n  // selection:: Selection\n  // The selection.\n\n  // storedMarks:: ?[Mark]\n  // A set of marks to apply to the next input. Will be null when\n  // no explicit marks have been set.\n\n  // :: Schema\n  // The schema of the state's document.\n  get schema() {\n    return this.config.schema\n  }\n\n  // :: [Plugin]\n  // The plugins that are active in this state.\n  get plugins() {\n    return this.config.plugins\n  }\n\n  // :: (Transaction) → EditorState\n  // Apply the given transaction to produce a new state.\n  apply(tr) {\n    return this.applyTransaction(tr).state\n  }\n\n  // : (Transaction) → bool\n  filterTransaction(tr, ignore = -1) {\n    for (let i = 0; i < this.config.plugins.length; i++) if (i != ignore) {\n      let plugin = this.config.plugins[i]\n      if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n        return false\n    }\n    return true\n  }\n\n  // :: (Transaction) → {state: EditorState, transactions: [Transaction]}\n  // Verbose variant of [`apply`](#state.EditorState.apply) that\n  // returns the precise transactions that were applied (which might\n  // be influenced by the [transaction\n  // hooks](#state.PluginSpec.filterTransaction) of\n  // plugins) along with the new state.\n  applyTransaction(rootTr) {\n    if (!this.filterTransaction(rootTr)) return {state: this, transactions: []}\n\n    let trs = [rootTr], newState = this.applyInner(rootTr), seen = null\n    // This loop repeatedly gives plugins a chance to respond to\n    // transactions as new transactions are added, making sure to only\n    // pass the transactions the plugin did not see before.\n    outer: for (;;) {\n      let haveNew = false\n      for (let i = 0; i < this.config.plugins.length; i++) {\n        let plugin = this.config.plugins[i]\n        if (plugin.spec.appendTransaction) {\n          let n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this\n          let tr = n < trs.length &&\n              plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState)\n          if (tr && newState.filterTransaction(tr, i)) {\n            tr.setMeta(\"appendedTransaction\", rootTr)\n            if (!seen) {\n              seen = []\n              for (let j = 0; j < this.config.plugins.length; j++)\n                seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0})\n            }\n            trs.push(tr)\n            newState = newState.applyInner(tr)\n            haveNew = true\n          }\n          if (seen) seen[i] = {state: newState, n: trs.length}\n        }\n      }\n      if (!haveNew) return {state: newState, transactions: trs}\n    }\n  }\n\n  // : (Transaction) → EditorState\n  applyInner(tr) {\n    if (!tr.before.eq(this.doc)) throw new RangeError(\"Applying a mismatched transaction\")\n    let newInstance = new EditorState(this.config), fields = this.config.fields\n    for (let i = 0; i < fields.length; i++) {\n      let field = fields[i]\n      newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance)\n    }\n    for (let i = 0; i < applyListeners.length; i++) applyListeners[i](this, tr, newInstance)\n    return newInstance\n  }\n\n  // :: Transaction\n  // Start a [transaction](#state.Transaction) from this state.\n  get tr() { return new Transaction(this) }\n\n  // :: (Object) → EditorState\n  // Create a new state.\n  //\n  //   config::- Configuration options. Must contain `schema` or `doc` (or both).\n  //\n  //      schema:: ?Schema\n  //      The schema to use (only relevant if no `doc` is specified).\n  //\n  //      doc:: ?Node\n  //      The starting document.\n  //\n  //      selection:: ?Selection\n  //      A valid selection in the document.\n  //\n  //      storedMarks:: ?[Mark]\n  //      The initial set of [stored marks](#state.EditorState.storedMarks).\n  //\n  //      plugins:: ?[Plugin]\n  //      The plugins that should be active in this state.\n  static create(config) {\n    let $config = new Configuration(config.doc ? config.doc.type.schema : config.schema, config.plugins)\n    let instance = new EditorState($config)\n    for (let i = 0; i < $config.fields.length; i++)\n      instance[$config.fields[i].name] = $config.fields[i].init(config, instance)\n    return instance\n  }\n\n  // :: (Object) → EditorState\n  // Create a new state based on this one, but with an adjusted set of\n  // active plugins. State fields that exist in both sets of plugins\n  // are kept unchanged. Those that no longer exist are dropped, and\n  // those that are new are initialized using their\n  // [`init`](#state.StateField.init) method, passing in the new\n  // configuration object..\n  //\n  //   config::- configuration options\n  //\n  //     plugins:: [Plugin]\n  //     New set of active plugins.\n  reconfigure(config) {\n    let $config = new Configuration(this.schema, config.plugins)\n    let fields = $config.fields, instance = new EditorState($config)\n    for (let i = 0; i < fields.length; i++) {\n      let name = fields[i].name\n      instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance)\n    }\n    return instance\n  }\n\n  // :: (?union<Object<Plugin>, string, number>) → Object\n  // Serialize this state to JSON. If you want to serialize the state\n  // of plugins, pass an object mapping property names to use in the\n  // resulting JSON object to plugin objects. The argument may also be\n  // a string or number, in which case it is ignored, to support the\n  // way `JSON.stringify` calls `toString` methods.\n  toJSON(pluginFields) {\n    let result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()}\n    if (this.storedMarks) result.storedMarks = this.storedMarks.map(m => m.toJSON())\n    if (pluginFields && typeof pluginFields == 'object') for (let prop in pluginFields) {\n      if (prop == \"doc\" || prop == \"selection\")\n        throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\")\n      let plugin = pluginFields[prop], state = plugin.spec.state\n      if (state && state.toJSON) result[prop] = state.toJSON.call(plugin, this[plugin.key])\n    }\n    return result\n  }\n\n  // :: (Object, Object, ?Object<Plugin>) → EditorState\n  // Deserialize a JSON representation of a state. `config` should\n  // have at least a `schema` field, and should contain array of\n  // plugins to initialize the state with. `pluginFields` can be used\n  // to deserialize the state of plugins, by associating plugin\n  // instances with the property names they use in the JSON object.\n  //\n  //   config::- configuration options\n  //\n  //     schema:: Schema\n  //     The schema to use.\n  //\n  //     plugins:: ?[Plugin]\n  //     The set of active plugins.\n  static fromJSON(config, json, pluginFields) {\n    if (!json) throw new RangeError(\"Invalid input for EditorState.fromJSON\")\n    if (!config.schema) throw new RangeError(\"Required config field 'schema' missing\")\n    let $config = new Configuration(config.schema, config.plugins)\n    let instance = new EditorState($config)\n    $config.fields.forEach(field => {\n      if (field.name == \"doc\") {\n        instance.doc = Node.fromJSON(config.schema, json.doc)\n      } else if (field.name == \"selection\") {\n        instance.selection = Selection.fromJSON(instance.doc, json.selection)\n      } else if (field.name == \"storedMarks\") {\n        if (json.storedMarks) instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON)\n      } else {\n        if (pluginFields) for (let prop in pluginFields) {\n          let plugin = pluginFields[prop], state = plugin.spec.state\n          if (plugin.key == field.name && state && state.fromJSON &&\n              Object.prototype.hasOwnProperty.call(json, prop)) {\n            // This field belongs to a plugin mapped to a JSON field, read it from there.\n            instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance)\n            return\n          }\n        }\n        instance[field.name] = field.init(config, instance)\n      }\n    })\n    return instance\n  }\n\n  // Kludge to allow the view to track mappings between different\n  // instances of a state.\n  //\n  // FIXME this is no longer needed as of prosemirror-view 1.9.0,\n  // though due to backwards-compat we should probably keep it around\n  // for a while (if only as a no-op)\n  static addApplyListener(f) {\n    applyListeners.push(f)\n  }\n  static removeApplyListener(f) {\n    let found = applyListeners.indexOf(f)\n    if (found > -1) applyListeners.splice(found, 1)\n  }\n}\n\nconst applyListeners = []\n","// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView) → Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState) → bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState) → ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactions—but only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (let prop in obj) {\n    let val = obj[prop]\n    if (val instanceof Function) val = val.bind(self)\n    else if (prop == \"handleDOMEvents\") val = bindProps(val, self, {})\n    target[prop] = val\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nexport class Plugin {\n  // :: (PluginSpec)\n  // Create a plugin.\n  constructor(spec) {\n    // :: EditorProps\n    // The [props](#view.EditorProps) exported by this plugin.\n    this.props = {}\n    if (spec.props) bindProps(spec.props, this, this.props)\n    // :: Object\n    // The plugin's [spec object](#state.PluginSpec).\n    this.spec = spec\n    this.key = spec.key ? spec.key.key : createKey(\"plugin\")\n  }\n\n  // :: (EditorState) → any\n  // Extract the plugin's state field from an editor state.\n  getState(state) { return state[this.key] }\n}\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState) → T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState) → T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T) → *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState) → T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nconst keys = Object.create(null)\n\nfunction createKey(name) {\n  if (name in keys) return name + \"$\" + ++keys[name]\n  keys[name] = 0\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nexport class PluginKey {\n  // :: (?string)\n  // Create a plugin key.\n  constructor(name = \"key\") { this.key = createKey(name) }\n\n  // :: (EditorState) → ?Plugin\n  // Get the active plugin with this key, if any, from an editor\n  // state.\n  get(state) { return state.config.pluginsByKey[this.key] }\n\n  // :: (EditorState) → ?any\n  // Get the plugin's state from an editor state.\n  getState(state) { return state[this.key] }\n}\n","import {joinPoint, canJoin, findWrapping, liftTarget, canSplit, ReplaceAroundStep, replaceStep} from \"prosemirror-transform\"\nimport {Slice, Fragment} from \"prosemirror-model\"\nimport {Selection, TextSelection, NodeSelection, AllSelection} from \"prosemirror-state\"\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Delete the selection, if there is one.\nexport function deleteSelection(state, dispatch) {\n  if (state.selection.empty) return false\n  if (dispatch) dispatch(state.tr.deleteSelection().scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and at the start of a textblock, try to\n// reduce the distance between that block and the one before it—if\n// there's a block directly before it that can be joined, join them.\n// If not, try to move the selected block closer to the next one in\n// the document structure by lifting it out of its parent or moving it\n// into a parent of the previous block. Will use the view for accurate\n// (bidi-aware) start-of-textblock detection if given.\nexport function joinBackward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"backward\", state)\n                        : $cursor.parentOffset > 0))\n    return false\n\n  let $cut = findCutBefore($cursor)\n\n  // If there is no node before this, try to lift\n  if (!$cut) {\n    let range = $cursor.blockRange(), target = range && liftTarget(range)\n    if (target == null) return false\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  let before = $cut.nodeBefore\n  // Apply the joining algorithm\n  if (!before.type.spec.isolating && deleteBarrier(state, $cut, dispatch))\n    return true\n\n  // If the node below has no content and the node above is\n  // selectable, delete the node below and select the one above.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(before, \"end\") || NodeSelection.isSelectable(before))) {\n    let delStep = replaceStep(state.doc, $cursor.before(), $cursor.after(), Slice.empty)\n    if (delStep.slice.size < delStep.to - delStep.from) {\n      if (dispatch) {\n        let tr = state.tr.step(delStep)\n        tr.setSelection(textblockAt(before, \"end\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos, -1)), -1)\n                        : NodeSelection.create(tr.doc, $cut.pos - before.nodeSize))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n  }\n\n  // If the node before is an atom, delete it\n  if (before.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos - before.nodeSize, $cut.pos).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\nfunction textblockAt(node, side, only) {\n  for (; node; node = (side == \"start\" ? node.firstChild : node.lastChild)) {\n    if (node.isTextblock) return true\n    if (only && node.childCount != 1) return false\n  }\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the start of a textblock, select\n// the node before that textblock, if possible. This is intended to be\n// bound to keys like backspace, after\n// [`joinBackward`](#commands.joinBackward) or other deleting\n// commands, as a fall-back behavior when the schema doesn't allow\n// deletion at the selected point.\nexport function selectNodeBackward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"backward\", state) : $head.parentOffset > 0) return false\n    $cut = findCutBefore($head)\n  }\n  let node = $cut && $cut.nodeBefore\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos - node.nodeSize)).scrollIntoView())\n  return true\n}\n\nfunction findCutBefore($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    if ($pos.index(i) > 0) return $pos.doc.resolve($pos.before(i + 1))\n    if ($pos.node(i).type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and the cursor is at the end of a\n// textblock, try to reduce or remove the boundary between that block\n// and the one after it, either by joining them or by moving the other\n// block closer to this one in the tree structure. Will use the view\n// for accurate start-of-textblock detection if given.\nexport function joinForward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"forward\", state)\n                        : $cursor.parentOffset < $cursor.parent.content.size))\n    return false\n\n  let $cut = findCutAfter($cursor)\n\n  // If there is no node after this, there's nothing to do\n  if (!$cut) return false\n\n  let after = $cut.nodeAfter\n  // Try the joining algorithm\n  if (deleteBarrier(state, $cut, dispatch)) return true\n\n  // If the node above has no content and the node below is\n  // selectable, delete the node above and select the one below.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(after, \"start\") || NodeSelection.isSelectable(after))) {\n    let delStep = replaceStep(state.doc, $cursor.before(), $cursor.after(), Slice.empty)\n    if (delStep.slice.size < delStep.to - delStep.from) {\n      if (dispatch) {\n        let tr = state.tr.step(delStep)\n        tr.setSelection(textblockAt(after, \"start\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)), 1)\n                        : NodeSelection.create(tr.doc, tr.mapping.map($cut.pos)))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n  }\n\n  // If the next node is an atom, delete it\n  if (after.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos, $cut.pos + after.nodeSize).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the end of a textblock, select\n// the node coming after that textblock, if possible. This is intended\n// to be bound to keys like delete, after\n// [`joinForward`](#commands.joinForward) and similar deleting\n// commands, to provide a fall-back behavior when the schema doesn't\n// allow deletion at the selected point.\nexport function selectNodeForward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"forward\", state) : $head.parentOffset < $head.parent.content.size)\n      return false\n    $cut = findCutAfter($head)\n  }\n  let node = $cut && $cut.nodeAfter\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos)).scrollIntoView())\n  return true\n}\n\nfunction findCutAfter($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    let parent = $pos.node(i)\n    if ($pos.index(i) + 1 < parent.childCount) return $pos.doc.resolve($pos.after(i + 1))\n    if (parent.type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block or, if there is a text selection, the\n// closest ancestor block of the selection that can be joined, with\n// the sibling above it.\nexport function joinUp(state, dispatch) {\n  let sel = state.selection, nodeSel = sel instanceof NodeSelection, point\n  if (nodeSel) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.from)) return false\n    point = sel.from\n  } else {\n    point = joinPoint(state.doc, sel.from, -1)\n    if (point == null) return false\n  }\n  if (dispatch) {\n    let tr = state.tr.join(point)\n    if (nodeSel) tr.setSelection(NodeSelection.create(tr.doc, point - state.doc.resolve(point).nodeBefore.nodeSize))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block, or the closest ancestor of the selection\n// that can be joined, with the sibling after it.\nexport function joinDown(state, dispatch) {\n  let sel = state.selection, point\n  if (sel instanceof NodeSelection) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.to)) return false\n    point = sel.to\n  } else {\n    point = joinPoint(state.doc, sel.to, 1)\n    if (point == null) return false\n  }\n  if (dispatch)\n    dispatch(state.tr.join(point).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Lift the selected block, or the closest ancestor block of the\n// selection that can be lifted, out of its parent node.\nexport function lift(state, dispatch) {\n  let {$from, $to} = state.selection\n  let range = $from.blockRange($to), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the selection is in a node whose type has a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, replace the\n// selection with a newline character.\nexport function newlineInCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  if (dispatch) dispatch(state.tr.insertText(\"\\n\").scrollIntoView())\n  return true\n}\n\nfunction defaultBlockAt(match) {\n  for (let i = 0; i < match.edgeCount; i++) {\n    let {type} = match.edge(i)\n    if (type.isTextblock && !type.hasRequiredAttrs()) return type\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// When the selection is in a node with a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, create a\n// default block after the code block, and move the cursor there.\nexport function exitCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  let above = $head.node(-1), after = $head.indexAfter(-1), type = defaultBlockAt(above.contentMatchAt(after))\n  if (!above.canReplaceWith(after, after, type)) return false\n  if (dispatch) {\n    let pos = $head.after(), tr = state.tr.replaceWith(pos, pos, type.createAndFill())\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If a block node is selected, create an empty paragraph before (if\n// it is its parent's first child) or after it.\nexport function createParagraphNear(state, dispatch) {\n  let sel = state.selection, {$from, $to} = sel\n  if (sel instanceof AllSelection || $from.parent.inlineContent || $to.parent.inlineContent) return false\n  let type = defaultBlockAt($to.parent.contentMatchAt($to.indexAfter()))\n  if (!type || !type.isTextblock) return false\n  if (dispatch) {\n    let side = (!$from.parentOffset && $to.index() < $to.parent.childCount ? $from : $to).pos\n    let tr = state.tr.insert(side, type.createAndFill())\n    tr.setSelection(TextSelection.create(tr.doc, side + 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the cursor is in an empty textblock that can be lifted, lift the\n// block.\nexport function liftEmptyBlock(state, dispatch) {\n  let {$cursor} = state.selection\n  if (!$cursor || $cursor.parent.content.size) return false\n  if ($cursor.depth > 1 && $cursor.after() != $cursor.end(-1)) {\n    let before = $cursor.before()\n    if (canSplit(state.doc, before)) {\n      if (dispatch) dispatch(state.tr.split(before).scrollIntoView())\n      return true\n    }\n  }\n  let range = $cursor.blockRange(), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Split the parent block of the selection. If the selection is a text\n// selection, also delete its content.\nexport function splitBlock(state, dispatch) {\n  let {$from, $to} = state.selection\n  if (state.selection instanceof NodeSelection && state.selection.node.isBlock) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) return false\n    if (dispatch) dispatch(state.tr.split($from.pos).scrollIntoView())\n    return true\n  }\n\n  if (!$from.parent.isBlock) return false\n\n  if (dispatch) {\n    let atEnd = $to.parentOffset == $to.parent.content.size\n    let tr = state.tr\n    if (state.selection instanceof TextSelection || state.selection instanceof AllSelection) tr.deleteSelection()\n    let deflt = $from.depth == 0 ? null : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)))\n    let types = atEnd && deflt ? [{type: deflt}] : null\n    let can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types)\n    if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{type: deflt}])) {\n      types = [{type: deflt}]\n      can = true\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types)\n      if (!atEnd && !$from.parentOffset && $from.parent.type != deflt) {\n        let first = tr.mapping.map($from.before()), $first = tr.doc.resolve(first)\n        if ($from.node(-1).canReplaceWith($first.index(), $first.index() + 1, deflt))\n          tr.setNodeMarkup(tr.mapping.map($from.before()), deflt)\n      }\n    }\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Acts like [`splitBlock`](#commands.splitBlock), but without\n// resetting the set of active marks at the cursor.\nexport function splitBlockKeepMarks(state, dispatch) {\n  return splitBlock(state, dispatch && (tr => {\n    let marks = state.storedMarks || (state.selection.$to.parentOffset && state.selection.$from.marks())\n    if (marks) tr.ensureMarks(marks)\n    dispatch(tr)\n  }))\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Move the selection to the node wrapping the current selection, if\n// any. (Will not select the document node.)\nexport function selectParentNode(state, dispatch) {\n  let {$from, to} = state.selection, pos\n  let same = $from.sharedDepth(to)\n  if (same == 0) return false\n  pos = $from.before(same)\n  if (dispatch) dispatch(state.tr.setSelection(NodeSelection.create(state.doc, pos)))\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Select the whole document.\nexport function selectAll(state, dispatch) {\n  if (dispatch) dispatch(state.tr.setSelection(new AllSelection(state.doc)))\n  return true\n}\n\nfunction joinMaybeClear(state, $pos, dispatch) {\n  let before = $pos.nodeBefore, after = $pos.nodeAfter, index = $pos.index()\n  if (!before || !after || !before.type.compatibleContent(after.type)) return false\n  if (!before.content.size && $pos.parent.canReplace(index - 1, index)) {\n    if (dispatch) dispatch(state.tr.delete($pos.pos - before.nodeSize, $pos.pos).scrollIntoView())\n    return true\n  }\n  if (!$pos.parent.canReplace(index, index + 1) || !(after.isTextblock || canJoin(state.doc, $pos.pos)))\n    return false\n  if (dispatch)\n    dispatch(state.tr\n             .clearIncompatible($pos.pos, before.type, before.contentMatchAt(before.childCount))\n             .join($pos.pos)\n             .scrollIntoView())\n  return true\n}\n\nfunction deleteBarrier(state, $cut, dispatch) {\n  let before = $cut.nodeBefore, after = $cut.nodeAfter, conn, match\n  if (before.type.spec.isolating || after.type.spec.isolating) return false\n  if (joinMaybeClear(state, $cut, dispatch)) return true\n\n  let canDelAfter = $cut.parent.canReplace($cut.index(), $cut.index() + 1)\n  if (canDelAfter &&\n      (conn = (match = before.contentMatchAt(before.childCount)).findWrapping(after.type)) &&\n      match.matchType(conn[0] || after.type).validEnd) {\n    if (dispatch) {\n      let end = $cut.pos + after.nodeSize, wrap = Fragment.empty\n      for (let i = conn.length - 1; i >= 0; i--)\n        wrap = Fragment.from(conn[i].create(null, wrap))\n      wrap = Fragment.from(before.copy(wrap))\n      let tr = state.tr.step(new ReplaceAroundStep($cut.pos - 1, end, $cut.pos, end, new Slice(wrap, 1, 0), conn.length, true))\n      let joinAt = end + 2 * conn.length\n      if (canJoin(tr.doc, joinAt)) tr.join(joinAt)\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  let selAfter = Selection.findFrom($cut, 1)\n  let range = selAfter && selAfter.$from.blockRange(selAfter.$to), target = range && liftTarget(range)\n  if (target != null && target >= $cut.depth) {\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  if (canDelAfter && textblockAt(after, \"start\", true) && textblockAt(before, \"end\")) {\n    let at = before, wrap = []\n    for (;;) {\n      wrap.push(at)\n      if (at.isTextblock) break\n      at = at.lastChild\n    }\n    let afterText = after, afterDepth = 1\n    for (; !afterText.isTextblock; afterText = afterText.firstChild) afterDepth++\n    if (at.canReplace(at.childCount, at.childCount, afterText.content)) {\n      if (dispatch) {\n        let end = Fragment.empty\n        for (let i = wrap.length - 1; i >= 0; i--) end = Fragment.from(wrap[i].copy(end))\n        let tr = state.tr.step(new ReplaceAroundStep($cut.pos - wrap.length, $cut.pos + after.nodeSize,\n                                                     $cut.pos + afterDepth, $cut.pos + after.nodeSize - afterDepth,\n                                                     new Slice(end, wrap.length, 0), 0, true))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n  }\n\n  return false\n}\n\nfunction selectTextblockSide(side) {\n  return function(state, dispatch) {\n    let sel = state.selection, $pos = side < 0 ? sel.$from : sel.$to\n    let depth = $pos.depth\n    while ($pos.node(depth).isInline) {\n      if (!depth) return false\n      depth--\n    }\n    if (!$pos.node(depth).isTextblock) return false\n    if (dispatch)\n      dispatch(state.tr.setSelection(TextSelection.create(\n        state.doc, side < 0 ? $pos.start(depth) : $pos.end(depth))))\n    return true\n  }\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Moves the cursor to the start of current text block.\nexport const selectTextblockStart = selectTextblockSide(-1)\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Moves the cursor to the end of current text block.\nexport const selectTextblockEnd = selectTextblockSide(1)\n\n// Parameterized commands\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Wrap the selection in a node of the given type with the given\n// attributes.\nexport function wrapIn(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return false\n    if (dispatch) dispatch(state.tr.wrap(range, wrapping).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command that tries to set the selected textblocks to the\n// given node type with the given attributes.\nexport function setBlockType(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {from, to} = state.selection\n    let applicable = false\n    state.doc.nodesBetween(from, to, (node, pos) => {\n      if (applicable) return false\n      if (!node.isTextblock || node.hasMarkup(nodeType, attrs)) return\n      if (node.type == nodeType) {\n        applicable = true\n      } else {\n        let $pos = state.doc.resolve(pos), index = $pos.index()\n        applicable = $pos.parent.canReplaceWith(index, index + 1, nodeType)\n      }\n    })\n    if (!applicable) return false\n    if (dispatch) dispatch(state.tr.setBlockType(from, to, nodeType, attrs).scrollIntoView())\n    return true\n  }\n}\n\nfunction markApplies(doc, ranges, type) {\n  for (let i = 0; i < ranges.length; i++) {\n    let {$from, $to} = ranges[i]\n    let can = $from.depth == 0 ? doc.type.allowsMarkType(type) : false\n    doc.nodesBetween($from.pos, $to.pos, node => {\n      if (can) return false\n      can = node.inlineContent && node.type.allowsMarkType(type)\n    })\n    if (can) return true\n  }\n  return false\n}\n\n// :: (MarkType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command function that toggles the given mark with the\n// given attributes. Will return `false` when the current selection\n// doesn't support that mark. This will remove the mark if any marks\n// of that type exist in the selection, or add it otherwise. If the\n// selection is empty, this applies to the [stored\n// marks](#state.EditorState.storedMarks) instead of a range of the\n// document.\nexport function toggleMark(markType, attrs) {\n  return function(state, dispatch) {\n    let {empty, $cursor, ranges} = state.selection\n    if ((empty && !$cursor) || !markApplies(state.doc, ranges, markType)) return false\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks()))\n          dispatch(state.tr.removeStoredMark(markType))\n        else\n          dispatch(state.tr.addStoredMark(markType.create(attrs)))\n      } else {\n        let has = false, tr = state.tr\n        for (let i = 0; !has && i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType)\n        }\n        for (let i = 0; i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          if (has) {\n            tr.removeMark($from.pos, $to.pos, markType)\n          } else {\n            let from = $from.pos, to = $to.pos, start = $from.nodeAfter, end = $to.nodeBefore\n            let spaceStart = start && start.isText ? /^\\s*/.exec(start.text)[0].length : 0\n            let spaceEnd = end && end.isText ? /\\s*$/.exec(end.text)[0].length : 0\n            if (from + spaceStart < to) { from += spaceStart; to -= spaceEnd }\n            tr.addMark(from, to, markType.create(attrs))\n          }\n        }\n        dispatch(tr.scrollIntoView())\n      }\n    }\n    return true\n  }\n}\n\nfunction wrapDispatchForJoin(dispatch, isJoinable) {\n  return tr => {\n    if (!tr.isGeneric) return dispatch(tr)\n\n    let ranges = []\n    for (let i = 0; i < tr.mapping.maps.length; i++) {\n      let map = tr.mapping.maps[i]\n      for (let j = 0; j < ranges.length; j++)\n        ranges[j] = map.map(ranges[j])\n      map.forEach((_s, _e, from, to) => ranges.push(from, to))\n    }\n\n    // Figure out which joinable points exist inside those ranges,\n    // by checking all node boundaries in their parent nodes.\n    let joinable = []\n    for (let i = 0; i < ranges.length; i += 2) {\n      let from = ranges[i], to = ranges[i + 1]\n      let $from = tr.doc.resolve(from), depth = $from.sharedDepth(to), parent = $from.node(depth)\n      for (let index = $from.indexAfter(depth), pos = $from.after(depth + 1); pos <= to; ++index) {\n        let after = parent.maybeChild(index)\n        if (!after) break\n        if (index && joinable.indexOf(pos) == -1) {\n          let before = parent.child(index - 1)\n          if (before.type == after.type && isJoinable(before, after))\n            joinable.push(pos)\n        }\n        pos += after.nodeSize\n      }\n    }\n    // Join the joinable points\n    joinable.sort((a, b) => a - b)\n    for (let i = joinable.length - 1; i >= 0; i--) {\n      if (canJoin(tr.doc, joinable[i])) tr.join(joinable[i])\n    }\n    dispatch(tr)\n  }\n}\n\n// :: ((state: EditorState, ?(tr: Transaction)) → bool, union<(before: Node, after: Node) → bool, [string]>) → (state: EditorState, ?(tr: Transaction)) → bool\n// Wrap a command so that, when it produces a transform that causes\n// two joinable nodes to end up next to each other, those are joined.\n// Nodes are considered joinable when they are of the same type and\n// when the `isJoinable` predicate returns true for them or, if an\n// array of strings was passed, if their node type name is in that\n// array.\nexport function autoJoin(command, isJoinable) {\n  if (Array.isArray(isJoinable)) {\n    let types = isJoinable\n    isJoinable = node => types.indexOf(node.type.name) > -1\n  }\n  return (state, dispatch, view) => command(state, dispatch && wrapDispatchForJoin(dispatch, isJoinable), view)\n}\n\n// :: (...[(EditorState, ?(tr: Transaction), ?EditorView) → bool]) → (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// Combine a number of command functions into a single function (which\n// calls them one by one until one returns true).\nexport function chainCommands(...commands) {\n  return function(state, dispatch, view) {\n    for (let i = 0; i < commands.length; i++)\n      if (commands[i](state, dispatch, view)) return true\n    return false\n  }\n}\n\nlet backspace = chainCommands(deleteSelection, joinBackward, selectNodeBackward)\nlet del = chainCommands(deleteSelection, joinForward, selectNodeForward)\n\n// :: Object\n// A basic keymap containing bindings not specific to any schema.\n// Binds the following keys (when multiple commands are listed, they\n// are chained with [`chainCommands`](#commands.chainCommands)):\n//\n// * **Enter** to `newlineInCode`, `createParagraphNear`, `liftEmptyBlock`, `splitBlock`\n// * **Mod-Enter** to `exitCode`\n// * **Backspace** and **Mod-Backspace** to `deleteSelection`, `joinBackward`, `selectNodeBackward`\n// * **Delete** and **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-a** to `selectAll`\nexport let pcBaseKeymap = {\n  \"Enter\": chainCommands(newlineInCode, createParagraphNear, liftEmptyBlock, splitBlock),\n  \"Mod-Enter\": exitCode,\n  \"Backspace\": backspace,\n  \"Mod-Backspace\": backspace,\n  \"Shift-Backspace\": backspace,\n  \"Delete\": del,\n  \"Mod-Delete\": del,\n  \"Mod-a\": selectAll\n}\n\n// :: Object\n// A copy of `pcBaseKeymap` that also binds **Ctrl-h** like Backspace,\n// **Ctrl-d** like Delete, **Alt-Backspace** like Ctrl-Backspace, and\n// **Ctrl-Alt-Backspace**, **Alt-Delete**, and **Alt-d** like\n// Ctrl-Delete.\nexport let macBaseKeymap = {\n  \"Ctrl-h\": pcBaseKeymap[\"Backspace\"],\n  \"Alt-Backspace\": pcBaseKeymap[\"Mod-Backspace\"],\n  \"Ctrl-d\": pcBaseKeymap[\"Delete\"],\n  \"Ctrl-Alt-Backspace\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-Delete\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-d\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Ctrl-a\": selectTextblockStart,\n  \"Ctrl-e\": selectTextblockEnd\n}\nfor (let key in pcBaseKeymap) macBaseKeymap[key] = pcBaseKeymap[key]\n\npcBaseKeymap.Home = selectTextblockStart\npcBaseKeymap.End = selectTextblockEnd\n\n// declare global: os, navigator\nconst mac = typeof navigator != \"undefined\" ? /Mac|iP(hone|[oa]d)/.test(navigator.platform)\n          : typeof os != \"undefined\" ? os.platform() == \"darwin\" : false\n\n// :: Object\n// Depending on the detected platform, this will hold\n// [`pcBasekeymap`](#commands.pcBaseKeymap) or\n// [`macBaseKeymap`](#commands.macBaseKeymap).\nexport let baseKeymap = mac ? macBaseKeymap : pcBaseKeymap\n","\n    /*!\n    * tiptap-commands v1.17.0\n    * (c) 2021 überdosis GbR (limited liability)\n    * @license MIT\n    */\n  \nimport { setBlockType, lift, wrapIn } from 'prosemirror-commands';\nexport { autoJoin, baseKeymap, chainCommands, createParagraphNear, deleteSelection, exitCode, joinBackward, joinDown, joinForward, joinUp, lift, liftEmptyBlock, macBaseKeymap, newlineInCode, pcBaseKeymap, selectAll, selectNodeBackward, selectNodeForward, selectParentNode, setBlockType, splitBlock, splitBlockKeepMarks, toggleMark, wrapIn } from 'prosemirror-commands';\nimport { liftListItem, wrapInList } from 'prosemirror-schema-list';\nexport { addListNodes, liftListItem, sinkListItem, splitListItem, wrapInList } from 'prosemirror-schema-list';\nimport { InputRule } from 'prosemirror-inputrules';\nexport { textblockTypeInputRule, wrappingInputRule } from 'prosemirror-inputrules';\nimport { Plugin } from 'prosemirror-state';\nimport { Slice, Fragment } from 'prosemirror-model';\nimport { getMarkRange, nodeIsActive, findParentNode } from 'tiptap-utils';\n\nfunction insertText (text = '') {\n  return (state, dispatch) => {\n    const {\n      $from\n    } = state.selection;\n    const {\n      pos\n    } = $from.pos;\n    dispatch(state.tr.insertText(text, pos));\n    return true;\n  };\n}\n\nfunction getMarksBetween(start, end, state) {\n  let marks = [];\n  state.doc.nodesBetween(start, end, (node, pos) => {\n    marks = [...marks, ...node.marks.map(mark => ({\n      start: pos,\n      end: pos + node.nodeSize,\n      mark\n    }))];\n  });\n  return marks;\n}\n\nfunction markInputRule (regexp, markType, getAttrs) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    const attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    const {\n      tr\n    } = state;\n    const m = match.length - 1;\n    let markEnd = end;\n    let markStart = start;\n\n    if (match[m]) {\n      const matchStart = start + match[0].indexOf(match[m - 1]);\n      const matchEnd = matchStart + match[m - 1].length - 1;\n      const textStart = matchStart + match[m - 1].lastIndexOf(match[m]);\n      const textEnd = textStart + match[m].length;\n      const excludedMarks = getMarksBetween(start, end, state).filter(item => {\n        const {\n          excluded\n        } = item.mark.type;\n        return excluded.find(type => type.name === markType.name);\n      }).filter(item => item.end > matchStart);\n\n      if (excludedMarks.length) {\n        return false;\n      }\n\n      if (textEnd < matchEnd) {\n        tr.delete(textEnd, matchEnd);\n      }\n\n      if (textStart > matchStart) {\n        tr.delete(matchStart, textStart);\n      }\n\n      markStart = matchStart;\n      markEnd = markStart + match[m].length;\n    }\n\n    tr.addMark(markStart, markEnd, markType.create(attrs));\n    tr.removeStoredMark(markType);\n    return tr;\n  });\n}\n\nfunction nodeInputRule (regexp, type, getAttrs) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    const attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    const {\n      tr\n    } = state;\n\n    if (match[0]) {\n      tr.replaceWith(start - 1, end, type.create(attrs));\n    }\n\n    return tr;\n  });\n}\n\nfunction pasteRule (regexp, type, getAttrs) {\n  const handler = fragment => {\n    const nodes = [];\n    fragment.forEach(child => {\n      if (child.isText) {\n        const {\n          text\n        } = child;\n        let pos = 0;\n        let match;\n\n        do {\n          match = regexp.exec(text);\n\n          if (match) {\n            const start = match.index;\n            const end = start + match[0].length;\n            const attrs = getAttrs instanceof Function ? getAttrs(match[0]) : getAttrs;\n\n            if (start > 0) {\n              nodes.push(child.cut(pos, start));\n            }\n\n            nodes.push(child.cut(start, end).mark(type.create(attrs).addToSet(child.marks)));\n            pos = end;\n          }\n        } while (match);\n\n        if (pos < text.length) {\n          nodes.push(child.cut(pos));\n        }\n      } else {\n        nodes.push(child.copy(handler(child.content)));\n      }\n    });\n    return Fragment.fromArray(nodes);\n  };\n\n  return new Plugin({\n    props: {\n      transformPasted: slice => new Slice(handler(slice.content), slice.openStart, slice.openEnd)\n    }\n  });\n}\n\nfunction markPasteRule (regexp, type, getAttrs) {\n  const handler = (fragment, parent) => {\n    const nodes = [];\n    fragment.forEach(child => {\n      if (child.isText) {\n        const {\n          text,\n          marks\n        } = child;\n        let pos = 0;\n        let match;\n        const isLink = !!marks.filter(x => x.type.name === 'link')[0]; // eslint-disable-next-line\n\n        while (!isLink && (match = regexp.exec(text)) !== null) {\n          if (parent && parent.type.allowsMarkType(type) && match[1]) {\n            const start = match.index;\n            const end = start + match[0].length;\n            const textStart = start + match[0].indexOf(match[1]);\n            const textEnd = textStart + match[1].length;\n            const attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs; // adding text before markdown to nodes\n\n            if (start > 0) {\n              nodes.push(child.cut(pos, start));\n            } // adding the markdown part to nodes\n\n\n            nodes.push(child.cut(textStart, textEnd).mark(type.create(attrs).addToSet(child.marks)));\n            pos = end;\n          }\n        } // adding rest of text to nodes\n\n\n        if (pos < text.length) {\n          nodes.push(child.cut(pos));\n        }\n      } else {\n        nodes.push(child.copy(handler(child.content, child)));\n      }\n    });\n    return Fragment.fromArray(nodes);\n  };\n\n  return new Plugin({\n    props: {\n      transformPasted: slice => new Slice(handler(slice.content), slice.openStart, slice.openEnd)\n    }\n  });\n}\n\nfunction removeMark (type) {\n  return (state, dispatch) => {\n    const {\n      tr,\n      selection\n    } = state;\n    let {\n      from,\n      to\n    } = selection;\n    const {\n      $from,\n      empty\n    } = selection;\n\n    if (empty) {\n      const range = getMarkRange($from, type);\n      from = range.from;\n      to = range.to;\n    }\n\n    tr.removeMark(from, to, type);\n    return dispatch(tr);\n  };\n}\n\nfunction replaceText (range = null, type, attrs = {}, fragment = Fragment.empty) {\n  return (state, dispatch) => {\n    const {\n      $from,\n      $to\n    } = state.selection;\n    const index = $from.index();\n    const from = range ? range.from : $from.pos;\n    const to = range ? range.to : $to.pos;\n\n    if (!$from.parent.canReplaceWith(index, index, type)) {\n      return false;\n    }\n\n    if (dispatch) {\n      dispatch(state.tr.replaceWith(from, to, type.create(attrs, fragment)));\n    }\n\n    return true;\n  };\n}\n\nfunction setInlineBlockType (type, attrs = {}) {\n  return (state, dispatch) => {\n    const {\n      $from\n    } = state.selection;\n    const index = $from.index();\n\n    if (!$from.parent.canReplaceWith(index, index, type)) {\n      return false;\n    }\n\n    if (dispatch) {\n      dispatch(state.tr.replaceSelectionWith(type.create(attrs)));\n    }\n\n    return true;\n  };\n}\n\n// see https://github.com/ProseMirror/prosemirror-transform/blob/main/src/structure.js\n// Since this piece of code was \"borrowed\" from prosemirror, ESLint rules are ignored.\n\n/* eslint-disable max-len, no-plusplus, no-undef, eqeqeq */\n\nfunction canSplit(doc, pos, depth = 1, typesAfter) {\n  const $pos = doc.resolve(pos);\n  const base = $pos.depth - depth;\n  const innerType = typesAfter && typesAfter[typesAfter.length - 1] || $pos.parent;\n  if (base < 0 || $pos.parent.type.spec.isolating || !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) || !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount))) return false;\n\n  for (let d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    const node = $pos.node(d);\n    const index = $pos.index(d);\n    if (node.type.spec.isolating) return false;\n    let rest = node.content.cutByIndex(index, node.childCount);\n    const after = typesAfter && typesAfter[i] || node;\n    if (after != node) rest = rest.replaceChild(0, after.type.create(after.attrs));\n    /* Change starts from here */\n    // if (!node.canReplace(index + 1, node.childCount) || !after.type.validContent(rest))\n    //   return false\n\n    if (!node.canReplace(index + 1, node.childCount)) return false;\n    /* Change ends here */\n  }\n\n  const index = $pos.indexAfter(base);\n  const baseType = typesAfter && typesAfter[0];\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type);\n} // this is a copy of splitListItem\n// see https://github.com/ProseMirror/prosemirror-schema-list/blob/main/src/schema-list.js\n\n\nfunction splitToDefaultListItem(itemType) {\n  return function (state, dispatch) {\n    const {\n      $from,\n      $to,\n      node\n    } = state.selection;\n    if (node && node.isBlock || $from.depth < 2 || !$from.sameParent($to)) return false;\n    const grandParent = $from.node(-1);\n    if (grandParent.type != itemType) return false;\n\n    if ($from.parent.content.size == 0) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType || $from.index(-2) != $from.node(-2).childCount - 1) return false;\n\n      if (dispatch) {\n        let wrap = Fragment.empty;\n        const keepItem = $from.index(-1) > 0; // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n\n        for (let d = $from.depth - (keepItem ? 1 : 2); d >= $from.depth - 3; d--) wrap = Fragment.from($from.node(d).copy(wrap)); // Add a second list item with an empty default start node\n\n\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()));\n        const tr = state.tr.replace($from.before(keepItem ? null : -1), $from.after(-3), new Slice(wrap, keepItem ? 3 : 2, 2));\n        tr.setSelection(state.selection.constructor.near(tr.doc.resolve($from.pos + (keepItem ? 3 : 2))));\n        dispatch(tr.scrollIntoView());\n      }\n\n      return true;\n    }\n\n    const nextType = $to.pos == $from.end() ? grandParent.contentMatchAt($from.indexAfter(-1)).defaultType : null;\n    const tr = state.tr.delete($from.pos, $to.pos);\n    /* Change starts from here */\n    // let types = nextType && [null, {type: nextType}]\n\n    let types = nextType && [{\n      type: itemType\n    }, {\n      type: nextType\n    }];\n    if (!types) types = [{\n      type: itemType\n    }, null];\n    /* Change ends here */\n\n    if (!canSplit(tr.doc, $from.pos, 2, types)) return false;\n    if (dispatch) dispatch(tr.split($from.pos, 2, types).scrollIntoView());\n    return true;\n  };\n}\n/* eslint-enable max-len, no-plusplus, no-undef, eqeqeq */\n\nfunction toggleBlockType (type, toggletype, attrs = {}) {\n  return (state, dispatch, view) => {\n    const isActive = nodeIsActive(state, type, attrs);\n\n    if (isActive) {\n      return setBlockType(toggletype)(state, dispatch, view);\n    }\n\n    return setBlockType(type, attrs)(state, dispatch, view);\n  };\n}\n\nfunction isList(node, schema) {\n  return node.type === schema.nodes.bullet_list || node.type === schema.nodes.ordered_list || node.type === schema.nodes.todo_list;\n}\n\nfunction toggleList(listType, itemType) {\n  return (state, dispatch, view) => {\n    const {\n      schema,\n      selection\n    } = state;\n    const {\n      $from,\n      $to\n    } = selection;\n    const range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    const parentList = findParentNode(node => isList(node, schema))(selection);\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      if (parentList.node.type === listType) {\n        return liftListItem(itemType)(state, dispatch, view);\n      }\n\n      if (isList(parentList.node, schema) && listType.validContent(parentList.node.content)) {\n        const {\n          tr\n        } = state;\n        tr.setNodeMarkup(parentList.pos, listType);\n\n        if (dispatch) {\n          dispatch(tr);\n        }\n\n        return false;\n      }\n    }\n\n    return wrapInList(listType)(state, dispatch, view);\n  };\n}\n\nfunction toggleWrap (type, attrs = {}) {\n  return (state, dispatch, view) => {\n    const isActive = nodeIsActive(state, type, attrs);\n\n    if (isActive) {\n      return lift(state, dispatch);\n    }\n\n    return wrapIn(type, attrs)(state, dispatch, view);\n  };\n}\n\nfunction updateMark (type, attrs) {\n  return (state, dispatch) => {\n    const {\n      tr,\n      selection,\n      doc\n    } = state;\n    const {\n      ranges,\n      empty\n    } = selection;\n\n    if (empty) {\n      const {\n        from,\n        to\n      } = getMarkRange(selection.$from, type);\n\n      if (doc.rangeHasMark(from, to, type)) {\n        tr.removeMark(from, to, type);\n      }\n\n      tr.addMark(from, to, type.create(attrs));\n    } else {\n      ranges.forEach(ref$1 => {\n        const {\n          $to,\n          $from\n        } = ref$1;\n\n        if (doc.rangeHasMark($from.pos, $to.pos, type)) {\n          tr.removeMark($from.pos, $to.pos, type);\n        }\n\n        tr.addMark($from.pos, $to.pos, type.create(attrs));\n      });\n    }\n\n    return dispatch(tr);\n  };\n}\n\nexport { insertText, markInputRule, markPasteRule, nodeInputRule, pasteRule, removeMark, replaceText, setInlineBlockType, splitToDefaultListItem, toggleBlockType, toggleList, toggleWrap, updateMark };\n","// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number) → number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number) → MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nconst lower16 = 0xffff\nconst factor16 = Math.pow(2, 16)\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nexport class MapResult {\n  constructor(pos, deleted = false, recover = null) {\n    // :: number The mapped version of the position.\n    this.pos = pos\n    // :: bool Tells you whether the position was deleted, that is,\n    // whether the step removed its surroundings from the document.\n    this.deleted = deleted\n    this.recover = recover\n  }\n}\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nexport class StepMap {\n  // :: ([number])\n  // Create a position map. The modifications to the document are\n  // represented as an array of numbers, in which each group of three\n  // represents a modified chunk as `[start, oldSize, newSize]`.\n  constructor(ranges, inverted = false) {\n    if (!ranges.length && StepMap.empty) return StepMap.empty\n    this.ranges = ranges\n    this.inverted = inverted\n  }\n\n  recover(value) {\n    let diff = 0, index = recoverIndex(value)\n    if (!this.inverted) for (let i = 0; i < index; i++)\n      diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]\n    return this.ranges[index * 3] + diff + recoverOffset(value)\n  }\n\n  // : (number, ?number) → MapResult\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  // : (number, ?number) → number\n  map(pos, assoc = 1) { return this._map(pos, assoc, true) }\n\n  _map(pos, assoc, simple) {\n    let diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize\n      if (pos <= end) {\n        let side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc\n        let result = start + diff + (side < 0 ? 0 : newSize)\n        if (simple) return result\n        let recover = pos == (assoc < 0 ? start : end) ? null : makeRecover(i / 3, pos - start)\n        return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n      }\n      diff += newSize - oldSize\n    }\n    return simple ? pos + diff : new MapResult(pos + diff)\n  }\n\n  touches(pos, recover) {\n    let diff = 0, index = recoverIndex(recover)\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], end = start + oldSize\n      if (pos <= end && i == index * 3) return true\n      diff += this.ranges[i + newIndex] - oldSize\n    }\n    return false\n  }\n\n  // :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n  // Calls the given function on each of the changed ranges included in\n  // this map.\n  forEach(f) {\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0, diff = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff)\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex]\n      f(oldStart, oldStart + oldSize, newStart, newStart + newSize)\n      diff += newSize - oldSize\n    }\n  }\n\n  // :: () → StepMap\n  // Create an inverted version of this map. The result can be used to\n  // map positions in the post-step document to the pre-step document.\n  invert() {\n    return new StepMap(this.ranges, !this.inverted)\n  }\n\n  toString() {\n    return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n  }\n\n  // :: (n: number) → StepMap\n  // Create a map that moves all positions by offset `n` (which may be\n  // negative). This can be useful when applying steps meant for a\n  // sub-document to a larger document, or vice-versa.\n  static offset(n) {\n    return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n  }\n}\n\nStepMap.empty = new StepMap([])\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// ‘[rebasing](/docs/guide/#transform.rebasing)’ steps for\n// collaboration or history management.)\nexport class Mapping {\n  // :: (?[StepMap])\n  // Create a new mapping with the given position maps.\n  constructor(maps, mirror, from, to) {\n    // :: [StepMap]\n    // The step maps in this mapping.\n    this.maps = maps || []\n    // :: number\n    // The starting position in the `maps` array, used when `map` or\n    // `mapResult` is called.\n    this.from = from || 0\n    // :: number\n    // The end position in the `maps` array.\n    this.to = to == null ? this.maps.length : to\n    this.mirror = mirror\n  }\n\n  // :: (?number, ?number) → Mapping\n  // Create a mapping that maps only through a part of this one.\n  slice(from = 0, to = this.maps.length) {\n    return new Mapping(this.maps, this.mirror, from, to)\n  }\n\n  copy() {\n    return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n  }\n\n  // :: (StepMap, ?number)\n  // Add a step map to the end of this mapping. If `mirrors` is\n  // given, it should be the index of the step map that is the mirror\n  // image of this one.\n  appendMap(map, mirrors) {\n    this.to = this.maps.push(map)\n    if (mirrors != null) this.setMirror(this.maps.length - 1, mirrors)\n  }\n\n  // :: (Mapping)\n  // Add all the step maps in a given mapping to this one (preserving\n  // mirroring information).\n  appendMapping(mapping) {\n    for (let i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null)\n    }\n  }\n\n  // :: (number) → ?number\n  // Finds the offset of the step map that mirrors the map at the\n  // given offset, in this mapping (as per the second argument to\n  // `appendMap`).\n  getMirror(n) {\n    if (this.mirror) for (let i = 0; i < this.mirror.length; i++)\n      if (this.mirror[i] == n) return this.mirror[i + (i % 2 ? -1 : 1)]\n  }\n\n  setMirror(n, m) {\n    if (!this.mirror) this.mirror = []\n    this.mirror.push(n, m)\n  }\n\n  // :: (Mapping)\n  // Append the inverse of the given mapping to this one.\n  appendMappingInverted(mapping) {\n    for (let i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null)\n    }\n  }\n\n  // :: () → Mapping\n  // Create an inverted version of this mapping.\n  invert() {\n    let inverse = new Mapping\n    inverse.appendMappingInverted(this)\n    return inverse\n  }\n\n  // : (number, ?number) → number\n  // Map a position through this mapping.\n  map(pos, assoc = 1) {\n    if (this.mirror) return this._map(pos, assoc, true)\n    for (let i = this.from; i < this.to; i++)\n      pos = this.maps[i].map(pos, assoc)\n    return pos\n  }\n\n  // : (number, ?number) → MapResult\n  // Map a position through this mapping, returning a mapping\n  // result.\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  _map(pos, assoc, simple) {\n    let deleted = false\n\n    for (let i = this.from; i < this.to; i++) {\n      let map = this.maps[i], result = map.mapResult(pos, assoc)\n      if (result.recover != null) {\n        let corr = this.getMirror(i)\n        if (corr != null && corr > i && corr < this.to) {\n          i = corr\n          pos = this.maps[corr].recover(result.recover)\n          continue\n        }\n      }\n\n      if (result.deleted) deleted = true\n      pos = result.pos\n    }\n\n    return simple ? pos : new MapResult(pos, deleted)\n  }\n}\n","import {Mapping} from \"./map\"\n\nexport function TransformError(message) {\n  let err = Error.call(this, message)\n  err.__proto__ = TransformError.prototype\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype)\nTransformError.prototype.constructor = TransformError\nTransformError.prototype.name = \"TransformError\"\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nexport class Transform {\n  // :: (Node)\n  // Create a transform that starts with the given document.\n  constructor(doc) {\n    // :: Node\n    // The current document (the result of applying the steps in the\n    // transform).\n    this.doc = doc\n    // :: [Step]\n    // The steps in this transform.\n    this.steps = []\n    // :: [Node]\n    // The documents before each of the steps.\n    this.docs = []\n    // :: Mapping\n    // A mapping with the maps for each of the steps in this transform.\n    this.mapping = new Mapping\n  }\n\n  // :: Node The starting document.\n  get before() { return this.docs.length ? this.docs[0] : this.doc }\n\n  // :: (step: Step) → this\n  // Apply a new step in this transform, saving the result. Throws an\n  // error when the step fails.\n  step(object) {\n    let result = this.maybeStep(object)\n    if (result.failed) throw new TransformError(result.failed)\n    return this\n  }\n\n  // :: (Step) → StepResult\n  // Try to apply a step in this transformation, ignoring it if it\n  // fails. Returns the step result.\n  maybeStep(step) {\n    let result = step.apply(this.doc)\n    if (!result.failed) this.addStep(step, result.doc)\n    return result\n  }\n\n  // :: bool\n  // True when the document has been changed (when there are any\n  // steps).\n  get docChanged() {\n    return this.steps.length > 0\n  }\n\n  addStep(step, doc) {\n    this.docs.push(this.doc)\n    this.steps.push(step)\n    this.mapping.appendMap(step.getMap())\n    this.doc = doc\n  }\n}\n","import {ReplaceError} from \"prosemirror-model\"\n\nimport {StepMap} from \"./map\"\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nconst stepsByID = Object.create(null)\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nexport class Step {\n  // :: (doc: Node) → StepResult\n  // Applies this step to the given document, returning a result\n  // object that either indicates failure, if the step can not be\n  // applied to this document, or indicates success by containing a\n  // transformed document.\n  apply(_doc) { return mustOverride() }\n\n  // :: () → StepMap\n  // Get the step map that represents the changes made by this step,\n  // and which can be used to transform between positions in the old\n  // and the new document.\n  getMap() { return StepMap.empty }\n\n  // :: (doc: Node) → Step\n  // Create an inverted version of this step. Needs the document as it\n  // was before the step as argument.\n  invert(_doc) { return mustOverride() }\n\n  // :: (mapping: Mappable) → ?Step\n  // Map this step through a mappable thing, returning either a\n  // version of that step with its positions adjusted, or `null` if\n  // the step was entirely deleted by the mapping.\n  map(_mapping) { return mustOverride() }\n\n  // :: (other: Step) → ?Step\n  // Try to merge this step with another one, to be applied directly\n  // after it. Returns the merged step when possible, null if the\n  // steps can't be merged.\n  merge(_other) { return null }\n\n  // :: () → Object\n  // Create a JSON-serializeable representation of this step. When\n  // defining this for a custom subclass, make sure the result object\n  // includes the step type's [JSON id](#transform.Step^jsonID) under\n  // the `stepType` property.\n  toJSON() { return mustOverride() }\n\n  // :: (Schema, Object) → Step\n  // Deserialize a step from its JSON representation. Will call\n  // through to the step class' own implementation of this method.\n  static fromJSON(schema, json) {\n    if (!json || !json.stepType) throw new RangeError(\"Invalid input for Step.fromJSON\")\n    let type = stepsByID[json.stepType]\n    if (!type) throw new RangeError(`No step type ${json.stepType} defined`)\n    return type.fromJSON(schema, json)\n  }\n\n  // :: (string, constructor<Step>)\n  // To be able to serialize steps to JSON, each step needs a string\n  // ID to attach to its JSON representation. Use this method to\n  // register an ID for your step classes. Try to pick something\n  // that's unlikely to clash with steps from other modules.\n  static jsonID(id, stepClass) {\n    if (id in stepsByID) throw new RangeError(\"Duplicate use of step JSON ID \" + id)\n    stepsByID[id] = stepClass\n    stepClass.prototype.jsonID = id\n    return stepClass\n  }\n}\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nexport class StepResult {\n  // : (?Node, ?string)\n  constructor(doc, failed) {\n    // :: ?Node The transformed document.\n    this.doc = doc\n    // :: ?string Text providing information about a failed step.\n    this.failed = failed\n  }\n\n  // :: (Node) → StepResult\n  // Create a successful step result.\n  static ok(doc) { return new StepResult(doc, null) }\n\n  // :: (string) → StepResult\n  // Create a failed step result.\n  static fail(message) { return new StepResult(null, message) }\n\n  // :: (Node, number, number, Slice) → StepResult\n  // Call [`Node.replace`](#model.Node.replace) with the given\n  // arguments. Create a successful result if it succeeds, and a\n  // failed one if it throws a `ReplaceError`.\n  static fromReplace(doc, from, to, slice) {\n    try {\n      return StepResult.ok(doc.replace(from, to, slice))\n    } catch (e) {\n      if (e instanceof ReplaceError) return StepResult.fail(e.message)\n      throw e\n    }\n  }\n}\n","import {Slice} from \"prosemirror-model\"\n\nimport {Step, StepResult} from \"./step\"\nimport {StepMap} from \"./map\"\n\n// ::- Replace a part of the document with a slice of new content.\nexport class ReplaceStep extends Step {\n  // :: (number, number, Slice, ?bool)\n  // The given `slice` should fit the 'gap' between `from` and\n  // `to`—the depths must line up, and the surrounding nodes must be\n  // able to be joined with the open sides of the slice. When\n  // `structure` is true, the step will fail if the content between\n  // from and to is not just a sequence of closing and then opening\n  // tokens (this is to guard against rebased replace steps\n  // overwriting something they weren't supposed to).\n  constructor(from, to, slice, structure) {\n    super()\n    // :: number\n    // The start position of the replaced range.\n    this.from = from\n    // :: number\n    // The end position of the replaced range.\n    this.to = to\n    // :: Slice\n    // The slice to insert.\n    this.slice = slice\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      return StepResult.fail(\"Structure replace would overwrite content\")\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  }\n\n  invert(doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted) return null\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  }\n\n  merge(other) {\n    if (!(other instanceof ReplaceStep) || other.structure || this.structure) return null\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd)\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd)\n      return new ReplaceStep(other.from, this.to, slice, this.structure)\n    } else {\n      return null\n    }\n  }\n\n  toJSON() {\n    let json = {stepType: \"replace\", from: this.from, to: this.to}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\")\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  }\n}\n\nStep.jsonID(\"replace\", ReplaceStep)\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nexport class ReplaceAroundStep extends Step {\n  // :: (number, number, number, number, Slice, number, ?bool)\n  // Create a replace-around step with the given range and gap.\n  // `insert` should be the point in the slice into which the content\n  // of the gap should be moved. `structure` has the same meaning as\n  // it has in the [`ReplaceStep`](#transform.ReplaceStep) class.\n  constructor(from, to, gapFrom, gapTo, slice, insert, structure) {\n    super()\n    // :: number\n    // The start position of the replaced range.\n    this.from = from\n    // :: number\n    // The end position of the replaced range.\n    this.to = to\n    // :: number\n    // The start of preserved range.\n    this.gapFrom = gapFrom\n    // :: number\n    // The end of preserved range.\n    this.gapTo = gapTo\n    // :: Slice\n    // The slice to insert.\n    this.slice = slice\n    // :: number\n    // The position in the slice where the preserved range should be\n    // inserted.\n    this.insert = insert\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      return StepResult.fail(\"Structure gap-replace would overwrite content\")\n\n    let gap = doc.slice(this.gapFrom, this.gapTo)\n    if (gap.openStart || gap.openEnd)\n      return StepResult.fail(\"Gap is not a flat range\")\n    let inserted = this.slice.insertAt(this.insert, gap.content)\n    if (!inserted) return StepResult.fail(\"Content does not fit in gap\")\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  }\n\n  invert(doc) {\n    let gap = this.gapTo - this.gapFrom\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    let gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1)\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) return null\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  }\n\n  toJSON() {\n    let json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\")\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  }\n}\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep)\n\nfunction contentBetween(doc, from, to) {\n  let $from = doc.resolve(from), dist = to - from, depth = $from.depth\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--\n    dist--\n  }\n  if (dist > 0) {\n    let next = $from.node(depth).maybeChild($from.indexAfter(depth))\n    while (dist > 0) {\n      if (!next || next.isLeaf) return true\n      next = next.firstChild\n      dist--\n    }\n  }\n  return false\n}\n","import {Slice, Fragment} from \"prosemirror-model\"\n\nimport {Transform} from \"./transform\"\nimport {ReplaceStep, ReplaceAroundStep} from \"./replace_step\"\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange) → ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nexport function liftTarget(range) {\n  let parent = range.parent\n  let content = parent.content.cutByIndex(range.startIndex, range.endIndex)\n  for (let depth = range.depth;; --depth) {\n    let node = range.$from.node(depth)\n    let index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth)\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      return depth\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) break\n  }\n}\n\n// :: (NodeRange, number) → this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  let {$from, $to, depth} = range\n\n  let gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1)\n  let start = gapStart, end = gapEnd\n\n  let before = Fragment.empty, openStart = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $from.index(d) > 0) {\n      splitting = true\n      before = Fragment.from($from.node(d).copy(before))\n      openStart++\n    } else {\n      start--\n    }\n  let after = Fragment.empty, openEnd = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $to.after(d + 1) < $to.end(d)) {\n      splitting = true\n      after = Fragment.from($to.node(d).copy(after))\n      openEnd++\n    } else {\n      end++\n    }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n}\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange) → ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nexport function findWrapping(range, nodeType, attrs, innerRange = range) {\n  let around = findWrappingOutside(range, nodeType)\n  let inner = around && findWrappingInside(innerRange, nodeType)\n  if (!inner) return null\n  return around.map(withAttrs).concat({type: nodeType, attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let around = parent.contentMatchAt(startIndex).findWrapping(type)\n  if (!around) return null\n  let outer = around.length ? around[0] : type\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let inner = parent.child(startIndex)\n  let inside = type.contentMatch.findWrapping(inner.type)\n  if (!inside) return null\n  let lastType = inside.length ? inside[inside.length - 1] : type\n  let innerMatch = lastType.contentMatch\n  for (let i = startIndex; innerMatch && i < endIndex; i++)\n    innerMatch = innerMatch.matchType(parent.child(i).type)\n  if (!innerMatch || !innerMatch.validEnd) return null\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}]) → this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--) {\n    if (content.size) {\n      let match = wrappers[i].type.contentMatch.matchFragment(content)\n      if (!match || !match.validEnd)\n        throw new RangeError(\"Wrapper type given to Transform.wrap does not form valid content of its parent wrapper\")\n    }\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n  }\n\n  let start = range.start, end = range.end\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n}\n\n// :: (number, ?number, NodeType, ?Object) → this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to = from, type, attrs) {\n  if (!type.isTextblock) throw new RangeError(\"Type given to setBlockType should be a textblock\")\n  let mapFrom = this.steps.length\n  this.doc.nodesBetween(from, to, (node, pos) => {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this.doc, this.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this.clearIncompatible(this.mapping.slice(mapFrom).map(pos, 1), type)\n      let mapping = this.mapping.slice(mapFrom)\n      let startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1)\n      this.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true))\n      return false\n    }\n  })\n  return this\n}\n\nfunction canChangeType(doc, pos, type) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark]) → this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  let node = this.doc.nodeAt(pos)\n  if (!node) throw new RangeError(\"No node at given position\")\n  if (!type) type = node.type\n  let newNode = type.create(attrs, null, marks || node.marks)\n  if (node.isLeaf)\n    return this.replaceWith(pos, pos + node.nodeSize, newNode)\n\n  if (!type.validContent(node.content))\n    throw new RangeError(\"Invalid content for node type \" + type.name)\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n}\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}]) → bool\n// Check whether splitting at the given position is allowed.\nexport function canSplit(doc, pos, depth = 1, typesAfter) {\n  let $pos = doc.resolve(pos), base = $pos.depth - depth\n  let innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    return false\n  for (let d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    let node = $pos.node(d), index = $pos.index(d)\n    if (node.type.spec.isolating) return false\n    let rest = node.content.cutByIndex(index, node.childCount)\n    let after = (typesAfter && typesAfter[i]) || node\n    if (after != node) rest = rest.replaceChild(0, after.type.create(after.attrs))\n    if (!node.canReplace(index + 1, node.childCount) || !after.type.validContent(rest))\n      return false\n  }\n  let index = $pos.indexAfter(base)\n  let baseType = typesAfter && typesAfter[0]\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}]) → this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth = 1, typesAfter) {\n  let $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty\n  for (let d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before))\n    let typeAfter = typesAfter && typesAfter[i]\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after))\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n}\n\n// :: (Node, number) → bool\n// Test whether the blocks before and after a given position can be\n// joined.\nexport function canJoin(doc, pos) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number) → ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nexport function joinPoint(doc, pos, dir = -1) {\n  let $pos = doc.resolve(pos)\n  for (let d = $pos.depth;; d--) {\n    let before, after, index = $pos.index(d)\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore\n      after = $pos.nodeAfter\n    } else if (dir > 0) {\n      before = $pos.node(d + 1)\n      index++\n      after = $pos.node(d).maybeChild(index)\n    } else {\n      before = $pos.node(d).maybeChild(index - 1)\n      after = $pos.node(d + 1)\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) return pos\n    if (d == 0) break\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d)\n  }\n}\n\n// :: (number, ?number) → this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth = 1) {\n  let step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true)\n  return this.step(step)\n}\n\n// :: (Node, number, NodeType) → ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nexport function insertPoint(doc, pos, nodeType) {\n  let $pos = doc.resolve(pos)\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) return pos\n\n  if ($pos.parentOffset == 0)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.index(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.before(d + 1)\n      if (index > 0) return null\n    }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.indexAfter(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.after(d + 1)\n      if (index < $pos.node(d).childCount) return null\n    }\n}\n\n// :: (Node, number, Slice) → ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nexport function dropPoint(doc, pos, slice) {\n  let $pos = doc.resolve(pos)\n  if (!slice.content.size) return pos\n  let content = slice.content\n  for (let i = 0; i < slice.openStart; i++) content = content.firstChild.content\n  for (let pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (let d = $pos.depth; d >= 0; d--) {\n      let bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1\n      let insertPos = $pos.index(d) + (bias > 0 ? 1 : 0)\n      let parent = $pos.node(d), fits = false\n      if (pass == 1) {\n        fits = parent.canReplace(insertPos, insertPos, content)\n      } else {\n        let wrapping = parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type)\n        fits = wrapping && parent.canReplaceWith(insertPos, insertPos, wrapping[0])\n      }\n      if (fits)\n        return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1)\n    }\n  }\n  return null\n}\n","import {Fragment, Slice} from \"prosemirror-model\"\nimport {Step, StepResult} from \"./step\"\n\nfunction mapFragment(fragment, f, parent) {\n  let mapped = []\n  for (let i = 0; i < fragment.childCount; i++) {\n    let child = fragment.child(i)\n    if (child.content.size) child = child.copy(mapFragment(child.content, f, child))\n    if (child.isInline) child = f(child, parent, i)\n    mapped.push(child)\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nexport class AddMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    // :: number\n    // The start of the marked range.\n    this.from = from\n    // :: number\n    // The end of the marked range.\n    this.to = to\n    // :: Mark\n    // The mark to add.\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from)\n    let parent = $from.node($from.sharedDepth(this.to))\n    let slice = new Slice(mapFragment(oldSlice.content, (node, parent) => {\n      if (!node.isAtom || !parent.type.allowsMarkType(this.mark.type)) return node\n      return node.mark(this.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\")\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"addMark\", AddMarkStep)\n\n// ::- Remove a mark from all inline content between two positions.\nexport class RemoveMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    // :: number\n    // The start of the unmarked range.\n    this.from = from\n    // :: number\n    // The end of the unmarked range.\n    this.to = to\n    // :: Mark\n    // The mark to remove.\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to)\n    let slice = new Slice(mapFragment(oldSlice.content, node => {\n      return node.mark(this.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\")\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"removeMark\", RemoveMarkStep)\n","// Utilities\n//\n'use strict';\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction isString(obj) { return _class(obj) === '[object String]'; }\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction has(object, key) {\n  return _hasOwnProperty.call(object, key);\n}\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    if (typeof source !== 'object') {\n      throw new TypeError(source + 'must be object');\n    }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\n// Remove element from array and put another array at those position.\n// Useful for some operations with tokens\nfunction arrayReplaceAt(src, pos, newElements) {\n  return [].concat(src.slice(0, pos), newElements, src.slice(pos + 1));\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isValidEntityCode(c) {\n  /*eslint no-bitwise:0*/\n  // broken sequence\n  if (c >= 0xD800 && c <= 0xDFFF) { return false; }\n  // never used\n  if (c >= 0xFDD0 && c <= 0xFDEF) { return false; }\n  if ((c & 0xFFFF) === 0xFFFF || (c & 0xFFFF) === 0xFFFE) { return false; }\n  // control codes\n  if (c >= 0x00 && c <= 0x08) { return false; }\n  if (c === 0x0B) { return false; }\n  if (c >= 0x0E && c <= 0x1F) { return false; }\n  if (c >= 0x7F && c <= 0x9F) { return false; }\n  // out of range\n  if (c > 0x10FFFF) { return false; }\n  return true;\n}\n\nfunction fromCodePoint(c) {\n  /*eslint no-bitwise:0*/\n  if (c > 0xffff) {\n    c -= 0x10000;\n    var surrogate1 = 0xd800 + (c >> 10),\n        surrogate2 = 0xdc00 + (c & 0x3ff);\n\n    return String.fromCharCode(surrogate1, surrogate2);\n  }\n  return String.fromCharCode(c);\n}\n\n\nvar UNESCAPE_MD_RE  = /\\\\([!\"#$%&'()*+,\\-.\\/:;<=>?@[\\\\\\]^_`{|}~])/g;\nvar ENTITY_RE       = /&([a-z#][a-z0-9]{1,31});/gi;\nvar UNESCAPE_ALL_RE = new RegExp(UNESCAPE_MD_RE.source + '|' + ENTITY_RE.source, 'gi');\n\nvar DIGITAL_ENTITY_TEST_RE = /^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;\n\nvar entities = require('./entities');\n\nfunction replaceEntityPattern(match, name) {\n  var code = 0;\n\n  if (has(entities, name)) {\n    return entities[name];\n  }\n\n  if (name.charCodeAt(0) === 0x23/* # */ && DIGITAL_ENTITY_TEST_RE.test(name)) {\n    code = name[1].toLowerCase() === 'x' ?\n      parseInt(name.slice(2), 16) : parseInt(name.slice(1), 10);\n\n    if (isValidEntityCode(code)) {\n      return fromCodePoint(code);\n    }\n  }\n\n  return match;\n}\n\n/*function replaceEntities(str) {\n  if (str.indexOf('&') < 0) { return str; }\n\n  return str.replace(ENTITY_RE, replaceEntityPattern);\n}*/\n\nfunction unescapeMd(str) {\n  if (str.indexOf('\\\\') < 0) { return str; }\n  return str.replace(UNESCAPE_MD_RE, '$1');\n}\n\nfunction unescapeAll(str) {\n  if (str.indexOf('\\\\') < 0 && str.indexOf('&') < 0) { return str; }\n\n  return str.replace(UNESCAPE_ALL_RE, function (match, escaped, entity) {\n    if (escaped) { return escaped; }\n    return replaceEntityPattern(match, entity);\n  });\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar HTML_ESCAPE_TEST_RE = /[&<>\"]/;\nvar HTML_ESCAPE_REPLACE_RE = /[&<>\"]/g;\nvar HTML_REPLACEMENTS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;'\n};\n\nfunction replaceUnsafeChar(ch) {\n  return HTML_REPLACEMENTS[ch];\n}\n\nfunction escapeHtml(str) {\n  if (HTML_ESCAPE_TEST_RE.test(str)) {\n    return str.replace(HTML_ESCAPE_REPLACE_RE, replaceUnsafeChar);\n  }\n  return str;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar REGEXP_ESCAPE_RE = /[.?*+^$[\\]\\\\(){}|-]/g;\n\nfunction escapeRE(str) {\n  return str.replace(REGEXP_ESCAPE_RE, '\\\\$&');\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isSpace(code) {\n  switch (code) {\n    case 0x09:\n    case 0x20:\n      return true;\n  }\n  return false;\n}\n\n// Zs (unicode class) || [\\t\\f\\v\\r\\n]\nfunction isWhiteSpace(code) {\n  if (code >= 0x2000 && code <= 0x200A) { return true; }\n  switch (code) {\n    case 0x09: // \\t\n    case 0x0A: // \\n\n    case 0x0B: // \\v\n    case 0x0C: // \\f\n    case 0x0D: // \\r\n    case 0x20:\n    case 0xA0:\n    case 0x1680:\n    case 0x202F:\n    case 0x205F:\n    case 0x3000:\n      return true;\n  }\n  return false;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/*eslint-disable max-len*/\nvar UNICODE_PUNCT_RE = require('uc.micro/categories/P/regex');\n\n// Currently without astral characters support.\nfunction isPunctChar(ch) {\n  return UNICODE_PUNCT_RE.test(ch);\n}\n\n\n// Markdown ASCII punctuation characters.\n//\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\n//\n// Don't confuse with unicode punctuation !!! It lacks some chars in ascii range.\n//\nfunction isMdAsciiPunct(ch) {\n  switch (ch) {\n    case 0x21/* ! */:\n    case 0x22/* \" */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x27/* ' */:\n    case 0x28/* ( */:\n    case 0x29/* ) */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2C/* , */:\n    case 0x2D/* - */:\n    case 0x2E/* . */:\n    case 0x2F/* / */:\n    case 0x3A/* : */:\n    case 0x3B/* ; */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x3F/* ? */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7C/* | */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\n// Hepler to unify [reference labels].\n//\nfunction normalizeReference(str) {\n  // Trim and collapse whitespace\n  //\n  str = str.trim().replace(/\\s+/g, ' ');\n\n  // In node v10 'ẞ'.toLowerCase() === 'Ṿ', which is presumed to be a bug\n  // fixed in v12 (couldn't find any details).\n  //\n  // So treat this one as a special case\n  // (remove this when node v10 is no longer supported).\n  //\n  if ('ẞ'.toLowerCase() === 'Ṿ') {\n    str = str.replace(/ẞ/g, 'ß');\n  }\n\n  // .toLowerCase().toUpperCase() should get rid of all differences\n  // between letter variants.\n  //\n  // Simple .toLowerCase() doesn't normalize 125 code points correctly,\n  // and .toUpperCase doesn't normalize 6 of them (list of exceptions:\n  // İ, ϴ, ẞ, Ω, K, Å - those are already uppercased, but have differently\n  // uppercased versions).\n  //\n  // Here's an example showing how it happens. Lets take greek letter omega:\n  // uppercase U+0398 (Θ), U+03f4 (ϴ) and lowercase U+03b8 (θ), U+03d1 (ϑ)\n  //\n  // Unicode entries:\n  // 0398;GREEK CAPITAL LETTER THETA;Lu;0;L;;;;;N;;;;03B8;\n  // 03B8;GREEK SMALL LETTER THETA;Ll;0;L;;;;;N;;;0398;;0398\n  // 03D1;GREEK THETA SYMBOL;Ll;0;L;<compat> 03B8;;;;N;GREEK SMALL LETTER SCRIPT THETA;;0398;;0398\n  // 03F4;GREEK CAPITAL THETA SYMBOL;Lu;0;L;<compat> 0398;;;;N;;;;03B8;\n  //\n  // Case-insensitive comparison should treat all of them as equivalent.\n  //\n  // But .toLowerCase() doesn't change ϑ (it's already lowercase),\n  // and .toUpperCase() doesn't change ϴ (already uppercase).\n  //\n  // Applying first lower then upper case normalizes any character:\n  // '\\u0398\\u03f4\\u03b8\\u03d1'.toLowerCase().toUpperCase() === '\\u0398\\u0398\\u0398\\u0398'\n  //\n  // Note: this is equivalent to unicode case folding; unicode normalization\n  // is a different step that is not required here.\n  //\n  // Final result should be uppercased, because it's later stored in an object\n  // (this avoid a conflict with Object.prototype members,\n  // most notably, `__proto__`)\n  //\n  return str.toLowerCase().toUpperCase();\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n// Re-export libraries commonly used in both markdown-it and its plugins,\n// so plugins won't have to depend on them explicitly, which reduces their\n// bundled size (e.g. a browser build).\n//\nexports.lib                 = {};\nexports.lib.mdurl           = require('mdurl');\nexports.lib.ucmicro         = require('uc.micro');\n\nexports.assign              = assign;\nexports.isString            = isString;\nexports.has                 = has;\nexports.unescapeMd          = unescapeMd;\nexports.unescapeAll         = unescapeAll;\nexports.isValidEntityCode   = isValidEntityCode;\nexports.fromCodePoint       = fromCodePoint;\n// exports.replaceEntities     = replaceEntities;\nexports.escapeHtml          = escapeHtml;\nexports.arrayReplaceAt      = arrayReplaceAt;\nexports.isSpace             = isSpace;\nexports.isWhiteSpace        = isWhiteSpace;\nexports.isMdAsciiPunct      = isMdAsciiPunct;\nexports.isPunctChar         = isPunctChar;\nexports.escapeRE            = escapeRE;\nexports.normalizeReference  = normalizeReference;\n","// Utilities\n//\n'use strict';\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction isString(obj) { return _class(obj) === '[object String]'; }\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction has(object, key) {\n  return _hasOwnProperty.call(object, key);\n}\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    if (typeof source !== 'object') {\n      throw new TypeError(source + 'must be object');\n    }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\n// Remove element from array and put another array at those position.\n// Useful for some operations with tokens\nfunction arrayReplaceAt(src, pos, newElements) {\n  return [].concat(src.slice(0, pos), newElements, src.slice(pos + 1));\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isValidEntityCode(c) {\n  /*eslint no-bitwise:0*/\n  // broken sequence\n  if (c >= 0xD800 && c <= 0xDFFF) { return false; }\n  // never used\n  if (c >= 0xFDD0 && c <= 0xFDEF) { return false; }\n  if ((c & 0xFFFF) === 0xFFFF || (c & 0xFFFF) === 0xFFFE) { return false; }\n  // control codes\n  if (c >= 0x00 && c <= 0x08) { return false; }\n  if (c === 0x0B) { return false; }\n  if (c >= 0x0E && c <= 0x1F) { return false; }\n  if (c >= 0x7F && c <= 0x9F) { return false; }\n  // out of range\n  if (c > 0x10FFFF) { return false; }\n  return true;\n}\n\nfunction fromCodePoint(c) {\n  /*eslint no-bitwise:0*/\n  if (c > 0xffff) {\n    c -= 0x10000;\n    var surrogate1 = 0xd800 + (c >> 10),\n        surrogate2 = 0xdc00 + (c & 0x3ff);\n\n    return String.fromCharCode(surrogate1, surrogate2);\n  }\n  return String.fromCharCode(c);\n}\n\n\nvar UNESCAPE_MD_RE  = /\\\\([!\"#$%&'()*+,\\-.\\/:;<=>?@[\\\\\\]^_`{|}~])/g;\nvar ENTITY_RE       = /&([a-z#][a-z0-9]{1,31});/gi;\nvar UNESCAPE_ALL_RE = new RegExp(UNESCAPE_MD_RE.source + '|' + ENTITY_RE.source, 'gi');\n\nvar DIGITAL_ENTITY_TEST_RE = /^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;\n\nvar entities = require('./entities');\n\nfunction replaceEntityPattern(match, name) {\n  var code = 0;\n\n  if (has(entities, name)) {\n    return entities[name];\n  }\n\n  if (name.charCodeAt(0) === 0x23/* # */ && DIGITAL_ENTITY_TEST_RE.test(name)) {\n    code = name[1].toLowerCase() === 'x' ?\n      parseInt(name.slice(2), 16) : parseInt(name.slice(1), 10);\n\n    if (isValidEntityCode(code)) {\n      return fromCodePoint(code);\n    }\n  }\n\n  return match;\n}\n\n/*function replaceEntities(str) {\n  if (str.indexOf('&') < 0) { return str; }\n\n  return str.replace(ENTITY_RE, replaceEntityPattern);\n}*/\n\nfunction unescapeMd(str) {\n  if (str.indexOf('\\\\') < 0) { return str; }\n  return str.replace(UNESCAPE_MD_RE, '$1');\n}\n\nfunction unescapeAll(str) {\n  if (str.indexOf('\\\\') < 0 && str.indexOf('&') < 0) { return str; }\n\n  return str.replace(UNESCAPE_ALL_RE, function (match, escaped, entity) {\n    if (escaped) { return escaped; }\n    return replaceEntityPattern(match, entity);\n  });\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar HTML_ESCAPE_TEST_RE = /[&<>\"]/;\nvar HTML_ESCAPE_REPLACE_RE = /[&<>\"]/g;\nvar HTML_REPLACEMENTS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;'\n};\n\nfunction replaceUnsafeChar(ch) {\n  return HTML_REPLACEMENTS[ch];\n}\n\nfunction escapeHtml(str) {\n  if (HTML_ESCAPE_TEST_RE.test(str)) {\n    return str.replace(HTML_ESCAPE_REPLACE_RE, replaceUnsafeChar);\n  }\n  return str;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar REGEXP_ESCAPE_RE = /[.?*+^$[\\]\\\\(){}|-]/g;\n\nfunction escapeRE(str) {\n  return str.replace(REGEXP_ESCAPE_RE, '\\\\$&');\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isSpace(code) {\n  switch (code) {\n    case 0x09:\n    case 0x20:\n      return true;\n  }\n  return false;\n}\n\n// Zs (unicode class) || [\\t\\f\\v\\r\\n]\nfunction isWhiteSpace(code) {\n  if (code >= 0x2000 && code <= 0x200A) { return true; }\n  switch (code) {\n    case 0x09: // \\t\n    case 0x0A: // \\n\n    case 0x0B: // \\v\n    case 0x0C: // \\f\n    case 0x0D: // \\r\n    case 0x20:\n    case 0xA0:\n    case 0x1680:\n    case 0x202F:\n    case 0x205F:\n    case 0x3000:\n      return true;\n  }\n  return false;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/*eslint-disable max-len*/\nvar UNICODE_PUNCT_RE = require('uc.micro/categories/P/regex');\n\n// Currently without astral characters support.\nfunction isPunctChar(ch) {\n  return UNICODE_PUNCT_RE.test(ch);\n}\n\n\n// Markdown ASCII punctuation characters.\n//\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\n//\n// Don't confuse with unicode punctuation !!! It lacks some chars in ascii range.\n//\nfunction isMdAsciiPunct(ch) {\n  switch (ch) {\n    case 0x21/* ! */:\n    case 0x22/* \" */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x27/* ' */:\n    case 0x28/* ( */:\n    case 0x29/* ) */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2C/* , */:\n    case 0x2D/* - */:\n    case 0x2E/* . */:\n    case 0x2F/* / */:\n    case 0x3A/* : */:\n    case 0x3B/* ; */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x3F/* ? */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7C/* | */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\n// Hepler to unify [reference labels].\n//\nfunction normalizeReference(str) {\n  // Trim and collapse whitespace\n  //\n  str = str.trim().replace(/\\s+/g, ' ');\n\n  // In node v10 'ẞ'.toLowerCase() === 'Ṿ', which is presumed to be a bug\n  // fixed in v12 (couldn't find any details).\n  //\n  // So treat this one as a special case\n  // (remove this when node v10 is no longer supported).\n  //\n  if ('ẞ'.toLowerCase() === 'Ṿ') {\n    str = str.replace(/ẞ/g, 'ß');\n  }\n\n  // .toLowerCase().toUpperCase() should get rid of all differences\n  // between letter variants.\n  //\n  // Simple .toLowerCase() doesn't normalize 125 code points correctly,\n  // and .toUpperCase doesn't normalize 6 of them (list of exceptions:\n  // İ, ϴ, ẞ, Ω, K, Å - those are already uppercased, but have differently\n  // uppercased versions).\n  //\n  // Here's an example showing how it happens. Lets take greek letter omega:\n  // uppercase U+0398 (Θ), U+03f4 (ϴ) and lowercase U+03b8 (θ), U+03d1 (ϑ)\n  //\n  // Unicode entries:\n  // 0398;GREEK CAPITAL LETTER THETA;Lu;0;L;;;;;N;;;;03B8;\n  // 03B8;GREEK SMALL LETTER THETA;Ll;0;L;;;;;N;;;0398;;0398\n  // 03D1;GREEK THETA SYMBOL;Ll;0;L;<compat> 03B8;;;;N;GREEK SMALL LETTER SCRIPT THETA;;0398;;0398\n  // 03F4;GREEK CAPITAL THETA SYMBOL;Lu;0;L;<compat> 0398;;;;N;;;;03B8;\n  //\n  // Case-insensitive comparison should treat all of them as equivalent.\n  //\n  // But .toLowerCase() doesn't change ϑ (it's already lowercase),\n  // and .toUpperCase() doesn't change ϴ (already uppercase).\n  //\n  // Applying first lower then upper case normalizes any character:\n  // '\\u0398\\u03f4\\u03b8\\u03d1'.toLowerCase().toUpperCase() === '\\u0398\\u0398\\u0398\\u0398'\n  //\n  // Note: this is equivalent to unicode case folding; unicode normalization\n  // is a different step that is not required here.\n  //\n  // Final result should be uppercased, because it's later stored in an object\n  // (this avoid a conflict with Object.prototype members,\n  // most notably, `__proto__`)\n  //\n  return str.toLowerCase().toUpperCase();\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n// Re-export libraries commonly used in both markdown-it and its plugins,\n// so plugins won't have to depend on them explicitly, which reduces their\n// bundled size (e.g. a browser build).\n//\nexports.lib                 = {};\nexports.lib.mdurl           = require('mdurl');\nexports.lib.ucmicro         = require('uc.micro');\n\nexports.assign              = assign;\nexports.isString            = isString;\nexports.has                 = has;\nexports.unescapeMd          = unescapeMd;\nexports.unescapeAll         = unescapeAll;\nexports.isValidEntityCode   = isValidEntityCode;\nexports.fromCodePoint       = fromCodePoint;\n// exports.replaceEntities     = replaceEntities;\nexports.escapeHtml          = escapeHtml;\nexports.arrayReplaceAt      = arrayReplaceAt;\nexports.isSpace             = isSpace;\nexports.isWhiteSpace        = isWhiteSpace;\nexports.isMdAsciiPunct      = isMdAsciiPunct;\nexports.isPunctChar         = isPunctChar;\nexports.escapeRE            = escapeRE;\nexports.normalizeReference  = normalizeReference;\n","import {Plugin} from \"prosemirror-state\"\n\n// ::- Input rules are regular expressions describing a piece of text\n// that, when typed, causes something to happen. This might be\n// changing two dashes into an emdash, wrapping a paragraph starting\n// with `\"> \"` into a blockquote, or something entirely different.\nexport class InputRule {\n  // :: (RegExp, union<string, (state: EditorState, match: [string], start: number, end: number) → ?Transaction>)\n  // Create an input rule. The rule applies when the user typed\n  // something and the text directly in front of the cursor matches\n  // `match`, which should end with `$`.\n  //\n  // The `handler` can be a string, in which case the matched text, or\n  // the first matched group in the regexp, is replaced by that\n  // string.\n  //\n  // Or a it can be a function, which will be called with the match\n  // array produced by\n  // [`RegExp.exec`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec),\n  // as well as the start and end of the matched range, and which can\n  // return a [transaction](#state.Transaction) that describes the\n  // rule's effect, or null to indicate the input was not handled.\n  constructor(match, handler) {\n    this.match = match\n    this.handler = typeof handler == \"string\" ? stringHandler(handler) : handler\n  }\n}\n\nfunction stringHandler(string) {\n  return function(state, match, start, end) {\n    let insert = string\n    if (match[1]) {\n      let offset = match[0].lastIndexOf(match[1])\n      insert += match[0].slice(offset + match[1].length)\n      start += offset\n      let cutOff = start - end\n      if (cutOff > 0) {\n        insert = match[0].slice(offset - cutOff, offset) + insert\n        start = end\n      }\n    }\n    return state.tr.insertText(insert, start, end)\n  }\n}\n\nconst MAX_MATCH = 500\n\n// :: (config: {rules: [InputRule]}) → Plugin\n// Create an input rules plugin. When enabled, it will cause text\n// input that matches any of the given rules to trigger the rule's\n// action.\nexport function inputRules({rules}) {\n  let plugin = new Plugin({\n    state: {\n      init() { return null },\n      apply(tr, prev) {\n        let stored = tr.getMeta(this)\n        if (stored) return stored\n        return tr.selectionSet || tr.docChanged ? null : prev\n      }\n    },\n\n    props: {\n      handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin)\n      },\n      handleDOMEvents: {\n        compositionend: (view) => {\n          setTimeout(() => {\n            let {$cursor} = view.state.selection\n            if ($cursor) run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin)\n          })\n        }\n      }\n    },\n\n    isInputRules: true\n  })\n  return plugin\n}\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) return false\n  let state = view.state, $from = state.doc.resolve(from)\n  if ($from.parent.type.spec.code) return false\n  let textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - MAX_MATCH), $from.parentOffset,\n                                            null, \"\\ufffc\") + text\n  for (let i = 0; i < rules.length; i++) {\n    let match = rules[i].match.exec(textBefore)\n    let tr = match && rules[i].handler(state, match, from - (match[0].length - text.length), to)\n    if (!tr) continue\n    view.dispatch(tr.setMeta(plugin, {transform: tr, from, to, text}))\n    return true\n  }\n  return false\n}\n\n// :: (EditorState, ?(Transaction)) → bool\n// This is a command that will undo an input rule, if applying such a\n// rule was the last thing that the user did.\nexport function undoInputRule(state, dispatch) {\n  let plugins = state.plugins\n  for (let i = 0; i < plugins.length; i++) {\n    let plugin = plugins[i], undoable\n    if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n      if (dispatch) {\n        let tr = state.tr, toUndo = undoable.transform\n        for (let j = toUndo.steps.length - 1; j >= 0; j--)\n          tr.step(toUndo.steps[j].invert(toUndo.docs[j]))\n        if (undoable.text) {\n          let marks = tr.doc.resolve(undoable.from).marks()\n          tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks))\n        } else {\n          tr.delete(undoable.from, undoable.to)\n        }\n        dispatch(tr)\n      }\n      return true\n    }\n  }\n  return false\n}\n","import {InputRule} from \"./inputrules\"\n\n// :: InputRule Converts double dashes to an emdash.\nexport const emDash = new InputRule(/--$/, \"—\")\n// :: InputRule Converts three dots to an ellipsis character.\nexport const ellipsis = new InputRule(/\\.\\.\\.$/, \"…\")\n// :: InputRule “Smart” opening double quotes.\nexport const openDoubleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(\")$/, \"“\")\n// :: InputRule “Smart” closing double quotes.\nexport const closeDoubleQuote = new InputRule(/\"$/, \"”\")\n// :: InputRule “Smart” opening single quotes.\nexport const openSingleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(')$/, \"‘\")\n// :: InputRule “Smart” closing single quotes.\nexport const closeSingleQuote = new InputRule(/'$/, \"’\")\n\n// :: [InputRule] Smart-quote related input rules.\nexport const smartQuotes = [openDoubleQuote, closeDoubleQuote, openSingleQuote, closeSingleQuote]\n","import {InputRule} from \"./inputrules\"\nimport {findWrapping, canJoin} from \"prosemirror-transform\"\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>, ?([string], Node) → bool) → InputRule\n// Build an input rule for automatically wrapping a textblock when a\n// given string is typed. The `regexp` argument is\n// directly passed through to the `InputRule` constructor. You'll\n// probably want the regexp to start with `^`, so that the pattern can\n// only occur at the start of a textblock.\n//\n// `nodeType` is the type of node to wrap in. If it needs attributes,\n// you can either pass them directly, or pass a function that will\n// compute them from the regular expression match.\n//\n// By default, if there's a node with the same type above the newly\n// wrapped node, the rule will try to [join](#transform.Transform.join) those\n// two nodes. You can pass a join predicate, which takes a regular\n// expression match and the node before the wrapped node, and can\n// return a boolean to indicate whether a join should happen.\nexport function wrappingInputRule(regexp, nodeType, getAttrs, joinPredicate) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    let tr = state.tr.delete(start, end)\n    let $start = tr.doc.resolve(start), range = $start.blockRange(), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return null\n    tr.wrap(range, wrapping)\n    let before = tr.doc.resolve(start - 1).nodeBefore\n    if (before && before.type == nodeType && canJoin(tr.doc, start - 1) &&\n        (!joinPredicate || joinPredicate(match, before)))\n      tr.join(start - 1)\n    return tr\n  })\n}\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>) → InputRule\n// Build an input rule that changes the type of a textblock when the\n// matched text is typed into it. You'll usually want to start your\n// regexp with `^` to that it is only matched at the start of a\n// textblock. The optional `getAttrs` parameter can be used to compute\n// the new node's attributes, and works the same as in the\n// `wrappingInputRule` function.\nexport function textblockTypeInputRule(regexp, nodeType, getAttrs) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let $start = state.doc.resolve(start)\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), nodeType)) return null\n    return state.tr\n      .delete(start, end)\n      .setBlockType(start, start, nodeType, attrs)\n  })\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import markdownit from \"markdown-it\"\nimport {schema} from \"./schema\"\nimport {Mark} from \"prosemirror-model\"\n\nfunction maybeMerge(a, b) {\n  if (a.isText && b.isText && Mark.sameSet(a.marks, b.marks))\n    return a.withText(a.text + b.text)\n}\n\n// Object used to track the context of a running parse.\nclass MarkdownParseState {\n  constructor(schema, tokenHandlers) {\n    this.schema = schema\n    this.stack = [{type: schema.topNodeType, content: []}]\n    this.marks = Mark.none\n    this.tokenHandlers = tokenHandlers\n  }\n\n  top() {\n    return this.stack[this.stack.length - 1]\n  }\n\n  push(elt) {\n    if (this.stack.length) this.top().content.push(elt)\n  }\n\n  // : (string)\n  // Adds the given text to the current position in the document,\n  // using the current marks as styling.\n  addText(text) {\n    if (!text) return\n    let nodes = this.top().content, last = nodes[nodes.length - 1]\n    let node = this.schema.text(text, this.marks), merged\n    if (last && (merged = maybeMerge(last, node))) nodes[nodes.length - 1] = merged\n    else nodes.push(node)\n  }\n\n  // : (Mark)\n  // Adds the given mark to the set of active marks.\n  openMark(mark) {\n    this.marks = mark.addToSet(this.marks)\n  }\n\n  // : (Mark)\n  // Removes the given mark from the set of active marks.\n  closeMark(mark) {\n    this.marks = mark.removeFromSet(this.marks)\n  }\n\n  parseTokens(toks) {\n    for (let i = 0; i < toks.length; i++) {\n      let tok = toks[i]\n      let handler = this.tokenHandlers[tok.type]\n      if (!handler)\n        throw new Error(\"Token type `\" + tok.type + \"` not supported by Markdown parser\")\n      handler(this, tok, toks, i)\n    }\n  }\n\n  // : (NodeType, ?Object, ?[Node]) → ?Node\n  // Add a node at the current position.\n  addNode(type, attrs, content) {\n    let node = type.createAndFill(attrs, content, this.marks)\n    if (!node) return null\n    this.push(node)\n    return node\n  }\n\n  // : (NodeType, ?Object)\n  // Wrap subsequent content in a node of the given type.\n  openNode(type, attrs) {\n    this.stack.push({type: type, attrs: attrs, content: []})\n  }\n\n  // : () → ?Node\n  // Close and return the node that is currently on top of the stack.\n  closeNode() {\n    if (this.marks.length) this.marks = Mark.none\n    let info = this.stack.pop()\n    return this.addNode(info.type, info.attrs, info.content)\n  }\n}\n\nfunction attrs(spec, token, tokens, i) {\n  if (spec.getAttrs) return spec.getAttrs(token, tokens, i)\n  // For backwards compatibility when `attrs` is a Function\n  else if (spec.attrs instanceof Function) return spec.attrs(token)\n  else return spec.attrs\n}\n\n// Code content is represented as a single token with a `content`\n// property in Markdown-it.\nfunction noCloseToken(spec, type) {\n  return spec.noCloseToken || type == \"code_inline\" || type == \"code_block\" || type == \"fence\"\n}\n\nfunction withoutTrailingNewline(str) {\n  return str[str.length - 1] == \"\\n\" ? str.slice(0, str.length - 1) : str\n}\n\nfunction noOp() {}\n\nfunction tokenHandlers(schema, tokens) {\n  let handlers = Object.create(null)\n  for (let type in tokens) {\n    let spec = tokens[type]\n    if (spec.block) {\n      let nodeType = schema.nodeType(spec.block)\n      if (noCloseToken(spec, type)) {\n        handlers[type] = (state, tok, tokens, i) => {\n          state.openNode(nodeType, attrs(spec, tok, tokens, i))\n          state.addText(withoutTrailingNewline(tok.content))\n          state.closeNode()\n        }\n      } else {\n        handlers[type + \"_open\"] = (state, tok, tokens, i) => state.openNode(nodeType, attrs(spec, tok, tokens, i))\n        handlers[type + \"_close\"] = state => state.closeNode()\n      }\n    } else if (spec.node) {\n      let nodeType = schema.nodeType(spec.node)\n      handlers[type] = (state, tok, tokens, i) => state.addNode(nodeType, attrs(spec, tok, tokens, i))\n    } else if (spec.mark) {\n      let markType = schema.marks[spec.mark]\n      if (noCloseToken(spec, type)) {\n        handlers[type] = (state, tok, tokens, i) => {\n          state.openMark(markType.create(attrs(spec, tok, tokens, i)))\n          state.addText(withoutTrailingNewline(tok.content))\n          state.closeMark(markType)\n        }\n      } else {\n        handlers[type + \"_open\"] = (state, tok, tokens, i) => state.openMark(markType.create(attrs(spec, tok, tokens, i)))\n        handlers[type + \"_close\"] = state => state.closeMark(markType)\n      }\n    } else if (spec.ignore) {\n      if (noCloseToken(spec, type)) {\n        handlers[type] = noOp\n      } else {\n        handlers[type + \"_open\"] = noOp\n        handlers[type + \"_close\"] = noOp\n      }\n    } else {\n      throw new RangeError(\"Unrecognized parsing spec \" + JSON.stringify(spec))\n    }\n  }\n\n  handlers.text = (state, tok) => state.addText(tok.content)\n  handlers.inline = (state, tok) => state.parseTokens(tok.children)\n  handlers.softbreak = handlers.softbreak || (state => state.addText(\"\\n\"))\n\n  return handlers\n}\n\n// ::- A configuration of a Markdown parser. Such a parser uses\n// [markdown-it](https://github.com/markdown-it/markdown-it) to\n// tokenize a file, and then runs the custom rules it is given over\n// the tokens to create a ProseMirror document tree.\nexport class MarkdownParser {\n  // :: (Schema, MarkdownIt, Object)\n  // Create a parser with the given configuration. You can configure\n  // the markdown-it parser to parse the dialect you want, and provide\n  // a description of the ProseMirror entities those tokens map to in\n  // the `tokens` object, which maps token names to descriptions of\n  // what to do with them. Such a description is an object, and may\n  // have the following properties:\n  //\n  // **`node`**`: ?string`\n  //   : This token maps to a single node, whose type can be looked up\n  //     in the schema under the given name. Exactly one of `node`,\n  //     `block`, or `mark` must be set.\n  //\n  // **`block`**`: ?string`\n  //   : This token (unless `noCloseToken` is true) comes in `_open`\n  //     and `_close` variants (which are appended to the base token\n  //     name provides a the object property), and wraps a block of\n  //     content. The block should be wrapped in a node of the type\n  //     named to by the property's value. If the token does not have\n  //     `_open` or `_close`, use the `noCloseToken` option.\n  //\n  // **`mark`**`: ?string`\n  //   : This token (again, unless `noCloseToken` is true) also comes\n  //     in `_open` and `_close` variants, but should add a mark\n  //     (named by the value) to its content, rather than wrapping it\n  //     in a node.\n  //\n  // **`attrs`**`: ?Object`\n  //   : Attributes for the node or mark. When `getAttrs` is provided,\n  //     it takes precedence.\n  //\n  // **`getAttrs`**`: ?(MarkdownToken) → Object`\n  //   : A function used to compute the attributes for the node or mark\n  //     that takes a [markdown-it\n  //     token](https://markdown-it.github.io/markdown-it/#Token) and\n  //     returns an attribute object.\n  //\n  // **`noCloseToken`**`: ?boolean`\n  //   : Indicates that the [markdown-it\n  //     token](https://markdown-it.github.io/markdown-it/#Token) has\n  //     no `_open` or `_close` for the nodes. This defaults to `true`\n  //     for `code_inline`, `code_block` and `fence`.\n  //\n  // **`ignore`**`: ?bool`\n  //   : When true, ignore content for the matched token.\n  constructor(schema, tokenizer, tokens) {\n    // :: Object The value of the `tokens` object used to construct\n    // this parser. Can be useful to copy and modify to base other\n    // parsers on.\n    this.tokens = tokens\n    this.schema = schema\n    // :: This parser's markdown-it tokenizer.\n    this.tokenizer = tokenizer\n    this.tokenHandlers = tokenHandlers(schema, tokens)\n  }\n\n  // :: (string) → Node\n  // Parse a string as [CommonMark](http://commonmark.org/) markup,\n  // and create a ProseMirror document as prescribed by this parser's\n  // rules.\n  parse(text) {\n    let state = new MarkdownParseState(this.schema, this.tokenHandlers), doc\n    state.parseTokens(this.tokenizer.parse(text, {}))\n    do { doc = state.closeNode() } while (state.stack.length)\n    return doc || this.schema.topNodeType.createAndFill()\n  }\n}\n\nfunction listIsTight(tokens, i) {\n  while (++i < tokens.length)\n    if (tokens[i].type != \"list_item_open\") return tokens[i].hidden\n  return false\n}\n\n// :: MarkdownParser\n// A parser parsing unextended [CommonMark](http://commonmark.org/),\n// without inline HTML, and producing a document in the basic schema.\nexport const defaultMarkdownParser = new MarkdownParser(schema, markdownit(\"commonmark\", {html: false}), {\n  blockquote: {block: \"blockquote\"},\n  paragraph: {block: \"paragraph\"},\n  list_item: {block: \"list_item\"},\n  bullet_list: {block: \"bullet_list\", getAttrs: (_, tokens, i) => ({tight: listIsTight(tokens, i)})},\n  ordered_list: {block: \"ordered_list\", getAttrs: (tok, tokens, i) => ({\n    order: +tok.attrGet(\"start\") || 1,\n    tight: listIsTight(tokens, i)\n  })},\n  heading: {block: \"heading\", getAttrs: tok => ({level: +tok.tag.slice(1)})},\n  code_block: {block: \"code_block\", noCloseToken: true},\n  fence: {block: \"code_block\", getAttrs: tok => ({params: tok.info || \"\"}), noCloseToken: true},\n  hr: {node: \"horizontal_rule\"},\n  image: {node: \"image\", getAttrs: tok => ({\n    src: tok.attrGet(\"src\"),\n    title: tok.attrGet(\"title\") || null,\n    alt: tok.children[0] && tok.children[0].content || null\n  })},\n  hardbreak: {node: \"hard_break\"},\n\n  em: {mark: \"em\"},\n  strong: {mark: \"strong\"},\n  link: {mark: \"link\", getAttrs: tok => ({\n    href: tok.attrGet(\"href\"),\n    title: tok.attrGet(\"title\") || null\n  })},\n  code_inline: {mark: \"code\", noCloseToken: true}\n})\n","// ::- A specification for serializing a ProseMirror document as\n// Markdown/CommonMark text.\nexport class MarkdownSerializer {\n  // :: (Object<(state: MarkdownSerializerState, node: Node, parent: Node, index: number)>, Object, ?Object)\n  // Construct a serializer with the given configuration. The `nodes`\n  // object should map node names in a given schema to function that\n  // take a serializer state and such a node, and serialize the node.\n  //\n  // The `marks` object should hold objects with `open` and `close`\n  // properties, which hold the strings that should appear before and\n  // after a piece of text marked that way, either directly or as a\n  // function that takes a serializer state and a mark, and returns a\n  // string. `open` and `close` can also be functions, which will be\n  // called as\n  //\n  //     (state: MarkdownSerializerState, mark: Mark,\n  //      parent: Fragment, index: number) → string\n  //\n  // Where `parent` and `index` allow you to inspect the mark's\n  // context to see which nodes it applies to.\n  //\n  // Mark information objects can also have a `mixable` property\n  // which, when `true`, indicates that the order in which the mark's\n  // opening and closing syntax appears relative to other mixable\n  // marks can be varied. (For example, you can say `**a *b***` and\n  // `*a **b***`, but not `` `a *b*` ``.)\n  //\n  // To disable character escaping in a mark, you can give it an\n  // `escape` property of `false`. Such a mark has to have the highest\n  // precedence (must always be the innermost mark).\n  //\n  // The `expelEnclosingWhitespace` mark property causes the\n  // serializer to move enclosing whitespace from inside the marks to\n  // outside the marks. This is necessary for emphasis marks as\n  // CommonMark does not permit enclosing whitespace inside emphasis\n  // marks, see: http://spec.commonmark.org/0.26/#example-330\n  //\n  //   options::- Optional additional options.\n  //     escapeExtraCharacters:: ?RegExp\n  //     Extra characters can be added for escaping. This is passed\n  //     directly to String.replace(), and the matching characters are\n  //     preceded by a backslash.\n  constructor(nodes, marks, options) {\n    // :: Object<(MarkdownSerializerState, Node)> The node serializer\n    // functions for this serializer.\n    this.nodes = nodes\n    // :: Object The mark serializer info.\n    this.marks = marks\n    this.options = options || {}\n  }\n\n  // :: (Node, ?Object) → string\n  // Serialize the content of the given node to\n  // [CommonMark](http://commonmark.org/).\n  serialize(content, options) {\n    options = Object.assign(this.options, options)\n    let state = new MarkdownSerializerState(this.nodes, this.marks, options)\n    state.renderContent(content)\n    return state.out\n  }\n}\n\n// :: MarkdownSerializer\n// A serializer for the [basic schema](#schema).\nexport const defaultMarkdownSerializer = new MarkdownSerializer({\n  blockquote(state, node) {\n    state.wrapBlock(\"> \", null, node, () => state.renderContent(node))\n  },\n  code_block(state, node) {\n    state.write(\"```\" + (node.attrs.params || \"\") + \"\\n\")\n    state.text(node.textContent, false)\n    state.ensureNewLine()\n    state.write(\"```\")\n    state.closeBlock(node)\n  },\n  heading(state, node) {\n    state.write(state.repeat(\"#\", node.attrs.level) + \" \")\n    state.renderInline(node)\n    state.closeBlock(node)\n  },\n  horizontal_rule(state, node) {\n    state.write(node.attrs.markup || \"---\")\n    state.closeBlock(node)\n  },\n  bullet_list(state, node) {\n    state.renderList(node, \"  \", () => (node.attrs.bullet || \"*\") + \" \")\n  },\n  ordered_list(state, node) {\n    let start = node.attrs.order || 1\n    let maxW = String(start + node.childCount - 1).length\n    let space = state.repeat(\" \", maxW + 2)\n    state.renderList(node, space, i => {\n      let nStr = String(start + i)\n      return state.repeat(\" \", maxW - nStr.length) + nStr + \". \"\n    })\n  },\n  list_item(state, node) {\n    state.renderContent(node)\n  },\n  paragraph(state, node) {\n    state.renderInline(node)\n    state.closeBlock(node)\n  },\n\n  image(state, node) {\n    state.write(\"![\" + state.esc(node.attrs.alt || \"\") + \"](\" + node.attrs.src +\n                (node.attrs.title ? ' \"' + node.attrs.title.replace(/\"/g, '\\\\\"') + '\"' : \"\") + \")\")\n  },\n  hard_break(state, node, parent, index) {\n    for (let i = index + 1; i < parent.childCount; i++)\n      if (parent.child(i).type != node.type) {\n        state.write(\"\\\\\\n\")\n        return\n      }\n  },\n  text(state, node) {\n    state.text(node.text)\n  }\n}, {\n  em: {open: \"*\", close: \"*\", mixable: true, expelEnclosingWhitespace: true},\n  strong: {open: \"**\", close: \"**\", mixable: true, expelEnclosingWhitespace: true},\n  link: {\n    open(_state, mark, parent, index) {\n      return isPlainURL(mark, parent, index, 1) ? \"<\" : \"[\"\n    },\n    close(state, mark, parent, index) {\n      return isPlainURL(mark, parent, index, -1) ? \">\"\n        : \"](\" + mark.attrs.href + (mark.attrs.title ? ' \"' + mark.attrs.title.replace(/\"/g, '\\\\\"') + '\"' : \"\") + \")\"\n    }\n  },\n  code: {open(_state, _mark, parent, index) { return backticksFor(parent.child(index), -1) },\n         close(_state, _mark, parent, index) { return backticksFor(parent.child(index - 1), 1) },\n         escape: false}\n})\n\nfunction backticksFor(node, side) {\n  let ticks = /`+/g, m, len = 0\n  if (node.isText) while (m = ticks.exec(node.text)) len = Math.max(len, m[0].length)\n  let result = len > 0 && side > 0 ? \" `\" : \"`\"\n  for (let i = 0; i < len; i++) result += \"`\"\n  if (len > 0 && side < 0) result += \" \"\n  return result\n}\n\nfunction isPlainURL(link, parent, index, side) {\n  if (link.attrs.title || !/^\\w+:/.test(link.attrs.href)) return false\n  let content = parent.child(index + (side < 0 ? -1 : 0))\n  if (!content.isText || content.text != link.attrs.href || content.marks[content.marks.length - 1] != link) return false\n  if (index == (side < 0 ? 1 : parent.childCount - 1)) return true\n  let next = parent.child(index + (side < 0 ? -2 : 1))\n  return !link.isInSet(next.marks)\n}\n\n// ::- This is an object used to track state and expose\n// methods related to markdown serialization. Instances are passed to\n// node and mark serialization methods (see `toMarkdown`).\nexport class MarkdownSerializerState {\n  constructor(nodes, marks, options) {\n    this.nodes = nodes\n    this.marks = marks\n    this.delim = this.out = \"\"\n    this.closed = false\n    this.inTightList = false\n    // :: Object\n    // The options passed to the serializer.\n    //   tightLists:: ?bool\n    //   Whether to render lists in a tight style. This can be overridden\n    //   on a node level by specifying a tight attribute on the node.\n    //   Defaults to false.\n    this.options = options || {}\n    if (typeof this.options.tightLists == \"undefined\")\n      this.options.tightLists = false\n  }\n\n  flushClose(size) {\n    if (this.closed) {\n      if (!this.atBlank()) this.out += \"\\n\"\n      if (size == null) size = 2\n      if (size > 1) {\n        let delimMin = this.delim\n        let trim = /\\s+$/.exec(delimMin)\n        if (trim) delimMin = delimMin.slice(0, delimMin.length - trim[0].length)\n        for (let i = 1; i < size; i++)\n          this.out += delimMin + \"\\n\"\n      }\n      this.closed = false\n    }\n  }\n\n  // :: (string, ?string, Node, ())\n  // Render a block, prefixing each line with `delim`, and the first\n  // line in `firstDelim`. `node` should be the node that is closed at\n  // the end of the block, and `f` is a function that renders the\n  // content of the block.\n  wrapBlock(delim, firstDelim, node, f) {\n    let old = this.delim\n    this.write(firstDelim || delim)\n    this.delim += delim\n    f()\n    this.delim = old\n    this.closeBlock(node)\n  }\n\n  atBlank() {\n    return /(^|\\n)$/.test(this.out)\n  }\n\n  // :: ()\n  // Ensure the current content ends with a newline.\n  ensureNewLine() {\n    if (!this.atBlank()) this.out += \"\\n\"\n  }\n\n  // :: (?string)\n  // Prepare the state for writing output (closing closed paragraphs,\n  // adding delimiters, and so on), and then optionally add content\n  // (unescaped) to the output.\n  write(content) {\n    this.flushClose()\n    if (this.delim && this.atBlank())\n      this.out += this.delim\n    if (content) this.out += content\n  }\n\n  // :: (Node)\n  // Close the block for the given node.\n  closeBlock(node) {\n    this.closed = node\n  }\n\n  // :: (string, ?bool)\n  // Add the given text to the document. When escape is not `false`,\n  // it will be escaped.\n  text(text, escape) {\n    let lines = text.split(\"\\n\")\n    for (let i = 0; i < lines.length; i++) {\n      var startOfLine = this.atBlank() || this.closed\n      this.write()\n      this.out += escape !== false ? this.esc(lines[i], startOfLine) : lines[i]\n      if (i != lines.length - 1) this.out += \"\\n\"\n    }\n  }\n\n  // :: (Node)\n  // Render the given node as a block.\n  render(node, parent, index) {\n    if (typeof parent == \"number\") throw new Error(\"!\")\n    if (!this.nodes[node.type.name]) throw new Error(\"Token type `\" + node.type.name + \"` not supported by Markdown renderer\")\n    this.nodes[node.type.name](this, node, parent, index)\n  }\n\n  // :: (Node)\n  // Render the contents of `parent` as block nodes.\n  renderContent(parent) {\n    parent.forEach((node, _, i) => this.render(node, parent, i))\n  }\n\n  // :: (Node)\n  // Render the contents of `parent` as inline content.\n  renderInline(parent) {\n    let active = [], trailing = \"\"\n    let progress = (node, _, index) => {\n      let marks = node ? node.marks : []\n\n      // Remove marks from `hard_break` that are the last node inside\n      // that mark to prevent parser edge cases with new lines just\n      // before closing marks.\n      // (FIXME it'd be nice if we had a schema-agnostic way to\n      // identify nodes that serialize as hard breaks)\n      if (node && node.type.name === \"hard_break\")\n        marks = marks.filter(m => {\n          if (index + 1 == parent.childCount) return false\n          let next = parent.child(index + 1)\n          return m.isInSet(next.marks) && (!next.isText || /\\S/.test(next.text))\n        })\n\n      let leading = trailing\n      trailing = \"\"\n      // If whitespace has to be expelled from the node, adjust\n      // leading and trailing accordingly.\n      if (node && node.isText && marks.some(mark => {\n        let info = this.marks[mark.type.name]\n        return info && info.expelEnclosingWhitespace\n      })) {\n        let [_, lead, inner, trail] = /^(\\s*)(.*?)(\\s*)$/m.exec(node.text)\n        leading += lead\n        trailing = trail\n        if (lead || trail) {\n          node = inner ? node.withText(inner) : null\n          if (!node) marks = active\n        }\n      }\n\n      let inner = marks.length && marks[marks.length - 1], noEsc = inner && this.marks[inner.type.name].escape === false\n      let len = marks.length - (noEsc ? 1 : 0)\n\n      // Try to reorder 'mixable' marks, such as em and strong, which\n      // in Markdown may be opened and closed in different order, so\n      // that order of the marks for the token matches the order in\n      // active.\n      outer: for (let i = 0; i < len; i++) {\n        let mark = marks[i]\n        if (!this.marks[mark.type.name].mixable) break\n        for (let j = 0; j < active.length; j++) {\n          let other = active[j]\n          if (!this.marks[other.type.name].mixable) break\n          if (mark.eq(other)) {\n            if (i > j)\n              marks = marks.slice(0, j).concat(mark).concat(marks.slice(j, i)).concat(marks.slice(i + 1, len))\n            else if (j > i)\n              marks = marks.slice(0, i).concat(marks.slice(i + 1, j)).concat(mark).concat(marks.slice(j, len))\n            continue outer\n          }\n        }\n      }\n\n      // Find the prefix of the mark set that didn't change\n      let keep = 0\n      while (keep < Math.min(active.length, len) && marks[keep].eq(active[keep])) ++keep\n\n      // Close the marks that need to be closed\n      while (keep < active.length)\n        this.text(this.markString(active.pop(), false, parent, index), false)\n\n      // Output any previously expelled trailing whitespace outside the marks\n      if (leading) this.text(leading)\n\n      // Open the marks that need to be opened\n      if (node) {\n        while (active.length < len) {\n          let add = marks[active.length]\n          active.push(add)\n          this.text(this.markString(add, true, parent, index), false)\n        }\n\n        // Render the node. Special case code marks, since their content\n        // may not be escaped.\n        if (noEsc && node.isText)\n          this.text(this.markString(inner, true, parent, index) + node.text +\n                    this.markString(inner, false, parent, index + 1), false)\n        else\n          this.render(node, parent, index)\n      }\n    }\n    parent.forEach(progress)\n    progress(null, null, parent.childCount)\n  }\n\n  // :: (Node, string, (number) → string)\n  // Render a node's content as a list. `delim` should be the extra\n  // indentation added to all lines except the first in an item,\n  // `firstDelim` is a function going from an item index to a\n  // delimiter for the first line of the item.\n  renderList(node, delim, firstDelim) {\n    if (this.closed && this.closed.type == node.type)\n      this.flushClose(3)\n    else if (this.inTightList)\n      this.flushClose(1)\n\n    let isTight = typeof node.attrs.tight != \"undefined\" ? node.attrs.tight : this.options.tightLists\n    let prevTight = this.inTightList\n    this.inTightList = isTight\n    node.forEach((child, _, i) => {\n      if (i && isTight) this.flushClose(1)\n      this.wrapBlock(delim, firstDelim(i), node, () => this.render(child, node, i))\n    })\n    this.inTightList = prevTight\n  }\n\n  // :: (string, ?bool) → string\n  // Escape the given string so that it can safely appear in Markdown\n  // content. If `startOfLine` is true, also escape characters that\n  // have special meaning only at the start of the line.\n  esc(str, startOfLine) {\n    str = str.replace(\n      /[`*\\\\~\\[\\]_]/g, \n      (m, i) => m == \"_\" && i > 0 && i + 1 < str.length && str[i-1].match(/\\w/) && str[i+1].match(/\\w/) ?  m : \"\\\\\" + m\n    )\n    if (startOfLine) str = str.replace(/^[:#\\-*+>]/, \"\\\\$&\").replace(/^(\\s*\\d+)\\./, \"$1\\\\.\")\n    if (this.options.escapeExtraCharacters) str = str.replace(this.options.escapeExtraCharacters, \"\\\\$&\")\n    return str\n  }\n\n  quote(str) {\n    var wrap = str.indexOf('\"') == -1 ? '\"\"' : str.indexOf(\"'\") == -1 ? \"''\" : \"()\"\n    return wrap[0] + str + wrap[1]\n  }\n\n  // :: (string, number) → string\n  // Repeat the given string `n` times.\n  repeat(str, n) {\n    let out = \"\"\n    for (let i = 0; i < n; i++) out += str\n    return out\n  }\n\n  // : (Mark, bool, string?) → string\n  // Get the markdown string for a given opening or closing mark.\n  markString(mark, open, parent, index) {\n    let info = this.marks[mark.type.name]\n    let value = open ? info.open : info.close\n    return typeof value == \"string\" ? value : value(this, mark, parent, index)\n  }\n\n  // :: (string) → { leading: ?string, trailing: ?string }\n  // Get leading and trailing whitespace from a string. Values of\n  // leading or trailing property of the return object will be undefined\n  // if there is no match.\n  getEnclosingWhitespace(text) {\n    return {\n      leading: (text.match(/^(\\s+)/) || [])[0],\n      trailing: (text.match(/(\\s+)$/) || [])[0]\n    }\n  }\n}\n","import {findWrapping, liftTarget, canSplit, ReplaceAroundStep} from \"prosemirror-transform\"\nimport {Slice, Fragment, NodeRange} from \"prosemirror-model\"\n\nconst olDOM = [\"ol\", 0], ulDOM = [\"ul\", 0], liDOM = [\"li\", 0]\n\n// :: NodeSpec\n// An ordered list [node spec](#model.NodeSpec). Has a single\n// attribute, `order`, which determines the number at which the list\n// starts counting, and defaults to 1. Represented as an `<ol>`\n// element.\nexport const orderedList = {\n  attrs: {order: {default: 1}},\n  parseDOM: [{tag: \"ol\", getAttrs(dom) {\n    return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1}\n  }}],\n  toDOM(node) {\n    return node.attrs.order == 1 ? olDOM : [\"ol\", {start: node.attrs.order}, 0]\n  }\n}\n\n// :: NodeSpec\n// A bullet list node spec, represented in the DOM as `<ul>`.\nexport const bulletList = {\n  parseDOM: [{tag: \"ul\"}],\n  toDOM() { return ulDOM }\n}\n\n// :: NodeSpec\n// A list item (`<li>`) spec.\nexport const listItem = {\n  parseDOM: [{tag: \"li\"}],\n  toDOM() { return liDOM },\n  defining: true\n}\n\nfunction add(obj, props) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  for (let prop in props) copy[prop] = props[prop]\n  return copy\n}\n\n// :: (OrderedMap<NodeSpec>, string, ?string) → OrderedMap<NodeSpec>\n// Convenience function for adding list-related node types to a map\n// specifying the nodes for a schema. Adds\n// [`orderedList`](#schema-list.orderedList) as `\"ordered_list\"`,\n// [`bulletList`](#schema-list.bulletList) as `\"bullet_list\"`, and\n// [`listItem`](#schema-list.listItem) as `\"list_item\"`.\n//\n// `itemContent` determines the content expression for the list items.\n// If you want the commands defined in this module to apply to your\n// list structure, it should have a shape like `\"paragraph block*\"` or\n// `\"paragraph (ordered_list | bullet_list)*\"`. `listGroup` can be\n// given to assign a group name to the list node types, for example\n// `\"block\"`.\nexport function addListNodes(nodes, itemContent, listGroup) {\n  return nodes.append({\n    ordered_list: add(orderedList, {content: \"list_item+\", group: listGroup}),\n    bullet_list: add(bulletList, {content: \"list_item+\", group: listGroup}),\n    list_item: add(listItem, {content: itemContent})\n  })\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command function that wraps the selection in a list with\n// the given type an attributes. If `dispatch` is null, only return a\n// value to indicate whether this is possible, but don't actually\n// perform the change.\nexport function wrapInList(listType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), doJoin = false, outerRange = range\n    if (!range) return false\n    // This is at the top of an existing list item\n    if (range.depth >= 2 && $from.node(range.depth - 1).type.compatibleContent(listType) && range.startIndex == 0) {\n      // Don't do anything if this is the top of the list\n      if ($from.index(range.depth - 1) == 0) return false\n      let $insert = state.doc.resolve(range.start - 2)\n      outerRange = new NodeRange($insert, $insert, range.depth)\n      if (range.endIndex < range.parent.childCount)\n        range = new NodeRange($from, state.doc.resolve($to.end(range.depth)), range.depth)\n      doJoin = true\n    }\n    let wrap = findWrapping(outerRange, listType, attrs, range)\n    if (!wrap) return false\n    if (dispatch) dispatch(doWrapInList(state.tr, range, wrap, doJoin, listType).scrollIntoView())\n    return true\n  }\n}\n\nfunction doWrapInList(tr, range, wrappers, joinBefore, listType) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--)\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n\n  tr.step(new ReplaceAroundStep(range.start - (joinBefore ? 2 : 0), range.end, range.start, range.end,\n                                new Slice(content, 0, 0), wrappers.length, true))\n\n  let found = 0\n  for (let i = 0; i < wrappers.length; i++) if (wrappers[i].type == listType) found = i + 1\n  let splitDepth = wrappers.length - found\n\n  let splitPos = range.start + wrappers.length - (joinBefore ? 2 : 0), parent = range.parent\n  for (let i = range.startIndex, e = range.endIndex, first = true; i < e; i++, first = false) {\n    if (!first && canSplit(tr.doc, splitPos, splitDepth)) {\n      tr.split(splitPos, splitDepth)\n      splitPos += 2 * splitDepth\n    }\n    splitPos += parent.child(i).nodeSize\n  }\n  return tr\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Build a command that splits a non-empty textblock at the top level\n// of a list item by also splitting that list item.\nexport function splitListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to, node} = state.selection\n    if ((node && node.isBlock) || $from.depth < 2 || !$from.sameParent($to)) return false\n    let grandParent = $from.node(-1)\n    if (grandParent.type != itemType) return false\n    if ($from.parent.content.size == 0 && $from.node(-1).childCount == $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType ||\n          $from.index(-2) != $from.node(-2).childCount - 1) return false\n      if (dispatch) {\n        let wrap = Fragment.empty\n        let depthBefore = $from.index(-1) ? 1 : $from.index(-2) ? 2 : 3\n        // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n        for (let d = $from.depth - depthBefore; d >= $from.depth - 3; d--)\n          wrap = Fragment.from($from.node(d).copy(wrap))\n        let depthAfter = $from.indexAfter(-1) < $from.node(-2).childCount ? 1\n            : $from.indexAfter(-2) < $from.node(-3).childCount ? 2 : 3\n        // Add a second list item with an empty default start node\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()))\n        let start = $from.before($from.depth - (depthBefore - 1))\n        let tr = state.tr.replace(start, $from.after(-depthAfter), new Slice(wrap, 4 - depthBefore, 0))\n        let sel = -1\n        tr.doc.nodesBetween(start, tr.doc.content.size, (node, pos) => {\n          if (sel > -1) return false\n          if (node.isTextblock && node.content.size == 0) sel = pos + 1\n        })\n        if (sel > -1) tr.setSelection(state.selection.constructor.near(tr.doc.resolve(sel)))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n    let nextType = $to.pos == $from.end() ? grandParent.contentMatchAt(0).defaultType : null\n    let tr = state.tr.delete($from.pos, $to.pos)\n    let types = nextType && [null, {type: nextType}]\n    if (!canSplit(tr.doc, $from.pos, 2, types)) return false\n    if (dispatch) dispatch(tr.split($from.pos, 2, types).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to lift the list item around the selection up into\n// a wrapping list.\nexport function liftListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    if (!dispatch) return true\n    if ($from.node(range.depth - 1).type == itemType) // Inside a parent list\n      return liftToOuterList(state, dispatch, itemType, range)\n    else // Outer list node\n      return liftOutOfList(state, dispatch, range)\n  }\n}\n\nfunction liftToOuterList(state, dispatch, itemType, range) {\n  let tr = state.tr, end = range.end, endOfList = range.$to.end(range.depth)\n  if (end < endOfList) {\n    // There are siblings after the lifted items, which must become\n    // children of the last item\n    tr.step(new ReplaceAroundStep(end - 1, endOfList, end, endOfList,\n                                  new Slice(Fragment.from(itemType.create(null, range.parent.copy())), 1, 0), 1, true))\n    range = new NodeRange(tr.doc.resolve(range.$from.pos), tr.doc.resolve(endOfList), range.depth)\n  }\n  dispatch(tr.lift(range, liftTarget(range)).scrollIntoView())\n  return true\n}\n\nfunction liftOutOfList(state, dispatch, range) {\n  let tr = state.tr, list = range.parent\n  // Merge the list items into a single big item\n  for (let pos = range.end, i = range.endIndex - 1, e = range.startIndex; i > e; i--) {\n    pos -= list.child(i).nodeSize\n    tr.delete(pos - 1, pos + 1)\n  }\n  let $start = tr.doc.resolve(range.start), item = $start.nodeAfter\n  if (tr.mapping.map(range.end) != range.start + $start.nodeAfter.nodeSize) return false\n  let atStart = range.startIndex == 0, atEnd = range.endIndex == list.childCount\n  let parent = $start.node(-1), indexBefore = $start.index(-1)\n  if (!parent.canReplace(indexBefore + (atStart ? 0 : 1), indexBefore + 1,\n                         item.content.append(atEnd ? Fragment.empty : Fragment.from(list))))\n    return false\n  let start = $start.pos, end = start + item.nodeSize\n  // Strip off the surrounding list. At the sides where we're not at\n  // the end of the list, the existing list is closed. At sides where\n  // this is the end, it is overwritten to its end.\n  tr.step(new ReplaceAroundStep(start - (atStart ? 1 : 0), end + (atEnd ? 1 : 0), start + 1, end - 1,\n                                new Slice((atStart ? Fragment.empty : Fragment.from(list.copy(Fragment.empty)))\n                                          .append(atEnd ? Fragment.empty : Fragment.from(list.copy(Fragment.empty))),\n                                          atStart ? 0 : 1, atEnd ? 0 : 1), atStart ? 0 : 1))\n  dispatch(tr.scrollIntoView())\n  return true\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to sink the list item around the selection down\n// into an inner list.\nexport function sinkListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    let startIndex = range.startIndex\n    if (startIndex == 0) return false\n    let parent = range.parent, nodeBefore = parent.child(startIndex - 1)\n    if (nodeBefore.type != itemType) return false\n\n    if (dispatch) {\n      let nestedBefore = nodeBefore.lastChild && nodeBefore.lastChild.type == parent.type\n      let inner = Fragment.from(nestedBefore ? itemType.create() : null)\n      let slice = new Slice(Fragment.from(itemType.create(null, Fragment.from(parent.type.create(null, inner)))),\n                            nestedBefore ? 3 : 1, 0)\n      let before = range.start, after = range.end\n      dispatch(state.tr.step(new ReplaceAroundStep(before - (nestedBefore ? 3 : 1), after,\n                                                   before, after, slice, 1, true))\n               .scrollIntoView())\n    }\n    return true\n  }\n}\n","module.exports = flarum.core.compat['common/components/Tooltip'];","import Component from 'flarum/common/Component';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default class CommandButton extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.state = this.attrs.state;\n    this.state.addItem(this.attrs.type, this.attrs.command, this.onEditorUpdate.bind(this));\n  }\n\n  view() {\n    return (\n      <Tooltip text={extractText(this.attrs.tooltip)}>\n        <button className=\"Button Button--icon Button--link CommandButton\" onclick={this.click.bind(this)} onkeydown={this.keydown.bind(this)}>\n          {icon(this.attrs.icon)}\n        </button>\n      </Tooltip>\n    );\n  }\n\n  keydown(e) {\n    if (e.key === ' ' || e.key === 'Enter') {\n      this.click(e);\n    }\n  }\n\n  click(e) {\n    e.preventDefault();\n    return this.state.run(this.attrs.type);\n  }\n\n  title() {\n    let tooltip = app.translator.trans(`askvortsov-rich-text.lib.composer.${this.attrs.type}_tooltip`);\n\n    return tooltip;\n  }\n\n  onEditorUpdate() {}\n}\n","module.exports = flarum.core.compat['common/utils/extractText'];","\n    /*!\n    * tiptap-utils v1.13.0\n    * (c) 2021 überdosis GbR (limited liability)\n    * @license MIT\n    */\n  \nimport { NodeSelection } from 'prosemirror-state';\n\nfunction createCell(cellType, cellContent) {\n  if (cellContent) {\n    return cellType.createChecked(null, cellContent);\n  }\n\n  return cellType.createAndFill();\n}\n\nfunction getTableNodeTypes(schema) {\n  if (schema.cached.tableNodeTypes) {\n    return schema.cached.tableNodeTypes;\n  }\n\n  const roles = {};\n  Object.keys(schema.nodes).forEach(type => {\n    const nodeType = schema.nodes[type];\n\n    if (nodeType.spec.tableRole) {\n      roles[nodeType.spec.tableRole] = nodeType;\n    }\n  }); // eslint-disable-next-line\n\n  schema.cached.tableNodeTypes = roles;\n  return roles;\n}\n\nfunction createTable(schema, rowsCount, colsCount, withHeaderRow, cellContent) {\n  const types = getTableNodeTypes(schema);\n  const headerCells = [];\n  const cells = [];\n\n  for (let index = 0; index < colsCount; index += 1) {\n    const cell = createCell(types.cell, cellContent);\n\n    if (cell) {\n      cells.push(cell);\n    }\n\n    if (withHeaderRow) {\n      const headerCell = createCell(types.header_cell, cellContent);\n\n      if (headerCell) {\n        headerCells.push(headerCell);\n      }\n    }\n  }\n\n  const rows = [];\n\n  for (let index = 0; index < rowsCount; index += 1) {\n    rows.push(types.row.createChecked(null, withHeaderRow && index === 0 ? headerCells : cells));\n  }\n\n  return types.table.createChecked(null, rows);\n}\n\nfunction equalNodeType(nodeType, node) {\n  return Array.isArray(nodeType) && nodeType.indexOf(node.type) > -1 || node.type === nodeType;\n}\n\nfunction flatten(node) {\n  // eslint-disable-next-line\n  const descend = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (!node) {\n    throw new Error('Invalid \"node\" parameter');\n  }\n\n  const result = []; // eslint-disable-next-line\n\n  node.descendants((child, pos) => {\n    result.push({\n      node: child,\n      pos\n    });\n\n    if (!descend) {\n      return false;\n    }\n  });\n  return result;\n}\n\nfunction findChildren(node, predicate, descend) {\n  if (!node) {\n    throw new Error('Invalid \"node\" parameter');\n  } else if (!predicate) {\n    throw new Error('Invalid \"predicate\" parameter');\n  }\n\n  return flatten(node, descend).filter(child => predicate(child.node));\n}\n\nfunction findBlockNodes(node, descend) {\n  return findChildren(node, child => child.isBlock, descend);\n}\n\n// eslint-disable-next-line\nfunction findParentNodeClosestToPos($pos, predicate) {\n  for (let i = $pos.depth; i > 0; i -= 1) {\n    const node = $pos.node(i);\n\n    if (predicate(node)) {\n      return {\n        pos: i > 0 ? $pos.before(i) : 0,\n        start: $pos.start(i),\n        depth: i,\n        node\n      };\n    }\n  }\n}\n\nfunction findParentNode(predicate) {\n  return selection => findParentNodeClosestToPos(selection.$from, predicate);\n}\n\nfunction isNodeSelection(selection) {\n  return selection instanceof NodeSelection;\n}\n\nfunction findSelectedNodeOfType(nodeType) {\n  // eslint-disable-next-line\n  return function (selection) {\n    if (isNodeSelection(selection)) {\n      const {\n        node\n      } = selection;\n      const {\n        $from\n      } = selection;\n\n      if (equalNodeType(nodeType, node)) {\n        return {\n          node,\n          pos: $from.pos,\n          depth: $from.depth\n        };\n      }\n    }\n  };\n}\n\nfunction getMarkAttrs(state, type) {\n  const {\n    from,\n    to\n  } = state.selection;\n  let marks = [];\n  state.doc.nodesBetween(from, to, node => {\n    marks = [...marks, ...node.marks];\n  });\n  const mark = marks.find(markItem => markItem.type.name === type.name);\n\n  if (mark) {\n    return mark.attrs;\n  }\n\n  return {};\n}\n\nfunction getMarkRange($pos = null, type = null) {\n  if (!$pos || !type) {\n    return false;\n  }\n\n  const start = $pos.parent.childAfter($pos.parentOffset);\n\n  if (!start.node) {\n    return false;\n  }\n\n  const link = start.node.marks.find(mark => mark.type === type);\n\n  if (!link) {\n    return false;\n  }\n\n  let startIndex = $pos.index();\n  let startPos = $pos.start() + start.offset;\n  let endIndex = startIndex + 1;\n  let endPos = startPos + start.node.nodeSize;\n\n  while (startIndex > 0 && link.isInSet($pos.parent.child(startIndex - 1).marks)) {\n    startIndex -= 1;\n    startPos -= $pos.parent.child(startIndex).nodeSize;\n  }\n\n  while (endIndex < $pos.parent.childCount && link.isInSet($pos.parent.child(endIndex).marks)) {\n    endPos += $pos.parent.child(endIndex).nodeSize;\n    endIndex += 1;\n  }\n\n  return {\n    from: startPos,\n    to: endPos\n  };\n}\n\nfunction getNodeAttrs(state, type) {\n  const {\n    from,\n    to\n  } = state.selection;\n  let nodes = [];\n  state.doc.nodesBetween(from, to, node => {\n    nodes = [...nodes, node];\n  });\n  const node = nodes.reverse().find(nodeItem => nodeItem.type.name === type.name);\n\n  if (node) {\n    return node.attrs;\n  }\n\n  return {};\n}\n\nfunction markIsActive(state, type) {\n  const {\n    from,\n    $from,\n    to,\n    empty\n  } = state.selection;\n\n  if (empty) {\n    return !!type.isInSet(state.storedMarks || $from.marks());\n  }\n\n  return !!state.doc.rangeHasMark(from, to, type);\n}\n\nfunction nodeEqualsType({\n  types,\n  node\n}) {\n  return Array.isArray(types) && types.includes(node.type) || node.type === types;\n}\n\nfunction nodeIsActive(state, type, attrs = {}) {\n  const predicate = node => node.type === type;\n\n  const node = findSelectedNodeOfType(type)(state.selection) || findParentNode(predicate)(state.selection);\n\n  if (!Object.keys(attrs).length || !node) {\n    return !!node;\n  }\n\n  return node.node.hasMarkup(type, { ...node.node.attrs,\n    ...attrs\n  });\n}\n\nexport { createCell, createTable, equalNodeType, findBlockNodes, findChildren, findParentNode, findParentNodeClosestToPos, findSelectedNodeOfType, flatten, getMarkAttrs, getMarkRange, getNodeAttrs, getTableNodeTypes, isNodeSelection, markIsActive, nodeEqualsType, nodeIsActive };\n","import { toggleMark } from 'tiptap-commands';\nimport CommandButton from './CommandButton';\n\nexport default class MarkButton extends CommandButton {\n  static initAttrs(attrs) {\n    attrs.command = toggleMark(attrs.mark);\n  }\n\n  onEditorUpdate() {\n    this.$().toggleClass('active', !!this.state.markActive(this.attrs.mark));\n  }\n}\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\",\n  229: \"q\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\",\n  229: \"Q\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar safari = typeof navigator != \"undefined\" && /Apple Computer/.test(navigator.vendor)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = chrome && (mac || +chrome[1] < 57) || gecko && mac\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  // Don't trust event.key in Chrome when there are modifiers until\n  // they fix https://bugs.chromium.org/p/chromium/issues/detail?id=633838\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    (safari || ie) && event.shiftKey && event.key && event.key.length == 1\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import {base, keyName} from \"w3c-keyname\"\nimport {Plugin} from \"prosemirror-state\"\n\n// declare global: navigator\n\nconst mac = typeof navigator != \"undefined\" ? /Mac|iP(hone|[oa]d)/.test(navigator.platform) : false\n\nfunction normalizeKeyName(name) {\n  let parts = name.split(/-(?!$)/), result = parts[parts.length - 1]\n  if (result == \"Space\") result = \" \"\n  let alt, ctrl, shift, meta\n  for (let i = 0; i < parts.length - 1; i++) {\n    let mod = parts[i]\n    if (/^(cmd|meta|m)$/i.test(mod)) meta = true\n    else if (/^a(lt)?$/i.test(mod)) alt = true\n    else if (/^(c|ctrl|control)$/i.test(mod)) ctrl = true\n    else if (/^s(hift)?$/i.test(mod)) shift = true\n    else if (/^mod$/i.test(mod)) { if (mac) meta = true; else ctrl = true }\n    else throw new Error(\"Unrecognized modifier name: \" + mod)\n  }\n  if (alt) result = \"Alt-\" + result\n  if (ctrl) result = \"Ctrl-\" + result\n  if (meta) result = \"Meta-\" + result\n  if (shift) result = \"Shift-\" + result\n  return result\n}\n\nfunction normalize(map) {\n  let copy = Object.create(null)\n  for (let prop in map) copy[normalizeKeyName(prop)] = map[prop]\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) name = \"Alt-\" + name\n  if (event.ctrlKey) name = \"Ctrl-\" + name\n  if (event.metaKey) name = \"Meta-\" + name\n  if (shift !== false && event.shiftKey) name = \"Shift-\" + name\n  return name\n}\n\n// :: (Object) → Plugin\n// Create a keymap plugin for the given set of bindings.\n//\n// Bindings should map key names to [command](#commands)-style\n// functions, which will be called with `(EditorState, dispatch,\n// EditorView)` arguments, and should return true when they've handled\n// the key. Note that the view argument isn't part of the command\n// protocol, but can be used as an escape hatch if a binding needs to\n// directly interact with the UI.\n//\n// Key names may be strings like `\"Shift-Ctrl-Enter\"`—a key\n// identifier prefixed with zero or more modifiers. Key identifiers\n// are based on the strings that can appear in\n// [`KeyEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key).\n// Use lowercase letters to refer to letter keys (or uppercase letters\n// if you want shift to be held). You may use `\"Space\"` as an alias\n// for the `\" \"` name.\n//\n// Modifiers can be given in any order. `Shift-` (or `s-`), `Alt-` (or\n// `a-`), `Ctrl-` (or `c-` or `Control-`) and `Cmd-` (or `m-` or\n// `Meta-`) are recognized. For characters that are created by holding\n// shift, the `Shift-` prefix is implied, and should not be added\n// explicitly.\n//\n// You can use `Mod-` as a shorthand for `Cmd-` on Mac and `Ctrl-` on\n// other platforms.\n//\n// You can add multiple keymap plugins to an editor. The order in\n// which they appear determines their precedence (the ones early in\n// the array get to dispatch first).\nexport function keymap(bindings) {\n  return new Plugin({props: {handleKeyDown: keydownHandler(bindings)}})\n}\n\n// :: (Object) → (view: EditorView, event: dom.Event) → bool\n// Given a set of bindings (using the same format as\n// [`keymap`](#keymap.keymap)), return a [keydown\n// handler](#view.EditorProps.handleKeyDown) that handles them.\nexport function keydownHandler(bindings) {\n  let map = normalize(bindings)\n  return function(view, event) {\n    let name = keyName(event), isChar = name.length == 1 && name != \" \", baseName\n    let direct = map[modifiers(name, event, !isChar)]\n    if (direct && direct(view.state, view.dispatch, view)) return true\n    if (isChar && (event.shiftKey || event.altKey || event.metaKey || name.charCodeAt(0) > 127) &&\n        (baseName = base[event.keyCode]) && baseName != name) {\n      // Try falling back to the keyCode when there's a modifier\n      // active or the character produced isn't ASCII, and our table\n      // produces a different name from the the keyCode. See #668,\n      // #1060\n      let fromCode = map[modifiers(baseName, event, true)]\n      if (fromCode && fromCode(view.state, view.dispatch, view)) return true\n    } else if (isChar && event.shiftKey) {\n      // Otherwise, if shift is active, also try the binding with the\n      // Shift- prefix enabled. See #997\n      let withShift = map[modifiers(name, event, true)]\n      if (withShift && withShift(view.state, view.dispatch, view)) return true\n    }\n    return false\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/components/Dropdown'];","import Modal from 'flarum/common/components/Modal';\n\nexport default class SafariModalHack extends Modal {\n  className() {\n    return 'LoadingModal Modal--small';\n  }\n\n  title() {\n    return this.attrs.title;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.$('.CommandButton').on('click', () => {\n      app.modal.close();\n    });\n  }\n\n  content() {\n    const onsubmit = this.attrs.onsubmit ? this.attrs.onsubmit.bind(this) : () => {};\n    return (\n      <div className=\"Modal-body\">\n        <form className=\"Form\" onsubmit={onsubmit}>\n          {this.attrs.vnodeContent}\n        </form>\n      </div>\n    );\n  }\n}\n","import Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SafariModalHack from './SafariModalHack';\n\nexport default class FormDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    attrs.buttonClassName = 'Button Button--icon Button--link Button--menuDropdown';\n  }\n\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.state = this.attrs.state;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.$().on('click', (e) => {\n      if ($('.App').is('.mobile-safari')) {\n        // Mobile Safari doesn't support fixed items\n        // So, we wrap them in a modal.\n        app.modal.show(SafariModalHack, {\n          title: this.attrs.tooltip,\n          vnodeContent: this.fields().toArray(),\n          onsubmit: this.onsubmit.bind(this),\n        });\n        e.stopPropagation();\n      }\n    });\n\n    this.$().on('shown.bs.dropdown', () => {\n      this.$('.Dropdown-menu').find('input, select, textarea').first().focus().select();\n    });\n  }\n\n  getButtonContent(children) {\n    return (\n      <Tooltip text={this.attrs.tooltip}>\n        <span>{icon(this.attrs.icon)}</span>\n      </Tooltip>\n    );\n  }\n\n  getMenu(items) {\n    return (\n      <ul className={'Dropdown-menu dropdown-menu FormDropdown'}>\n        <form className=\"Form\" onsubmit={this.onsubmit.bind(this)}>\n          {this.fields().toArray()}\n        </form>\n      </ul>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'insert',\n      <Button type=\"submit\" className=\"Button Button--primary\">\n        {app.translator.trans('askvortsov-rich-text.lib.composer.insert_button')}\n      </Button>\n    );\n\n    return items;\n  }\n\n  onsubmit(e) {\n    // Here for the safari workaround\n    app.modal.close();\n    e.preventDefault();\n    $('body').trigger('click');\n    this.insert(e);\n    app.composer.editor.focus();\n  }\n\n  insert(e) {}\n}\n","module.exports = flarum.core.compat['common/extend'];","module.exports=/[!-#%-\\*,-\\/:;\\?@\\[-\\]_\\{\\}\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4E\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F]/","import CommandButton from './CommandButton';\nimport { toggleList } from 'tiptap-commands';\n\nexport default class ListButton extends CommandButton {\n  oninit(vnode) {\n    vnode.attrs.command = (state, dispatch) => {\n      return toggleList(vnode.attrs.listType, this.active ? state.schema.nodes.list_item : undefined)(state, dispatch);\n    };\n\n    super.oninit(vnode);\n  }\n\n  onEditorUpdate() {\n    this.active = !!this.state.nodeActive(this.attrs.listType);\n    this.$().toggleClass('active', this.active);\n  }\n}\n","module.exports = flarum.core.compat['common/components/TextEditor'];","'use strict';\n\n\nmodule.exports.encode = require('./encode');\nmodule.exports.decode = require('./decode');\nmodule.exports.format = require('./format');\nmodule.exports.parse  = require('./parse');\n","import { defaultMarkdownSerializer, MarkdownSerializer, MarkdownSerializerState } from 'prosemirror-markdown';\n\n/**\n * COPIED FROM https://github.com/StackExchange/Stacks-Editor/blob/main/src/rich-text/markdown-serializer.ts\n *\n * Generates a config from a base config that is aware of special \"markup\" added by the markdown tokenizer;\n * typically this will be differences in how markdown can be written (e.g. * vs _ for emphasis),\n * but could also be html tags from our extended html support plugin (e.g. * vs <em> for emphasis)\n * @param config The base config to extend\n */\nfunction genMarkupAwareMarkConfig(config) {\n  // we don't support function open/close since these could have fairly complicated logic in them\n  if (config.open instanceof Function || config.close instanceof Function) {\n    // log an error to the console and return the unmodified base config\n    error('markdown-serializer genMarkupAwareMarkSpec', 'Unable to extend mark config with open/close as functions', config);\n    return config;\n  }\n\n  return {\n    ...config,\n    open(_, mark) {\n      const markup = mark.attrs.markup;\n      return markup || config.open;\n    },\n    close(_, mark) {\n      let markup = mark.attrs.markup;\n      // insert the `/` on html closing tags\n      markup = /^<[a-z]+>$/i.test(markup) ? markup.replace(/^</, '</') : markup;\n      return markup || config.close;\n    },\n  };\n}\n\nMarkdownSerializerState.prototype.esc = function (str, startOfLine) {\n  str = str.replace(/[`*\\\\~]/g, '\\\\$&');\n  if (startOfLine) str = str.replace(/^[#\\-*+]/, '\\\\$&').replace(/^(\\s*\\d+)\\./, '$1\\\\.');\n  return str;\n};\n\nexport default class MarkdownSerializerBuilder {\n  constructor(schema) {\n    this.schema = schema;\n  }\n\n  buildNodes() {\n    return {\n      ...defaultMarkdownSerializer.nodes,\n\n      spoiler(state, node) {\n        state.wrapBlock('>! ', null, node, () => state.renderContent(node));\n      },\n\n      math_block(state, node) {\n        state.write('$$\\n');\n        state.text(node.textContent, false);\n        state.ensureNewLine();\n        state.write('$$');\n        state.closeBlock(node);\n      },\n\n      // We still want to put a new line for empty paragraphs\n      paragraph(state, node) {\n        if (node.content.size === 0) {\n          state.write('\\n');\n        } else {\n          defaultMarkdownSerializer.nodes.paragraph(state, node);\n        }\n      },\n\n      // Override this to put in just a whiteline, since Litedown doesn't like line-ending slashes.\n      hard_break(state, node, parent, index) {\n        for (let i = index + 1; i < parent.childCount; i++)\n          if (parent.child(i).type != node.type) {\n            state.write('\\n');\n            return;\n          }\n      },\n    };\n  }\n\n  buildMarks() {\n    return {\n      ...defaultMarkdownSerializer.marks,\n\n      spoiler_inline: genMarkupAwareMarkConfig({\n        open: '>!',\n        close: '!<',\n        mixable: true,\n        expelEnclosingWhitespace: true,\n      }),\n\n      strike: genMarkupAwareMarkConfig({\n        open: '~~',\n        close: '~~',\n        mixable: true,\n        expelEnclosingWhitespace: true,\n      }),\n\n      sub: genMarkupAwareMarkConfig({\n        open: '~',\n        close: '~',\n        mixable: true,\n        expelEnclosingWhitespace: true,\n      }),\n\n      sup: genMarkupAwareMarkConfig({\n        open: '^',\n        close: '^',\n        mixable: true,\n        expelEnclosingWhitespace: true,\n      }),\n\n      math_inline: {\n        ...genMarkupAwareMarkConfig({\n          open: '$',\n          close: '$',\n          mixable: false,\n          expelEnclosingWhitespace: true,\n        }),\n        escape: false,\n      },\n    };\n  }\n\n  build() {\n    return new MarkdownSerializer(this.buildNodes(), this.buildMarks());\n  }\n}\n","import { schema } from 'prosemirror-markdown';\nimport { Schema } from 'prosemirror-model';\n\n/**\n * COPIED FROM https://github.com/StackExchange/Stacks-Editor/blob/main/src/shared/schema.ts\n *\n * Creates a generic html MarkSpec for an inline html tag\n * @param tag The name of the tag to use in the Prosemirror dom\n */\nfunction genHtmlInlineMarkSpec(...tags) {\n  return {\n    toDOM() {\n      return [tags[0], 0];\n    },\n    parseDOM: tags.map((tag) => ({ tag: tag })),\n  };\n}\n\nconst spoilerNodeSpec = {\n  content: 'block+',\n  group: 'block',\n  attrs: { open: { default: true } },\n  parseDOM: [\n    {\n      tag: 'details',\n    },\n  ],\n  toDOM(node) {\n    const attrs = { class: 'spoiler' };\n\n    if (node.attrs.open) attrs.open = true;\n\n    return ['details', attrs, 0];\n  },\n};\n\nconst mathBlockNodeSpec = {\n  content: 'text*',\n  code: true,\n  group: 'block',\n  parseDOM: [\n    {\n      tag: 'pre',\n    },\n  ],\n  toDOM(node) {\n    return ['pre', { class: 'math' }, ['code', 0]];\n  },\n};\n\nexport default class SchemaBuilder {\n  buildNodes() {\n    return (\n      schema.spec.nodes\n        // Make lists tight by default\n        .update(\n          'ordered_list',\n          Object.assign({}, schema.spec.nodes.get('ordered_list'), { attrs: { order: { default: 1 }, tight: { default: true } } })\n        )\n        .update('bullet_list', Object.assign({}, schema.spec.nodes.get('bullet_list'), { attrs: { tight: { default: true } } }))\n        .addBefore('blockquote', 'spoiler', spoilerNodeSpec)\n        .addBefore('blockquote', 'math_block', mathBlockNodeSpec)\n    );\n  }\n\n  buildMarks() {\n    return schema.spec.marks\n      .addBefore('strong', 'strike', genHtmlInlineMarkSpec('del', 's', 'strike'))\n      .addBefore('strong', 'sub', genHtmlInlineMarkSpec('sub'))\n      .addBefore('strong', 'sup', genHtmlInlineMarkSpec('sup'))\n      .addBefore('strong', 'spoiler_inline', {\n        attrs: { open: { default: true } },\n        parseDOM: [\n          {\n            tag: 'spoiler',\n          },\n        ],\n        toDOM(node) {\n          return ['spoiler', 0];\n        },\n      })\n      .addBefore('strong', 'math_inline', {\n        parseDOM: [\n          {\n            tag: 'math',\n          },\n        ],\n        toDOM(node) {\n          return ['math', 0];\n        },\n        excludes: '_',\n      });\n  }\n\n  build() {\n    return new Schema({\n      nodes: this.buildNodes(),\n      marks: this.buildMarks(),\n    });\n  }\n}\n","module.exports = flarum.core.compat['common/Component'];","import Dropdown from 'flarum/common/components/Dropdown';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport extractText from 'flarum/common/utils/extractText';\nimport { setBlockType } from 'tiptap-commands';\nimport SafariModalHack from './SafariModalHack';\n\nexport default class NodeTypeDropdown extends Dropdown {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.state = this.attrs.state;\n    this.state.addItem(\n      this.attrs.type,\n      (state, dispatch) => {\n        return this.command(state, dispatch);\n      },\n      this.onEditorUpdate.bind(this)\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.$().on('click', (e) => {\n      if ($('.App').is('.mobile-safari')) {\n        // Mobile Safari doesn't support fixed items\n        // So, we wrap them in a modal.\n        app.modal.show(SafariModalHack, {\n          title: this.attrs.tooltip,\n          vnodeContent: this.getNodeTypeButtons(),\n        });\n        e.stopPropagation();\n      }\n    });\n\n    this.onEditorUpdate();\n  }\n\n  getButton(children) {\n    return (\n      <button className=\"Dropdown-toggle Button Button--icon Button--link NodeTypeButton Button--menuDropdown\" data-toggle=\"dropdown\">\n        <Tooltip text={this.attrs.tooltip}>\n          <span></span>\n        </Tooltip>\n      </button>\n    );\n  }\n\n  getNodeTypeButtons() {\n    return this.attrs.options\n      .filter((_, i) => i !== this.activeIndex)\n      .map((option) => (\n        <Tooltip text={extractText(option.tooltip)} key={option.title}>\n          <button\n            className=\"Button Button--icon Button--link NodeTypeButton\"\n            onclick={this.click.bind(this, option.type, option.attrs)}\n            onkeydown={this.keydown.bind(this, option.type, option.attrs)}\n          >\n            {option.title}\n          </button>\n        </Tooltip>\n      ));\n  }\n\n  getMenu(items) {\n    return <ul className={'Dropdown-menu dropdown-menu NodeTypeDropdownMenu'}>{this.getNodeTypeButtons()}</ul>;\n  }\n\n  keydown(type, attrs, e) {\n    if (e.key === ' ' || e.key === 'Enter') {\n      this.click(type, attrs, e);\n    }\n  }\n\n  click(type, attrs, e) {\n    // Here for the safari workaround\n    app.modal.close();\n    e.preventDefault();\n    this.command = setBlockType(type, attrs);\n    return this.state.run(this.attrs.type);\n  }\n\n  onEditorUpdate() {\n    if (!this.element) return;\n\n    this.attrs.options.forEach((option, i) => {\n      if (this.state.nodeActive(option.type, option.attrs)) {\n        this.element.children[0].children[0].innerText = option.title;\n        this.activeIndex = i;\n      }\n    });\n  }\n}\n","import extractText from 'flarum/common/utils/extractText';\nimport Stream from 'flarum/common/utils/Stream';\nimport FormDropdown from './FormDropdown';\n\nexport default class InsertImageDropdown extends FormDropdown {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.src = Stream('');\n    this.title = Stream('');\n  }\n\n  fields() {\n    const items = super.fields();\n\n    items.add(\n      'src',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"src\"\n          type=\"url\"\n          placeholder={extractText(app.translator.trans('askvortsov-rich-text.lib.composer.insert_image.src_placeholder'))}\n          bidi={this.src}\n          required\n        />\n      </div>,\n      10\n    );\n\n    items.add(\n      'title',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"title\"\n          placeholder={extractText(app.translator.trans('askvortsov-rich-text.lib.composer.insert_image.title_placeholder'))}\n          bidi={this.title}\n        />\n      </div>,\n      10\n    );\n\n    return items;\n  }\n\n  insert(e) {\n    this.state.insertNode(this.attrs.node, {\n      src: this.src(),\n      title: this.title(),\n    });\n\n    this.src('');\n    this.title('');\n  }\n}\n","import { getMarkAttrs, markIsActive, nodeIsActive } from 'tiptap-utils';\n\nexport default class MenuState {\n  constructor() {\n    this.items = {};\n  }\n\n  attachEditorView(editorView) {\n    this.editorView = editorView;\n  }\n\n  addItem(key, command, onEditorUpdate) {\n    this.items[key] = { command, onEditorUpdate };\n  }\n\n  getSchema() {\n    return this.editorView.state.schema;\n  }\n\n  update() {\n    app.editor = this.editorView;\n    Object.keys(this.items).forEach((key) => {\n      this.items[key].onEditorUpdate();\n    });\n  }\n\n  destroy() {\n    // No need for this: Mithril will destroy the editor DOM when the composer closes.\n  }\n\n  markActive(markType) {\n    return markIsActive(this.editorView.state, markType);\n  }\n\n  markAttrs(markType) {\n    return getMarkAttrs(this.editorView.state, markType);\n  }\n\n  nodeActive(nodeType, attrs) {\n    return nodeIsActive(this.editorView.state, nodeType, attrs);\n  }\n\n  selectionEmpty() {\n    return this.editorView.state.selection.empty;\n  }\n\n  insertNode(nodeType, attrs) {\n    const node = nodeType.createAndFill(attrs);\n\n    let transaction;\n    if (this.editorView.state.selection.empty) {\n      transaction = this.editorView.state.tr.insert(this.editorView.state.selection.from, node);\n    } else {\n      transaction = this.editorView.state.tr.replaceSelection(node);\n    }\n    this.editorView.dispatch(transaction);\n    this.editorView.focus();\n  }\n\n  run(key) {\n    if (this.items[key]) {\n      this.editorView.focus();\n      this.items[key].command(this.editorView.state, this.editorView.dispatch, this.editorView);\n    }\n  }\n}\n","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number) → RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number) → T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number) → ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number) → U, ?number, ?number) → [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nvar ropeSequence = RopeSequence;\n\nexport default ropeSequence;\n","import RopeSequence from \"rope-sequence\"\nimport {Mapping} from \"prosemirror-transform\"\nimport {Plugin, PluginKey} from \"prosemirror-state\"\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event' — a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n\n// Used to schedule history compression\nconst max_empty_items = 500\n\nclass Branch {\n  constructor(items, eventCount) {\n    this.items = items\n    this.eventCount = eventCount\n  }\n\n  // : (EditorState, bool) → ?{transform: Transform, selection: ?SelectionBookmark, remaining: Branch}\n  // Pop the latest event off the branch's history and apply it\n  // to a document transform.\n  popEvent(state, preserveItems) {\n    if (this.eventCount == 0) return null\n\n    let end = this.items.length\n    for (;; end--) {\n      let next = this.items.get(end - 1)\n      if (next.selection) { --end; break }\n    }\n\n    let remap, mapFrom\n    if (preserveItems) {\n      remap = this.remapping(end, this.items.length)\n      mapFrom = remap.maps.length\n    }\n    let transform = state.tr\n    let selection, remaining\n    let addAfter = [], addBefore = []\n\n    this.items.forEach((item, i) => {\n      if (!item.step) {\n        if (!remap) {\n          remap = this.remapping(end, i + 1)\n          mapFrom = remap.maps.length\n        }\n        mapFrom--\n        addBefore.push(item)\n        return\n      }\n\n      if (remap) {\n        addBefore.push(new Item(item.map))\n        let step = item.step.map(remap.slice(mapFrom)), map\n\n        if (step && transform.maybeStep(step).doc) {\n          map = transform.mapping.maps[transform.mapping.maps.length - 1]\n          addAfter.push(new Item(map, null, null, addAfter.length + addBefore.length))\n        }\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n      } else {\n        transform.maybeStep(item.step)\n      }\n\n      if (item.selection) {\n        selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection\n        remaining = new Branch(this.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this.eventCount - 1)\n        return false\n      }\n    }, this.items.length, 0)\n\n    return {remaining, transform, selection}\n  }\n\n  // : (Transform, ?SelectionBookmark, Object) → Branch\n  // Create a new branch with the given transform added.\n  addTransform(transform, selection, histOptions, preserveItems) {\n    let newItems = [], eventCount = this.eventCount\n    let oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null\n\n    for (let i = 0; i < transform.steps.length; i++) {\n      let step = transform.steps[i].invert(transform.docs[i])\n      let item = new Item(transform.mapping.maps[i], step, selection), merged\n      if (merged = lastItem && lastItem.merge(item)) {\n        item = merged\n        if (i) newItems.pop()\n        else oldItems = oldItems.slice(0, oldItems.length - 1)\n      }\n      newItems.push(item)\n      if (selection) {\n        eventCount++\n        selection = null\n      }\n      if (!preserveItems) lastItem = item\n    }\n    let overflow = eventCount - histOptions.depth\n    if (overflow > DEPTH_OVERFLOW) {\n      oldItems = cutOffEvents(oldItems, overflow)\n      eventCount -= overflow\n    }\n    return new Branch(oldItems.append(newItems), eventCount)\n  }\n\n  remapping(from, to) {\n    let maps = new Mapping\n    this.items.forEach((item, i) => {\n      let mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n          ? maps.maps.length - item.mirrorOffset : null\n      maps.appendMap(item.map, mirrorPos)\n    }, from, to)\n    return maps\n  }\n\n  addMaps(array) {\n    if (this.eventCount == 0) return this\n    return new Branch(this.items.append(array.map(map => new Item(map))), this.eventCount)\n  }\n\n  // : (Transform, number)\n  // When the collab module receives remote changes, the history has\n  // to know about those, so that it can adjust the steps that were\n  // rebased on top of the remote changes, and include the position\n  // maps for the remote changes in its array of items.\n  rebased(rebasedTransform, rebasedCount) {\n    if (!this.eventCount) return this\n\n    let rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount)\n\n    let mapping = rebasedTransform.mapping\n    let newUntil = rebasedTransform.steps.length\n    let eventCount = this.eventCount\n    this.items.forEach(item => { if (item.selection) eventCount-- }, start)\n\n    let iRebased = rebasedCount\n    this.items.forEach(item => {\n      let pos = mapping.getMirror(--iRebased)\n      if (pos == null) return\n      newUntil = Math.min(newUntil, pos)\n      let map = mapping.maps[pos]\n      if (item.step) {\n        let step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos])\n        let selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos))\n        if (selection) eventCount++\n        rebasedItems.push(new Item(map, step, selection))\n      } else {\n        rebasedItems.push(new Item(map))\n      }\n    }, start)\n\n    let newMaps = []\n    for (let i = rebasedCount; i < newUntil; i++)\n      newMaps.push(new Item(mapping.maps[i]))\n    let items = this.items.slice(0, start).append(newMaps).append(rebasedItems)\n    let branch = new Branch(items, eventCount)\n\n    if (branch.emptyItemCount() > max_empty_items)\n      branch = branch.compress(this.items.length - rebasedItems.length)\n    return branch\n  }\n\n  emptyItemCount() {\n    let count = 0\n    this.items.forEach(item => { if (!item.step) count++ })\n    return count\n  }\n\n  // Compressing a branch means rewriting it to push the air (map-only\n  // items) out. During collaboration, these naturally accumulate\n  // because each remote change adds one. The `upto` argument is used\n  // to ensure that only the items below a given level are compressed,\n  // because `rebased` relies on a clean, untouched set of items in\n  // order to associate old items with rebased steps.\n  compress(upto = this.items.length) {\n    let remap = this.remapping(0, upto), mapFrom = remap.maps.length\n    let items = [], events = 0\n    this.items.forEach((item, i) => {\n      if (i >= upto) {\n        items.push(item)\n        if (item.selection) events++\n      } else if (item.step) {\n        let step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap()\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n        if (step) {\n          let selection = item.selection && item.selection.map(remap.slice(mapFrom))\n          if (selection) events++\n          let newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1\n          if (merged = items.length && items[last].merge(newItem))\n            items[last] = merged\n          else\n            items.push(newItem)\n        }\n      } else if (item.map) {\n        mapFrom--\n      }\n    }, this.items.length, 0)\n    return new Branch(RopeSequence.from(items.reverse()), events)\n  }\n}\n\nBranch.empty = new Branch(RopeSequence.empty, 0)\n\nfunction cutOffEvents(items, n) {\n  let cutPoint\n  items.forEach((item, i) => {\n    if (item.selection && (n-- == 0)) {\n      cutPoint = i\n      return false\n    }\n  })\n  return items.slice(cutPoint)\n}\n\nclass Item {\n  constructor(map, step, selection, mirrorOffset) {\n    // The (forward) step map for this item.\n    this.map = map\n    // The inverted step\n    this.step = step\n    // If this is non-null, this item is the start of a group, and\n    // this selection is the starting selection for the group (the one\n    // that was active before the first step was applied)\n    this.selection = selection\n    // If this item is the inverse of a previous mapping on the stack,\n    // this points at the inverse's offset\n    this.mirrorOffset = mirrorOffset\n  }\n\n  merge(other) {\n    if (this.step && other.step && !other.selection) {\n      let step = other.step.merge(this.step)\n      if (step) return new Item(step.getMap().invert(), step, this.selection)\n    }\n  }\n}\n\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nexport class HistoryState {\n  constructor(done, undone, prevRanges, prevTime) {\n    this.done = done\n    this.undone = undone\n    this.prevRanges = prevRanges\n    this.prevTime = prevTime\n  }\n}\n\nconst DEPTH_OVERFLOW = 20\n\n// : (HistoryState, EditorState, Transaction, Object)\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n  let historyTr = tr.getMeta(historyKey), rebased\n  if (historyTr) return historyTr.historyState\n\n  if (tr.getMeta(closeHistoryKey)) history = new HistoryState(history.done, history.undone, null, 0)\n\n  let appended = tr.getMeta(\"appendedTransaction\")\n\n  if (tr.steps.length == 0) {\n    return history\n  } else if (appended && appended.getMeta(historyKey)) {\n    if (appended.getMeta(historyKey).redo)\n      return new HistoryState(history.done.addTransform(tr, null, options, mustPreserveItems(state)),\n                              history.undone, rangesFor(tr.mapping.maps[tr.steps.length - 1]), history.prevTime)\n    else\n      return new HistoryState(history.done, history.undone.addTransform(tr, null, options, mustPreserveItems(state)),\n                              null, history.prevTime)\n  } else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n    // Group transforms that occur in quick succession into one event.\n    let newGroup = history.prevTime == 0 || !appended && (history.prevTime < (tr.time || 0) - options.newGroupDelay ||\n                                                          !isAdjacentTo(tr, history.prevRanges))\n    let prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps[tr.steps.length - 1])\n    return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : null,\n                                                      options, mustPreserveItems(state)),\n                            Branch.empty, prevRanges, tr.time)\n  } else if (rebased = tr.getMeta(\"rebased\")) {\n    // Used by the collab module to tell the history that some of its\n    // content has been rebased.\n    return new HistoryState(history.done.rebased(tr, rebased),\n                            history.undone.rebased(tr, rebased),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  } else {\n    return new HistoryState(history.done.addMaps(tr.mapping.maps),\n                            history.undone.addMaps(tr.mapping.maps),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  }\n}\n\nfunction isAdjacentTo(transform, prevRanges) {\n  if (!prevRanges) return false\n  if (!transform.docChanged) return true\n  let adjacent = false\n  transform.mapping.maps[0].forEach((start, end) => {\n    for (let i = 0; i < prevRanges.length; i += 2)\n      if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n        adjacent = true\n  })\n  return adjacent\n}\n\nfunction rangesFor(map) {\n  let result = []\n  map.forEach((_from, _to, from, to) => result.push(from, to))\n  return result\n}\n\nfunction mapRanges(ranges, mapping) {\n  if (!ranges) return null\n  let result = []\n  for (let i = 0; i < ranges.length; i += 2) {\n    let from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1)\n    if (from <= to) result.push(from, to)\n  }\n  return result\n}\n\n// : (HistoryState, EditorState, (tr: Transaction), bool)\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, dispatch, redo) {\n  let preserveItems = mustPreserveItems(state), histOptions = historyKey.get(state).spec.config\n  let pop = (redo ? history.undone : history.done).popEvent(state, preserveItems)\n  if (!pop) return\n\n  let selection = pop.selection.resolve(pop.transform.doc)\n  let added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(),\n                                                                  histOptions, preserveItems)\n\n  let newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0)\n  dispatch(pop.transform.setSelection(selection).setMeta(historyKey, {redo, historyState: newHist}).scrollIntoView())\n}\n\nlet cachedPreserveItems = false, cachedPreserveItemsPlugins = null\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n  let plugins = state.plugins\n  if (cachedPreserveItemsPlugins != plugins) {\n    cachedPreserveItems = false\n    cachedPreserveItemsPlugins = plugins\n    for (let i = 0; i < plugins.length; i++) if (plugins[i].spec.historyPreserveItems) {\n      cachedPreserveItems = true\n      break\n    }\n  }\n  return cachedPreserveItems\n}\n\n// :: (Transaction) → Transaction\n// Set a flag on the given transaction that will prevent further steps\n// from being appended to an existing history event (so that they\n// require a separate undo command to undo).\nexport function closeHistory(tr) {\n  return tr.setMeta(closeHistoryKey, true)\n}\n\nconst historyKey = new PluginKey(\"history\")\nconst closeHistoryKey = new PluginKey(\"closeHistory\")\n\n// :: (?Object) → Plugin\n// Returns a plugin that enables the undo history for an editor. The\n// plugin will track undo and redo stacks, which can be used with the\n// [`undo`](#history.undo) and [`redo`](#history.redo) commands.\n//\n// You can set an `\"addToHistory\"` [metadata\n// property](#state.Transaction.setMeta) of `false` on a transaction\n// to prevent it from being rolled back by undo.\n//\n//   config::-\n//   Supports the following configuration options:\n//\n//     depth:: ?number\n//     The amount of history events that are collected before the\n//     oldest events are discarded. Defaults to 100.\n//\n//     newGroupDelay:: ?number\n//     The delay between changes after which a new group should be\n//     started. Defaults to 500 (milliseconds). Note that when changes\n//     aren't adjacent, a new group is always started.\nexport function history(config) {\n  config = {depth: config && config.depth || 100,\n            newGroupDelay: config && config.newGroupDelay || 500}\n  return new Plugin({\n    key: historyKey,\n\n    state: {\n      init() {\n        return new HistoryState(Branch.empty, Branch.empty, null, 0)\n      },\n      apply(tr, hist, state) {\n        return applyTransaction(hist, state, tr, config)\n      }\n    },\n\n    config,\n\n    props: {\n      handleDOMEvents: {\n        beforeinput(view, e) {\n          let handled = e.inputType == \"historyUndo\" ? undo(view.state, view.dispatch) :\n              e.inputType == \"historyRedo\" ? redo(view.state, view.dispatch) : false\n          if (handled) e.preventDefault()\n          return handled\n        }\n      }\n    }\n  })\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that undoes the last change, if any.\nexport function undo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.done.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, false)\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that redoes the last undone change, if any.\nexport function redo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.undone.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, true)\n  return true\n}\n\n// :: (EditorState) → number\n// The amount of undoable events available in a given state.\nexport function undoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.done.eventCount : 0\n}\n\n// :: (EditorState) → number\n// The amount of redoable events available in a given editor state.\nexport function redoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.undone.eventCount : 0\n}\n","const result = {}\nexport default result\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  const ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent)\n  const ie_upto10 = /MSIE \\d/.test(navigator.userAgent)\n  const ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\n\n  let ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge)\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent)\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n  let chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\n  result.chrome = !!chrome\n  result.chrome_version = chrome && +chrome[1]\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor)\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2)\n  result.mac = result.ios || /Mac/.test(navigator.platform)\n  result.android = /Android \\d/.test(navigator.userAgent)\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n}\n","import browser from \"./browser\"\n\nexport const domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling\n    if (!node) return index\n  }\n}\n\nexport const parentNode = function(node) {\n  let parent = node.assignedSlot || node.parentNode\n  return parent && parent.nodeType == 11 ? parent.host : parent\n}\n\nlet reusedRange = null\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nexport const textRange = function(node, from, to) {\n  let range = reusedRange || (reusedRange = document.createRange())\n  range.setEnd(node, to == null ? node.nodeValue.length : to)\n  range.setStart(node, from || 0)\n  return range\n}\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nexport const isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n}\n\nconst atomElements = /^(img|br|input|textarea|hr)$/i\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) return true\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      let parent = node.parentNode\n      if (!parent || parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) ||\n          node.contentEditable == \"false\")\n        return false\n      off = domIndex(node) + (dir < 0 ? 0 : 1)\n      node = parent\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)]\n      if (node.contentEditable == \"false\") return false\n      off = dir < 0 ? nodeSize(node) : 0\n    } else {\n      return false\n    }\n  }\n}\n\nexport function nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nexport function isOnEdge(node, offset, parent) {\n  for (let atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) return true\n    let index = domIndex(node)\n    node = node.parentNode\n    if (!node) return false\n    atStart = atStart && index == 0\n    atEnd = atEnd && index == nodeSize(node)\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  let desc\n  for (let cur = dom; cur; cur = cur.parentNode) if (desc = cur.pmViewDesc) break\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nexport const selectionCollapsed = function(domSel) {\n  let collapsed = domSel.isCollapsed\n  if (collapsed && browser.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    collapsed = false\n  return collapsed\n}\n\nexport function keyEvent(keyCode, key) {\n  let event = document.createEvent(\"Event\")\n  event.initEvent(\"keydown\", true, true)\n  event.keyCode = keyCode\n  event.key = event.code = key\n  return event\n}\n","import {nodeSize, textRange, parentNode} from \"./dom\"\nimport browser from \"./browser\"\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  let rect = node.getBoundingClientRect()\n  // Adjust for elements with style \"transform: scale()\"\n  let scaleX = (rect.width / node.offsetWidth) || 1\n  let scaleY = (rect.height / node.offsetHeight) || 1\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth * scaleX,\n          top: rect.top, bottom: rect.top + node.clientHeight * scaleY}\n}\n\nexport function scrollRectIntoView(view, rect, startDOM) {\n  let scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5\n  let doc = view.dom.ownerDocument\n  for (let parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) break\n    if (parent.nodeType != 1) continue\n    let atTop = parent == doc.body || parent.nodeType != 1\n    let bounding = atTop ? windowRect(doc) : clientRect(parent)\n    let moveX = 0, moveY = 0\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\"))\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\")\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\"))\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\")\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY)\n      } else {\n        let startX = parent.scrollLeft, startY = parent.scrollTop\n        if (moveY) parent.scrollTop += moveY\n        if (moveX) parent.scrollLeft += moveX\n        let dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY}\n      }\n    }\n    if (atTop) break\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nexport function storeScrollPos(view) {\n  let rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top)\n  let refDOM, refTop\n  for (let x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    let dom = view.root.elementFromPoint(x, y)\n    if (dom == view.dom || !view.dom.contains(dom)) continue\n    let localRect = dom.getBoundingClientRect()\n    if (localRect.top >= startY - 20) {\n      refDOM = dom\n      refTop = localRect.top\n      break\n    }\n  }\n  return {refDOM, refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  let stack = [], doc = dom.ownerDocument\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom, top: dom.scrollTop, left: dom.scrollLeft})\n    if (dom == doc) break\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nexport function resetScrollPos({refDOM, refTop, stack}) {\n  let newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop)\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (let i = 0; i < stack.length; i++) {\n    let {dom, top, left} = stack[i]\n    if (dom.scrollTop != top + dTop) dom.scrollTop = top + dTop\n    if (dom.scrollLeft != left) dom.scrollLeft = left\n  }\n}\n\nlet preventScrollSupported = null\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nexport function focusPreventScroll(dom) {\n  if (dom.setActive) return dom.setActive() // in IE\n  if (preventScrollSupported) return dom.focus(preventScrollSupported)\n\n  let stored = scrollStack(dom)\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true}\n      return true\n    }\n  } : undefined)\n  if (!preventScrollSupported) {\n    preventScrollSupported = false\n    restoreScrollStack(stored, 0)\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  let closest, dxClosest = 2e8, coordsClosest, offset = 0\n  let rowBot = coords.top, rowTop = coords.top\n  for (let child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    let rects\n    if (child.nodeType == 1) rects = child.getClientRects()\n    else if (child.nodeType == 3) rects = textRange(child).getClientRects()\n    else continue\n\n    for (let i = 0; i < rects.length; i++) {\n      let rect = rects[i]\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot)\n        rowTop = Math.min(rect.top, rowTop)\n        let dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0\n        if (dx < dxClosest) {\n          closest = child\n          dxClosest = dx\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords\n          if (child.nodeType == 1 && dx)\n            offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        offset = childIndex + 1\n    }\n  }\n  if (closest && closest.nodeType == 3) return findOffsetInText(closest, coordsClosest)\n  if (!closest || (dxClosest && closest.nodeType == 1)) return {node, offset}\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  let len = node.nodeValue.length\n  let range = document.createRange()\n  for (let i = 0; i < len; i++) {\n    range.setEnd(node, i + 1)\n    range.setStart(node, i)\n    let rect = singleRect(range, 1)\n    if (rect.top == rect.bottom) continue\n    if (inRect(coords, rect))\n      return {node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)}\n  }\n  return {node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  let parent = dom.parentNode\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    return parent\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  let {node, offset} = findOffsetInNode(elt, coords), bias = -1\n  if (node.nodeType == 1 && !node.firstChild) {\n    let rect = node.getBoundingClientRect()\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  let outside = -1\n  for (let cur = node;;) {\n    if (cur == view.dom) break\n    let desc = view.docView.nearestDesc(cur, true)\n    if (!desc) return null\n    if (desc.node.isBlock && desc.parent) {\n      let rect = desc.dom.getBoundingClientRect()\n      if (rect.left > coords.left || rect.top > coords.top) outside = desc.posBefore\n      else if (rect.right < coords.left || rect.bottom < coords.top) outside = desc.posAfter\n      else break\n    }\n    cur = desc.dom.parentNode\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  let len = element.childNodes.length\n  if (len && box.top < box.bottom) {\n    for (let startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      let child = element.childNodes[i]\n      if (child.nodeType == 1) {\n        let rects = child.getClientRects()\n        for (let j = 0; j < rects.length; j++) {\n          let rect = rects[j]\n          if (inRect(coords, rect)) return elementFromPoint(child, coords, rect)\n        }\n      }\n      if ((i = (i + 1) % len) == startI) break\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nexport function posAtCoords(view, coords) {\n  let doc = view.dom.ownerDocument, node, offset\n  if (doc.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      let pos = doc.caretPositionFromPoint(coords.left, coords.top)\n      if (pos) ({offsetNode: node, offset} = pos)\n    } catch (_) {}\n  }\n  if (!node && doc.caretRangeFromPoint) {\n    let range = doc.caretRangeFromPoint(coords.left, coords.top)\n    if (range) ({startContainer: node, startOffset: offset} = range)\n  }\n\n  let elt = (view.root.elementFromPoint ? view.root : doc).elementFromPoint(coords.left, coords.top + 1), pos\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    let box = view.dom.getBoundingClientRect()\n    if (!inRect(coords, box)) return null\n    elt = elementFromPoint(view.dom, coords, box)\n    if (!elt) return null\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (browser.safari) {\n    for (let p = elt; node && p; p = parentNode(p))\n      if (p.draggable) node = offset = null\n  }\n  elt = targetKludge(elt, coords)\n  if (node) {\n    if (browser.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length)\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        let next = node.childNodes[offset], box\n        if (next.nodeName == \"IMG\" && (box = next.getBoundingClientRect()).right <= coords.left &&\n            box.bottom > coords.top)\n          offset++\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      pos = view.state.doc.content.size\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      pos = posFromCaret(view, node, offset, coords)\n  }\n  if (pos == null) pos = posFromElement(view, elt, coords)\n\n  let desc = view.docView.nearestDesc(elt, true)\n  return {pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  let rects = object.getClientRects()\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nconst BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/\n\n// : (EditorView, number, number) → {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nexport function coordsAtPos(view, pos, side) {\n  let {node, offset} = view.docView.domFromPos(pos, side < 0 ? -1 : 1)\n\n  let supportEmptyRange = browser.webkit || browser.gecko\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      let rect = singleRect(textRange(node, offset, offset), side)\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (browser.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        let rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1)\n        if (rectBefore.top == rect.top) {\n          let rectAfter = singleRect(textRange(node, offset, offset + 1), -1)\n          if (rectAfter.top != rect.top)\n            return flattenV(rectAfter, rectAfter.left < rectBefore.left)\n        }\n      }\n      return rect\n    } else {\n      let from = offset, to = offset, takeSide = side < 0 ? 1 : -1\n      if (side < 0 && !offset) { to++; takeSide = -1 }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1 }\n      else if (side < 0) { from-- }\n      else { to ++ }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      let before = node.childNodes[offset - 1]\n      if (before.nodeType == 1) return flattenH(before.getBoundingClientRect(), false)\n    }\n    if (offset < nodeSize(node)) {\n      let after = node.childNodes[offset]\n      if (after.nodeType == 1) return flattenH(after.getBoundingClientRect(), true)\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    let before = node.childNodes[offset - 1]\n    let target = before.nodeType == 3 ? textRange(before, nodeSize(before) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before.nodeType == 1 && (before.nodeName != \"BR\" || !before.nextSibling) ? before : null\n    if (target) return flattenV(singleRect(target, 1), false)\n  }\n  if (offset < nodeSize(node)) {\n    let after = node.childNodes[offset]\n    while (after.pmViewDesc && after.pmViewDesc.ignoreForCoords) after = after.nextSibling\n    let target = !after ? null : after.nodeType == 3 ? textRange(after, 0, (supportEmptyRange ? 0 : 1))\n        : after.nodeType == 1 ? after : null\n    if (target) return flattenV(singleRect(target, -1), true)\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) return rect\n  let x = left ? rect.left : rect.right\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) return rect\n  let y = top ? rect.top : rect.bottom\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  let viewState = view.state, active = view.root.activeElement\n  if (viewState != state) view.updateState(state)\n  if (active != view.dom) view.focus()\n  try {\n    return f()\n  } finally {\n    if (viewState != state) view.updateState(viewState)\n    if (active != view.dom && active) active.focus()\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  let sel = state.selection\n  let $pos = dir == \"up\" ? sel.$from : sel.$to\n  return withFlushedState(view, state, () => {\n    let {node: dom} = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1)\n    for (;;) {\n      let nearest = view.docView.nearestDesc(dom, true)\n      if (!nearest) break\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode\n    }\n    let coords = coordsAtPos(view, $pos.pos, 1)\n    for (let child = dom.firstChild; child; child = child.nextSibling) {\n      let boxes\n      if (child.nodeType == 1) boxes = child.getClientRects()\n      else if (child.nodeType == 3) boxes = textRange(child, 0, child.nodeValue.length).getClientRects()\n      else continue\n      for (let i = 0; i < boxes.length; i++) {\n        let box = boxes[i]\n        if (box.bottom > box.top + 1 &&\n            (dir == \"up\" ? coords.top - box.top > (box.bottom - coords.top) * 2\n             : box.bottom - coords.bottom > (coords.bottom - box.top) * 2))\n          return false\n      }\n    }\n    return true\n  })\n}\n\nconst maybeRTL = /[\\u0590-\\u08ac]/\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  let {$head} = state.selection\n  if (!$head.parent.isTextblock) return false\n  let offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size\n  let sel = view.root.getSelection()\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    return dir == \"left\" || dir == \"backward\" ? atStart : atEnd\n\n  return withFlushedState(view, state, () => {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    let oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset\n    let oldBidiLevel = sel.caretBidiLevel // Only for Firefox\n    sel.modify(\"move\", dir, \"character\")\n    let parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom\n    let result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset)\n    // Restore the previous selection\n    sel.removeAllRanges()\n    sel.addRange(oldRange)\n    if (oldBidiLevel != null) sel.caretBidiLevel = oldBidiLevel\n    return result\n  })\n}\n\nlet cachedState = null, cachedDir = null, cachedResult = false\nexport function endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) return cachedResult\n  cachedState = state; cachedDir = dir\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n","import {DOMSerializer, Fragment, Mark} from \"prosemirror-model\"\nimport {TextSelection} from \"prosemirror-state\"\n\nimport {domIndex, isEquivalentPosition, nodeSize} from \"./dom\"\nimport browser from \"./browser\"\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration], innerDecorations: DecorationSource) → bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), an array\n//   of active decorations around the node (which are automatically\n//   drawn, and the node view may ignore if it isn't interested in\n//   them), and a [decoration source](#view.DecorationSource) that\n//   represents any decorations that apply to the content of the node\n//   (which again may be ignored). It should return true if it was\n//   able to update to that node, and false otherwise. If the node\n//   view has a `contentDOM` property (or no `dom` property), updating\n//   its child nodes will be handled by ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord) → bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed. (Not available for marks.)\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nconst NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nclass ViewDesc {\n  // : (?ViewDesc, [ViewDesc], dom.Node, ?dom.Node)\n  constructor(parent, children, dom, contentDOM) {\n    this.parent = parent\n    this.children = children\n    this.dom = dom\n    // An expando property on the DOM node provides a link back to its\n    // description.\n    dom.pmViewDesc = this\n    // This is the node that holds the child views. It may be null for\n    // descs that don't have children.\n    this.contentDOM = contentDOM\n    this.dirty = NOT_DIRTY\n  }\n\n  // Used to check whether a given description corresponds to a\n  // widget/mark/node.\n  matchesWidget() { return false }\n  matchesMark() { return false }\n  matchesNode() { return false }\n  matchesHack(_nodeName) { return false }\n\n  // : () → ?ParseRule\n  // When parsing in-editor content (in domchange.js), we allow\n  // descriptions to determine the parse rules that should be used to\n  // parse them.\n  parseRule() { return null }\n\n  // : (dom.Event) → bool\n  // Used by the editor's event handler to ignore events that come\n  // from certain descs.\n  stopEvent() { return false }\n\n  // The size of the content represented by this desc.\n  get size() {\n    let size = 0\n    for (let i = 0; i < this.children.length; i++) size += this.children[i].size\n    return size\n  }\n\n  // For block nodes, this represents the space taken up by their\n  // start/end tokens.\n  get border() { return 0 }\n\n  destroy() {\n    this.parent = null\n    if (this.dom.pmViewDesc == this) this.dom.pmViewDesc = null\n    for (let i = 0; i < this.children.length; i++)\n      this.children[i].destroy()\n  }\n\n  posBeforeChild(child) {\n    for (let i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n      let cur = this.children[i]\n      if (cur == child) return pos\n      pos += cur.size\n    }\n  }\n\n  get posBefore() {\n    return this.parent.posBeforeChild(this)\n  }\n\n  get posAtStart() {\n    return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n  }\n\n  get posAfter() {\n    return this.posBefore + this.size\n  }\n\n  get posAtEnd() {\n    return this.posAtStart + this.size - 2 * this.border\n  }\n\n  // : (dom.Node, number, ?number) → number\n  localPosFromDOM(dom, offset, bias) {\n    // If the DOM position is in the content, use the child desc after\n    // it to figure out a position.\n    if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n      if (bias < 0) {\n        let domBefore, desc\n        if (dom == this.contentDOM) {\n          domBefore = dom.childNodes[offset - 1]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domBefore = dom.previousSibling\n        }\n        while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) domBefore = domBefore.previousSibling\n        return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n      } else {\n        let domAfter, desc\n        if (dom == this.contentDOM) {\n          domAfter = dom.childNodes[offset]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domAfter = dom.nextSibling\n        }\n        while (domAfter && !((desc = domAfter.pmViewDesc) && desc.parent == this)) domAfter = domAfter.nextSibling\n        return domAfter ? this.posBeforeChild(desc) : this.posAtEnd\n      }\n    }\n    // Otherwise, use various heuristics, falling back on the bias\n    // parameter, to determine whether to return the position at the\n    // start or at the end of this view desc.\n    let atEnd\n    if (dom == this.dom && this.contentDOM) {\n      atEnd = offset > domIndex(this.contentDOM)\n    } else if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n      atEnd = dom.compareDocumentPosition(this.contentDOM) & 2\n    } else if (this.dom.firstChild) {\n      if (offset == 0) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = false; break }\n        if (search.parentNode.firstChild != search) break\n      }\n      if (atEnd == null && offset == dom.childNodes.length) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = true; break }\n        if (search.parentNode.lastChild != search) break\n      }\n    }\n    return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n  }\n\n  // Scan up the dom finding the first desc that is a descendant of\n  // this one.\n  nearestDesc(dom, onlyNodes) {\n    for (let first = true, cur = dom; cur; cur = cur.parentNode) {\n      let desc = this.getDesc(cur)\n      if (desc && (!onlyNodes || desc.node)) {\n        // If dom is outside of this desc's nodeDOM, don't count it.\n        if (first && desc.nodeDOM &&\n            !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n          first = false\n        else\n          return desc\n      }\n    }\n  }\n\n  getDesc(dom) {\n    let desc = dom.pmViewDesc\n    for (let cur = desc; cur; cur = cur.parent) if (cur == this) return desc\n  }\n\n  posFromDOM(dom, offset, bias) {\n    for (let scan = dom; scan; scan = scan.parentNode) {\n      let desc = this.getDesc(scan)\n      if (desc) return desc.localPosFromDOM(dom, offset, bias)\n    }\n    return -1\n  }\n\n  // : (number) → ?NodeViewDesc\n  // Find the desc for the node after the given pos, if any. (When a\n  // parent node overrode rendering, there might not be one.)\n  descAt(pos) {\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == pos && end != offset) {\n        while (!child.border && child.children.length) child = child.children[0]\n        return child\n      }\n      if (pos < end) return child.descAt(pos - offset - child.border)\n      offset = end\n    }\n  }\n\n  // : (number, number) → {node: dom.Node, offset: number}\n  domFromPos(pos, side) {\n    if (!this.contentDOM) return {node: this.dom, offset: 0}\n    // First find the position in the child array\n    let i = 0, offset = 0\n    for (let curPos = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = curPos + child.size\n      if (end > pos || child instanceof TrailingHackViewDesc) { offset = pos - curPos; break }\n      curPos = end\n    }\n    // If this points into the middle of a child, call through\n    if (offset) return this.children[i].domFromPos(offset - this.children[i].border, side)\n    // Go back if there were any zero-length widgets with side >= 0 before this point\n    for (let prev; i && !(prev = this.children[i - 1]).size && prev instanceof WidgetViewDesc && prev.widget.type.side >= 0; i--) {}\n    // Scan towards the first useable node\n    if (side <= 0) {\n      let prev, enter = true\n      for (;; i--, enter = false) {\n        prev = i ? this.children[i - 1] : null\n        if (!prev || prev.dom.parentNode == this.contentDOM) break\n      }\n      if (prev && side && enter && !prev.border && !prev.domAtom) return prev.domFromPos(prev.size, side)\n      return {node: this.contentDOM, offset: prev ? domIndex(prev.dom) + 1 : 0}\n    } else {\n      let next, enter = true\n      for (;; i++, enter = false) {\n        next = i < this.children.length ? this.children[i] : null\n        if (!next || next.dom.parentNode == this.contentDOM) break\n      }\n      if (next && enter && !next.border && !next.domAtom) return next.domFromPos(0, side)\n      return {node: this.contentDOM, offset: next ? domIndex(next.dom) : this.contentDOM.childNodes.length}\n    }\n  }\n\n  // Used to find a DOM range in a single parent for a given changed\n  // range.\n  parseRange(from, to, base = 0) {\n    if (this.children.length == 0)\n      return {node: this.contentDOM, from, to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length}\n\n    let fromOffset = -1, toOffset = -1\n    for (let offset = base, i = 0;; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (fromOffset == -1 && from <= end) {\n        let childBase = offset + child.border\n        // FIXME maybe descend mark views to parse a narrower range?\n        if (from >= childBase && to <= end - child.border && child.node &&\n            child.contentDOM && this.contentDOM.contains(child.contentDOM))\n          return child.parseRange(from, to, childBase)\n\n        from = offset\n        for (let j = i; j > 0; j--) {\n          let prev = this.children[j - 1]\n          if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n            fromOffset = domIndex(prev.dom) + 1\n            break\n          }\n          from -= prev.size\n        }\n        if (fromOffset == -1) fromOffset = 0\n      }\n      if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n        to = end\n        for (let j = i + 1; j < this.children.length; j++) {\n          let next = this.children[j]\n          if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n            toOffset = domIndex(next.dom)\n            break\n          }\n          to += next.size\n        }\n        if (toOffset == -1) toOffset = this.contentDOM.childNodes.length\n        break\n      }\n      offset = end\n    }\n    return {node: this.contentDOM, from, to, fromOffset, toOffset}\n  }\n\n  emptyChildAt(side) {\n    if (this.border || !this.contentDOM || !this.children.length) return false\n    let child = this.children[side < 0 ? 0 : this.children.length - 1]\n    return child.size == 0 || child.emptyChildAt(side)\n  }\n\n  // : (number) → dom.Node\n  domAfterPos(pos) {\n    let {node, offset} = this.domFromPos(pos, 0)\n    if (node.nodeType != 1 || offset == node.childNodes.length)\n      throw new RangeError(\"No node after pos \" + pos)\n    return node.childNodes[offset]\n  }\n\n  // : (number, number, dom.Document)\n  // View descs are responsible for setting any selection that falls\n  // entirely inside of them, so that custom implementations can do\n  // custom things with the selection. Note that this falls apart when\n  // a selection starts in such a node and ends in another, in which\n  // case we just use whatever domFromPos produces as a best effort.\n  setSelection(anchor, head, root, force) {\n    // If the selection falls entirely in a child, give it to that child\n    let from = Math.min(anchor, head), to = Math.max(anchor, head)\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (from > offset && to < end)\n        return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force)\n      offset = end\n    }\n\n    let anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1)\n    let headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1)\n    let domSel = root.getSelection()\n\n    let brKludge = false\n    // On Firefox, using Selection.collapse to put the cursor after a\n    // BR node for some reason doesn't always work (#1073). On Safari,\n    // the cursor sometimes inexplicable visually lags behind its\n    // reported position in such situations (#1092).\n    if ((browser.gecko || browser.safari) && anchor == head) {\n      let {node, offset} = anchorDOM\n      if (node.nodeType == 3) {\n        brKludge = offset && node.nodeValue[offset - 1] == \"\\n\"\n        // Issue #1128\n        if (brKludge && offset == node.nodeValue.length) {\n          for (let scan = node, after; scan; scan = scan.parentNode) {\n            if (after = scan.nextSibling) {\n              if (after.nodeName == \"BR\")\n                anchorDOM = headDOM = {node: after.parentNode, offset: domIndex(after) + 1}\n              break\n            }\n            let desc = scan.pmViewDesc\n            if (desc && desc.node && desc.node.isBlock) break\n          }\n        }\n      } else {\n        let prev = node.childNodes[offset - 1]\n        brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\")\n      }\n    }\n    // Firefox can act strangely when the selection is in front of an\n    // uneditable node. See #1163 and https://bugzilla.mozilla.org/show_bug.cgi?id=1709536\n    if (browser.gecko && domSel.focusNode && domSel.focusNode != headDOM.node && domSel.focusNode.nodeType == 1) {\n      let after = domSel.focusNode.childNodes[domSel.focusOffset]\n      if (after && after.contentEditable == \"false\") force = true\n    }\n\n    if (!(force || brKludge && browser.safari) &&\n        isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n        isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n      return\n\n    // Selection.extend can be used to create an 'inverted' selection\n    // (one where the focus is before the anchor), but not all\n    // browsers support it yet.\n    let domSelExtended = false\n    if ((domSel.extend || anchor == head) && !brKludge) {\n      domSel.collapse(anchorDOM.node, anchorDOM.offset)\n      try {\n        if (anchor != head) domSel.extend(headDOM.node, headDOM.offset)\n        domSelExtended = true\n      } catch (err) {\n        // In some cases with Chrome the selection is empty after calling\n        // collapse, even when it should be valid. This appears to be a bug, but\n        // it is difficult to isolate. If this happens fallback to the old path\n        // without using extend.\n        if (!(err instanceof DOMException)) throw err\n        // declare global: DOMException\n      }\n    }\n    if (!domSelExtended) {\n      if (anchor > head) { let tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp }\n      let range = document.createRange()\n      range.setEnd(headDOM.node, headDOM.offset)\n      range.setStart(anchorDOM.node, anchorDOM.offset)\n      domSel.removeAllRanges()\n      domSel.addRange(range)\n    }\n  }\n\n  // : (dom.MutationRecord) → bool\n  ignoreMutation(mutation) {\n    return !this.contentDOM && mutation.type != \"selection\"\n  }\n\n  get contentLost() {\n    return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n  }\n\n  // Remove a subtree of the element tree that has been touched\n  // by a DOM change, so that the next update will redraw it.\n  markDirty(from, to) {\n    for (let offset = 0, i = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n        let startInside = offset + child.border, endInside = end - child.border\n        if (from >= startInside && to <= endInside) {\n          this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY\n          if (from == startInside && to == endInside &&\n              (child.contentLost || child.dom.parentNode != this.contentDOM)) child.dirty = NODE_DIRTY\n          else child.markDirty(from - startInside, to - startInside)\n          return\n        } else {\n          child.dirty = child.dom == child.contentDOM && child.dom.parentNode == this.contentDOM && !child.children.length\n            ? CONTENT_DIRTY : NODE_DIRTY\n        }\n      }\n      offset = end\n    }\n    this.dirty = CONTENT_DIRTY\n  }\n\n  markParentsDirty() {\n    let level = 1\n    for (let node = this.parent; node; node = node.parent, level++) {\n      let dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY\n      if (node.dirty < dirty) node.dirty = dirty\n    }\n  }\n\n  get domAtom() { return false }\n\n  get ignoreForCoords() { return false }\n}\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nconst nothing = []\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nclass WidgetViewDesc extends ViewDesc {\n  // : (ViewDesc, Decoration)\n  constructor(parent, widget, view, pos) {\n    let self, dom = widget.type.toDOM\n    if (typeof dom == \"function\") dom = dom(view, () => {\n      if (!self) return pos\n      if (self.parent) return self.parent.posBeforeChild(self)\n    })\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        let wrap = document.createElement(\"span\")\n        wrap.appendChild(dom)\n        dom = wrap\n      }\n      dom.contentEditable = false\n      dom.classList.add(\"ProseMirror-widget\")\n    }\n    super(parent, nothing, dom, null)\n    this.widget = widget\n    self = this\n  }\n\n  matchesWidget(widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  }\n\n  parseRule() { return {ignore: true} }\n\n  stopEvent(event) {\n    let stop = this.widget.spec.stopEvent\n    return stop ? stop(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  }\n\n  destroy() {\n    this.widget.type.destroy(this.dom)\n    super.destroy()\n  }\n\n  get domAtom() { return true }\n}\n\nclass CompositionViewDesc extends ViewDesc {\n  constructor(parent, dom, textDOM, text) {\n    super(parent, nothing, dom, null)\n    this.textDOM = textDOM\n    this.text = text\n  }\n\n  get size() { return this.text.length }\n\n  localPosFromDOM(dom, offset) {\n    if (dom != this.textDOM) return this.posAtStart + (offset ? this.size : 0)\n    return this.posAtStart + offset\n  }\n\n  domFromPos(pos) {\n    return {node: this.textDOM, offset: pos}\n  }\n\n  ignoreMutation(mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   }\n}\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nclass MarkViewDesc extends ViewDesc {\n  // : (ViewDesc, Mark, dom.Node)\n  constructor(parent, mark, dom, contentDOM) {\n    super(parent, [], dom, contentDOM)\n    this.mark = mark\n  }\n\n  static create(parent, mark, inline, view) {\n    let custom = view.nodeViews[mark.type.name]\n    let spec = custom && custom(mark, view, inline)\n    if (!spec || !spec.dom)\n      spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline))\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  }\n\n  parseRule() {\n    if ((this.dirty & NODE_DIRTY) || this.mark.type.spec.reparseInView) return null\n    return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM}\n  }\n\n  matchesMark(mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) }\n\n  markDirty(from, to) {\n    super.markDirty(from, to)\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      let parent = this.parent\n      while (!parent.node) parent = parent.parent\n      if (parent.dirty < this.dirty) parent.dirty = this.dirty\n      this.dirty = NOT_DIRTY\n    }\n  }\n\n  slice(from, to, view) {\n    let copy = MarkViewDesc.create(this.parent, this.mark, true, view)\n    let nodes = this.children, size = this.size\n    if (to < size) nodes = replaceNodes(nodes, to, size, view)\n    if (from > 0) nodes = replaceNodes(nodes, 0, from, view)\n    for (let i = 0; i < nodes.length; i++) nodes[i].parent = copy\n    copy.children = nodes\n    return copy\n  }\n}\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nclass NodeViewDesc extends ViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSource, dom.Node, ?dom.Node, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    super(parent, node.isLeaf ? nothing : [], dom, contentDOM)\n    this.nodeDOM = nodeDOM\n    this.node = node\n    this.outerDeco = outerDeco\n    this.innerDeco = innerDeco\n    if (contentDOM) this.updateChildren(view, pos)\n  }\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  static create(parent, node, outerDeco, innerDeco, view, pos) {\n    let custom = view.nodeViews[node.type.name], descObj\n    let spec = custom && custom(node, view, () => {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) return pos\n      if (descObj.parent) return descObj.parent.posBeforeChild(descObj)\n    }, outerDeco, innerDeco)\n\n    let dom = spec && spec.dom, contentDOM = spec && spec.contentDOM\n    if (node.isText) {\n      if (!dom) dom = document.createTextNode(node.text)\n      else if (dom.nodeType != 3) throw new RangeError(\"Text must be rendered as a DOM text node\")\n    } else if (!dom) {\n      ;({dom, contentDOM} = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)))\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) dom.contentEditable = false\n      if (node.type.spec.draggable) dom.draggable = true\n    }\n\n    let nodeDOM = dom\n    dom = applyOuterDeco(dom, outerDeco, node)\n\n    if (spec)\n      return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1)\n    else if (node.isText)\n      return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view)\n    else\n      return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1)\n  }\n\n  parseRule() {\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) return null\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    let rule = {node: this.node.type.name, attrs: this.node.attrs}\n    if (this.node.type.whitespace == \"pre\") rule.preserveWhitespace = \"full\"\n    if (this.contentDOM && !this.contentLost) rule.contentElement = this.contentDOM\n    else rule.getContent = () => this.contentDOM ? Fragment.empty : this.node.content\n    return rule\n  }\n\n  matchesNode(node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  }\n\n  get size() { return this.node.nodeSize }\n\n  get border() { return this.node.isLeaf ? 0 : 1 }\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  updateChildren(view, pos) {\n    let inline = this.node.inlineContent, off = pos\n    let composition = view.composing && this.localCompositionInfo(view, pos)\n    let localComposition = composition && composition.pos > -1 ? composition : null\n    let compositionInChild = composition && composition.pos < 0\n    let updater = new ViewTreeUpdater(this, localComposition && localComposition.node)\n    iterDeco(this.node, this.innerDeco, (widget, i, insideNode) => {\n      if (widget.spec.marks)\n        updater.syncToMarks(widget.spec.marks, inline, view)\n      else if (widget.type.side >= 0 && !insideNode)\n        updater.syncToMarks(i == this.node.childCount ? Mark.none : this.node.child(i).marks, inline, view)\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off)\n    }, (child, outerDeco, innerDeco, i) => {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view)\n      // Try several strategies for drawing this node\n      let compIndex\n      if (updater.findNodeMatch(child, outerDeco, innerDeco, i)) {\n        // Found precise match with existing node view\n      } else if (compositionInChild && view.state.selection.from > off &&\n                 view.state.selection.to < off + child.nodeSize &&\n                 (compIndex = updater.findIndexWithChild(composition.node)) > -1 &&\n                 updater.updateNodeAt(child, outerDeco, innerDeco, compIndex, view)) {\n        // Updated the specific node that holds the composition\n      } else if (updater.updateNextNode(child, outerDeco, innerDeco, view, i)) {\n        // Could update an existing node to reflect this node\n      } else {\n        // Add it as a new view\n        updater.addNode(child, outerDeco, innerDeco, view, off)\n      }\n      off += child.nodeSize\n    })\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view)\n    if (this.node.isTextblock) updater.addTextblockHacks()\n    updater.destroyRest()\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (localComposition) this.protectLocalComposition(view, localComposition)\n      renderDescs(this.contentDOM, this.children, view)\n      if (browser.ios) iosHacks(this.dom)\n    }\n  }\n\n  localCompositionInfo(view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node\n    let {from, to} = view.state.selection\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) return\n    let sel = view.root.getSelection()\n    let textNode = nearbyTextNode(sel.focusNode, sel.focusOffset)\n    if (!textNode || !this.dom.contains(textNode.parentNode)) return\n\n    if (this.node.inlineContent) {\n      // Find the text in the focused node in the node, stop if it's not\n      // there (may have been modified through other means, in which\n      // case it should overwritten)\n      let text = textNode.nodeValue\n      let textPos = findTextInFragment(this.node.content, text, from - pos, to - pos)\n      return textPos < 0 ? null : {node: textNode, pos: textPos, text}\n    } else {\n      return {node: textNode, pos: -1}\n    }\n  }\n\n  protectLocalComposition(view, {node, pos, text}) {\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) return\n\n    // Create a composition view for the orphaned nodes\n    let topNode = node\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) break\n      while (topNode.previousSibling) topNode.parentNode.removeChild(topNode.previousSibling)\n      while (topNode.nextSibling) topNode.parentNode.removeChild(topNode.nextSibling)\n      if (topNode.pmViewDesc) topNode.pmViewDesc = null\n    }\n    let desc = new CompositionViewDesc(this, topNode, node, text)\n    view.compositionNodes.push(desc)\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc)\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView) → bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) return false\n    this.updateInner(node, outerDeco, innerDeco, view)\n    return true\n  }\n\n  updateInner(node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco)\n    this.node = node\n    this.innerDeco = innerDeco\n    if (this.contentDOM) this.updateChildren(view, this.posAtStart)\n    this.dirty = NOT_DIRTY\n  }\n\n  updateOuterDeco(outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) return\n    let needsWrap = this.nodeDOM.nodeType != 1\n    let oldDOM = this.dom\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap))\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null\n      this.dom.pmViewDesc = this\n    }\n    this.outerDeco = outerDeco\n  }\n\n  // Mark this node as being the selected node.\n  selectNode() {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.draggable = true\n  }\n\n  // Remove selected node marking from this node.\n  deselectNode() {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.removeAttribute(\"draggable\")\n  }\n\n  get domAtom() { return this.node.isAtom }\n}\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nexport function docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc)\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nclass TextViewDesc extends NodeViewDesc {\n  constructor(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    super(parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view)\n  }\n\n  parseRule() {\n    let skip = this.nodeDOM.parentNode\n    while (skip && skip != this.dom && !skip.pmIsDeco) skip = skip.parentNode\n    return {skip: skip || true}\n  }\n\n  update(node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) return false\n    this.updateOuterDeco(outerDeco)\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text\n      if (view.trackWrites == this.nodeDOM) view.trackWrites = null\n    }\n    this.node = node\n    this.dirty = NOT_DIRTY\n    return true\n  }\n\n  inParent() {\n    let parentDOM = this.parent.contentDOM\n    for (let n = this.nodeDOM; n; n = n.parentNode) if (n == parentDOM) return true\n    return false\n  }\n\n  domFromPos(pos) {\n    return {node: this.nodeDOM, offset: pos}\n  }\n\n  localPosFromDOM(dom, offset, bias) {\n    if (dom == this.nodeDOM) return this.posAtStart + Math.min(offset, this.node.text.length)\n    return super.localPosFromDOM(dom, offset, bias)\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  }\n\n  slice(from, to, view) {\n    let node = this.node.cut(from, to), dom = document.createTextNode(node.text)\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  }\n\n  markDirty(from, to) {\n    super.markDirty(from, to)\n    if (this.dom != this.nodeDOM && (from == 0 || to == this.nodeDOM.nodeValue.length))\n      this.dirty = NODE_DIRTY\n  }\n\n  get domAtom() { return false }\n}\n\n// A dummy desc used to tag trailing BR or IMG nodes created to work\n// around contentEditable terribleness.\nclass TrailingHackViewDesc extends ViewDesc {\n  parseRule() { return {ignore: true} }\n  matchesHack(nodeName) { return this.dirty == NOT_DIRTY && this.dom.nodeName == nodeName }\n  get domAtom() { return true }\n  get ignoreForCoords() { return this.dom.nodeName == \"IMG\" }\n}\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nclass CustomNodeViewDesc extends NodeViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSource, dom.Node, ?dom.Node, NodeView, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    super(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos)\n    this.spec = spec\n  }\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) return false\n    if (this.spec.update) {\n      let result = this.spec.update(node, outerDeco, innerDeco)\n      if (result) this.updateInner(node, outerDeco, innerDeco, view)\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return super.update(node, outerDeco, innerDeco, view)\n    }\n  }\n\n  selectNode() {\n    this.spec.selectNode ? this.spec.selectNode() : super.selectNode()\n  }\n\n  deselectNode() {\n    this.spec.deselectNode ? this.spec.deselectNode() : super.deselectNode()\n  }\n\n  setSelection(anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : super.setSelection(anchor, head, root, force)\n  }\n\n  destroy() {\n    if (this.spec.destroy) this.spec.destroy()\n    super.destroy()\n  }\n\n  stopEvent(event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : super.ignoreMutation(mutation)\n  }\n}\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  let dom = parentDOM.firstChild, written = false\n  for (let i = 0; i < descs.length; i++) {\n    let desc = descs[i], childDOM = desc.dom\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true }\n      dom = dom.nextSibling\n    } else {\n      written = true\n      parentDOM.insertBefore(childDOM, dom)\n    }\n    if (desc instanceof MarkViewDesc) {\n      let pos = dom ? dom.previousSibling : parentDOM.lastChild\n      renderDescs(desc.contentDOM, desc.children, view)\n      dom = pos ? pos.nextSibling : parentDOM.firstChild\n    }\n  }\n  while (dom) { dom = rm(dom); written = true }\n  if (written && view.trackWrites == parentDOM) view.trackWrites = null\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) this.nodeName = nodeName\n}\nOuterDecoLevel.prototype = Object.create(null)\n\nconst noDeco = [new OuterDecoLevel]\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) return noDeco\n\n  let top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top]\n\n  for (let i = 0; i < outerDeco.length; i++) {\n    let attrs = outerDeco[i].type.attrs\n    if (!attrs) continue\n    if (attrs.nodeName)\n      result.push(top = new OuterDecoLevel(attrs.nodeName))\n\n    for (let name in attrs) {\n      let val = attrs[name]\n      if (val == null) continue\n      if (needsWrap && result.length == 1)\n        result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\"))\n      if (name == \"class\") top.class = (top.class ? top.class + \" \" : \"\") + val\n      else if (name == \"style\") top.style = (top.style ? top.style + \";\" : \"\") + val\n      else if (name != \"nodeName\") top[name] = val\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) return nodeDOM\n\n  let curDOM = nodeDOM\n  for (let i = 0; i < curComputed.length; i++) {\n    let deco = curComputed[i], prev = prevComputed[i]\n    if (i) {\n      let parent\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent\n      } else {\n        parent = document.createElement(deco.nodeName)\n        parent.pmIsDeco = true\n        parent.appendChild(curDOM)\n        prev = noDeco[0]\n        curDOM = parent\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco)\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (let name in prev)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      dom.removeAttribute(name)\n  for (let name in cur)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && cur[name] != prev[name])\n      dom.setAttribute(name, cur[name])\n  if (prev.class != cur.class) {\n    let prevList = prev.class ? prev.class.split(\" \").filter(Boolean) : nothing\n    let curList = cur.class ? cur.class.split(\" \").filter(Boolean) : nothing\n    for (let i = 0; i < prevList.length; i++) if (curList.indexOf(prevList[i]) == -1)\n      dom.classList.remove(prevList[i])\n    for (let i = 0; i < curList.length; i++) if (prevList.indexOf(curList[i]) == -1)\n      dom.classList.add(curList[i])\n    if (dom.classList.length == 0)\n      dom.removeAttribute(\"class\")\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      let prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m\n      while (m = prop.exec(prev.style))\n        dom.style.removeProperty(m[1])\n    }\n    if (cur.style)\n      dom.style.cssText += cur.style\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration]) → bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) return false\n  for (let i = 0; i < a.length; i++) if (!a[i].type.eq(b[i].type)) return false\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  let next = dom.nextSibling\n  dom.parentNode.removeChild(dom)\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nclass ViewTreeUpdater {\n  // : (NodeViewDesc)\n  constructor(top, lockedNode) {\n    this.top = top\n    this.lock = lockedNode\n    // Index into `this.top`'s child array, represents the current\n    // update position.\n    this.index = 0\n    // When entering a mark, the current top and index are pushed\n    // onto this.\n    this.stack = []\n    // Tracks whether anything was changed\n    this.changed = false\n\n    this.preMatch = preMatch(top.node.content, top)\n  }\n\n  // Destroy and remove the children between the given indices in\n  // `this.top`.\n  destroyBetween(start, end) {\n    if (start == end) return\n    for (let i = start; i < end; i++) this.top.children[i].destroy()\n    this.top.children.splice(start, end - start)\n    this.changed = true\n  }\n\n  // Destroy all remaining children in `this.top`.\n  destroyRest() {\n    this.destroyBetween(this.index, this.top.children.length)\n  }\n\n  // : ([Mark], EditorView)\n  // Sync the current stack of mark descs with the given array of\n  // marks, reusing existing mark descs when possible.\n  syncToMarks(marks, inline, view) {\n    let keep = 0, depth = this.stack.length >> 1\n    let maxKeep = Math.min(depth, marks.length)\n    while (keep < maxKeep &&\n           (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n      keep++\n\n    while (keep < depth) {\n      this.destroyRest()\n      this.top.dirty = NOT_DIRTY\n      this.index = this.stack.pop()\n      this.top = this.stack.pop()\n      depth--\n    }\n    while (depth < marks.length) {\n      this.stack.push(this.top, this.index + 1)\n      let found = -1\n      for (let i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n        if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n      }\n      if (found > -1) {\n        if (found > this.index) {\n          this.changed = true\n          this.destroyBetween(this.index, found)\n        }\n        this.top = this.top.children[this.index]\n      } else {\n        let markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view)\n        this.top.children.splice(this.index, 0, markDesc)\n        this.top = markDesc\n        this.changed = true\n      }\n      this.index = 0\n      depth++\n    }\n  }\n\n  // : (Node, [Decoration], DecorationSource) → bool\n  // Try to find a node desc matching the given data. Skip over it and\n  // return true when successful.\n  findNodeMatch(node, outerDeco, innerDeco, index) {\n    let found = -1, targetDesc\n    if (index >= this.preMatch.index &&\n        (targetDesc = this.preMatch.matches[index - this.preMatch.index]).parent == this.top &&\n        targetDesc.matchesNode(node, outerDeco, innerDeco)) {\n      found = this.top.children.indexOf(targetDesc, this.index)\n    } else {\n      for (let i = this.index, e = Math.min(this.top.children.length, i + 5); i < e; i++) {\n        let child = this.top.children[i]\n        if (child.matchesNode(node, outerDeco, innerDeco) && !this.preMatch.matched.has(child)) {\n          found = i\n          break\n        }\n      }\n    }\n    if (found < 0) return false\n    this.destroyBetween(this.index, found)\n    this.index++\n    return true\n  }\n\n  updateNodeAt(node, outerDeco, innerDeco, index, view) {\n    let child = this.top.children[index]\n    if (!child.update(node, outerDeco, innerDeco, view)) return false\n    this.destroyBetween(this.index, index)\n    this.index = index + 1\n    return true\n  }\n\n  findIndexWithChild(domNode) {\n    for (;;) {\n      let parent = domNode.parentNode\n      if (!parent) return -1\n      if (parent == this.top.contentDOM) {\n        let desc = domNode.pmViewDesc\n        if (desc) for (let i = this.index; i < this.top.children.length; i++) {\n          if (this.top.children[i] == desc) return i\n        }\n        return -1\n      }\n      domNode = parent\n    }\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView, Fragment, number) → bool\n  // Try to update the next node, if any, to the given data. Checks\n  // pre-matches to avoid overwriting nodes that could still be used.\n  updateNextNode(node, outerDeco, innerDeco, view, index) {\n    for (let i = this.index; i < this.top.children.length; i++) {\n      let next = this.top.children[i]\n      if (next instanceof NodeViewDesc) {\n        let preMatch = this.preMatch.matched.get(next)\n        if (preMatch != null && preMatch != index) return false\n        let nextDOM = next.dom\n\n        // Can't update if nextDOM is or contains this.lock, except if\n        // it's a text node whose content already matches the new text\n        // and whose decorations match the new ones.\n        let locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n            !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n              next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco))\n        if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n          this.destroyBetween(this.index, i)\n          if (next.dom != nextDOM) this.changed = true\n          this.index++\n          return true\n        }\n        break\n      }\n    }\n    return false\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView)\n  // Insert the node as a newly created node desc.\n  addNode(node, outerDeco, innerDeco, view, pos) {\n    this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos))\n    this.changed = true\n  }\n\n  placeWidget(widget, view, pos) {\n    let next = this.index < this.top.children.length ? this.top.children[this.index] : null\n    if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n      this.index++\n    } else {\n      let desc = new WidgetViewDesc(this.top, widget, view, pos)\n      this.top.children.splice(this.index++, 0, desc)\n      this.changed = true\n    }\n  }\n\n  // Make sure a textblock looks and behaves correctly in\n  // contentEditable.\n  addTextblockHacks() {\n    let lastChild = this.top.children[this.index - 1]\n    while (lastChild instanceof MarkViewDesc) lastChild = lastChild.children[lastChild.children.length - 1]\n\n    if (!lastChild || // Empty textblock\n        !(lastChild instanceof TextViewDesc) ||\n        /\\n$/.test(lastChild.node.text)) {\n      // Avoid bugs in Safari's cursor drawing (#1165) and Chrome's mouse selection (#1152)\n      if ((browser.safari || browser.chrome) && lastChild && lastChild.dom.contentEditable == \"false\")\n        this.addHackNode(\"IMG\")\n      this.addHackNode(\"BR\")\n    }\n  }\n\n  addHackNode(nodeName) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack(nodeName)) {\n      this.index++\n    } else {\n      let dom = document.createElement(nodeName)\n      if (nodeName == \"IMG\") {\n        dom.className = \"ProseMirror-separator\"\n        dom.alt = \"\"\n      }\n      if (nodeName == \"BR\") dom.className = \"ProseMirror-trailingBreak\"\n      this.top.children.splice(this.index++, 0, new TrailingHackViewDesc(this.top, nothing, dom, null))\n      this.changed = true\n    }\n  }\n}\n\n// : (Fragment, [ViewDesc]) → {index: number, matched: Map<ViewDesc, number>, matches: ViewDesc[]}\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing those\n// for other nodes. Returns the fragment index of the first node that\n// is part of the sequence of matched nodes at the end of the\n// fragment.\nfunction preMatch(frag, parentDesc) {\n  let curDesc = parentDesc, descI = curDesc.children.length\n  let fI = frag.childCount, matched = new Map, matches = []\n  outer: while (fI > 0) {\n    let desc\n    for (;;) {\n      if (descI) {\n        let next = curDesc.children[descI - 1]\n        if (next instanceof MarkViewDesc) {\n          curDesc = next\n          descI = next.children.length\n        } else {\n          desc = next\n          descI--\n          break\n        }\n      } else if (curDesc == parentDesc) {\n        break outer\n      } else {\n        // FIXME\n        descI = curDesc.parent.children.indexOf(curDesc)\n        curDesc = curDesc.parent\n      }\n    }\n    let node = desc.node\n    if (!node) continue\n    if (node != frag.child(fI - 1)) break\n    --fI\n    matched.set(desc, fI)\n    matches.push(desc)\n  }\n  return {index: fI, matched, matches: matches.reverse()}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSource, (Decoration, number), (Node, [Decoration], DecorationSource, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  let locals = deco.locals(parent), offset = 0\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (let i = 0; i < parent.childCount; i++) {\n      let child = parent.child(i)\n      onNode(child, locals, deco.forChild(offset, child), i)\n      offset += child.nodeSize\n    }\n    return\n  }\n\n  let decoIndex = 0, active = [], restNode = null\n  for (let parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      let widget = locals[decoIndex++], widgets\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        (widgets || (widgets = [widget])).push(locals[decoIndex++])\n      if (widgets) {\n        widgets.sort(compareSide)\n        for (let i = 0; i < widgets.length; i++) onWidget(widgets[i], parentIndex, !!restNode)\n      } else {\n        onWidget(widget, parentIndex, !!restNode)\n      }\n    }\n\n    let child, index\n    if (restNode) {\n      index = -1\n      child = restNode\n      restNode = null\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex\n      child = parent.child(parentIndex++)\n    } else {\n      break\n    }\n\n    for (let i = 0; i < active.length; i++) if (active[i].to <= offset) active.splice(i--, 1)\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      active.push(locals[decoIndex++])\n\n    let end = offset + child.nodeSize\n    if (child.isText) {\n      let cutAt = end\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) cutAt = locals[decoIndex].from\n      for (let i = 0; i < active.length; i++) if (active[i].to < cutAt) cutAt = active[i].to\n      if (cutAt < end) {\n        restNode = child.cut(cutAt - offset)\n        child = child.cut(0, cutAt - offset)\n        end = cutAt\n        index = -1\n      }\n    }\n\n    let outerDeco = !active.length ? nothing\n        : child.isInline && !child.isLeaf ? active.filter(d => !d.inline)\n        : active.slice()\n    onNode(child, outerDeco, deco.forChild(offset, child), index)\n    offset = end\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    let oldCSS = dom.style.cssText\n    dom.style.cssText = oldCSS + \"; list-style: square !important\"\n    window.getComputedStyle(dom).listStyle\n    dom.style.cssText = oldCSS\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) return node\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        return node.childNodes[offset]\n      node = node.childNodes[offset - 1]\n      offset = nodeSize(node)\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset]\n      offset = 0\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (let i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    let child = frag.child(i++), childStart = pos\n    pos += child.nodeSize\n    if (!child.isText) continue\n    let str = child.text\n    while (i < frag.childCount) {\n      let next = frag.child(i++)\n      pos += next.nodeSize\n      if (!next.isText) break\n      str += next.text\n    }\n    if (pos >= from) {\n      let found = childStart < to ? str.lastIndexOf(text, to - childStart - 1) : -1\n      if (found >= 0 && found + text.length + childStart >= from)\n        return childStart + found\n      if (from == to && str.length >= (to + text.length) - childStart &&\n          str.slice(to - childStart, to - childStart + text.length) == text)\n        return to\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  let result = []\n  for (let i = 0, off = 0; i < nodes.length; i++) {\n    let child = nodes[i], start = off, end = off += child.size\n    if (start >= to || end <= from) {\n      result.push(child)\n    } else {\n      if (start < from) result.push(child.slice(0, from - start, view))\n      if (replacement) {\n        result.push(replacement)\n        replacement = null\n      }\n      if (end > to) result.push(child.slice(to - start, child.size, view))\n    }\n  }\n  return result\n}\n","import {Selection, NodeSelection, TextSelection, AllSelection} from \"prosemirror-state\"\nimport browser from \"./browser\"\nimport {domIndex, selectionCollapsed} from \"./dom\"\nimport {selectionToDOM} from \"./selection\"\n\nfunction moveSelectionBlock(state, dir) {\n  let {$anchor, $head} = state.selection\n  let $side = dir > 0 ? $anchor.max($head) : $anchor.min($head)\n  let $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView())\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      let next = moveSelectionBlock(view.state, dir)\n      if (next && (next instanceof NodeSelection)) return apply(view, next)\n      return false\n    } else if (!(browser.mac && mods.indexOf(\"m\") > -1)) {\n      let $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc\n      if (!node || node.isText) return false\n      let nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) return false\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (browser.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next) return apply(view, next)\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let moveNode, moveOffset, force = false\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (browser.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) force = true\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        let before = node.childNodes[offset - 1]\n        if (isIgnorable(before)) {\n          moveNode = node\n          moveOffset = --offset\n        } else if (before.nodeType == 3) {\n          node = before\n          offset = node.nodeValue.length\n        } else break\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let prev = node.previousSibling\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode\n        moveOffset = domIndex(prev)\n        prev = prev.previousSibling\n      }\n      if (!prev) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = 0\n      } else {\n        node = prev\n        offset = nodeLen(node)\n      }\n    }\n  }\n  if (force) setSelFocus(view, sel, node, offset)\n  else if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let len = nodeLen(node)\n  let moveNode, moveOffset\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) break\n      let after = node.childNodes[offset]\n      if (isIgnorable(after)) {\n        moveNode = node\n        moveOffset = ++offset\n      }\n      else break\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let next = node.nextSibling\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode\n        moveOffset = domIndex(next) + 1\n        next = next.nextSibling\n      }\n      if (!next) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = len = 0\n      } else {\n        node = next\n        offset = 0\n        len = nodeLen(node)\n      }\n    }\n  }\n  if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\nfunction isBlockNode(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    let range = document.createRange()\n    range.setEnd(node, offset)\n    range.setStart(node, offset)\n    sel.removeAllRanges()\n    sel.addRange(range)\n  } else if (sel.extend) {\n    sel.extend(node, offset)\n  }\n  view.domObserver.setCurSelection()\n  let {state} = view\n  // If no state update ends up happening, reset the selection.\n  setTimeout(() => {\n    if (view.state == state) selectionToDOM(view)\n  }, 50)\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) return false\n  if (browser.mac && mods.indexOf(\"m\") > -1) return false\n  let {$from, $to} = sel\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next && (next instanceof NodeSelection))\n      return apply(view, next)\n  }\n  if (!$from.parent.inlineContent) {\n    let side = dir < 0 ? $from : $to\n    let beyond = sel instanceof AllSelection ? Selection.near(side, dir) : Selection.findFrom(side, dir)\n    return beyond ? apply(view, beyond) : false\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) return true\n  let {$head, $anchor, empty} = view.state.selection\n  if (!$head.sameParent($anchor)) return true\n  if (!empty) return false\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) return true\n  let nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter)\n  if (nextNode && !nextNode.isText) {\n    let tr = view.state.tr\n    if (dir < 0) tr.delete($head.pos - nextNode.nodeSize, $head.pos)\n    else tr.delete($head.pos, $head.pos + nextNode.nodeSize)\n    view.dispatch(tr)\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop()\n  node.contentEditable = state\n  view.domObserver.start()\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!browser.safari || view.state.selection.$head.parentOffset > 0) return\n  let {focusNode, focusOffset} = view.root.getSelection()\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    let child = focusNode.firstChild\n    switchEditable(view, child, true)\n    setTimeout(() => switchEditable(view, child, false), 20)\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  let result = \"\"\n  if (event.ctrlKey) result += \"c\"\n  if (event.metaKey) result += \"m\"\n  if (event.altKey) result += \"a\"\n  if (event.shiftKey) result += \"s\"\n  return result\n}\n\nexport function captureKeyDown(view, event) {\n  let code = event.keyCode, mods = getMods(event)\n  if (code == 8 || (browser.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (browser.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (browser.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n","import {Fragment, DOMParser} from \"prosemirror-model\"\nimport {Selection, TextSelection} from \"prosemirror-state\"\n\nimport {selectionBetween, selectionFromDOM, selectionToDOM} from \"./selection\"\nimport {selectionCollapsed, keyEvent} from \"./dom\"\nimport browser from \"./browser\"\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  let {node: parent, fromOffset, toOffset, from, to} = view.docView.parseRange(from_, to_)\n\n  let domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}]\n    if (!selectionCollapsed(domSel))\n      find.push({node: domSel.focusNode, offset: domSel.focusOffset})\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (browser.chrome && view.lastKeyCode === 8) {\n    for (let off = toOffset; off > fromOffset; off--) {\n      let node = parent.childNodes[off - 1], desc = node.pmViewDesc\n      if (node.nodeName == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) break\n    }\n  }\n  let startDoc = view.state.doc\n  let parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n  let $from = startDoc.resolve(from)\n\n  let sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.whitespace == \"pre\" ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode,\n    context: $from\n  })\n  if (find && find[0].pos != null) {\n    let anchor = find[0].pos, head = find[1] && find[1].pos\n    if (head == null) head = anchor\n    sel = {anchor: anchor + from, head: head + from}\n  }\n  return {doc, sel, from, to}\n}\n\nfunction ruleFromNode(dom) {\n  let desc = dom.pmViewDesc\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (browser.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      let skip = document.createElement(\"div\")\n      skip.appendChild(document.createElement(\"li\"))\n      return {skip}\n    } else if (dom.parentNode.lastChild == dom || browser.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nexport function readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    let origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null\n    let newSel = selectionFromDOM(view, origin)\n    if (newSel && !view.state.selection.eq(newSel)) {\n      let tr = view.state.tr.setSelection(newSel)\n      if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n      else if (origin == \"key\") tr.scrollIntoView()\n      view.dispatch(tr)\n    }\n    return\n  }\n\n  let $before = view.state.doc.resolve(from)\n  let shared = $before.sharedDepth(to)\n  from = $before.before(shared + 1)\n  to = view.state.doc.resolve(to).after(shared + 1)\n\n  let sel = view.state.selection\n  let parse = parseBetween(view, from, to)\n\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (browser.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    let text = view.cursorWrapper.deco.type.toDOM.nextSibling\n    let size = text && text.nodeValue ? text.nodeValue.length : 1\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size}\n  }\n\n  let doc = view.state.doc, compare = doc.slice(parse.from, parse.to)\n  let preferredPos, preferredSide\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to\n    preferredSide = \"end\"\n  } else {\n    preferredPos = view.state.selection.from\n    preferredSide = \"start\"\n  }\n  view.lastKeyCode = null\n\n  let change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide)\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to}\n    } else if ((browser.ios && view.lastIOSEnter > Date.now() - 225 || browser.android) &&\n               addedNodes.some(n => n.nodeName == \"DIV\" || n.nodeName == \"P\") &&\n               view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))) {\n      view.lastIOSEnter = 0\n      return\n    } else {\n      if (parse.sel) {\n        let sel = resolveSelection(view, view.state.doc, parse.sel)\n        if (sel && !sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n      }\n      return\n    }\n  }\n  view.domChangeCount++\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2 &&\n        view.state.selection.from >= parse.from) {\n      change.start = view.state.selection.from\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2 &&\n               view.state.selection.to <= parse.to) {\n      change.endB += (view.state.selection.to - change.endA)\n      change.endA = view.state.selection.to\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (browser.ie && browser.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--\n    change.endA--\n    change.endB--\n  }\n\n  let $from = parse.doc.resolveNoCache(change.start - parse.from)\n  let $to = parse.doc.resolveNoCache(change.endB - parse.from)\n  let inlineChange = $from.sameParent($to) && $from.parent.inlineContent\n  let nextSel\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((browser.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(n => n.nodeName == \"DIV\" || n.nodeName == \"P\"))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))) {\n    view.lastIOSEnter = 0\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) {\n    if (browser.android && browser.chrome) view.domObserver.suppressSelectionUpdates() // #820\n    return\n  }\n\n  // Chrome Android will occasionally, during composition, delete the\n  // entire composition and then immediately insert it again. This is\n  // used to detect that situation.\n  if (browser.chrome && browser.android && change.toB == change.from)\n    view.lastAndroidDelete = Date.now()\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (browser.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2\n    $to = parse.doc.resolveNoCache(change.endB - parse.from)\n    setTimeout(() => {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })\n    }, 20)\n  }\n\n  let chFrom = change.start, chTo = change.endA\n\n  let tr, storedMarks, markChange, $from1\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (browser.ie && browser.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates()\n        setTimeout(() => selectionToDOM(view), 20)\n      }\n      tr = view.state.tr.delete(chFrom, chTo)\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA))\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr\n      if (markChange.type == \"add\") tr.addMark(chFrom, chTo, markChange.mark)\n      else tr.removeMark(chFrom, chTo, markChange.mark)\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      let text = $from.parent.textBetween($from.parentOffset, $to.parentOffset)\n      if (view.someProp(\"handleTextInput\", f => f(view, chFrom, chTo, text))) return\n      tr = view.state.tr.insertText(text, chFrom, chTo)\n    }\n  }\n\n  if (!tr)\n    tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from))\n  if (parse.sel) {\n    let sel = resolveSelection(view, tr.doc, parse.sel)\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel && !(browser.chrome && browser.android && view.composing && sel.empty &&\n                 (change.start != change.endB || view.lastAndroidDelete < Date.now() - 100) &&\n                 (sel.head == chFrom || sel.head == tr.mapping.map(chTo) - 1) ||\n                 browser.ie && sel.empty && sel.head == chFrom))\n      tr.setSelection(sel)\n  }\n  if (storedMarks) tr.ensureMarks(storedMarks)\n  view.dispatch(tr.scrollIntoView())\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) return null\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment) → ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  let curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks\n  let added = curMarks, removed = prevMarks, type, mark, update\n  for (let i = 0; i < prevMarks.length; i++) added = prevMarks[i].removeFromSet(added)\n  for (let i = 0; i < curMarks.length; i++) removed = curMarks[i].removeFromSet(removed)\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0]\n    type = \"add\"\n    update = node => node.mark(mark.addToSet(node.marks))\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0]\n    type = \"remove\"\n    update = node => node.mark(mark.removeFromSet(node.marks))\n  } else {\n    return null\n  }\n  let updated = []\n  for (let i = 0; i < prev.childCount; i++) updated.push(update(prev.child(i)))\n  if (Fragment.from(updated).eq(cur)) return {mark, type}\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    return false\n\n  let $start = old.resolve(start)\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    return false\n  let $next = old.resolve(skipClosingAndOpening($start, true, true))\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    return false\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  let depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--\n    end++\n    fromEnd = false\n  }\n  if (mayOpen) {\n    let next = $pos.node(depth).maybeChild($pos.indexAfter(depth))\n    while (next && !next.isLeaf) {\n      next = next.firstChild\n      end++\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  let start = a.findDiffStart(b, pos)\n  if (start == null) return null\n  let {a: endA, b: endB} = a.findDiffEnd(b, pos + a.size, pos + b.size)\n  if (preferredSide == \"end\") {\n    let adjust = Math.max(0, start - Math.min(endA, endB))\n    preferredPos -= endA + adjust - start\n  }\n  if (endA < start && a.size < b.size) {\n    let move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0\n    start -= move\n    endB = start + (endB - endA)\n    endA = start\n  } else if (endB < start) {\n    let move = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0\n    start -= move\n    endA = start + (endA - endB)\n    endB = start\n  }\n  return {start, endA, endB}\n}\n","import {Slice, Fragment, DOMParser, DOMSerializer} from \"prosemirror-model\"\nimport browser from \"./browser\"\n\nexport function serializeForClipboard(view, slice) {\n  let context = [], {content, openStart, openEnd} = slice\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--\n    openEnd--\n    let node = content.firstChild\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null)\n    content = node.content\n  }\n\n  let serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema)\n  let doc = detachedDoc(), wrap = doc.createElement(\"div\")\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}))\n\n  let firstChild = wrap.firstChild, needsWrap\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (let i = needsWrap.length - 1; i >= 0; i--) {\n      let wrapper = doc.createElement(needsWrap[i])\n      while (wrap.firstChild) wrapper.appendChild(wrap.firstChild)\n      wrap.appendChild(wrapper)\n      if (needsWrap[i] != \"tbody\") {\n        openStart++\n        openEnd++\n      }\n    }\n    firstChild = wrap.firstChild\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    firstChild.setAttribute(\"data-pm-slice\", `${openStart} ${openEnd} ${JSON.stringify(context)}`)\n\n  let text = view.someProp(\"clipboardTextSerializer\", f => f(slice)) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\")\n\n  return {dom: wrap, text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos) → ?Slice\n// Read a slice of content from the clipboard (or drop data).\nexport function parseFromClipboard(view, text, html, plainText, $context) {\n  let dom, inCode = $context.parent.type.spec.code, slice\n  if (!html && !text) return null\n  let asText = text && (plainText || inCode || !html)\n  if (asText) {\n    view.someProp(\"transformPastedText\", f => { text = f(text, inCode || plainText) })\n    if (inCode) return text ? new Slice(Fragment.from(view.state.schema.text(text.replace(/\\r\\n?/g, \"\\n\"))), 0, 0) : Slice.empty\n    let parsed = view.someProp(\"clipboardTextParser\", f => f(text, $context, plainText))\n    if (parsed) {\n      slice = parsed\n    } else {\n      let marks = $context.marks()\n      let {schema} = view.state, serializer = DOMSerializer.fromSchema(schema)\n      dom = document.createElement(\"div\")\n      text.split(/(?:\\r\\n?|\\n)+/).forEach(block => {\n        let p = dom.appendChild(document.createElement(\"p\"))\n        if (block) p.appendChild(serializer.serializeNode(schema.text(block, marks)))\n      })\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", f => { html = f(html) })\n    dom = readHTML(html)\n    if (browser.webkit) restoreReplacedSpaces(dom)\n  }\n\n  let contextNode = dom && dom.querySelector(\"[data-pm-slice]\")\n  let sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"))\n  if (!slice) {\n    let parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n    slice = parser.parseSlice(dom, {\n      preserveWhitespace: !!(asText || sliceData),\n      context: $context,\n      ruleFromNode(dom) {\n        if (dom.nodeName == \"BR\" && !dom.nextSibling &&\n            dom.parentNode && !inlineParents.test(dom.parentNode.nodeName)) return {ignore: true}\n      }\n    })\n  }\n  if (sliceData) {\n    slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3])\n  } else { // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), true)\n    if (slice.openStart || slice.openEnd) {\n      let openStart = 0, openEnd = 0\n      for (let node = slice.content.firstChild; openStart < slice.openStart && !node.type.spec.isolating;\n           openStart++, node = node.firstChild) {}\n      for (let node = slice.content.lastChild; openEnd < slice.openEnd && !node.type.spec.isolating;\n           openEnd++, node = node.lastChild) {}\n      slice = closeSlice(slice, openStart, openEnd)\n    }\n  }\n\n  view.someProp(\"transformPasted\", f => { slice = f(slice) })\n  return slice\n}\n\nconst inlineParents = /^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) return fragment\n  for (let d = $context.depth; d >= 0; d--) {\n    let parent = $context.node(d)\n    let match = parent.contentMatchAt($context.index(d))\n    let lastWrap, result = []\n    fragment.forEach(node => {\n      if (!result) return\n      let wrap = match.findWrapping(node.type), inLast\n      if (!wrap) return result = null\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast\n      } else {\n        if (result.length) result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length)\n        let wrapped = withWrappers(node, wrap)\n        result.push(wrapped)\n        match = match.matchType(wrapped.type, wrapped.attrs)\n        lastWrap = wrap\n      }\n    })\n    if (result) return Fragment.from(result)\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from = 0) {\n  for (let i = wrap.length - 1; i >= from; i--)\n    node = wrap[i].create(null, Fragment.from(node))\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    let inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1)\n    if (inner) return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner))\n    let match = sibling.contentMatchAt(sibling.childCount)\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1))))\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) return node\n  let fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1))\n  let fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  let node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content\n  if (depth < to - 1) inner = closeRange(inner, side, from, to, depth + 1, openEnd)\n  if (depth >= from)\n    inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true))\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd)\n  if (openEnd < slice.openEnd)\n    slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd)\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nconst wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n}\n\nlet _detachedDoc = null\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  let metas = /^(\\s*<meta [^>]*>)*/.exec(html)\n  if (metas) html = html.slice(metas[0].length)\n  let elt = detachedDoc().createElement(\"div\")\n  let firstTag = /<([a-z][^>\\s]+)/i.exec(html), wrap\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()])\n    html = wrap.map(n => \"<\" + n + \">\").join(\"\") + html + wrap.map(n => \"</\" + n + \">\").reverse().join(\"\")\n  elt.innerHTML = html\n  if (wrap) for (let i = 0; i < wrap.length; i++) elt = elt.querySelector(wrap[i]) || elt\n  return elt\n}\n\n// Webkit browsers do some hard-to-predict replacement of regular\n// spaces with non-breaking spaces when putting content on the\n// clipboard. This tries to convert such non-breaking spaces (which\n// will be wrapped in a plain span on Chrome, a span with class\n// Apple-converted-space on Safari) back to regular spaces.\nfunction restoreReplacedSpaces(dom) {\n  let nodes = dom.querySelectorAll(browser.chrome ? \"span:not([class]):not([style])\" : \"span.Apple-converted-space\")\n  for (let i = 0; i < nodes.length; i++) {\n    let node = nodes[i]\n    if (node.childNodes.length == 1 && node.textContent == \"\\u00a0\" && node.parentNode)\n      node.parentNode.replaceChild(dom.ownerDocument.createTextNode(\" \"), node)\n  }\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) return slice\n  let schema = slice.content.firstChild.type.schema, array\n  try { array = JSON.parse(context) }\n  catch(e) { return slice }\n  let {content, openStart, openEnd} = slice\n  for (let i = array.length - 2; i >= 0; i -= 2) {\n    let type = schema.nodes[array[i]]\n    if (!type || type.hasRequiredAttrs()) break\n    content = Fragment.from(type.create(array[i + 1], content))\n    openStart++; openEnd++\n  }\n  return new Slice(content, openStart, openEnd)\n}\n","import browser from \"./browser\"\nimport {domIndex, isEquivalentPosition} from \"./dom\"\nimport {hasFocusAndSelection, hasSelection, selectionToDOM} from \"./selection\"\n\nconst observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n}\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nconst useCharData = browser.ie && browser.ie_version <= 11\n\nclass SelectionState {\n  constructor() {\n    this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null\n  }\n\n  set(sel) {\n    this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset\n    this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset\n  }\n\n  eq(sel) {\n    return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n      sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n  }\n}\n\nexport class DOMObserver {\n  constructor(view, handleDOMChange) {\n    this.view = view\n    this.handleDOMChange = handleDOMChange\n    this.queue = []\n    this.flushingSoon = -1\n    this.observer = window.MutationObserver &&\n      new window.MutationObserver(mutations => {\n        for (let i = 0; i < mutations.length; i++) this.queue.push(mutations[i])\n        // IE11 will sometimes (on backspacing out a single character\n        // text node after a BR node) call the observer callback\n        // before actually updating the DOM, which will cause\n        // ProseMirror to miss the change (see #930)\n        if (browser.ie && browser.ie_version <= 11 && mutations.some(\n          m => m.type == \"childList\" && m.removedNodes.length ||\n               m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length))\n          this.flushSoon()\n        else\n          this.flush()\n      })\n    this.currentSelection = new SelectionState\n    if (useCharData) {\n      this.onCharData = e => {\n        this.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue})\n        this.flushSoon()\n      }\n    }\n    this.onSelectionChange = this.onSelectionChange.bind(this)\n    this.suppressingSelectionUpdates = false\n  }\n\n  flushSoon() {\n    if (this.flushingSoon < 0)\n      this.flushingSoon = window.setTimeout(() => { this.flushingSoon = -1; this.flush() }, 20)\n  }\n\n  forceFlush() {\n    if (this.flushingSoon > -1) {\n      window.clearTimeout(this.flushingSoon)\n      this.flushingSoon = -1\n      this.flush()\n    }\n  }\n\n  start() {\n    if (this.observer)\n      this.observer.observe(this.view.dom, observeOptions)\n    if (useCharData)\n      this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.connectSelection()\n  }\n\n  stop() {\n    if (this.observer) {\n      let take = this.observer.takeRecords()\n      if (take.length) {\n        for (let i = 0; i < take.length; i++) this.queue.push(take[i])\n        window.setTimeout(() => this.flush(), 20)\n      }\n      this.observer.disconnect()\n    }\n    if (useCharData) this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.disconnectSelection()\n  }\n\n  connectSelection() {\n    this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  disconnectSelection() {\n    this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  suppressSelectionUpdates() {\n    this.suppressingSelectionUpdates = true\n    setTimeout(() => this.suppressingSelectionUpdates = false, 50)\n  }\n\n  onSelectionChange() {\n    if (!hasFocusAndSelection(this.view)) return\n    if (this.suppressingSelectionUpdates) return selectionToDOM(this.view)\n    // Deletions on IE11 fire their events in the wrong order, giving\n    // us a selection change event before the DOM changes are\n    // reported.\n    if (browser.ie && browser.ie_version <= 11 && !this.view.state.selection.empty) {\n      let sel = this.view.root.getSelection()\n      // Selection.isCollapsed isn't reliable on IE\n      if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n        return this.flushSoon()\n    }\n    this.flush()\n  }\n\n  setCurSelection() {\n    this.currentSelection.set(this.view.root.getSelection())\n  }\n\n  ignoreSelectionChange(sel) {\n    if (sel.rangeCount == 0) return true\n    let container = sel.getRangeAt(0).commonAncestorContainer\n    let desc = this.view.docView.nearestDesc(container)\n    if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n      this.setCurSelection()\n      return true\n    }\n  }\n\n  flush() {\n    if (!this.view.docView || this.flushingSoon > -1) return\n    let mutations = this.observer ? this.observer.takeRecords() : []\n    if (this.queue.length) {\n      mutations = this.queue.concat(mutations)\n      this.queue.length = 0\n    }\n\n    let sel = this.view.root.getSelection()\n    let newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel)\n\n    let from = -1, to = -1, typeOver = false, added = []\n    if (this.view.editable) {\n      for (let i = 0; i < mutations.length; i++) {\n        let result = this.registerMutation(mutations[i], added)\n        if (result) {\n          from = from < 0 ? result.from : Math.min(result.from, from)\n          to = to < 0 ? result.to : Math.max(result.to, to)\n          if (result.typeOver) typeOver = true\n        }\n      }\n    }\n\n    if (browser.gecko && added.length > 1) {\n      let brs = added.filter(n => n.nodeName == \"BR\")\n      if (brs.length == 2) {\n        let [a, b] = brs\n        if (a.parentNode && a.parentNode.parentNode == b.parentNode) b.remove()\n        else a.remove()\n      }\n    }\n\n    if (from > -1 || newSel) {\n      if (from > -1) {\n        this.view.docView.markDirty(from, to)\n        checkCSS(this.view)\n      }\n      this.handleDOMChange(from, to, typeOver, added)\n      if (this.view.docView && this.view.docView.dirty) this.view.updateState(this.view.state)\n      else if (!this.currentSelection.eq(sel)) selectionToDOM(this.view)\n      this.currentSelection.set(sel)\n    }\n  }\n\n  registerMutation(mut, added) {\n    // Ignore mutations inside nodes that were already noted as inserted\n    if (added.indexOf(mut.target) > -1) return null\n    let desc = this.view.docView.nearestDesc(mut.target)\n    if (mut.type == \"attributes\" &&\n        (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n         // Firefox sometimes fires spurious events for null/empty styles\n         (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n      return null\n    if (!desc || desc.ignoreMutation(mut)) return null\n\n    if (mut.type == \"childList\") {\n      for (let i = 0; i < mut.addedNodes.length; i++) added.push(mut.addedNodes[i])\n      if (desc.contentDOM && desc.contentDOM != desc.dom && !desc.contentDOM.contains(mut.target))\n        return {from: desc.posBefore, to: desc.posAfter}\n      let prev = mut.previousSibling, next = mut.nextSibling\n      if (browser.ie && browser.ie_version <= 11 && mut.addedNodes.length) {\n        // IE11 gives us incorrect next/prev siblings for some\n        // insertions, so if there are added nodes, recompute those\n        for (let i = 0; i < mut.addedNodes.length; i++) {\n          let {previousSibling, nextSibling} = mut.addedNodes[i]\n          if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) prev = previousSibling\n          if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) next = nextSibling\n        }\n      }\n      let fromOffset = prev && prev.parentNode == mut.target\n          ? domIndex(prev) + 1 : 0\n      let from = desc.localPosFromDOM(mut.target, fromOffset, -1)\n      let toOffset = next && next.parentNode == mut.target\n          ? domIndex(next) : mut.target.childNodes.length\n      let to = desc.localPosFromDOM(mut.target, toOffset, 1)\n      return {from, to}\n    } else if (mut.type == \"attributes\") {\n      return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n    } else { // \"characterData\"\n      return {\n        from: desc.posAtStart,\n        to: desc.posAtEnd,\n        // An event was generated for a text change that didn't change\n        // any text. Mark the dom change to fall back to assuming the\n        // selection was typed over with an identical value if it can't\n        // find another change.\n        typeOver: mut.target.nodeValue == mut.oldValue\n      }\n    }\n  }\n}\n\nlet cssChecked = false\n\nfunction checkCSS(view) {\n  if (cssChecked) return\n  cssChecked = true\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\")\n}\n","import {Selection, NodeSelection, TextSelection} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\nimport {Slice} from \"prosemirror-model\"\n\nimport browser from \"./browser\"\nimport {captureKeyDown} from \"./capturekeys\"\nimport {readDOMChange} from \"./domchange\"\nimport {parseFromClipboard, serializeForClipboard} from \"./clipboard\"\nimport {DOMObserver} from \"./domobserver\"\nimport {selectionBetween, selectionToDOM, selectionFromDOM} from \"./selection\"\nimport {keyEvent} from \"./dom\"\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nconst handlers = {}, editHandlers = {}\n\nexport function initInput(view) {\n  view.shiftKey = false\n  view.mouseDown = null\n  view.lastKeyCode = null\n  view.lastKeyCodeTime = 0\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"}\n  view.lastSelectionOrigin = null\n  view.lastSelectionTime = 0\n\n  view.lastIOSEnter = 0\n  view.lastIOSEnterFallbackTimeout = null\n  view.lastAndroidDelete = 0\n\n  view.composing = false\n  view.composingTimeout = null\n  view.compositionNodes = []\n  view.compositionEndedAt = -2e8\n\n  view.domObserver = new DOMObserver(view, (from, to, typeOver, added) => readDOMChange(view, from, to, typeOver, added))\n  view.domObserver.start()\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0\n\n  view.eventHandlers = Object.create(null)\n  for (let event in handlers) {\n    let handler = handlers[event]\n    view.dom.addEventListener(event, view.eventHandlers[event] = event => {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        handler(view, event)\n    })\n  }\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (browser.safari) view.dom.addEventListener(\"input\", () => null)\n\n  ensureListeners(view)\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin\n  view.lastSelectionTime = Date.now()\n}\n\nexport function destroyInput(view) {\n  view.domObserver.stop()\n  for (let type in view.eventHandlers)\n    view.dom.removeEventListener(type, view.eventHandlers[type])\n  clearTimeout(view.composingTimeout)\n  clearTimeout(view.lastIOSEnterFallbackTimeout)\n}\n\nexport function ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", currentHandlers => {\n    for (let type in currentHandlers) if (!view.eventHandlers[type])\n      view.dom.addEventListener(type, view.eventHandlers[type] = event => runCustomHandler(view, event))\n  })\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", handlers => {\n    let handler = handlers[event.type]\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) return true\n  if (event.defaultPrevented) return false\n  for (let node = event.target; node != view.dom; node = node.parentNode)\n    if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      return false\n  return true\n}\n\nexport function dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    handlers[event.type](view, event)\n}\n\neditHandlers.keydown = (view, event) => {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey\n  if (inOrNearComposition(view, event)) return\n  view.lastKeyCode = event.keyCode\n  view.lastKeyCodeTime = Date.now()\n  // Suppress enter key events on Chrome Android, because those tend\n  // to be part of a confused sequence of composition events fired,\n  // and handling them eagerly tends to corrupt the input.\n  if (browser.android && browser.chrome && event.keyCode == 13) return\n  if (event.keyCode != 229) view.domObserver.forceFlush()\n\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (browser.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    let now = Date.now()\n    view.lastIOSEnter = now\n    view.lastIOSEnterFallbackTimeout = setTimeout(() => {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))\n        view.lastIOSEnter = 0\n      }\n    }, 200)\n  } else if (view.someProp(\"handleKeyDown\", f => f(view, event)) || captureKeyDown(view, event)) {\n    event.preventDefault()\n  } else {\n    setSelectionOrigin(view, \"key\")\n  }\n}\n\neditHandlers.keyup = (view, e) => {\n  if (e.keyCode == 16) view.shiftKey = false\n}\n\neditHandlers.keypress = (view, event) => {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || browser.mac && event.metaKey) return\n\n  if (view.someProp(\"handleKeyPress\", f => f(view, event))) {\n    event.preventDefault()\n    return\n  }\n\n  let sel = view.state.selection\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    let text = String.fromCharCode(event.charCode)\n    if (!view.someProp(\"handleTextInput\", f => f(view, sel.$from.pos, sel.$to.pos, text)))\n      view.dispatch(view.state.tr.insertText(text).scrollIntoView())\n    event.preventDefault()\n  }\n}\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  let dx = click.x - event.clientX, dy = click.y - event.clientY\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    if (view.someProp(propName, f => i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false)))\n      return true\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) view.focus()\n  let tr = view.state.tr.setSelection(selection)\n  if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n  view.dispatch(tr)\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\")\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) return false\n  let sel = view.state.selection, selectedNode, selectAt\n  if (sel instanceof NodeSelection) selectedNode = sel.node\n\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        selectAt = $pos.before(sel.$from.depth)\n      else\n        selectAt = $pos.before(i)\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\")\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", f => f(view, pos, event)) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", f => f(view, pos, event))\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", f => f(view, pos, event)) ||\n    defaultTripleClick(view, inside, event)\n}\n\nfunction defaultTripleClick(view, inside, event) {\n  if (event.button != 0) return false\n  let doc = view.state.doc\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\")\n      return true\n    }\n    return false\n  }\n\n  let $pos = doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    let nodePos = $pos.before(i)\n    if (node.inlineContent)\n      updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\")\n    else if (NodeSelection.isSelectable(node))\n      updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\")\n    else\n      continue\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nconst selectNodeModifier = browser.mac ? \"metaKey\" : \"ctrlKey\"\n\nhandlers.mousedown = (view, event) => {\n  view.shiftKey = event.shiftKey\n  let flushed = forceDOMFlush(view)\n  let now = Date.now(), type = \"singleClick\"\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") type = \"doubleClick\"\n    else if (view.lastClick.type == \"doubleClick\") type = \"tripleClick\"\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type}\n\n  let pos = view.posAtCoords(eventCoords(event))\n  if (!pos) return\n\n  if (type == \"singleClick\") {\n    if (view.mouseDown) view.mouseDown.done()\n    view.mouseDown = new MouseDown(view, pos, event, flushed)\n  } else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event)) {\n    event.preventDefault()\n  } else {\n    setSelectionOrigin(view, \"pointer\")\n  }\n}\n\nclass MouseDown {\n  constructor(view, pos, event, flushed) {\n    this.view = view\n    this.startDoc = view.state.doc\n    this.pos = pos\n    this.event = event\n    this.flushed = flushed\n    this.selectNode = event[selectNodeModifier]\n    this.allowDefault = event.shiftKey\n    this.delayedSelectionSync = false\n\n    let targetNode, targetPos\n    if (pos.inside > -1) {\n      targetNode = view.state.doc.nodeAt(pos.inside)\n      targetPos = pos.inside\n    } else {\n      let $pos = view.state.doc.resolve(pos.pos)\n      targetNode = $pos.parent\n      targetPos = $pos.depth ? $pos.before() : 0\n    }\n\n    this.mightDrag = null\n\n    const target = flushed ? null : event.target\n    const targetDesc = target ? view.docView.nearestDesc(target, true) : null\n    this.target = targetDesc ? targetDesc.dom : null\n\n    let {selection} = view.state\n    if (event.button == 0 &&\n        targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n        selection instanceof NodeSelection && selection.from <= targetPos && selection.to > targetPos)\n      this.mightDrag = {node: targetNode,\n                        pos: targetPos,\n                        addAttr: this.target && !this.target.draggable,\n                        setUneditable: this.target && browser.gecko && !this.target.hasAttribute(\"contentEditable\")}\n\n    if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.draggable = true\n      if (this.mightDrag.setUneditable)\n        setTimeout(() => {\n          if (this.view.mouseDown == this) this.target.setAttribute(\"contentEditable\", \"false\")\n        }, 20)\n      this.view.domObserver.start()\n    }\n\n    view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this))\n    view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this))\n    setSelectionOrigin(view, \"pointer\")\n  }\n\n  done() {\n    this.view.root.removeEventListener(\"mouseup\", this.up)\n    this.view.root.removeEventListener(\"mousemove\", this.move)\n    if (this.mightDrag && this.target) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.removeAttribute(\"draggable\")\n      if (this.mightDrag.setUneditable) this.target.removeAttribute(\"contentEditable\")\n      this.view.domObserver.start()\n    }\n    if (this.delayedSelectionSync) setTimeout(() => selectionToDOM(this.view))\n    this.view.mouseDown = null\n  }\n\n  up(event) {\n    this.done()\n\n    if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n      return\n\n    let pos = this.pos\n    if (this.view.state.doc != this.startDoc) pos = this.view.posAtCoords(eventCoords(event))\n\n    if (this.allowDefault || !pos) {\n      setSelectionOrigin(this.view, \"pointer\")\n    } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n      event.preventDefault()\n    } else if (event.button == 0 &&\n               (this.flushed ||\n                // Safari ignores clicks on draggable elements\n                (browser.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n                // Chrome will sometimes treat a node selection as a\n                // cursor, but still report that the node is selected\n                // when asked through getSelection. You'll then get a\n                // situation where clicking at the point where that\n                // (hidden) cursor is doesn't change the selection, and\n                // thus doesn't get a reaction from ProseMirror. This\n                // works around that.\n                (browser.chrome && !(this.view.state.selection instanceof TextSelection) &&\n                 Math.min(Math.abs(pos.pos - this.view.state.selection.from),\n                          Math.abs(pos.pos - this.view.state.selection.to)) <= 2))) {\n      updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\")\n      event.preventDefault()\n    } else {\n      setSelectionOrigin(this.view, \"pointer\")\n    }\n  }\n\n  move(event) {\n    if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                               Math.abs(this.event.y - event.clientY) > 4))\n      this.allowDefault = true\n    setSelectionOrigin(this.view, \"pointer\")\n    if (event.buttons == 0) this.done()\n  }\n}\n\nhandlers.touchdown = view => {\n  forceDOMFlush(view)\n  setSelectionOrigin(view, \"pointer\")\n}\n\nhandlers.contextmenu = view => forceDOMFlush(view)\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) return true\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (browser.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nconst timeoutComposition = browser.android ? 5000 : -1\n\neditHandlers.compositionstart = editHandlers.compositionupdate = view => {\n  if (!view.composing) {\n    view.domObserver.flush()\n    let {state} = view, $pos = state.selection.$from\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(m => m.type.spec.inclusive === false)))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks()\n      endComposition(view, true)\n      view.markCursor = null\n    } else {\n      endComposition(view)\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (browser.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        let sel = view.root.getSelection()\n        for (let node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          let before = offset < 0 ? node.lastChild : node.childNodes[offset - 1]\n          if (!before) break\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length)\n            break\n          } else {\n            node = before\n            offset = -1\n          }\n        }\n      }\n    }\n    view.composing = true\n  }\n  scheduleComposeEnd(view, timeoutComposition)\n}\n\neditHandlers.compositionend = (view, event) => {\n  if (view.composing) {\n    view.composing = false\n    view.compositionEndedAt = event.timeStamp\n    scheduleComposeEnd(view, 20)\n  }\n}\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout)\n  if (delay > -1) view.composingTimeout = setTimeout(() => endComposition(view), delay)\n}\n\nexport function clearComposition(view) {\n  if (view.composing) {\n    view.composing = false\n    view.compositionEndedAt = timestampFromCustomEvent()\n  }\n  while (view.compositionNodes.length > 0) view.compositionNodes.pop().markParentsDirty()\n}\n\nfunction timestampFromCustomEvent() {\n  let event = document.createEvent(\"Event\")\n  event.initEvent(\"event\", true, true)\n  return event.timeStamp\n}\n\nexport function endComposition(view, forceUpdate) {\n  if (browser.android && view.domObserver.flushingSoon >= 0) return\n  view.domObserver.forceFlush()\n  clearComposition(view)\n  if (forceUpdate || view.docView && view.docView.dirty) {\n    let sel = selectionFromDOM(view)\n    if (sel && !sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n    else view.updateState(view.state)\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) return\n  let wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"))\n  wrap.appendChild(dom)\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  let sel = getSelection(), range = document.createRange()\n  range.selectNodeContents(dom)\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur()\n  sel.removeAllRanges()\n  sel.addRange(range)\n  setTimeout(() => {\n    if (wrap.parentNode) wrap.parentNode.removeChild(wrap)\n    view.focus()\n  }, 50)\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nconst brokenClipboardAPI = (browser.ie && browser.ie_version < 15) ||\n      (browser.ios && browser.webkit_version < 604)\n\nhandlers.copy = editHandlers.cut = (view, e) => {\n  let sel = view.state.selection, cut = e.type == \"cut\"\n  if (sel.empty) return\n\n  // IE and Edge's clipboard interface is completely broken\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  let slice = sel.content(), {dom, text} = serializeForClipboard(view, slice)\n  if (data) {\n    e.preventDefault()\n    data.clearData()\n    data.setData(\"text/html\", dom.innerHTML)\n    data.setData(\"text/plain\", text)\n  } else {\n    captureCopy(view, dom)\n  }\n  if (cut) view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\"))\n}\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) return\n  let plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code\n  let target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"))\n  if (!plainText) target.contentEditable = \"true\"\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  target.focus()\n  setTimeout(() => {\n    view.focus()\n    if (target.parentNode) target.parentNode.removeChild(target)\n    if (plainText) doPaste(view, target.value, null, e)\n    else doPaste(view, target.textContent, target.innerHTML, e)\n  }, 50)\n}\n\nfunction doPaste(view, text, html, e) {\n  let slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from)\n  if (view.someProp(\"handlePaste\", f => f(view, e, slice || Slice.empty))) return true\n  if (!slice) return false\n\n  let singleNode = sliceSingleNode(slice)\n  let tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice)\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"))\n  return true\n}\n\neditHandlers.paste = (view, e) => {\n  // Handling paste from JavaScript during composition is very poorly\n  // handled by browsers, so as a dodgy but preferable kludge, we just\n  // let the browser do its native thing there, except on Android,\n  // where the editor is almost always composing.\n  if (view.composing && !browser.android) return\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) e.preventDefault()\n  else capturePaste(view, e)\n}\n\nclass Dragging {\n  constructor(slice, move) {\n    this.slice = slice\n    this.move = move\n  }\n}\n\nconst dragCopyModifier = browser.mac ? \"altKey\" : \"ctrlKey\"\n\nhandlers.dragstart = (view, e) => {\n  let mouseDown = view.mouseDown\n  if (mouseDown) mouseDown.done()\n  if (!e.dataTransfer) return\n\n  let sel = view.state.selection\n  let pos = sel.empty ? null : view.posAtCoords(eventCoords(e))\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) {\n    // In selection\n  } else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)))\n  } else if (e.target && e.target.nodeType == 1) {\n    let desc = view.docView.nearestDesc(e.target, true)\n    if (desc && desc.node.type.spec.draggable && desc != view.docView)\n      view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)))\n  }\n  let slice = view.state.selection.content(), {dom, text} = serializeForClipboard(view, slice)\n  e.dataTransfer.clearData()\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML)\n  // See https://github.com/ProseMirror/prosemirror/issues/1156\n  e.dataTransfer.effectAllowed = \"copyMove\"\n  if (!brokenClipboardAPI) e.dataTransfer.setData(\"text/plain\", text)\n  view.dragging = new Dragging(slice, !e[dragCopyModifier])\n}\n\nhandlers.dragend = view => {\n  let dragging = view.dragging\n  window.setTimeout(() => {\n    if (view.dragging == dragging)  view.dragging = null\n  }, 50)\n}\n\neditHandlers.dragover = editHandlers.dragenter = (_, e) => e.preventDefault()\n\neditHandlers.drop = (view, e) => {\n  let dragging = view.dragging\n  view.dragging = null\n\n  if (!e.dataTransfer) return\n\n  let eventPos = view.posAtCoords(eventCoords(e))\n  if (!eventPos) return\n  let $mouse = view.state.doc.resolve(eventPos.pos)\n  if (!$mouse) return\n  let slice = dragging && dragging.slice\n  if (slice) {\n    view.someProp(\"transformPasted\", f => { slice = f(slice) })\n  } else {\n    slice = parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                               brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse)\n  }\n  let move = dragging && !e[dragCopyModifier]\n  if (view.someProp(\"handleDrop\", f => f(view, e, slice || Slice.empty, move))) {\n    e.preventDefault()\n    return\n  }\n  if (!slice) return\n\n  e.preventDefault()\n  let insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos\n  if (insertPos == null) insertPos = $mouse.pos\n\n  let tr = view.state.tr\n  if (move) tr.deleteSelection()\n\n  let pos = tr.mapping.map(insertPos)\n  let isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1\n  let beforeInsert = tr.doc\n  if (isNode)\n    tr.replaceRangeWith(pos, pos, slice.content.firstChild)\n  else\n    tr.replaceRange(pos, pos, slice)\n  if (tr.doc.eq(beforeInsert)) return\n\n  let $pos = tr.doc.resolve(pos)\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos))\n  } else {\n    let end = tr.mapping.map(insertPos)\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach((_from, _to, _newFrom, newTo) => end = newTo)\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)))\n  }\n  view.focus()\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"))\n}\n\nhandlers.focus = view => {\n  if (!view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.add(\"ProseMirror-focused\")\n    view.domObserver.start()\n    view.focused = true\n    setTimeout(() => {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        selectionToDOM(view)\n    }, 20)\n  }\n}\n\nhandlers.blur = (view, e) => {\n  if (view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.remove(\"ProseMirror-focused\")\n    view.domObserver.start()\n    if (e.relatedTarget && view.dom.contains(e.relatedTarget))\n      view.domObserver.currentSelection.set({})\n    view.focused = false\n  }\n}\n\nhandlers.beforeinput = (view, event) => {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (browser.chrome && browser.android && event.inputType == \"deleteContentBackward\") {\n    view.domObserver.flushSoon()\n    let {domChangeCount} = view\n    setTimeout(() => {\n      if (view.domChangeCount != domChangeCount) return // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur()\n      view.focus()\n      if (view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) return\n      let {$cursor} = view.state.selection\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView())\n    }, 50)\n  }\n}\n\n// Make sure all handlers get registered\nfor (let prop in editHandlers) handlers[prop] = editHandlers[prop]\n","function compareObjs(a, b) {\n  if (a == b) return true\n  for (let p in a) if (a[p] !== b[p]) return false\n  for (let p in b) if (!(p in a)) return false\n  return true\n}\n\nclass WidgetType {\n  constructor(toDOM, spec) {\n    this.spec = spec || noSpec\n    this.side = this.spec.side || 0\n    this.toDOM = toDOM\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let {pos, deleted} = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1)\n    return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n  }\n\n  valid() { return true }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof WidgetType &&\n       (this.spec.key && this.spec.key == other.spec.key ||\n        this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n  }\n\n  destroy(node) {\n    if (this.spec.destroy) this.spec.destroy(node)\n  }\n}\n\nclass InlineType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset\n    let to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset\n    return from >= to ? null : new Decoration(from, to, this)\n  }\n\n  valid(_, span) { return span.from < span.to }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n\n  static is(span) { return span.type instanceof InlineType }\n}\n\nclass NodeType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.mapResult(span.from + oldOffset, 1)\n    if (from.deleted) return null\n    let to = mapping.mapResult(span.to + oldOffset, -1)\n    if (to.deleted || to.pos <= from.pos) return null\n    return new Decoration(from.pos - offset, to.pos - offset, this)\n  }\n\n  valid(node, span) {\n    let {index, offset} = node.content.findIndex(span.from), child\n    return offset == span.from && !(child = node.child(index)).isText && offset + child.nodeSize == span.to\n  }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n}\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variants—see the static members of this class for details.\nexport class Decoration {\n  constructor(from, to, type) {\n    // :: number\n    // The start position of the decoration.\n    this.from = from\n    // :: number\n    // The end position. Will be the same as `from` for [widget\n    // decorations](#view.Decoration^widget).\n    this.to = to\n    this.type = type\n  }\n\n  copy(from, to) {\n    return new Decoration(from, to, this.type)\n  }\n\n  eq(other, offset = 0) {\n    return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n  }\n\n  map(mapping, offset, oldOffset) {\n    return this.type.map(mapping, this, offset, oldOffset)\n  }\n\n  // :: (number, union<(view: EditorView, getPos: () → number) → dom.Node, dom.Node>, ?Object) → Decoration\n  // Creates a widget decoration, which is a DOM node that's shown in\n  // the document at the given position. It is recommended that you\n  // delay rendering the widget by passing a function that will be\n  // called when the widget is actually drawn in a view, but you can\n  // also directly pass a DOM node. `getPos` can be used to find the\n  // widget's current document position.\n  //\n  //   spec::- These options are supported:\n  //\n  //     side:: ?number\n  //     Controls which side of the document position this widget is\n  //     associated with. When negative, it is drawn before a cursor\n  //     at its position, and content inserted at that position ends\n  //     up after the widget. When zero (the default) or positive, the\n  //     widget is drawn after the cursor and content inserted there\n  //     ends up before the widget.\n  //\n  //     When there are multiple widgets at a given position, their\n  //     `side` values determine the order in which they appear. Those\n  //     with lower values appear first. The ordering of widgets with\n  //     the same `side` value is unspecified.\n  //\n  //     When `marks` is null, `side` also determines the marks that\n  //     the widget is wrapped in—those of the node before when\n  //     negative, those of the node after when positive.\n  //\n  //     marks:: ?[Mark]\n  //     The precise set of marks to draw around the widget.\n  //\n  //     stopEvent:: ?(event: dom.Event) → bool\n  //     Can be used to control which DOM events, when they bubble out\n  //     of this widget, the editor view should ignore.\n  //\n  //     ignoreSelection:: ?bool\n  //     When set (defaults to false), selection changes inside the\n  //     widget are ignored, and don't cause ProseMirror to try and\n  //     re-sync the selection with its selection state.\n  //\n  //     key:: ?string\n  //     When comparing decorations of this type (in order to decide\n  //     whether it needs to be redrawn), ProseMirror will by default\n  //     compare the widget DOM node by identity. If you pass a key,\n  //     that key will be compared instead, which can be useful when\n  //     you generate decorations on the fly and don't want to store\n  //     and reuse DOM nodes. Make sure that any widgets with the same\n  //     key are interchangeable—if widgets differ in, for example,\n  //     the behavior of some event handler, they should get\n  //     different keys.\n  //\n  //     destroy:: ?(node: dom.Node)\n  //     Called when the widget decoration is removed as a result of\n  //     mapping\n  static widget(pos, toDOM, spec) {\n    return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object) → Decoration\n  // Creates an inline decoration, which adds the given attributes to\n  // each inline node between `from` and `to`.\n  //\n  //   spec::- These options are recognized:\n  //\n  //     inclusiveStart:: ?bool\n  //     Determines how the left side of the decoration is\n  //     [mapped](#transform.Position_Mapping) when content is\n  //     inserted directly at that position. By default, the decoration\n  //     won't include the new content, but you can set this to `true`\n  //     to make it inclusive.\n  //\n  //     inclusiveEnd:: ?bool\n  //     Determines how the right side of the decoration is mapped.\n  //     See\n  //     [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\n  static inline(from, to, attrs, spec) {\n    return new Decoration(from, to, new InlineType(attrs, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object) → Decoration\n  // Creates a node decoration. `from` and `to` should point precisely\n  // before and after a node in the document. That node, and only that\n  // node, will receive the given attributes.\n  //\n  //   spec::-\n  //\n  //   Optional information to store with the decoration. It\n  //   is also used when comparing decorators for equality.\n  static node(from, to, attrs, spec) {\n    return new Decoration(from, to, new NodeType(attrs, spec))\n  }\n\n  // :: Object\n  // The spec provided when creating this decoration. Can be useful\n  // if you've stored extra information in that object.\n  get spec() { return this.type.spec }\n\n  get inline() { return this.type instanceof InlineType }\n}\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nconst none = [], noSpec = {}\n\n// :: class extends DecorationSource\n// A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structure—it is not\n// modified, updates create a new value.\nexport class DecorationSet {\n  constructor(local, children) {\n    this.local = local && local.length ? local : none\n    this.children = children && children.length ? children : none\n  }\n\n  // :: (Node, [Decoration]) → DecorationSet\n  // Create a set of decorations, using the structure of the given\n  // document.\n  static create(doc, decorations) {\n    return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n  }\n\n  // :: (?number, ?number, ?(spec: Object) → bool) → [Decoration]\n  // Find all decorations in this set which touch the given range\n  // (including decorations that start or end directly at the\n  // boundaries) and match the given predicate on their spec. When\n  // `start` and `end` are omitted, all decorations in the set are\n  // considered. When `predicate` isn't given, all decorations are\n  // assumed to match.\n  find(start, end, predicate) {\n    let result = []\n    this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate)\n    return result\n  }\n\n  findInner(start, end, result, offset, predicate) {\n    for (let i = 0; i < this.local.length; i++) {\n      let span = this.local[i]\n      if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n        result.push(span.copy(span.from + offset, span.to + offset))\n    }\n    for (let i = 0; i < this.children.length; i += 3) {\n      if (this.children[i] < end && this.children[i + 1] > start) {\n        let childOff = this.children[i] + 1\n        this.children[i + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate)\n      }\n    }\n  }\n\n  // :: (Mapping, Node, ?Object) → DecorationSet\n  // Map the set of decorations in response to a change in the\n  // document.\n  //\n  //   options::- An optional set of options.\n  //\n  //     onRemove:: ?(decorationSpec: Object)\n  //     When given, this function will be called for each decoration\n  //     that gets dropped as a result of the mapping, passing the\n  //     spec of that decoration.\n  map(mapping, doc, options) {\n    if (this == empty || mapping.maps.length == 0) return this\n    return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n  }\n\n  mapInner(mapping, node, offset, oldOffset, options) {\n    let newLocal\n    for (let i = 0; i < this.local.length; i++) {\n      let mapped = this.local[i].map(mapping, offset, oldOffset)\n      if (mapped && mapped.type.valid(node, mapped)) (newLocal || (newLocal = [])).push(mapped)\n      else if (options.onRemove) options.onRemove(this.local[i].spec)\n    }\n\n    if (this.children.length)\n      return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options)\n    else\n      return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty\n  }\n\n  // :: (Node, [Decoration]) → DecorationSet\n  // Add the given array of decorations to the ones in the set,\n  // producing a new set. Needs access to the current document to\n  // create the appropriate tree structure.\n  add(doc, decorations) {\n    if (!decorations.length) return this\n    if (this == empty) return DecorationSet.create(doc, decorations)\n    return this.addInner(doc, decorations, 0)\n  }\n\n  addInner(doc, decorations, offset) {\n    let children, childIndex = 0\n    doc.forEach((childNode, childOffset) => {\n      let baseOffset = childOffset + offset, found\n      if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) return\n\n      if (!children) children = this.children.slice()\n      while (childIndex < children.length && children[childIndex] < childOffset) childIndex += 3\n      if (children[childIndex] == childOffset)\n        children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1)\n      else\n        children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec))\n      childIndex += 3\n    })\n\n    let local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset)\n    for (let i = 0; i < local.length; i++) if (!local[i].type.valid(doc, local[i])) local.splice(i--, 1)\n\n    return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                             children || this.children)\n  }\n\n  // :: ([Decoration]) → DecorationSet\n  // Create a new set that contains the decorations in this set, minus\n  // the ones in the given array.\n  remove(decorations) {\n    if (decorations.length == 0 || this == empty) return this\n    return this.removeInner(decorations, 0)\n  }\n\n  removeInner(decorations, offset) {\n    let children = this.children, local = this.local\n    for (let i = 0; i < children.length; i += 3) {\n      let found, from = children[i] + offset, to = children[i + 1] + offset\n      for (let j = 0, span; j < decorations.length; j++) if (span = decorations[j]) {\n        if (span.from > from && span.to < to) {\n          decorations[j] = null\n          ;(found || (found = [])).push(span)\n        }\n      }\n      if (!found) continue\n      if (children == this.children) children = this.children.slice()\n      let removed = children[i + 2].removeInner(found, from + 1)\n      if (removed != empty) {\n        children[i + 2] = removed\n      } else {\n        children.splice(i, 3)\n        i -= 3\n      }\n    }\n    if (local.length) for (let i = 0, span; i < decorations.length; i++) if (span = decorations[i]) {\n      for (let j = 0; j < local.length; j++) if (local[j].eq(span, offset)) {\n        if (local == this.local) local = this.local.slice()\n        local.splice(j--, 1)\n      }\n    }\n    if (children == this.children && local == this.local) return this\n    return local.length || children.length ? new DecorationSet(local, children) : empty\n  }\n\n  forChild(offset, node) {\n    if (this == empty) return this\n    if (node.isLeaf) return DecorationSet.empty\n\n    let child, local\n    for (let i = 0; i < this.children.length; i += 3) if (this.children[i] >= offset) {\n      if (this.children[i] == offset) child = this.children[i + 2]\n      break\n    }\n    let start = offset + 1, end = start + node.content.size\n    for (let i = 0; i < this.local.length; i++) {\n      let dec = this.local[i]\n      if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n        let from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start\n        if (from < to) (local || (local = [])).push(dec.copy(from, to))\n      }\n    }\n    if (local) {\n      let localSet = new DecorationSet(local.sort(byPos))\n      return child ? new DecorationGroup([localSet, child]) : localSet\n    }\n    return child || empty\n  }\n\n  eq(other) {\n    if (this == other) return true\n    if (!(other instanceof DecorationSet) ||\n        this.local.length != other.local.length ||\n        this.children.length != other.children.length) return false\n    for (let i = 0; i < this.local.length; i++)\n      if (!this.local[i].eq(other.local[i])) return false\n    for (let i = 0; i < this.children.length; i += 3)\n      if (this.children[i] != other.children[i] ||\n          this.children[i + 1] != other.children[i + 1] ||\n          !this.children[i + 2].eq(other.children[i + 2])) return false\n    return true\n  }\n\n  locals(node) {\n    return removeOverlap(this.localsInner(node))\n  }\n\n  localsInner(node) {\n    if (this == empty) return none\n    if (node.inlineContent || !this.local.some(InlineType.is)) return this.local\n    let result = []\n    for (let i = 0; i < this.local.length; i++) {\n      if (!(this.local[i].type instanceof InlineType))\n        result.push(this.local[i])\n    }\n    return result\n  }\n}\n\n// DecorationSource:: interface\n// An object that can [provide](#view.EditorProps.decorations)\n// decorations. Implemented by [`DecorationSet`](#view.DecorationSet),\n// and passed to [node views](#view.EditorProps.nodeViews).\n//\n//   map:: (Mapping, Node) → DecorationSource\n//   Map the set of decorations in response to a change in the\n//   document.\n\nconst empty = new DecorationSet()\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty\n\nDecorationSet.removeOverlap = removeOverlap\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nclass DecorationGroup {\n  constructor(members) {\n    this.members = members\n  }\n\n  map(mapping, doc) {\n    const mappedDecos = this.members.map(\n      member => member.map(mapping, doc, noSpec)\n    )\n    return DecorationGroup.from(mappedDecos)\n  }\n\n  forChild(offset, child) {\n    if (child.isLeaf) return DecorationSet.empty\n    let found = []\n    for (let i = 0; i < this.members.length; i++) {\n      let result = this.members[i].forChild(offset, child)\n      if (result == empty) continue\n      if (result instanceof DecorationGroup) found = found.concat(result.members)\n      else found.push(result)\n    }\n    return DecorationGroup.from(found)\n  }\n\n  eq(other) {\n    if (!(other instanceof DecorationGroup) ||\n        other.members.length != this.members.length) return false\n    for (let i = 0; i < this.members.length; i++)\n      if (!this.members[i].eq(other.members[i])) return false\n    return true\n  }\n\n  locals(node) {\n    let result, sorted = true\n    for (let i = 0; i < this.members.length; i++) {\n      let locals = this.members[i].localsInner(node)\n      if (!locals.length) continue\n      if (!result) {\n        result = locals\n      } else {\n        if (sorted) {\n          result = result.slice()\n          sorted = false\n        }\n        for (let j = 0; j < locals.length; j++) result.push(locals[j])\n      }\n    }\n    return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n  }\n\n  // : ([DecorationSet]) → union<DecorationSet, DecorationGroup>\n  // Create a group for the given array of decoration sets, or return\n  // a single set when possible.\n  static from(members) {\n    switch (members.length) {\n      case 0: return empty\n      case 1: return members[0]\n      default: return new DecorationGroup(members)\n    }\n  }\n}\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  let children = oldChildren.slice()\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  let shift = (oldStart, oldEnd, newStart, newEnd) => {\n    for (let i = 0; i < children.length; i += 3) {\n      let end = children[i + 1], dSize\n      if (end == -1 || oldStart > end + oldOffset) continue\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize\n        children[i + 1] += dSize\n      }\n    }\n  }\n  for (let i = 0; i < mapping.maps.length; i++) mapping.maps[i].forEach(shift)\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  let mustRebuild = false\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] == -1) { // Touched nodes\n    let from = mapping.map(oldChildren[i] + oldOffset), fromLocal = from - offset\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    let to = mapping.map(oldChildren[i + 1] + oldOffset, -1), toLocal = to - offset\n    let {index, offset: childOffset} = node.content.findIndex(fromLocal)\n    let childNode = node.maybeChild(index)\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      let mapped = children[i + 2].mapInner(mapping, childNode, from + 1, oldChildren[i] + oldOffset + 1, options)\n      if (mapped != empty) {\n        children[i] = fromLocal\n        children[i + 1] = toLocal\n        children[i + 2] = mapped\n      } else {\n        children[i + 1] = -2\n        mustRebuild = true\n      }\n    } else {\n      mustRebuild = true\n    }\n  }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    let decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options)\n    let built = buildTree(decorations, node, 0, options)\n    newLocal = built.local\n    for (let i = 0; i < children.length; i += 3) if (children[i + 1] < 0) {\n      children.splice(i, 3)\n      i -= 3\n    }\n    for (let i = 0, j = 0; i < built.children.length; i += 3) {\n      let from = built.children[i]\n      while (j < children.length && children[j] < from) j += 3\n      children.splice(j, 0, built.children[i], built.children[i + 1], built.children[i + 2])\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) return spans\n  let result = []\n  for (let i = 0; i < spans.length; i++) {\n    let span = spans[i]\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type))\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (let i = 0; i < set.local.length; i++) {\n      let mapped = set.local[i].map(mapping, offset, oldOffset)\n      if (mapped) decorations.push(mapped)\n      else if (options.onRemove) options.onRemove(set.local[i].spec)\n    }\n    for (let i = 0; i < set.children.length; i += 3)\n      gather(set.children[i + 2], set.children[i] + oldOffset + 1)\n  }\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] == -1)\n    gather(children[i + 2], oldChildren[i] + oldOffset + 1)\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) return null\n  let end = offset + node.nodeSize, found = null\n  for (let i = 0, span; i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n      ;(found || (found = [])).push(span)\n      spans[i] = null\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  let result = []\n  for (let i = 0; i < array.length; i++)\n    if (array[i] != null) result.push(array[i])\n  return result\n}\n\n// : ([Decoration], Node, number) → DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtracted from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  let children = [], hasNulls = false\n  node.forEach((childNode, localStart) => {\n    let found = takeSpansForNode(spans, childNode, localStart + offset)\n    if (found) {\n      hasNulls = true\n      let subtree = buildTree(found, childNode, offset + localStart + 1, options)\n      if (subtree != empty)\n        children.push(localStart, localStart + childNode.nodeSize, subtree)\n    }\n  })\n  let locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos)\n  for (let i = 0; i < locals.length; i++) if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) options.onRemove(locals[i].spec)\n    locals.splice(i--, 1)\n  }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration) → number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration]) → [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  let working = spans\n  for (let i = 0; i < working.length - 1; i++) {\n    let span = working[i]\n    if (span.from != span.to) for (let j = i + 1; j < working.length; j++) {\n      let next = working[j]\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) working = spans.slice()\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to)\n          insertAhead(working, j + 1, next.copy(span.to, next.to))\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) working = spans.slice()\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from)\n          insertAhead(working, j, span.copy(next.from, span.to))\n        }\n        break\n      }\n    }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) i++\n  array.splice(i, 0, deco)\n}\n\n// : (EditorView) → union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nexport function viewDecorations(view) {\n  let found = []\n  view.someProp(\"decorations\", f => {\n    let result = f(view.state)\n    if (result && result != empty) found.push(result)\n  })\n  if (view.cursorWrapper)\n    found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco]))\n  return DecorationGroup.from(found)\n}\n","import {keydownHandler} from \"prosemirror-keymap\"\nimport {TextSelection, NodeSelection, Plugin} from \"prosemirror-state\"\nimport {Fragment, Slice} from \"prosemirror-model\"\nimport {Decoration, DecorationSet} from \"prosemirror-view\"\n\nimport {GapCursor} from \"./gapcursor\"\n\n// :: () → Plugin\n// Create a gap cursor plugin. When enabled, this will capture clicks\n// near and arrow-key-motion past places that don't have a normally\n// selectable position nearby, and create a gap cursor selection for\n// them. The cursor is drawn as an element with class\n// `ProseMirror-gapcursor`. You can either include\n// `style/gapcursor.css` from the package's directory or add your own\n// styles to make it visible.\nexport const gapCursor = function() {\n  return new Plugin({\n    props: {\n      decorations: drawGapCursor,\n\n      createSelectionBetween(_view, $anchor, $head) {\n        if ($anchor.pos == $head.pos && GapCursor.valid($head)) return new GapCursor($head)\n      },\n\n      handleClick,\n      handleKeyDown,\n      handleDOMEvents: {beforeinput}\n    }\n  })\n}\n\nexport {GapCursor}\n\nconst handleKeyDown = keydownHandler({\n  \"ArrowLeft\": arrow(\"horiz\", -1),\n  \"ArrowRight\": arrow(\"horiz\", 1),\n  \"ArrowUp\": arrow(\"vert\", -1),\n  \"ArrowDown\": arrow(\"vert\", 1)\n})\n\nfunction arrow(axis, dir) {\n  let dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\")\n  return function(state, dispatch, view) {\n    let sel = state.selection\n    let $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty\n    if (sel instanceof TextSelection) {\n      if (!view.endOfTextblock(dirStr) || $start.depth == 0) return false\n      mustMove = false\n      $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before())\n    }\n    let $found = GapCursor.findFrom($start, dir, mustMove)\n    if (!$found) return false\n    if (dispatch) dispatch(state.tr.setSelection(new GapCursor($found)))\n    return true\n  }\n}\n\nfunction handleClick(view, pos, event) {\n  if (!view.editable) return false\n  let $pos = view.state.doc.resolve(pos)\n  if (!GapCursor.valid($pos)) return false\n  let {inside} = view.posAtCoords({left: event.clientX, top: event.clientY})\n  if (inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(inside))) return false\n  view.dispatch(view.state.tr.setSelection(new GapCursor($pos)))\n  return true\n}\n\n// This is a hack that, when a composition starts while a gap cursor\n// is active, quickly creates an inline context for the composition to\n// happen in, to avoid it being aborted by the DOM selection being\n// moved into a valid position.\nfunction beforeinput(view, event) {\n  if (event.inputType != \"insertCompositionText\" || !(view.state.selection instanceof GapCursor)) return false\n\n  let {$from} = view.state.selection\n  let insert = $from.parent.contentMatchAt($from.index()).findWrapping(view.state.schema.nodes.text)\n  if (!insert) return false\n\n  let frag = Fragment.empty\n  for (let i = insert.length - 1; i >= 0; i--) frag = Fragment.from(insert[i].createAndFill(null, frag))\n  let tr = view.state.tr.replace($from.pos, $from.pos, new Slice(frag, 0, 0))\n  tr.setSelection(TextSelection.near(tr.doc.resolve($from.pos + 1)))\n  view.dispatch(tr)\n  return false\n}\n\nfunction drawGapCursor(state) {\n  if (!(state.selection instanceof GapCursor)) return null\n  let node = document.createElement(\"div\")\n  node.className = \"ProseMirror-gapcursor\"\n  return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, {key: \"gapcursor\"})])\n}\n","import {Plugin} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\n\n// :: (options: ?Object) → Plugin\n// Create a plugin that, when added to a ProseMirror instance,\n// causes a decoration to show up at the drop position when something\n// is dragged over the editor.\n//\n// Nodes may add a `disableDropCursor` property to their spec to\n// control the showing of a drop cursor inside them. This may be a\n// boolean or a function, which will be called with a view and a\n// position, and should return a boolean.\n//\n//   options::- These options are supported:\n//\n//     color:: ?string\n//     The color of the cursor. Defaults to `black`.\n//\n//     width:: ?number\n//     The precise width of the cursor in pixels. Defaults to 1.\n//\n//     class:: ?string\n//     A CSS class name to add to the cursor element.\nexport function dropCursor(options = {}) {\n  return new Plugin({\n    view(editorView) { return new DropCursorView(editorView, options) }\n  })\n}\n\nclass DropCursorView {\n  constructor(editorView, options) {\n    this.editorView = editorView\n    this.width = options.width || 1\n    this.color = options.color || \"black\"\n    this.class = options.class\n    this.cursorPos = null\n    this.element = null\n    this.timeout = null\n\n    this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(name => {\n      let handler = e => this[name](e)\n      editorView.dom.addEventListener(name, handler)\n      return {name, handler}\n    })\n  }\n\n  destroy() {\n    this.handlers.forEach(({name, handler}) => this.editorView.dom.removeEventListener(name, handler))\n  }\n\n  update(editorView, prevState) {\n    if (this.cursorPos != null && prevState.doc != editorView.state.doc) {\n      if (this.cursorPos > editorView.state.doc.content.size) this.setCursor(null)\n      else this.updateOverlay()\n    }\n  }\n\n  setCursor(pos) {\n    if (pos == this.cursorPos) return\n    this.cursorPos = pos\n    if (pos == null) {\n      this.element.parentNode.removeChild(this.element)\n      this.element = null\n    } else {\n      this.updateOverlay()\n    }\n  }\n\n  updateOverlay() {\n    let $pos = this.editorView.state.doc.resolve(this.cursorPos), rect\n    if (!$pos.parent.inlineContent) {\n      let before = $pos.nodeBefore, after = $pos.nodeAfter\n      if (before || after) {\n        let nodeRect = this.editorView.nodeDOM(this.cursorPos - (before ?  before.nodeSize : 0)).getBoundingClientRect()\n        let top = before ? nodeRect.bottom : nodeRect.top\n        if (before && after)\n          top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2\n        rect = {left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2}\n      }\n    }\n    if (!rect) {\n      let coords = this.editorView.coordsAtPos(this.cursorPos)\n      rect = {left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom}\n    }\n\n    let parent = this.editorView.dom.offsetParent\n    if (!this.element) {\n      this.element = parent.appendChild(document.createElement(\"div\"))\n      if (this.class) this.element.className = this.class\n      this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none; background-color: \" + this.color\n    }\n    let parentLeft, parentTop\n    if (!parent || parent == document.body && getComputedStyle(parent).position == \"static\") {\n      parentLeft = -pageXOffset\n      parentTop = -pageYOffset\n    } else {\n      let rect = parent.getBoundingClientRect()\n      parentLeft = rect.left - parent.scrollLeft\n      parentTop = rect.top - parent.scrollTop\n    }\n    this.element.style.left = (rect.left - parentLeft) + \"px\"\n    this.element.style.top = (rect.top - parentTop) + \"px\"\n    this.element.style.width = (rect.right - rect.left) + \"px\"\n    this.element.style.height = (rect.bottom - rect.top) + \"px\"\n  }\n\n  scheduleRemoval(timeout) {\n    clearTimeout(this.timeout)\n    this.timeout = setTimeout(() => this.setCursor(null), timeout)\n  }\n\n  dragover(event) {\n    if (!this.editorView.editable) return\n    let pos = this.editorView.posAtCoords({left: event.clientX, top: event.clientY})\n\n    let node = pos && pos.inside >= 0 && this.editorView.state.doc.nodeAt(pos.inside)\n    let disableDropCursor = node && node.type.spec.disableDropCursor\n    let disabled = typeof disableDropCursor == \"function\" ? disableDropCursor(this.editorView, pos) : disableDropCursor\n\n    if (pos && !disabled) {\n      let target = pos.pos\n      if (this.editorView.dragging && this.editorView.dragging.slice) {\n        target = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice)\n        if (target == null) return this.setCursor(null)\n      }\n      this.setCursor(target)\n      this.scheduleRemoval(5000)\n    }\n  }\n\n  dragend() {\n    this.scheduleRemoval(20)\n  }\n\n  drop() {\n    this.scheduleRemoval(20)\n  }\n\n  dragleave(event) {\n    if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n      this.setCursor(null)\n  }\n}\n","import {Selection, NodeSelection} from \"prosemirror-state\"\nimport {Slice} from \"prosemirror-model\"\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nexport class GapCursor extends Selection {\n  // :: (ResolvedPos)\n  // Create a gap cursor.\n  constructor($pos) {\n    super($pos, $pos)\n  }\n\n  map(doc, mapping) {\n    let $pos = doc.resolve(mapping.map(this.head))\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n\n  content() { return Slice.empty }\n\n  eq(other) {\n    return other instanceof GapCursor && other.head == this.head\n  }\n\n  toJSON() {\n    return {type: \"gapcursor\", pos: this.head}\n  }\n\n  static fromJSON(doc, json) {\n    if (typeof json.pos != \"number\") throw new RangeError(\"Invalid input for GapCursor.fromJSON\")\n    return new GapCursor(doc.resolve(json.pos))\n  }\n\n  getBookmark() { return new GapBookmark(this.anchor) }\n\n  static valid($pos) {\n    let parent = $pos.parent\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) return false\n    let override = parent.type.spec.allowGapCursor\n    if (override != null) return override\n    let deflt = parent.contentMatchAt($pos.index()).defaultType\n    return deflt && deflt.isTextblock\n  }\n\n  static findFrom($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) return $pos\n      let pos = $pos.pos, next = null\n      // Scan up from this position\n      for (let d = $pos.depth;; d--) {\n        let parent = $pos.node(d)\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1)\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      // And then down into the next node\n      for (;;) {\n        let inside = dir > 0 ? next.firstChild : next.lastChild\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir)\n            mustMove = false\n            continue search\n          }\n          break\n        }\n        next = inside\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      return null\n    }\n  }\n}\n\nGapCursor.prototype.visible = false\n\nSelection.jsonID(\"gapcursor\", GapCursor)\n\nclass GapBookmark {\n  constructor(pos) {\n    this.pos = pos\n  }\n  map(mapping) {\n    return new GapBookmark(mapping.map(this.pos))\n  }\n  resolve(doc) {\n    let $pos = doc.resolve(this.pos)\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n}\n\nfunction closedBefore($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.index(d), parent = $pos.node(d)\n    // At the start of this parent, look at next one\n    if (index == 0) {\n      if (parent.type.spec.isolating) return true\n      continue\n    }\n    // See if the node before (or its first ancestor) is closed\n    for (let before = parent.child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) return true\n      if (before.inlineContent) return false\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.indexAfter(d), parent = $pos.node(d)\n    if (index == parent.childCount) {\n      if (parent.type.spec.isolating) return true\n      continue\n    }\n    for (let after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) return true\n      if (after.inlineContent) return false\n    }\n  }\n  return true\n}\n","import { Plugin } from 'prosemirror-state';\n\n// From https://gist.github.com/khanzadimahdi/bab8a3416bdb764b9eda5b38b35735b8\nconst dataImageRegex = /^data:((?:\\w+\\/(?:(?!;).)+)?)((?:;[\\w\\W]*?[^;])*),(.+)$/;\n\nlet parser = new DOMParser();\n\nexport default function disableBase64PastePlugin() {\n  return new Plugin({\n    props: {\n      transformPastedHTML(html) {\n        const doc = parser.parseFromString(html, 'text/html');\n        doc.querySelectorAll('img').forEach((node) => {\n          if (dataImageRegex.test(node.src)) {\n            node.remove();\n          }\n        });\n\n        return doc.documentElement.outerHTML;\n      },\n    },\n  });\n}\n","import { Plugin } from 'prosemirror-state';\n\nfunction onClick(schema) {\n  return (view, pos, node, nodePos, event, direct) => {\n    if (direct && node.type === schema.nodes.spoiler && event.target.tagName !== 'P') {\n      // TODO: Figure out why this dispatch event isn't working.\n      // Mutating the node directly isn't good practice.\n      // view.dispatch(\n      //     view.state.tr.setNodeMarkup(pos, null, { open: false })\n      // );\n      node.attrs.open = !node.attrs.open;\n      view.focus();\n      event.stopPropagation();\n      event.preventDefault();\n      return false;\n    }\n  };\n}\n\nexport default function toggleSpoiler(schema) {\n  return new Plugin({\n    props: {\n      handleClickOn: onClick(schema),\n      handleDoubleClickOn: onClick(schema),\n    },\n  });\n}\n","import { inputRules, wrappingInputRule, textblockTypeInputRule, emDash, ellipsis } from 'prosemirror-inputrules';\nimport { markInputRule, nodeInputRule } from 'tiptap-commands';\n\n// Copied from https://github.com/ProseMirror/prosemirror-example-setup/blob/master/src/inputrules.js\n\nfunction blockQuoteRule(nodeType) {\n  return wrappingInputRule(/^\\s*>\\s$/, nodeType);\n}\n\nfunction orderedListRule(nodeType) {\n  return wrappingInputRule(\n    /^(\\d+)(\\.|\\))\\s$/,\n    nodeType,\n    (match) => ({ order: +match[1] }),\n    (match, node) => node.childCount + node.attrs.order == +match[1]\n  );\n}\n\nfunction bulletListRule(nodeType) {\n  return wrappingInputRule(/^\\s*([-+*])\\s$/, nodeType);\n}\n\nfunction codeBlockRule(nodeType) {\n  return textblockTypeInputRule(/^```$/, nodeType);\n}\n\nfunction headingRule(nodeType, maxLevel) {\n  return textblockTypeInputRule(new RegExp('^(#{1,' + maxLevel + '})\\\\s$'), nodeType, (match) => ({ level: match[1].length }));\n}\n\nfunction blockSpoilerRule(nodeType) {\n  return wrappingInputRule(/^\\s*>!\\s$/, nodeType);\n}\n\nexport default function buildInputRules(schema) {\n  const rules = [\n    ellipsis,\n    blockQuoteRule(schema.nodes.blockquote),\n    orderedListRule(schema.nodes.ordered_list),\n    bulletListRule(schema.nodes.bullet_list),\n    codeBlockRule(schema.nodes.code_block),\n    headingRule(schema.nodes.heading, 6),\n    blockSpoilerRule(schema.nodes.spoiler),\n    nodeInputRule(/(?:___\\s|\\*\\*\\*\\s|---)$/, schema.nodes.horizontal_rule),\n    textblockTypeInputRule(/^\\s*\\$\\$\\s$/, schema.nodes.math_block),\n    markInputRule(/(?:\\*\\*|__)([^\\*_]+)(?:\\*\\*|__)$/, schema.marks.strong),\n    markInputRule(/(?:^|[^_])(_([^_]+)_)$/, schema.marks.em),\n    markInputRule(/(?:^|[^*])(\\*([^*]+)\\*)$/, schema.marks.em),\n    markInputRule(/(?:`)([^`]+)(?:`)$/, schema.marks.code),\n    markInputRule(/(?:~~)([^~]+)(?:~~)$/, schema.marks.strike),\n    markInputRule(/(?:[^~]~)([^~]+)(?:~)$/, schema.marks.sub),\n    markInputRule(/(?:\\^)([^^]+)(?:\\^)$/, schema.marks.sup),\n    markInputRule(/(?:\\|\\|)([^\\|]+)(?:\\|\\|)$/, schema.marks.spoiler_inline),\n    markInputRule(/(?:>!)(.+)(?:!<)$/, schema.marks.spoiler_inline),\n    markInputRule(/(?:\\$)([^$]+)(?:\\$)$/, schema.marks.math_inline),\n  ];\n\n  return rules;\n}\n","import { baseKeymap } from 'tiptap-commands';\nimport { history } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { EditorState, Selection, TextSelection } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\n\nimport ItemList from 'flarum/common/utils/ItemList';\nimport disabledPlugin from './plugins/disabledPlugin';\nimport disableBase64PastePlugin from './plugins/disableBase64PastePlugin';\nimport placeholderPlugin from './plugins/placeholderPlugin';\nimport menuPlugin from './plugins/menuPlugin';\nimport toggleSpoiler from './plugins/toggleSpoiler';\nimport richTextKeymap from './key-bindings';\nimport buildInputRules from './inputrules';\nimport MarkdownSerializerBuilder from './markdown/MarkdownSerializerBuilder';\nimport MarkdownParserBuilder from './markdown/MarkdownParserBuilder';\nimport SchemaBuilder from './markdown/SchemaBuilder';\nimport { inputRules } from 'prosemirror-inputrules';\n\nexport default class ProseMirrorEditorDriver {\n  constructor(target, attrs) {\n    this.build(target, attrs);\n  }\n\n  build(target, attrs) {\n    this.attrs = attrs;\n    this.schema = new SchemaBuilder().build();\n\n    this.parser = new MarkdownParserBuilder(this.schema).build();\n    this.serializer = new MarkdownSerializerBuilder(this.schema).build();\n\n    this.state = EditorState.create(this.buildEditorStateConfig());\n    this.view = new EditorView(target, this.buildEditorProps());\n\n    const cssClasses = attrs.classNames || [];\n    cssClasses.forEach((className) => this.view.dom.classList.add(className));\n\n    const callInputListeners = (e) => {\n      this.attrs.inputListeners.forEach((listener) => {\n        listener.call(target);\n      });\n\n      e.redraw = false;\n    };\n\n    target.oninput = callInputListeners;\n    target.onclick = callInputListeners;\n    target.onkeyup = callInputListeners;\n  }\n\n  buildEditorStateConfig() {\n    return {\n      doc: this.parseInitialValue(this.attrs.value),\n      disabled: this.attrs.disabled,\n      schema: this.schema,\n      plugins: this.buildPluginItems().toArray(),\n    };\n  }\n\n  buildPluginItems() {\n    const items = new ItemList();\n\n    items.add('markdownInputrules', inputRules({ rules: this.buildInputRules(this.schema) }));\n\n    items.add('submit', keymap({ 'Mod-Enter': this.attrs.onsubmit }));\n\n    items.add('escape', keymap({ Escape: this.attrs.escape }));\n\n    items.add('richTextKeymap', keymap(richTextKeymap(this.schema)));\n\n    items.add('baseKeymap', keymap(baseKeymap));\n\n    items.add('placeholder', placeholderPlugin(this.attrs.placeholder));\n\n    items.add('history', history());\n\n    items.add('disabled', disabledPlugin());\n\n    items.add('disableBase64Paste', disableBase64PastePlugin());\n\n    items.add('dropCursor', dropCursor());\n\n    items.add('gapCursor', gapCursor());\n\n    items.add('menu', menuPlugin(this.attrs.menuState));\n\n    items.add('toggleSpoiler', toggleSpoiler(this.schema));\n\n    return items;\n  }\n\n  buildEditorProps() {\n    const self = this;\n\n    return {\n      state: this.state,\n      dispatchTransaction(transaction) {\n        let newState = this.state.apply(transaction);\n        this.updateState(newState);\n\n        const newDoc = this.state.doc;\n        const newDocPlaintext = self.serializeContent(newDoc, self.schema);\n        self.attrs.oninput(newDocPlaintext);\n      },\n    };\n  }\n\n  buildInputRules(schema) {\n    return buildInputRules(schema);\n  }\n\n  parseInitialValue(text) {\n    return this.parser.parse(text);\n  }\n\n  serializeContent(doc) {\n    return this.serializer.serialize(doc, { tightLists: true });\n  }\n\n  // External Control Stuff\n\n  /**\n   * Focus the textarea and place the cursor at the given index.\n   *\n   * @param {number} position\n   */\n  moveCursorTo(position) {\n    this.setSelectionRange(position, position);\n  }\n\n  /**\n   * Get the selected range of the textarea.\n   *\n   * @return {Array}\n   */\n  getSelectionRange() {\n    return [this.view.state.selection.from, this.view.state.selection.to];\n  }\n\n  /**\n   * Get (at most) the last N characters from the current \"text block\".\n   */\n  getLastNChars(n) {\n    const lastNode = this.view.state.selection.$from.nodeBefore;\n\n    if (!lastNode || !lastNode.text) return '';\n\n    return lastNode.text.slice(Math.max(0, lastNode.text.length - n));\n  }\n\n  /**\n   * Insert content into the textarea at the position of the cursor.\n   *\n   * @param {String} text\n   */\n  insertAtCursor(text, escape) {\n    this.insertAt(this.getSelectionRange()[0], text, escape);\n    $(this.view.dom).trigger('click');\n  }\n\n  /**\n   * Insert content into the textarea at the given position.\n   *\n   * @param {number} pos\n   * @param {String} text\n   */\n  insertAt(pos, text, escape) {\n    this.insertBetween(pos, pos, text, escape);\n  }\n\n  /**\n   * Insert content into the textarea between the given positions.\n   *\n   * If the start and end positions are different, any text between them will be\n   * overwritten.\n   *\n   * @param start\n   * @param end\n   * @param text\n   * @param rawMarkdown\n   */\n  insertBetween(start, end, text, escape = true) {\n    let trailingNewLines = 0;\n\n    if (escape) {\n      this.view.dispatch(this.view.state.tr.insertText(text, start, end));\n    } else {\n      // Without this, a newline would be added before the inserted text.\n      const OFFSET_TO_REMOVE_PREFIX_NEWLINE = 1;\n      start -= OFFSET_TO_REMOVE_PREFIX_NEWLINE;\n      const parsedText = this.parseInitialValue(text);\n      this.view.dispatch(this.view.state.tr.replaceRangeWith(start, end, parsedText));\n\n      trailingNewLines = text.match(/\\s+$/)[0].split('\\n').length - 1;\n    }\n\n    // Move the textarea cursor to the end of the content we just inserted.\n    // The offset is necessary so the new cursor position doesn't split the inserted text\n    // when the space is added below.\n    this.moveCursorTo(Math.min(start + text.length + OFFSET_TO_REMOVE_PREFIX_NEWLINE, Selection.atEnd(this.view.state.doc).to));\n    m.redraw();\n\n    // TODO: accomplish this in one step.\n    if (text.endsWith(' ') && !escape) {\n      this.insertAtCursor(' ');\n    }\n\n    Array(trailingNewLines)\n      .fill(0)\n      .forEach(() => {\n        baseKeymap['Enter'](this.view.state, this.view.dispatch);\n      });\n  }\n\n  /**\n   * Replace existing content from the start to the current cursor position.\n   *\n   * @param start\n   * @param text\n   */\n  replaceBeforeCursor(start, text, escape) {\n    this.insertBetween(start, this.getSelectionRange()[0], text, escape);\n  }\n\n  /**\n   * Set the selected range of the textarea.\n   *\n   * @param {number} start\n   * @param {number} end\n   * @private\n   */\n  setSelectionRange(start, end) {\n    const $start = this.view.state.tr.doc.resolve(start);\n    const $end = this.view.state.tr.doc.resolve(end);\n\n    this.view.dispatch(this.view.state.tr.setSelection(new TextSelection($start, $end)));\n    this.focus();\n  }\n\n  getCaretCoordinates(position) {\n    const viewportCoords = this.view.coordsAtPos(position);\n    const editorViewportOffset = this.view.dom.getBoundingClientRect();\n    return {\n      left: viewportCoords.left - editorViewportOffset.left,\n      top: viewportCoords.top - editorViewportOffset.top,\n    };\n  }\n\n  focus() {\n    this.view.focus();\n  }\n  destroy() {\n    this.view.destroy();\n  }\n\n  disabled(disabled) {\n    this.view.dispatch(this.view.state.tr.setMeta('disabled', disabled));\n  }\n}\n","import { Plugin } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from 'prosemirror-view';\n\nexport default function placeholderPlugin(text) {\n  return new Plugin({\n    props: {\n      decorations: (state) => {\n        const decorations = [];\n\n        if (state.doc.childCount === 1) {\n          const node = state.doc.child(0);\n          if (node.type.isBlock && node.childCount === 0 && node.type == state.schema.nodes.paragraph) {\n            decorations.push(\n              Decoration.node(0, node.nodeSize, {\n                class: 'placeholder',\n                'data-before': text,\n              })\n            );\n          }\n        }\n\n        return DecorationSet.create(state.doc, decorations);\n      },\n    },\n  });\n}\n","import { Plugin } from 'prosemirror-state';\n\nexport default function menuPlugin(menuState) {\n  return new Plugin({\n    view(editorView) {\n      menuState.attachEditorView(editorView);\n      return menuState;\n    },\n  });\n}\n","import { redo, undo } from 'prosemirror-history';\nimport { undoInputRule } from 'prosemirror-inputrules';\nimport { TextSelection } from 'prosemirror-state';\nimport {\n  chainCommands,\n  exitCode,\n  liftListItem,\n  newlineInCode,\n  setBlockType,\n  sinkListItem,\n  splitListItem,\n  toggleList,\n  toggleMark,\n  wrapIn,\n} from 'tiptap-commands';\n\nexport default function richTextKeymap(schema) {\n  const considerDropdown = (state, dispatch) => {\n    const emojiDropdown = $('.EmojiDropdown:visible');\n    const mentionsDropdown = $('.MentionsDropdown:visible');\n\n    if (emojiDropdown[0] || mentionsDropdown[0]) return true;\n  };\n\n  const smartExitCode = (state, dispatch, view) => {\n    let { $head, $anchor } = state.selection;\n    if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false;\n\n    const nodeBefore = state.selection.$from.nodeBefore;\n    const nodeAfter = state.selection.$from.nodeAfter;\n    if ((!nodeBefore || nodeBefore.text.slice(-1) === '\\n') && !nodeAfter) {\n      view.dispatch(view.state.tr.delete(state.selection.from - 1, state.selection.from));\n      view.dispatch(view.state.tr.setSelection(TextSelection.near(view.state.doc.resolve(view.state.selection.from))));\n      return exitCode(view.state, view.dispatch);\n    } else {\n      return newlineInCode(state, dispatch);\n    }\n  };\n\n  const insertHardBreak = (state, dispatch) => {\n    dispatch(state.tr.replaceSelectionWith(schema.nodes.hard_break.create()).scrollIntoView());\n    return true;\n  };\n\n  const smartInsertHardBreak = (state, dispatch, view) => {\n    let { $head, $anchor } = state.selection;\n    if ($head.parent.type.name !== 'paragraph' || !$head.sameParent($anchor)) return false;\n\n    const nodeBefore = state.selection.$from.nodeBefore;\n    const nodeAfter = state.selection.$from.nodeAfter;\n\n    if (nodeBefore && nodeBefore.text && nodeBefore.text.slice(-1) !== '\\n') {\n      return insertHardBreak(view.state, view.dispatch);\n    } else if (nodeBefore && !nodeBefore.text && !nodeAfter) {\n      view.dispatch(view.state.tr.delete(state.selection.from - 1, state.selection.from));\n      view.dispatch(view.state.tr.setSelection(TextSelection.near(view.state.doc.resolve(view.state.selection.from))));\n    }\n  };\n\n  const enterCommands = [considerDropdown, splitListItem(schema.nodes.list_item), smartExitCode];\n\n  if (app.session.user.preferences().richTextCompactParagraphs) {\n    enterCommands.push(smartInsertHardBreak);\n  }\n\n  const handleEnter = chainCommands(...enterCommands);\n\n  return {\n    // History\n    'Mod-z': undo,\n    'Mod-y': redo,\n    'Mod-Shift-z': redo,\n    Backspace: undoInputRule,\n    // Formatting: Marks\n    'Mod-b': toggleMark(schema.marks.strong),\n    'Mod-i': toggleMark(schema.marks.em),\n    'Mod-`': toggleMark(schema.marks.code),\n    'Alt-Shift-5': toggleMark(schema.marks.strike),\n    'Mod-,': toggleMark(schema.marks.sub),\n    'Mod-.': toggleMark(schema.marks.sup),\n    'Mod-;': toggleMark(schema.marks.spoiler_inline),\n    // Formatting: Wrap\n    'Shift-Mod-8': toggleList(schema.nodes.bullet_list),\n    'Shift-Mod-9': toggleList(schema.nodes.ordered_list),\n    'Mod-q': wrapIn(schema.nodes.blockquote),\n    // Formatting: Type\n    'Shift-Ctrl-0': setBlockType(schema.nodes.paragraph),\n    'Shift-Ctrl-1': setBlockType(schema.nodes.heading, { level: 1 }),\n    'Shift-Ctrl-2': setBlockType(schema.nodes.heading, { level: 2 }),\n    'Shift-Ctrl-3': setBlockType(schema.nodes.heading, { level: 3 }),\n    'Shift-Ctrl-4': setBlockType(schema.nodes.heading, { level: 4 }),\n    'Shift-Ctrl-5': setBlockType(schema.nodes.heading, { level: 5 }),\n    'Shift-Ctrl-6': setBlockType(schema.nodes.heading, { level: 6 }),\n    'Shift-Ctrl-\\\\': setBlockType(schema.nodes.code_block),\n    // Whitespace\n    'Mod-]': sinkListItem(schema.nodes.list_item),\n    'Mod-m': sinkListItem(schema.nodes.list_item),\n    'Mod-[': liftListItem(schema.nodes.list_item),\n    'Mod-Shift-m': liftListItem(schema.nodes.list_item),\n    Enter: handleEnter,\n    'Shift-Enter': chainCommands(newlineInCode, insertHardBreak),\n  };\n}\n","import { Plugin, PluginKey } from 'prosemirror-state';\n\nexport default function disabledPlugin(text) {\n  return new Plugin({\n    key: new PluginKey('disabled'),\n\n    props: {\n      editable: (state) => {\n        return !state.disabled$;\n      },\n    },\n\n    state: {\n      init(config) {\n        return config.disabled;\n      },\n\n      apply(tr, curr) {\n        const disabled = tr.getMeta('disabled');\n\n        if (disabled !== undefined) {\n          return disabled;\n        }\n\n        return curr;\n      },\n    },\n  });\n}\n","// COPIED FROM https://github.com/markdown-it/markdown-it/blob/master/lib/rules_inline/text.js\n// NEEDED TO ALLOW `|` as terminator character.\n\n// Skip text characters for text token, place those to pending buffer\n// and increment current pos\n\n'use strict';\n\n// Rule to skip pure text\n// '{}$%@~+=:' reserved for extentions\n\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n\n// !!!! Don't confuse with \"Markdown ASCII Punctuation\" chars\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\nfunction isTerminatorChar(ch) {\n  switch (ch) {\n    case 0x0a /* \\n */:\n    case 0x21 /* ! */:\n    case 0x23 /* # */:\n    case 0x24 /* $ */:\n    case 0x25 /* % */:\n    case 0x26 /* & */:\n    case 0x2a /* * */:\n    case 0x2b /* + */:\n    case 0x2d /* - */:\n    case 0x3a /* : */:\n    case 0x3c /* < */:\n    case 0x3d /* = */:\n    case 0x3e /* > */:\n    case 0x40 /* @ */:\n    case 0x5b /* [ */:\n    case 0x5c /* \\ */:\n    case 0x5d /* ] */:\n    case 0x5e /* ^ */:\n    case 0x5f /* _ */:\n    case 0x60 /* ` */:\n    case 0x7b /* { */:\n    case 0x7c /* | */:\n    case 0x7d /* } */:\n    case 0x7e /* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\nconst tokenize = (state, silent) => {\n  var pos = state.pos;\n\n  while (pos < state.posMax && !isTerminatorChar(state.src.charCodeAt(pos))) {\n    pos++;\n  }\n\n  if (pos === state.pos) {\n    return false;\n  }\n\n  if (!silent) {\n    state.pending += state.src.slice(state.pos, pos);\n  }\n\n  state.pos = pos;\n\n  return true;\n};\n\nexport default function (md) {\n  md.inline.ruler.before('text', 'altText', tokenize);\n  md.inline.ruler.disable('text');\n}\n","// COPIED FROM https://github.com/StackExchange/Stacks-Editor/blob/main/src/shared/markdown-it/spoiler.ts\n\nimport { isSpace } from 'markdown-it/lib/common/utils';\n\n// TODO unfortunately, we cannot reliably extend blockquote since it is hardcoded to search for `>` characters\n// In addition, we cannot just call \"blockquote\" inside spoiler, because it does a lookahead for `>` characters and leaves our `!`s behind, potentially causing parsing issues\n// The official advice is to just \"copy paste then edit\" \"extended\" rules...\n// see https://github.com/markdown-it/markdown-it/blob/master/docs/development.md#general-considerations-for-plugins\n// see also https://github.com/markdown-it/markdown-it/issues/46#issuecomment-73125248\nfunction blockquoteExt(options, state, startLine, endLine, silent) {\n  // NOTE: we're keeping the source as close to upstream as possible, so ignore errors like this\n  // eslint-disable-next-line no-var\n  var adjustTab,\n    ch,\n    i,\n    initial,\n    l,\n    lastLineEmpty,\n    lines,\n    nextLine,\n    offset,\n    oldBMarks,\n    oldBSCount,\n    oldIndent,\n    oldParentType,\n    oldSCount,\n    oldTShift,\n    spaceAfterMarker,\n    terminate,\n    terminatorRules,\n    token,\n    wasOutdented,\n    oldLineMax = state.lineMax,\n    pos = state.bMarks[startLine] + state.tShift[startLine],\n    max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) {\n    return false;\n  }\n\n  // check the block quote marker\n  if (state.src.charCodeAt(pos) !== 0x3e /* > */ || !options.followingCharRegex.test(state.src[pos + 1])) {\n    return false;\n  }\n\n  pos += options.markup.length;\n\n  // we know that it's going to be a valid blockquote,\n  // so no point trying to find the end of it in silent mode\n  if (silent) {\n    return true;\n  }\n\n  // skip spaces after \">\" and re-calculate offset\n  initial = offset = state.sCount[startLine] + pos - (state.bMarks[startLine] + state.tShift[startLine]);\n\n  // skip one optional space after '>'\n  if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n    // ' >   test '\n    //     ^ -- position start of line here:\n    pos++;\n    initial++;\n    offset++;\n    adjustTab = false;\n    spaceAfterMarker = true;\n  } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n    spaceAfterMarker = true;\n\n    if ((state.bsCount[startLine] + offset) % 4 === 3) {\n      // '  >\\t  test '\n      //       ^ -- position start of line here (tab has width===1)\n      pos++;\n      initial++;\n      offset++;\n      adjustTab = false;\n    } else {\n      // ' >\\t  test '\n      //    ^ -- position start of line here + shift bsCount slightly\n      //         to make extra space appear\n      adjustTab = true;\n    }\n  } else {\n    spaceAfterMarker = false;\n  }\n\n  // ! INSERTED\n  // We need to add this hack in so that inline spoilers\n  // at the start of lines don't get classified\n  // as block spoilers.\n  const spoiler = options.markup === '>!';\n  let foundExclamation = false;\n  let foundOpen = false;\n  let oldPos = pos;\n  if (spoiler) {\n    while (pos < max) {\n      ch = state.src.charCodeAt(pos);\n\n      if (foundExclamation && ch === 0x3c /* < */) {\n        return false;\n      } else if (ch === 0x3e /* > */) {\n        foundOpen = true;\n      } else if (foundOpen && ch === 0x21 /* ! */) {\n        break; // Inline spoiler embedded in block spoiler, this is fine.\n      } else if (ch === 0x21 /* ! */) {\n        foundExclamation = true;\n      } else if (ch === 0x0a /* \\n */) {\n        break; // Not an inline comment\n      } else {\n        foundExclamation = false;\n        foundOpen = false;\n      }\n\n      pos++;\n    }\n  }\n  pos = oldPos;\n  // ! END INSERTED\n\n  oldBMarks = [state.bMarks[startLine]];\n  state.bMarks[startLine] = pos;\n\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (isSpace(ch)) {\n      if (ch === 0x09) {\n        offset += 4 - ((offset + state.bsCount[startLine] + (adjustTab ? 1 : 0)) % 4);\n      } else {\n        offset++;\n      }\n    } else {\n      break;\n    }\n\n    pos++;\n  }\n\n  oldBSCount = [state.bsCount[startLine]];\n  state.bsCount[startLine] = state.sCount[startLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n  lastLineEmpty = pos >= max;\n\n  oldSCount = [state.sCount[startLine]];\n  state.sCount[startLine] = offset - initial;\n\n  oldTShift = [state.tShift[startLine]];\n  state.tShift[startLine] = pos - state.bMarks[startLine];\n\n  terminatorRules = state.md.block.ruler.getRules('spoiler');\n\n  oldParentType = state.parentType;\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore TODO adding a new parent type here...\n  state.parentType = 'spoiler';\n  wasOutdented = false;\n\n  // Search the end of the block\n  //\n  // Block ends with either:\n  //  1. an empty line outside:\n  //     ```\n  //     > test\n  //\n  //     ```\n  //  2. an empty line inside:\n  //     ```\n  //     >\n  //     test\n  //     ```\n  //  3. another tag:\n  //     ```\n  //     > test\n  //      - - -\n  //     ```\n  for (nextLine = startLine + 1; nextLine < endLine; nextLine++) {\n    // check if it's outdented, i.e. it's inside list item and indented\n    // less than said list item:\n    //\n    // ```\n    // 1. anything\n    //    > current blockquote\n    // 2. checking this line\n    // ```\n    if (state.sCount[nextLine] < state.blkIndent) wasOutdented = true;\n\n    pos = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos >= max) {\n      // Case 1: line is not inside the blockquote, and this line is empty.\n      break;\n    }\n\n    pos += options.markup.length;\n\n    if (\n      state.src.charCodeAt(pos - options.markup.length) === 0x3e /* > */ &&\n      options.followingCharRegex.test(state.src[pos - options.markup.length + 1]) &&\n      !wasOutdented\n    ) {\n      // This line is inside the blockquote.\n\n      // skip spaces after \">\" and re-calculate offset\n      initial = offset = state.sCount[nextLine] + pos - (state.bMarks[nextLine] + state.tShift[nextLine]);\n\n      // skip one optional space after '>'\n      if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n        // ' >   test '\n        //     ^ -- position start of line here:\n        pos++;\n        initial++;\n        offset++;\n        adjustTab = false;\n        spaceAfterMarker = true;\n      } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n        spaceAfterMarker = true;\n\n        if ((state.bsCount[nextLine] + offset) % 4 === 3) {\n          // '  >\\t  test '\n          //       ^ -- position start of line here (tab has width===1)\n          pos++;\n          initial++;\n          offset++;\n          adjustTab = false;\n        } else {\n          // ' >\\t  test '\n          //    ^ -- position start of line here + shift bsCount slightly\n          //         to make extra space appear\n          adjustTab = true;\n        }\n      } else {\n        spaceAfterMarker = false;\n      }\n\n      oldBMarks.push(state.bMarks[nextLine]);\n      state.bMarks[nextLine] = pos;\n\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n\n        if (isSpace(ch)) {\n          if (ch === 0x09) {\n            offset += 4 - ((offset + state.bsCount[nextLine] + (adjustTab ? 1 : 0)) % 4);\n          } else {\n            offset++;\n          }\n        } else {\n          break;\n        }\n\n        pos++;\n      }\n\n      lastLineEmpty = pos >= max;\n\n      oldBSCount.push(state.bsCount[nextLine]);\n      state.bsCount[nextLine] = state.sCount[nextLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n      oldSCount.push(state.sCount[nextLine]);\n      state.sCount[nextLine] = offset - initial;\n\n      oldTShift.push(state.tShift[nextLine]);\n      state.tShift[nextLine] = pos - state.bMarks[nextLine];\n      continue;\n    }\n\n    // Case 2: line is not inside the blockquote, and the last line was empty.\n    if (lastLineEmpty) {\n      break;\n    }\n\n    // Case 3: another tag found.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) {\n      // Quirk to enforce \"hard termination mode\" for paragraphs;\n      // normally if you call `tokenize(state, startLine, nextLine)`,\n      // paragraphs will look below nextLine for paragraph continuation,\n      // but if blockquote is terminated by another tag, they shouldn't\n      state.lineMax = nextLine;\n\n      if (state.blkIndent !== 0) {\n        // state.blkIndent was non-zero, we now set it to zero,\n        // so we need to re-calculate all offsets to appear as\n        // if indent wasn't changed\n        oldBMarks.push(state.bMarks[nextLine]);\n        oldBSCount.push(state.bsCount[nextLine]);\n        oldTShift.push(state.tShift[nextLine]);\n        oldSCount.push(state.sCount[nextLine]);\n        state.sCount[nextLine] -= state.blkIndent;\n      }\n\n      break;\n    }\n\n    oldBMarks.push(state.bMarks[nextLine]);\n    oldBSCount.push(state.bsCount[nextLine]);\n    oldTShift.push(state.tShift[nextLine]);\n    oldSCount.push(state.sCount[nextLine]);\n\n    // A negative indentation means that this is a paragraph continuation\n    //\n    state.sCount[nextLine] = -1;\n  }\n\n  oldIndent = state.blkIndent;\n  state.blkIndent = 0;\n\n  token = state.push(options.name + '_open', options.name, 1);\n  token.markup = options.markup;\n  token.map = lines = [startLine, 0];\n\n  state.md.block.tokenize(state, startLine, nextLine);\n\n  token = state.push(options.name + '_close', options.name, -1);\n  token.markup = options.markup;\n\n  state.lineMax = oldLineMax;\n  state.parentType = oldParentType;\n  lines[1] = state.line;\n\n  // Restore original tShift; this might not be necessary since the parser\n  // has already been here, but just to make sure we can do that.\n  for (i = 0; i < oldTShift.length; i++) {\n    state.bMarks[i + startLine] = oldBMarks[i];\n    state.tShift[i + startLine] = oldTShift[i];\n    state.sCount[i + startLine] = oldSCount[i];\n    state.bsCount[i + startLine] = oldBSCount[i];\n  }\n  state.blkIndent = oldIndent;\n\n  return true;\n}\n\nfunction spoilerFn(state, startLine, endLine, silent) {\n  return blockquoteExt(\n    {\n      followingCharRegex: /!/,\n      markup: '>!',\n      name: 'spoiler',\n    },\n    state,\n    startLine,\n    endLine,\n    silent\n  );\n}\n\nfunction blockquoteFn(state, startLine, endLine, silent) {\n  return blockquoteExt(\n    {\n      followingCharRegex: /[^!]/,\n      markup: '>',\n      name: 'blockquote',\n    },\n    state,\n    startLine,\n    endLine,\n    silent\n  );\n}\n\n/**\n * Parses out spoiler `>!` blocks\n * @param md\n */\nexport default function blockSpoiler(md) {\n  // TODO necessary?\n  // find all blockquote chain rules and update to be part of the spoiler chain as well\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore TODO no public way to iterate over all rules; maybe there's a better way?\n  md.block.ruler.__rules__.forEach((r) => {\n    const bqIndex = r.alt.indexOf('blockquote');\n    if (bqIndex > -1) {\n      // add in \"spoiler\" right before the \"blockquote\" entry\n      r.alt.splice(bqIndex, 0, 'spoiler');\n    }\n  });\n  md.block.ruler.before('blockquote', 'spoiler', spoilerFn, {\n    // TODO stole this from blockquote, dunno what it does...\n    alt: ['paragraph', 'reference', 'spoiler', 'blockquote', 'list'],\n  });\n\n  md.block.ruler.at('blockquote', blockquoteFn, {\n    alt: ['paragraph', 'reference', 'spoiler', 'blockquote', 'list'],\n  });\n}\n","/**!\n * markdown-it-mark\n *\n * Copyright (c) 2014-2015 Vitaly Puzrin, Alex Kocharin.\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n'use strict';\nconst exMark = 0x7c; /* | */\n\nconst tokenize = (frontPriorMode) => (state, silent) => {\n  if (silent) return false;\n\n  const start = state.pos;\n  const marker = state.src.charCodeAt(start);\n\n  if (marker !== exMark) return false;\n\n  const scanned = state.scanDelims(state.pos, true);\n  let len = scanned.length;\n  const ch = String.fromCharCode(marker);\n\n  if (len < 2) return false;\n\n  let isOdd = false;\n  if (len % 2) {\n    isOdd = true;\n    if (!frontPriorMode) {\n      const token = state.push('text', '', 0);\n      token.content = ch;\n    }\n    len--;\n  }\n\n  for (let i = 0; i < len; i += 2) {\n    const token = state.push('text', '', 0);\n    token.content = ch + ch;\n\n    state.delimiters.push({\n      marker,\n      length: 0, // disable \"rule of 3\" length checks meant for emphasis\n      jump: i / 2, // 1 delimiter = 2 characters\n      token: state.tokens.length - 1,\n      end: -1,\n      open: scanned.can_open,\n      close: scanned.can_close,\n    });\n  }\n\n  state.pos += scanned.length;\n  if (isOdd && frontPriorMode) {\n    state.pos--;\n  }\n\n  return true;\n};\n\nconst postProcess = (state, delimiters) => {\n  const loneMarkers = [];\n\n  for (const startDelim of delimiters) {\n    if (startDelim.marker !== exMark) continue;\n    if (startDelim.end === -1) continue;\n\n    const endDelim = delimiters[startDelim.end];\n\n    const tokenO = state.tokens[startDelim.token];\n    tokenO.type = 'spoiler_inline_open';\n    tokenO.tag = 'span';\n    tokenO.attrs = [['class', 'spoiler_inline']];\n    tokenO.nesting = 1;\n    tokenO.markup = '||';\n    tokenO.content = '';\n\n    const tokenC = state.tokens[endDelim.token];\n    tokenC.type = 'spoiler_inline_close';\n    tokenC.tag = 'span';\n    tokenC.nesting = -1;\n    tokenC.markup = '||';\n    tokenC.content = '';\n\n    if (state.tokens[endDelim.token - 1].type === 'text' && state.tokens[endDelim.token - 1].content === '|') {\n      loneMarkers.push(endDelim.token - 1);\n    }\n  }\n\n  // If a marker sequence has an odd number of characters, it's splitted\n  // like this: `|||||` -> `|` + `||` + `||`, leaving one marker at the\n  // start of the sequence.\n  //\n  // So, we have to move all those markers after subsequent spoiler_inline_close tags.\n  //\n  while (loneMarkers.length) {\n    const i = loneMarkers.pop();\n    let j = i + 1;\n\n    while (j < state.tokens.length && state.tokens[j].type === 'spoiler_inline_close') {\n      j++;\n    }\n\n    j--;\n\n    if (i !== j) {\n      const token = state.tokens[j];\n      state.tokens[j] = state.tokens[i];\n      state.tokens[i] = token;\n    }\n  }\n};\n\nexport default function (md, frontPriorMode = false) {\n  md.inline.ruler.before('emphasis', 'spoiler_inline_bars', tokenize(frontPriorMode));\n  md.inline.ruler2.before('emphasis', 'spoiler_inline_bars', (state) => {\n    postProcess(state, state.delimiters);\n\n    if (!state.tokens_meta) return;\n    for (const meta of state.tokens_meta) {\n      if (meta && meta.delimiters) {\n        postProcess(state, meta.delimiters);\n      }\n    }\n  });\n}\n","// BASED ON https://github.com/markdown-it/markdown-it-sub/blob/master/index.js\n\nconst tokenize = (frontPriorMode) => (state, silent) => {\n  if (silent) return false;\n\n  var scanned,\n    max = state.posMax,\n    start = state.pos;\n\n  if (state.src.charCodeAt(start) === 0x3e /* > */ && start + 3 <= max && state.src.charCodeAt(start + 1) === 0x21 /* ! */) {\n    scanned = state.scanDelims(state.pos, true);\n    state.push('text', '', 0);\n    state.delimiters.push({\n      marker: '>!<',\n      length: 2,\n      jump: 0,\n      token: state.tokens.length - 1,\n      end: -1,\n      open: true,\n      close: false,\n    });\n    state.pos += 2;\n    return true;\n  }\n\n  if (state.src.charCodeAt(start) === 0x21 /* ! */ && start + 2 <= max && state.src.charCodeAt(start + 1) === 0x3c /* < */) {\n    state.push('text', '', 0);\n    state.delimiters.push({\n      marker: '>!<',\n      length: 2,\n      jump: 0,\n      token: state.tokens.length - 1,\n      end: -1,\n      open: false,\n      close: true,\n    });\n    state.pos += 2;\n    return true;\n  }\n\n  return false;\n};\n\nfunction postProcess(state, delimiters) {\n  var i,\n    startDelim,\n    endDelim,\n    token,\n    max = delimiters.length;\n\n  for (i = max - 1; i >= 0; i--) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== '>!<') {\n      continue;\n    }\n\n    // Process only opening markers\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    token = state.tokens[startDelim.token];\n    token.type = 'spoiler_inline_open';\n    // token.tag = isStrong ? 'strong' : 'em';\n    token.nesting = 1;\n    token.markup = '>!';\n    token.content = '';\n\n    token = state.tokens[endDelim.token];\n    token.type = 'spoiler_inline_close';\n    // token.tag = isStrong ? 'strong' : 'em';\n    token.nesting = -1;\n    token.markup = '!<';\n    token.content = '';\n  }\n}\n\nexport default function (md, frontPriorMode = false) {\n  md.inline.ruler.before('emphasis', 'spoiler_inline_tags', tokenize(frontPriorMode));\n  md.inline.ruler2.before('emphasis', 'spoiler_inline_bars', (state) => {\n    postProcess(state, state.delimiters);\n\n    if (!state.tokens_meta) return;\n    for (const meta of state.tokens_meta) {\n      if (meta && meta.delimiters) {\n        postProcess(state, meta.delimiters);\n      }\n    }\n  });\n}\n","import markdownit from 'markdown-it';\nimport subPlugin from 'markdown-it-sub';\nimport supPlugin from 'markdown-it-sup';\nimport latexPlugin from 'markdown-it-latex2img';\nimport { defaultMarkdownParser, MarkdownParser } from 'prosemirror-markdown';\nimport altText from './markdown-it/altText';\nimport blockSpoiler from './markdown-it/blockSpoiler';\nimport inlineSpoilerBars from './markdown-it/inlineSpoilerBars';\nimport inlineSpoilerTags from './markdown-it/inlineSpoilerTags';\n\nexport default class MarkdownParserBuilder {\n  constructor(schema) {\n    this.schema = schema;\n  }\n\n  tokenizerParams() {\n    return { html: false };\n  }\n\n  buildTokenizer() {\n    return markdownit('commonmark', this.tokenizerParams())\n      .enable('strikethrough')\n      .use(altText)\n      .use(blockSpoiler)\n      .use(latexPlugin)\n      .use(subPlugin)\n      .use(supPlugin)\n      .use(inlineSpoilerBars)\n      .use(inlineSpoilerTags);\n  }\n\n  buildTokens() {\n    return {\n      ...defaultMarkdownParser.tokens,\n\n      // add support for the strike mark\n      s: {\n        mark: 'strike',\n      },\n\n      // Litedown treaks softbreaks as hard breaks\n      softbreak: { node: 'hard_break' },\n\n      spoiler: {\n        block: 'spoiler',\n      },\n\n      spoiler_inline: {\n        mark: 'spoiler_inline',\n      },\n\n      sub: {\n        mark: 'sub',\n      },\n\n      sup: {\n        mark: 'sup',\n      },\n\n      math_block: {\n        block: 'math_block',\n        noCloseToken: true,\n      },\n\n      math_inline: {\n        mark: 'math_inline',\n        noCloseToken: true,\n      },\n    };\n  }\n\n  build() {\n    return new MarkdownParser(this.schema, this.buildTokenizer(), this.buildTokens());\n  }\n}\n","import Dropdown from 'flarum/common/components/Dropdown';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport SafariModalHack from './SafariModalHack';\n\nexport default class HiddenItemsDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    attrs.buttonClassName = 'Button Button--icon Button--link Button--menuDropdown';\n  }\n\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.state = this.attrs.state;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.$().on('click', (e) => {\n      if ($('.App').is('.mobile-safari')) {\n        // Mobile Safari doesn't support fixed items\n        // So, we wrap them in a modal.\n        app.modal.show(SafariModalHack, {\n          title: this.attrs.tooltip,\n          vnodeContent: this.attrs.buttons.map((button) => {\n            return button;\n          }),\n        });\n        e.stopPropagation();\n      }\n    });\n  }\n\n  getButtonContent(children) {\n    return (\n      <Tooltip text={this.attrs.tooltip}>\n        <span>{icon(this.attrs.icon)}</span>\n      </Tooltip>\n    );\n  }\n\n  getMenu(items) {\n    return <ul className={'Dropdown-menu dropdown-menu HiddenItemsDropdownMenu'}>{this.attrs.buttons}</ul>;\n  }\n}\n","import { toggleBlockType, toggleWrap, wrapIn } from 'tiptap-commands';\n\nimport Component from 'flarum/common/Component';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nimport CommandButton from './CommandButton';\nimport MarkButton from './MarkButton';\nimport NodeTypeDropdown from './NodeTypeDropdown';\nimport InsertImageDropdown from './InsertImageDropdown';\nimport InsertLinkDropdown from './InsertLinkDropdown';\nimport ListButton from './ListButton';\nimport insertHr from '../proseMirror/commands/insertHr';\nimport HiddenItemsDropdown from './HiddenItemsDropdown';\n\nexport default class ProseMirrorMenu extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.modifierKey = navigator.userAgent.match(/Macintosh/) ? '⌘' : 'ctrl';\n  }\n  view(vnode) {\n    if (!this.attrs.state) return '';\n\n    return <div class=\"ProseMirrorMenu\">{this.items().toArray()}</div>;\n  }\n\n  items() {\n    const items = new ItemList();\n    const state = this.attrs.state;\n    const modifierKey = this.modifierKey;\n\n    items.add(\n      'text_type',\n      NodeTypeDropdown.component({\n        type: 'text_type',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.text_type_tooltip'),\n        state: state,\n        options: [\n          {\n            title: 'H1',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 1 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 1 }),\n          },\n          {\n            title: 'H2',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 2 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 2 }),\n          },\n          {\n            title: 'H3',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 3 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 3 }),\n          },\n          {\n            title: 'H4',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 4 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 4 }),\n          },\n          {\n            title: 'H5',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 5 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 5 }),\n          },\n          {\n            title: 'H6',\n            type: state.getSchema().nodes.heading,\n            attrs: { level: 6 },\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.header_tooltip', { modifierKey, level: 6 }),\n          },\n          {\n            title: 'P',\n            type: state.getSchema().nodes.paragraph,\n            tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.paragraph_tooltip', { modifierKey }),\n          },\n        ],\n      }),\n      100\n    );\n\n    items.add(\n      'bold',\n      MarkButton.component({\n        type: 'bold',\n        icon: 'fas fa-bold',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.bold_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.strong,\n      }),\n      90\n    );\n\n    items.add(\n      'italic',\n      MarkButton.component({\n        type: 'italic',\n        icon: 'fas fa-italic',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.italic_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.em,\n      }),\n      80\n    );\n\n    items.add(\n      'code',\n      MarkButton.component({\n        type: 'code',\n        icon: 'fas fa-code',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.code_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.code,\n      }),\n      70\n    );\n\n    items.add(\n      'quote',\n      CommandButton.component({\n        type: 'quote',\n        icon: 'fas fa-quote-left',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.quote_tooltip', { modifierKey }),\n        state: state,\n        command: wrapIn(state.getSchema().nodes.blockquote),\n      }),\n      60\n    );\n\n    items.add(\n      'link',\n      InsertLinkDropdown.component({\n        type: 'link',\n        icon: 'fas fa-link',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.link_tooltip'),\n        state: state,\n        mark: state.getSchema().marks.link,\n      }),\n      50\n    );\n\n    items.add(\n      'image',\n      InsertImageDropdown.component({\n        type: 'image',\n        icon: 'fas fa-image',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.image_tooltip'),\n        state: state,\n        node: state.getSchema().nodes.image,\n      }),\n      40\n    );\n\n    items.add(\n      'unordered_list',\n      ListButton.component({\n        type: 'unordered_list',\n        icon: 'fas fa-list-ul',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.unordered_list_tooltip', { modifierKey }),\n        state: state,\n        listType: state.getSchema().nodes.bullet_list,\n      }),\n      30\n    );\n\n    items.add(\n      'ordered_list',\n      ListButton.component({\n        type: 'ordered_list',\n        icon: 'fas fa-list-ol',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.ordered_list_tooltip', { modifierKey }),\n        state: state,\n        listType: state.getSchema().nodes.ordered_list,\n      }),\n      20\n    );\n\n    items.add(\n      'additional_items',\n      HiddenItemsDropdown.component({\n        type: 'additional_items',\n        icon: 'fas fa-plus',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.additional_items_tooltip'),\n        state: state,\n        buttons: this.hiddenItems().toArray(),\n      })\n    );\n\n    return items;\n  }\n\n  hiddenItems() {\n    const items = new ItemList();\n    const state = this.attrs.state;\n    const modifierKey = this.modifierKey;\n\n    items.add(\n      'strike',\n      MarkButton.component({\n        type: 'strike',\n        icon: 'fas fa-strikethrough',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.strike_tooltip'),\n        state: state,\n        mark: state.getSchema().marks.strike,\n      })\n    );\n\n    items.add(\n      'sub',\n      MarkButton.component({\n        type: 'sub',\n        icon: 'fas fa-subscript',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.sub_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.sub,\n      })\n    );\n\n    items.add(\n      'sup',\n      MarkButton.component({\n        type: 'sup',\n        icon: 'fas fa-superscript',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.sup_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.sup,\n      })\n    );\n\n    items.add(\n      'spoiler_inline',\n      MarkButton.component({\n        type: 'spoiler_inline',\n        icon: 'fas fa-eye-slash',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.spoiler_inline_tooltip', { modifierKey }),\n        state: state,\n        mark: state.getSchema().marks.spoiler_inline,\n      })\n    );\n\n    items.add(\n      'code_block',\n      CommandButton.component({\n        type: 'code_block',\n        icon: 'fas fa-terminal',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.code_block_tooltip', { modifierKey }),\n        state: state,\n        command: toggleBlockType(state.getSchema().nodes.code_block, state.getSchema().nodes.paragraph),\n      })\n    );\n\n    items.add(\n      'spoiler_block',\n      CommandButton.component({\n        type: 'spoiler_block',\n        icon: 'fas fa-caret-square-right',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.spoiler_block_tooltip', { modifierKey }),\n        state: state,\n        command: toggleWrap(state.getSchema().nodes.spoiler),\n      })\n    );\n\n    items.add(\n      'horizontal_rule',\n      CommandButton.component({\n        type: 'horizontal_rule',\n        icon: 'fas fa-minus',\n        tooltip: app.translator.trans('askvortsov-rich-text.lib.composer.horizontal_rule_tooltip'),\n        state: state,\n        command: insertHr(state.getSchema().nodes.horizontal_rule),\n      })\n    );\n\n    return items;\n  }\n}\n","export default function insertHr(nodeType, attrs) {\n  return function (state, dispatch) {\n    dispatch(state.tr.replaceSelectionWith(nodeType.create(attrs)));\n    return true;\n  };\n}\n","import Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport Stream from 'flarum/common/utils/Stream';\nimport FormDropdown from './FormDropdown';\n\nimport { removeMark, updateMark } from 'tiptap-commands';\nimport insertLink from '../proseMirror/commands/insertLink';\n\nexport default class InsertLinkDropdown extends FormDropdown {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.text = Stream('');\n\n    this.href = Stream('');\n    this.title = Stream('');\n\n    this.state.addItem(\n      this.attrs.type,\n      (state, dispatch) => {\n        this.command(state, dispatch);\n      },\n      this.onEditorUpdate.bind(this)\n    );\n\n    this.selectionEmpty = true;\n  }\n\n  fields() {\n    const items = super.fields();\n\n    if (this.selectionEmpty && !this.active) {\n      items.add(\n        'text',\n        <div className=\"Form-group\">\n          <input\n            className=\"FormControl\"\n            name=\"text\"\n            placeholder={extractText(app.translator.trans('askvortsov-rich-text.lib.composer.insert_link.text_placeholder'))}\n            bidi={this.text}\n            required\n          />\n        </div>,\n        10\n      );\n    }\n\n    items.add(\n      'href',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"href\"\n          type=\"url\"\n          placeholder={extractText(app.translator.trans('askvortsov-rich-text.lib.composer.insert_link.href_placeholder'))}\n          bidi={this.href}\n          required\n        />\n      </div>,\n      10\n    );\n\n    items.add(\n      'title',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"title\"\n          placeholder={extractText(app.translator.trans('askvortsov-rich-text.lib.composer.insert_link.title_placeholder'))}\n          bidi={this.title}\n        />\n      </div>,\n      10\n    );\n\n    if (this.active) {\n      items.add(\n        'remove',\n        <Button onclick={this.remove.bind(this)} className=\"Button Button--danger\">\n          {app.translator.trans('askvortsov-rich-text.lib.composer.insert_link.remove_button')}\n        </Button>,\n        -10\n      );\n    }\n\n    return items;\n  }\n\n  insert(e) {\n    const linkAttrs = { href: this.href(), title: this.title() };\n\n    if (this.selectionEmpty && !this.active) {\n      this.command = insertLink(this.text(), this.attrs.mark, linkAttrs);\n\n      this.text('');\n    } else {\n      this.command = updateMark(this.attrs.mark, linkAttrs);\n    }\n\n    this.state.run(this.attrs.type);\n  }\n\n  remove(e) {\n    $('body').trigger('click');\n    this.command = removeMark(this.attrs.mark);\n    this.state.run(this.attrs.type);\n    app.composer.editor.focus();\n  }\n\n  onEditorUpdate() {\n    this.active = !!this.state.markActive(this.attrs.mark);\n    this.$('.Dropdown-toggle').toggleClass('active', this.active);\n\n    const attrs = this.state.markAttrs(this.attrs.mark);\n\n    this.href(attrs.href);\n    this.title(attrs.title);\n\n    this.selectionEmpty = this.state.selectionEmpty();\n  }\n}\n","export default function insertLink(text, markType, attrs) {\n  return function (state, dispatch) {\n    dispatch(state.tr.replaceSelectionWith(state.schema.text(text, [markType.create(attrs)]), false));\n  };\n}\n","module.exports=/[\\0-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/","module.exports=/[\\0-\\x1F\\x7F-\\x9F]/","module.exports=/[ \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000]/","/**\n * class Ruler\n *\n * Helper class, used by [[MarkdownIt#core]], [[MarkdownIt#block]] and\n * [[MarkdownIt#inline]] to manage sequences of functions (rules):\n *\n * - keep rules in defined order\n * - assign the name to each rule\n * - enable/disable rules\n * - add/replace rules\n * - allow assign rules to additional named chains (in the same)\n * - cacheing lists of active rules\n *\n * You will not need use this class directly until write plugins. For simple\n * rules control use [[MarkdownIt.disable]], [[MarkdownIt.enable]] and\n * [[MarkdownIt.use]].\n **/\n'use strict';\n\n\n/**\n * new Ruler()\n **/\nfunction Ruler() {\n  // List of added rules. Each element is:\n  //\n  // {\n  //   name: XXX,\n  //   enabled: Boolean,\n  //   fn: Function(),\n  //   alt: [ name2, name3 ]\n  // }\n  //\n  this.__rules__ = [];\n\n  // Cached rule chains.\n  //\n  // First level - chain name, '' for default.\n  // Second level - diginal anchor for fast filtering by charcodes.\n  //\n  this.__cache__ = null;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// Helper methods, should not be used directly\n\n\n// Find rule index by name\n//\nRuler.prototype.__find__ = function (name) {\n  for (var i = 0; i < this.__rules__.length; i++) {\n    if (this.__rules__[i].name === name) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n// Build rules lookup cache\n//\nRuler.prototype.__compile__ = function () {\n  var self = this;\n  var chains = [ '' ];\n\n  // collect unique names\n  self.__rules__.forEach(function (rule) {\n    if (!rule.enabled) { return; }\n\n    rule.alt.forEach(function (altName) {\n      if (chains.indexOf(altName) < 0) {\n        chains.push(altName);\n      }\n    });\n  });\n\n  self.__cache__ = {};\n\n  chains.forEach(function (chain) {\n    self.__cache__[chain] = [];\n    self.__rules__.forEach(function (rule) {\n      if (!rule.enabled) { return; }\n\n      if (chain && rule.alt.indexOf(chain) < 0) { return; }\n\n      self.__cache__[chain].push(rule.fn);\n    });\n  });\n};\n\n\n/**\n * Ruler.at(name, fn [, options])\n * - name (String): rule name to replace.\n * - fn (Function): new rule function.\n * - options (Object): new rule options (not mandatory).\n *\n * Replace rule by name with new function & options. Throws error if name not\n * found.\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * Replace existing typographer replacement rule with new one:\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.at('replacements', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.at = function (name, fn, options) {\n  var index = this.__find__(name);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + name); }\n\n  this.__rules__[index].fn = fn;\n  this.__rules__[index].alt = opt.alt || [];\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.before(beforeName, ruleName, fn [, options])\n * - beforeName (String): new rule will be added before this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain before one with given name. See also\n * [[Ruler.after]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.block.ruler.before('paragraph', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.before = function (beforeName, ruleName, fn, options) {\n  var index = this.__find__(beforeName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + beforeName); }\n\n  this.__rules__.splice(index, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.after(afterName, ruleName, fn [, options])\n * - afterName (String): new rule will be added after this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain after one with given name. See also\n * [[Ruler.before]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.inline.ruler.after('text', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.after = function (afterName, ruleName, fn, options) {\n  var index = this.__find__(afterName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + afterName); }\n\n  this.__rules__.splice(index + 1, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Ruler.push(ruleName, fn [, options])\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Push new rule to the end of chain. See also\n * [[Ruler.before]], [[Ruler.after]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.push('my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.push = function (ruleName, fn, options) {\n  var opt = options || {};\n\n  this.__rules__.push({\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.enable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to enable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.disable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.enable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and enable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = true;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.enableOnly(list [, ignoreInvalid])\n * - list (String|Array): list of rule names to enable (whitelist).\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names, and disable everything else. If any rule name\n * not found - throw Error. Errors can be disabled by second param.\n *\n * See also [[Ruler.disable]], [[Ruler.enable]].\n **/\nRuler.prototype.enableOnly = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  this.__rules__.forEach(function (rule) { rule.enabled = false; });\n\n  this.enable(list, ignoreInvalid);\n};\n\n\n/**\n * Ruler.disable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Disable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.enable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.disable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and disable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = false;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.getRules(chainName) -> Array\n *\n * Return array of active functions (rules) for given chain name. It analyzes\n * rules configuration, compiles caches if not exists and returns result.\n *\n * Default chain name is `''` (empty string). It can't be skipped. That's\n * done intentionally, to keep signature monomorphic for high speed.\n **/\nRuler.prototype.getRules = function (chainName) {\n  if (this.__cache__ === null) {\n    this.__compile__();\n  }\n\n  // Chain can be empty, if rules disabled. But we still have to return Array.\n  return this.__cache__[chainName] || [];\n};\n\nmodule.exports = Ruler;\n","// Token class\n\n'use strict';\n\n\n/**\n * class Token\n **/\n\n/**\n * new Token(type, tag, nesting)\n *\n * Create new token and fill passed properties.\n **/\nfunction Token(type, tag, nesting) {\n  /**\n   * Token#type -> String\n   *\n   * Type of the token (string, e.g. \"paragraph_open\")\n   **/\n  this.type     = type;\n\n  /**\n   * Token#tag -> String\n   *\n   * html tag name, e.g. \"p\"\n   **/\n  this.tag      = tag;\n\n  /**\n   * Token#attrs -> Array\n   *\n   * Html attributes. Format: `[ [ name1, value1 ], [ name2, value2 ] ]`\n   **/\n  this.attrs    = null;\n\n  /**\n   * Token#map -> Array\n   *\n   * Source map info. Format: `[ line_begin, line_end ]`\n   **/\n  this.map      = null;\n\n  /**\n   * Token#nesting -> Number\n   *\n   * Level change (number in {-1, 0, 1} set), where:\n   *\n   * -  `1` means the tag is opening\n   * -  `0` means the tag is self-closing\n   * - `-1` means the tag is closing\n   **/\n  this.nesting  = nesting;\n\n  /**\n   * Token#level -> Number\n   *\n   * nesting level, the same as `state.level`\n   **/\n  this.level    = 0;\n\n  /**\n   * Token#children -> Array\n   *\n   * An array of child nodes (inline and img tokens)\n   **/\n  this.children = null;\n\n  /**\n   * Token#content -> String\n   *\n   * In a case of self-closing tag (code, html, fence, etc.),\n   * it has contents of this tag.\n   **/\n  this.content  = '';\n\n  /**\n   * Token#markup -> String\n   *\n   * '*' or '_' for emphasis, fence string for fence, etc.\n   **/\n  this.markup   = '';\n\n  /**\n   * Token#info -> String\n   *\n   * Additional information:\n   *\n   * - Info string for \"fence\" tokens\n   * - The value \"auto\" for autolink \"link_open\" and \"link_close\" tokens\n   * - The string value of the item marker for ordered-list \"list_item_open\" tokens\n   **/\n  this.info     = '';\n\n  /**\n   * Token#meta -> Object\n   *\n   * A place for plugins to store an arbitrary data\n   **/\n  this.meta     = null;\n\n  /**\n   * Token#block -> Boolean\n   *\n   * True for block-level tokens, false for inline tokens.\n   * Used in renderer to calculate line breaks\n   **/\n  this.block    = false;\n\n  /**\n   * Token#hidden -> Boolean\n   *\n   * If it's true, ignore this element when rendering. Used for tight lists\n   * to hide paragraphs.\n   **/\n  this.hidden   = false;\n}\n\n\n/**\n * Token.attrIndex(name) -> Number\n *\n * Search attribute index by name.\n **/\nToken.prototype.attrIndex = function attrIndex(name) {\n  var attrs, i, len;\n\n  if (!this.attrs) { return -1; }\n\n  attrs = this.attrs;\n\n  for (i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i][0] === name) { return i; }\n  }\n  return -1;\n};\n\n\n/**\n * Token.attrPush(attrData)\n *\n * Add `[ name, value ]` attribute to list. Init attrs if necessary\n **/\nToken.prototype.attrPush = function attrPush(attrData) {\n  if (this.attrs) {\n    this.attrs.push(attrData);\n  } else {\n    this.attrs = [ attrData ];\n  }\n};\n\n\n/**\n * Token.attrSet(name, value)\n *\n * Set `name` attribute to `value`. Override old value if exists.\n **/\nToken.prototype.attrSet = function attrSet(name, value) {\n  var idx = this.attrIndex(name),\n      attrData = [ name, value ];\n\n  if (idx < 0) {\n    this.attrPush(attrData);\n  } else {\n    this.attrs[idx] = attrData;\n  }\n};\n\n\n/**\n * Token.attrGet(name)\n *\n * Get the value of attribute `name`, or null if it does not exist.\n **/\nToken.prototype.attrGet = function attrGet(name) {\n  var idx = this.attrIndex(name), value = null;\n  if (idx >= 0) {\n    value = this.attrs[idx][1];\n  }\n  return value;\n};\n\n\n/**\n * Token.attrJoin(name, value)\n *\n * Join value to existing attribute via space. Or create new attribute if not\n * exists. Useful to operate with token classes.\n **/\nToken.prototype.attrJoin = function attrJoin(name, value) {\n  var idx = this.attrIndex(name);\n\n  if (idx < 0) {\n    this.attrPush([ name, value ]);\n  } else {\n    this.attrs[idx][1] = this.attrs[idx][1] + ' ' + value;\n  }\n};\n\n\nmodule.exports = Token;\n","/**\n * class Ruler\n *\n * Helper class, used by [[MarkdownIt#core]], [[MarkdownIt#block]] and\n * [[MarkdownIt#inline]] to manage sequences of functions (rules):\n *\n * - keep rules in defined order\n * - assign the name to each rule\n * - enable/disable rules\n * - add/replace rules\n * - allow assign rules to additional named chains (in the same)\n * - cacheing lists of active rules\n *\n * You will not need use this class directly until write plugins. For simple\n * rules control use [[MarkdownIt.disable]], [[MarkdownIt.enable]] and\n * [[MarkdownIt.use]].\n **/\n'use strict';\n\n\n/**\n * new Ruler()\n **/\nfunction Ruler() {\n  // List of added rules. Each element is:\n  //\n  // {\n  //   name: XXX,\n  //   enabled: Boolean,\n  //   fn: Function(),\n  //   alt: [ name2, name3 ]\n  // }\n  //\n  this.__rules__ = [];\n\n  // Cached rule chains.\n  //\n  // First level - chain name, '' for default.\n  // Second level - diginal anchor for fast filtering by charcodes.\n  //\n  this.__cache__ = null;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// Helper methods, should not be used directly\n\n\n// Find rule index by name\n//\nRuler.prototype.__find__ = function (name) {\n  for (var i = 0; i < this.__rules__.length; i++) {\n    if (this.__rules__[i].name === name) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n// Build rules lookup cache\n//\nRuler.prototype.__compile__ = function () {\n  var self = this;\n  var chains = [ '' ];\n\n  // collect unique names\n  self.__rules__.forEach(function (rule) {\n    if (!rule.enabled) { return; }\n\n    rule.alt.forEach(function (altName) {\n      if (chains.indexOf(altName) < 0) {\n        chains.push(altName);\n      }\n    });\n  });\n\n  self.__cache__ = {};\n\n  chains.forEach(function (chain) {\n    self.__cache__[chain] = [];\n    self.__rules__.forEach(function (rule) {\n      if (!rule.enabled) { return; }\n\n      if (chain && rule.alt.indexOf(chain) < 0) { return; }\n\n      self.__cache__[chain].push(rule.fn);\n    });\n  });\n};\n\n\n/**\n * Ruler.at(name, fn [, options])\n * - name (String): rule name to replace.\n * - fn (Function): new rule function.\n * - options (Object): new rule options (not mandatory).\n *\n * Replace rule by name with new function & options. Throws error if name not\n * found.\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * Replace existing typographer replacement rule with new one:\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.at('replacements', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.at = function (name, fn, options) {\n  var index = this.__find__(name);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + name); }\n\n  this.__rules__[index].fn = fn;\n  this.__rules__[index].alt = opt.alt || [];\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.before(beforeName, ruleName, fn [, options])\n * - beforeName (String): new rule will be added before this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain before one with given name. See also\n * [[Ruler.after]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.block.ruler.before('paragraph', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.before = function (beforeName, ruleName, fn, options) {\n  var index = this.__find__(beforeName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + beforeName); }\n\n  this.__rules__.splice(index, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.after(afterName, ruleName, fn [, options])\n * - afterName (String): new rule will be added after this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain after one with given name. See also\n * [[Ruler.before]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.inline.ruler.after('text', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.after = function (afterName, ruleName, fn, options) {\n  var index = this.__find__(afterName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + afterName); }\n\n  this.__rules__.splice(index + 1, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Ruler.push(ruleName, fn [, options])\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Push new rule to the end of chain. See also\n * [[Ruler.before]], [[Ruler.after]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.push('my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.push = function (ruleName, fn, options) {\n  var opt = options || {};\n\n  this.__rules__.push({\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.enable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to enable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.disable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.enable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and enable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = true;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.enableOnly(list [, ignoreInvalid])\n * - list (String|Array): list of rule names to enable (whitelist).\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names, and disable everything else. If any rule name\n * not found - throw Error. Errors can be disabled by second param.\n *\n * See also [[Ruler.disable]], [[Ruler.enable]].\n **/\nRuler.prototype.enableOnly = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  this.__rules__.forEach(function (rule) { rule.enabled = false; });\n\n  this.enable(list, ignoreInvalid);\n};\n\n\n/**\n * Ruler.disable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Disable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.enable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.disable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and disable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = false;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.getRules(chainName) -> Array\n *\n * Return array of active functions (rules) for given chain name. It analyzes\n * rules configuration, compiles caches if not exists and returns result.\n *\n * Default chain name is `''` (empty string). It can't be skipped. That's\n * done intentionally, to keep signature monomorphic for high speed.\n **/\nRuler.prototype.getRules = function (chainName) {\n  if (this.__cache__ === null) {\n    this.__compile__();\n  }\n\n  // Chain can be empty, if rules disabled. But we still have to return Array.\n  return this.__cache__[chainName] || [];\n};\n\nmodule.exports = Ruler;\n","// Token class\n\n'use strict';\n\n\n/**\n * class Token\n **/\n\n/**\n * new Token(type, tag, nesting)\n *\n * Create new token and fill passed properties.\n **/\nfunction Token(type, tag, nesting) {\n  /**\n   * Token#type -> String\n   *\n   * Type of the token (string, e.g. \"paragraph_open\")\n   **/\n  this.type     = type;\n\n  /**\n   * Token#tag -> String\n   *\n   * html tag name, e.g. \"p\"\n   **/\n  this.tag      = tag;\n\n  /**\n   * Token#attrs -> Array\n   *\n   * Html attributes. Format: `[ [ name1, value1 ], [ name2, value2 ] ]`\n   **/\n  this.attrs    = null;\n\n  /**\n   * Token#map -> Array\n   *\n   * Source map info. Format: `[ line_begin, line_end ]`\n   **/\n  this.map      = null;\n\n  /**\n   * Token#nesting -> Number\n   *\n   * Level change (number in {-1, 0, 1} set), where:\n   *\n   * -  `1` means the tag is opening\n   * -  `0` means the tag is self-closing\n   * - `-1` means the tag is closing\n   **/\n  this.nesting  = nesting;\n\n  /**\n   * Token#level -> Number\n   *\n   * nesting level, the same as `state.level`\n   **/\n  this.level    = 0;\n\n  /**\n   * Token#children -> Array\n   *\n   * An array of child nodes (inline and img tokens)\n   **/\n  this.children = null;\n\n  /**\n   * Token#content -> String\n   *\n   * In a case of self-closing tag (code, html, fence, etc.),\n   * it has contents of this tag.\n   **/\n  this.content  = '';\n\n  /**\n   * Token#markup -> String\n   *\n   * '*' or '_' for emphasis, fence string for fence, etc.\n   **/\n  this.markup   = '';\n\n  /**\n   * Token#info -> String\n   *\n   * fence infostring\n   **/\n  this.info     = '';\n\n  /**\n   * Token#meta -> Object\n   *\n   * A place for plugins to store an arbitrary data\n   **/\n  this.meta     = null;\n\n  /**\n   * Token#block -> Boolean\n   *\n   * True for block-level tokens, false for inline tokens.\n   * Used in renderer to calculate line breaks\n   **/\n  this.block    = false;\n\n  /**\n   * Token#hidden -> Boolean\n   *\n   * If it's true, ignore this element when rendering. Used for tight lists\n   * to hide paragraphs.\n   **/\n  this.hidden   = false;\n}\n\n\n/**\n * Token.attrIndex(name) -> Number\n *\n * Search attribute index by name.\n **/\nToken.prototype.attrIndex = function attrIndex(name) {\n  var attrs, i, len;\n\n  if (!this.attrs) { return -1; }\n\n  attrs = this.attrs;\n\n  for (i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i][0] === name) { return i; }\n  }\n  return -1;\n};\n\n\n/**\n * Token.attrPush(attrData)\n *\n * Add `[ name, value ]` attribute to list. Init attrs if necessary\n **/\nToken.prototype.attrPush = function attrPush(attrData) {\n  if (this.attrs) {\n    this.attrs.push(attrData);\n  } else {\n    this.attrs = [ attrData ];\n  }\n};\n\n\n/**\n * Token.attrSet(name, value)\n *\n * Set `name` attribute to `value`. Override old value if exists.\n **/\nToken.prototype.attrSet = function attrSet(name, value) {\n  var idx = this.attrIndex(name),\n      attrData = [ name, value ];\n\n  if (idx < 0) {\n    this.attrPush(attrData);\n  } else {\n    this.attrs[idx] = attrData;\n  }\n};\n\n\n/**\n * Token.attrGet(name)\n *\n * Get the value of attribute `name`, or null if it does not exist.\n **/\nToken.prototype.attrGet = function attrGet(name) {\n  var idx = this.attrIndex(name), value = null;\n  if (idx >= 0) {\n    value = this.attrs[idx][1];\n  }\n  return value;\n};\n\n\n/**\n * Token.attrJoin(name, value)\n *\n * Join value to existing attribute via space. Or create new attribute if not\n * exists. Useful to operate with token classes.\n **/\nToken.prototype.attrJoin = function attrJoin(name, value) {\n  var idx = this.attrIndex(name);\n\n  if (idx < 0) {\n    this.attrPush([ name, value ]);\n  } else {\n    this.attrs[idx][1] = this.attrs[idx][1] + ' ' + value;\n  }\n};\n\n\nmodule.exports = Token;\n","// HTML5 entities map: { name -> utf16string }\n//\n'use strict';\n\n/*eslint quotes:0*/\nmodule.exports = require('entities/lib/maps/entities.json');\n","'use strict';\n\nexports.Any = require('./properties/Any/regex');\nexports.Cc  = require('./categories/Cc/regex');\nexports.Cf  = require('./categories/Cf/regex');\nexports.P   = require('./categories/P/regex');\nexports.Z   = require('./categories/Z/regex');\n","// Regexps to match html elements\n\n'use strict';\n\nvar attr_name     = '[a-zA-Z_:][a-zA-Z0-9:._-]*';\n\nvar unquoted      = '[^\"\\'=<>`\\\\x00-\\\\x20]+';\nvar single_quoted = \"'[^']*'\";\nvar double_quoted = '\"[^\"]*\"';\n\nvar attr_value  = '(?:' + unquoted + '|' + single_quoted + '|' + double_quoted + ')';\n\nvar attribute   = '(?:\\\\s+' + attr_name + '(?:\\\\s*=\\\\s*' + attr_value + ')?)';\n\nvar open_tag    = '<[A-Za-z][A-Za-z0-9\\\\-]*' + attribute + '*\\\\s*\\\\/?>';\n\nvar close_tag   = '<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>';\nvar comment     = '<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->';\nvar processing  = '<[?][\\\\s\\\\S]*?[?]>';\nvar declaration = '<![A-Z]+\\\\s+[^>]*>';\nvar cdata       = '<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>';\n\nvar HTML_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + '|' + comment +\n                        '|' + processing + '|' + declaration + '|' + cdata + ')');\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + ')');\n\nmodule.exports.HTML_TAG_RE = HTML_TAG_RE;\nmodule.exports.HTML_OPEN_CLOSE_TAG_RE = HTML_OPEN_CLOSE_TAG_RE;\n","// ~~strike through~~\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function strikethrough(state, silent) {\n  var i, scanned, token, len, ch,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x7E/* ~ */) { return false; }\n\n  scanned = state.scanDelims(state.pos, true);\n  len = scanned.length;\n  ch = String.fromCharCode(marker);\n\n  if (len < 2) { return false; }\n\n  if (len % 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch;\n    len--;\n  }\n\n  for (i = 0; i < len; i += 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch + ch;\n\n    state.delimiters.push({\n      marker: marker,\n      length: 0,     // disable \"rule of 3\" length checks meant for emphasis\n      token:  state.tokens.length - 1,\n      end:    -1,\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i, j,\n      startDelim,\n      endDelim,\n      token,\n      loneMarkers = [],\n      max = delimiters.length;\n\n  for (i = 0; i < max; i++) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x7E/* ~ */) {\n      continue;\n    }\n\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    token         = state.tokens[startDelim.token];\n    token.type    = 's_open';\n    token.tag     = 's';\n    token.nesting = 1;\n    token.markup  = '~~';\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = 's_close';\n    token.tag     = 's';\n    token.nesting = -1;\n    token.markup  = '~~';\n    token.content = '';\n\n    if (state.tokens[endDelim.token - 1].type === 'text' &&\n        state.tokens[endDelim.token - 1].content === '~') {\n\n      loneMarkers.push(endDelim.token - 1);\n    }\n  }\n\n  // If a marker sequence has an odd number of characters, it's splitted\n  // like this: `~~~~~` -> `~` + `~~` + `~~`, leaving one marker at the\n  // start of the sequence.\n  //\n  // So, we have to move all those markers after subsequent s_close tags.\n  //\n  while (loneMarkers.length) {\n    i = loneMarkers.pop();\n    j = i + 1;\n\n    while (j < state.tokens.length && state.tokens[j].type === 's_close') {\n      j++;\n    }\n\n    j--;\n\n    if (i !== j) {\n      token = state.tokens[j];\n      state.tokens[j] = state.tokens[i];\n      state.tokens[i] = token;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function strikethrough(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Process *this* and _that_\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function emphasis(state, silent) {\n  var i, scanned, token,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x5F /* _ */ && marker !== 0x2A /* * */) { return false; }\n\n  scanned = state.scanDelims(state.pos, marker === 0x2A);\n\n  for (i = 0; i < scanned.length; i++) {\n    token         = state.push('text', '', 0);\n    token.content = String.fromCharCode(marker);\n\n    state.delimiters.push({\n      // Char code of the starting marker (number).\n      //\n      marker: marker,\n\n      // Total length of these series of delimiters.\n      //\n      length: scanned.length,\n\n      // A position of the token this delimiter corresponds to.\n      //\n      token:  state.tokens.length - 1,\n\n      // If this delimiter is matched as a valid opener, `end` will be\n      // equal to its position, otherwise it's `-1`.\n      //\n      end:    -1,\n\n      // Boolean flags that determine if this delimiter could open or close\n      // an emphasis.\n      //\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i,\n      startDelim,\n      endDelim,\n      token,\n      ch,\n      isStrong,\n      max = delimiters.length;\n\n  for (i = max - 1; i >= 0; i--) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x5F/* _ */ && startDelim.marker !== 0x2A/* * */) {\n      continue;\n    }\n\n    // Process only opening markers\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    // If the previous delimiter has the same marker and is adjacent to this one,\n    // merge those into one strong delimiter.\n    //\n    // `<em><em>whatever</em></em>` -> `<strong>whatever</strong>`\n    //\n    isStrong = i > 0 &&\n               delimiters[i - 1].end === startDelim.end + 1 &&\n               // check that first two markers match and adjacent\n               delimiters[i - 1].marker === startDelim.marker &&\n               delimiters[i - 1].token === startDelim.token - 1 &&\n               // check that last two markers are adjacent (we can safely assume they match)\n               delimiters[startDelim.end + 1].token === endDelim.token + 1;\n\n    ch = String.fromCharCode(startDelim.marker);\n\n    token         = state.tokens[startDelim.token];\n    token.type    = isStrong ? 'strong_open' : 'em_open';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = 1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = isStrong ? 'strong_close' : 'em_close';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = -1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    if (isStrong) {\n      state.tokens[delimiters[i - 1].token].content = '';\n      state.tokens[delimiters[startDelim.end + 1].token].content = '';\n      i--;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function emphasis(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","// HTML5 entities map: { name -> utf16string }\n//\n'use strict';\n\n/*eslint quotes:0*/\nmodule.exports = require('entities/lib/maps/entities.json');\n","// Regexps to match html elements\n\n'use strict';\n\nvar attr_name     = '[a-zA-Z_:][a-zA-Z0-9:._-]*';\n\nvar unquoted      = '[^\"\\'=<>`\\\\x00-\\\\x20]+';\nvar single_quoted = \"'[^']*'\";\nvar double_quoted = '\"[^\"]*\"';\n\nvar attr_value  = '(?:' + unquoted + '|' + single_quoted + '|' + double_quoted + ')';\n\nvar attribute   = '(?:\\\\s+' + attr_name + '(?:\\\\s*=\\\\s*' + attr_value + ')?)';\n\nvar open_tag    = '<[A-Za-z][A-Za-z0-9\\\\-]*' + attribute + '*\\\\s*\\\\/?>';\n\nvar close_tag   = '<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>';\nvar comment     = '<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->';\nvar processing  = '<[?].*?[?]>';\nvar declaration = '<![A-Z]+\\\\s+[^>]*>';\nvar cdata       = '<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>';\n\nvar HTML_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + '|' + comment +\n                        '|' + processing + '|' + declaration + '|' + cdata + ')');\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + ')');\n\nmodule.exports.HTML_TAG_RE = HTML_TAG_RE;\nmodule.exports.HTML_OPEN_CLOSE_TAG_RE = HTML_OPEN_CLOSE_TAG_RE;\n","// ~~strike through~~\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function strikethrough(state, silent) {\n  var i, scanned, token, len, ch,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x7E/* ~ */) { return false; }\n\n  scanned = state.scanDelims(state.pos, true);\n  len = scanned.length;\n  ch = String.fromCharCode(marker);\n\n  if (len < 2) { return false; }\n\n  if (len % 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch;\n    len--;\n  }\n\n  for (i = 0; i < len; i += 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch + ch;\n\n    state.delimiters.push({\n      marker: marker,\n      length: 0, // disable \"rule of 3\" length checks meant for emphasis\n      jump:   i,\n      token:  state.tokens.length - 1,\n      end:    -1,\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i, j,\n      startDelim,\n      endDelim,\n      token,\n      loneMarkers = [],\n      max = delimiters.length;\n\n  for (i = 0; i < max; i++) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x7E/* ~ */) {\n      continue;\n    }\n\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    token         = state.tokens[startDelim.token];\n    token.type    = 's_open';\n    token.tag     = 's';\n    token.nesting = 1;\n    token.markup  = '~~';\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = 's_close';\n    token.tag     = 's';\n    token.nesting = -1;\n    token.markup  = '~~';\n    token.content = '';\n\n    if (state.tokens[endDelim.token - 1].type === 'text' &&\n        state.tokens[endDelim.token - 1].content === '~') {\n\n      loneMarkers.push(endDelim.token - 1);\n    }\n  }\n\n  // If a marker sequence has an odd number of characters, it's splitted\n  // like this: `~~~~~` -> `~` + `~~` + `~~`, leaving one marker at the\n  // start of the sequence.\n  //\n  // So, we have to move all those markers after subsequent s_close tags.\n  //\n  while (loneMarkers.length) {\n    i = loneMarkers.pop();\n    j = i + 1;\n\n    while (j < state.tokens.length && state.tokens[j].type === 's_close') {\n      j++;\n    }\n\n    j--;\n\n    if (i !== j) {\n      token = state.tokens[j];\n      state.tokens[j] = state.tokens[i];\n      state.tokens[i] = token;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function strikethrough(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Process *this* and _that_\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function emphasis(state, silent) {\n  var i, scanned, token,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x5F /* _ */ && marker !== 0x2A /* * */) { return false; }\n\n  scanned = state.scanDelims(state.pos, marker === 0x2A);\n\n  for (i = 0; i < scanned.length; i++) {\n    token         = state.push('text', '', 0);\n    token.content = String.fromCharCode(marker);\n\n    state.delimiters.push({\n      // Char code of the starting marker (number).\n      //\n      marker: marker,\n\n      // Total length of these series of delimiters.\n      //\n      length: scanned.length,\n\n      // An amount of characters before this one that's equivalent to\n      // current one. In plain English: if this delimiter does not open\n      // an emphasis, neither do previous `jump` characters.\n      //\n      // Used to skip sequences like \"*****\" in one step, for 1st asterisk\n      // value will be 0, for 2nd it's 1 and so on.\n      //\n      jump:   i,\n\n      // A position of the token this delimiter corresponds to.\n      //\n      token:  state.tokens.length - 1,\n\n      // If this delimiter is matched as a valid opener, `end` will be\n      // equal to its position, otherwise it's `-1`.\n      //\n      end:    -1,\n\n      // Boolean flags that determine if this delimiter could open or close\n      // an emphasis.\n      //\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i,\n      startDelim,\n      endDelim,\n      token,\n      ch,\n      isStrong,\n      max = delimiters.length;\n\n  for (i = max - 1; i >= 0; i--) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x5F/* _ */ && startDelim.marker !== 0x2A/* * */) {\n      continue;\n    }\n\n    // Process only opening markers\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    // If the previous delimiter has the same marker and is adjacent to this one,\n    // merge those into one strong delimiter.\n    //\n    // `<em><em>whatever</em></em>` -> `<strong>whatever</strong>`\n    //\n    isStrong = i > 0 &&\n               delimiters[i - 1].end === startDelim.end + 1 &&\n               delimiters[i - 1].token === startDelim.token - 1 &&\n               delimiters[startDelim.end + 1].token === endDelim.token + 1 &&\n               delimiters[i - 1].marker === startDelim.marker;\n\n    ch = String.fromCharCode(startDelim.marker);\n\n    token         = state.tokens[startDelim.token];\n    token.type    = isStrong ? 'strong_open' : 'em_open';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = 1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = isStrong ? 'strong_close' : 'em_close';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = -1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    if (isStrong) {\n      state.tokens[delimiters[i - 1].token].content = '';\n      state.tokens[delimiters[startDelim.end + 1].token].content = '';\n      i--;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function emphasis(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","import CommandButton from './CommandButton';\nimport FormDropdown from './FormDropdown';\nimport InsertImageDropdown from './InsertImageDropdown';\nimport InsertLinkDropdown from './InsertLinkDropdown';\nimport ListButton from './ListButton';\nimport MarkButton from './MarkButton';\nimport NodeTypeDropdown from './NodeTypeDropdown';\nimport ProseMirrorMenu from './ProseMirrorMenu';\n\nexport const components = {\n  CommandButton: CommandButton,\n  FormDropdown: FormDropdown,\n  InsertImageDropdown: InsertImageDropdown,\n  InsertLinkDropdown: InsertLinkDropdown,\n  ListButton: ListButton,\n  MarkButton: MarkButton,\n  NodeTypeDropdown: NodeTypeDropdown,\n  ProseMirrorMenu: ProseMirrorMenu,\n};\n","import updateToggleMark from './updateToggleMark';\n\nexport const commands = {\n  updateToggleMark: updateToggleMark,\n};\n","import { toggleMark, updateMark } from 'tiptap-commands';\n\nexport default function updateToggleMark(type, attrs) {\n  return function (state, dispatch) {\n    if (state.selection.empty) {\n      return toggleMark(type, attrs)(state, dispatch);\n    }\n    return updateMark(type, attrs)(state, dispatch);\n  };\n}\n","import { commands } from './commands';\nimport { markdown } from './markdown';\nimport ProseMirrorEditorDriver from './ProseMirrorEditorDriver';\n\nexport const proseMirror = {\n  commands: commands,\n  markdown: markdown,\n  ProseMirrorEditorDriver: ProseMirrorEditorDriver,\n};\n","import MarkdownParserBuilder from './MarkdownParserBuilder';\nimport MarkdownSerializerBuilder from './MarkdownSerializerBuilder';\nimport SchemaBuilder from './SchemaBuilder';\n\nexport const markdown = {\n  MarkdownParserBuilder: MarkdownParserBuilder,\n  MarkdownSerializerBuilder: MarkdownSerializerBuilder,\n  SchemaBuilder: SchemaBuilder,\n};\n","import MenuState from './MenuState';\n\nexport const states = {\n  MenuState: MenuState,\n};\n","import { extend, override } from 'flarum/common/extend';\n\nimport Button from 'flarum/common/components/Button';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport classList from 'flarum/common/utils/classList';\n\nimport ProseMirrorEditorDriver from './proseMirror/ProseMirrorEditorDriver';\nimport ProseMirrorMenu from './components/ProseMirrorMenu';\nimport MenuState from './states/MenuState';\n\nexport default function applyEditor() {\n  extend(TextEditor.prototype, 'controlItems', function (items) {\n    if (!app.forum.attribute('toggleRichTextEditorButton')) return;\n\n    const buttonOnClick = () => {\n      app.session.user.savePreferences({ useRichTextEditor: !app.session.user.preferences().useRichTextEditor }).then(() => {\n        app.composer.editor.destroy();\n        this.attrs.composer.editor = this.buildEditor(this.$('.TextEditor-editorContainer')[0]);\n        m.redraw.sync();\n        app.composer.editor.focus();\n      });\n    };\n\n    items.add(\n      'rich-text',\n      <Tooltip text={app.translator.trans('askvortsov-rich-text.lib.composer.toggle_button')}>\n        <Button\n          icon=\"fas fa-pen-fancy\"\n          className={classList({ Button: true, 'Button--icon': true, active: app.session.user.preferences().useRichTextEditor })}\n          onclick={buttonOnClick}\n        />\n      </Tooltip>,\n      -10\n    );\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    if (!app.session.user.preferences().useRichTextEditor) return;\n\n    items.remove('markdown');\n\n    items.add('prosemirror-menu', <ProseMirrorMenu state={this.menuState} />, 100);\n  });\n\n  extend(TextEditor.prototype, 'buildEditorParams', function (items) {\n    if (!app.session.user.preferences().useRichTextEditor) return;\n\n    items.menuState = this.menuState = new MenuState();\n    items.classNames.push('Post-body');\n    items.escape = () => app.composer.close();\n    m.redraw();\n  });\n\n  override(TextEditor.prototype, 'buildEditor', function (original, dom) {\n    if (app.session.user.preferences().useRichTextEditor) {\n      return new ProseMirrorEditorDriver(dom, this.buildEditorParams());\n    }\n\n    return original(dom);\n  });\n}\n","module.exports = flarum.core.compat['common/utils/classList'];","'use strict';\n\n\nmodule.exports = require('./lib/');\n","'use strict';\n\n\nmodule.exports = require('./lib/');\n","// Process ~subscript~\n\n'use strict';\n\n// same as UNESCAPE_MD_RE plus a space\nvar UNESCAPE_RE = /\\\\([ \\\\!\"#$%&'()*+,.\\/:;<=>?@[\\]^_`{|}~-])/g;\n\n\nfunction subscript(state, silent) {\n  var found,\n      content,\n      token,\n      max = state.posMax,\n      start = state.pos;\n\n  if (state.src.charCodeAt(start) !== 0x7E/* ~ */) { return false; }\n  if (silent) { return false; } // don't run any pairs in validation mode\n  if (start + 2 >= max) { return false; }\n\n  state.pos = start + 1;\n\n  while (state.pos < max) {\n    if (state.src.charCodeAt(state.pos) === 0x7E/* ~ */) {\n      found = true;\n      break;\n    }\n\n    state.md.inline.skipToken(state);\n  }\n\n  if (!found || start + 1 === state.pos) {\n    state.pos = start;\n    return false;\n  }\n\n  content = state.src.slice(start + 1, state.pos);\n\n  // don't allow unescaped spaces/newlines inside\n  if (content.match(/(^|[^\\\\])(\\\\\\\\)*\\s/)) {\n    state.pos = start;\n    return false;\n  }\n\n  // found!\n  state.posMax = state.pos;\n  state.pos = start + 1;\n\n  // Earlier we checked !silent, but this implementation does not need it\n  token         = state.push('sub_open', 'sub', 1);\n  token.markup  = '~';\n\n  token         = state.push('text', '', 0);\n  token.content = content.replace(UNESCAPE_RE, '$1');\n\n  token         = state.push('sub_close', 'sub', -1);\n  token.markup  = '~';\n\n  state.pos = state.posMax + 1;\n  state.posMax = max;\n  return true;\n}\n\n\nmodule.exports = function sub_plugin(md) {\n  md.inline.ruler.after('emphasis', 'sub', subscript);\n};\n","// Process ^superscript^\n\n'use strict';\n\n// same as UNESCAPE_MD_RE plus a space\nvar UNESCAPE_RE = /\\\\([ \\\\!\"#$%&'()*+,.\\/:;<=>?@[\\]^_`{|}~-])/g;\n\nfunction superscript(state, silent) {\n  var found,\n      content,\n      token,\n      max = state.posMax,\n      start = state.pos;\n\n  if (state.src.charCodeAt(start) !== 0x5E/* ^ */) { return false; }\n  if (silent) { return false; } // don't run any pairs in validation mode\n  if (start + 2 >= max) { return false; }\n\n  state.pos = start + 1;\n\n  while (state.pos < max) {\n    if (state.src.charCodeAt(state.pos) === 0x5E/* ^ */) {\n      found = true;\n      break;\n    }\n\n    state.md.inline.skipToken(state);\n  }\n\n  if (!found || start + 1 === state.pos) {\n    state.pos = start;\n    return false;\n  }\n\n  content = state.src.slice(start + 1, state.pos);\n\n  // don't allow unescaped spaces/newlines inside\n  if (content.match(/(^|[^\\\\])(\\\\\\\\)*\\s/)) {\n    state.pos = start;\n    return false;\n  }\n\n  // found!\n  state.posMax = state.pos;\n  state.pos = start + 1;\n\n  // Earlier we checked !silent, but this implementation does not need it\n  token         = state.push('sup_open', 'sup', 1);\n  token.markup  = '^';\n\n  token         = state.push('text', '', 0);\n  token.content = content.replace(UNESCAPE_RE, '$1');\n\n  token         = state.push('sup_close', 'sup', -1);\n  token.markup  = '^';\n\n  state.pos = state.posMax + 1;\n  state.posMax = max;\n  return true;\n}\n\n\nmodule.exports = function sup_plugin(md) {\n  md.inline.ruler.after('emphasis', 'sup', superscript);\n};\n","// Process latex\n//\n\"use strict\";\n\nfunction isValidDelim(state, pos) {\n  let prevChar,\n    nextChar,\n    max = state.posMax,\n    can_open = true,\n    can_close = true;\n\n  prevChar = pos > 0 ? state.src.charCodeAt(pos - 1) : -1;\n  nextChar = pos + 1 <= max ? state.src.charCodeAt(pos + 1) : -1;\n\n  // Check non-whitespace conditions for opening and closing, and\n  // check that closing delimeter isn't followed by a number\n  if (\n    prevChar === 0x20 /* \" \" */ ||\n    prevChar === 0x09 /* \\t */ ||\n    (nextChar >= 0x30 /* \"0\" */ && nextChar <= 0x39) /* \"9\" */\n  ) {\n    can_close = false;\n  }\n  if (nextChar === 0x20 /* \" \" */ || nextChar === 0x09 /* \\t */) {\n    can_open = false;\n  }\n\n  return {\n    can_open: can_open,\n    can_close: can_close,\n  };\n}\n\nfunction math_inline(state, silent) {\n  let start, match, token, res, pos;\n\n  if (state.src[state.pos] !== \"$\") {\n    return false;\n  }\n\n  res = isValidDelim(state, state.pos);\n  if (!res.can_open) {\n    if (!silent) {\n      state.pending += \"$\";\n    }\n    state.pos += 1;\n    return true;\n  }\n\n  // First check for and bypass all properly escaped delimieters\n  // This loop will assume that the first leading backtick can not\n  // be the first character in state.src, which is known since\n  // we have found an opening delimieter already.\n  start = state.pos + 1;\n  match = start;\n  while ((match = state.src.indexOf(\"$\", match)) !== -1) {\n    // Found potential $, look for escapes, pos will point to\n    // first non escape when complete\n    pos = match - 1;\n    while (state.src[pos] === \"\\\\\") {\n      pos -= 1;\n    }\n\n    // Even number of escapes, potential closing delimiter found\n    if ((match - pos) % 2 == 1) {\n      break;\n    }\n    match += 1;\n  }\n\n  // No closing delimter found.  Consume $ and continue.\n  if (match === -1) {\n    if (!silent) {\n      state.pending += \"$\";\n    }\n    state.pos = start;\n    return true;\n  }\n\n  // Check if we have empty content, ie: $$.  Do not parse.\n  if (match - start === 0) {\n    if (!silent) {\n      state.pending += \"$$\";\n    }\n    state.pos = start + 1;\n    return true;\n  }\n\n  // Check for valid closing delimiter\n  res = isValidDelim(state, match);\n  if (!res.can_close) {\n    if (!silent) {\n      state.pending += \"$\";\n    }\n    state.pos = start;\n    return true;\n  }\n\n  if (!silent) {\n    token = state.push(\"math_inline\", \"math\", 0);\n    token.markup = \"$\";\n    token.content = state.src.slice(start, match);\n  }\n\n  state.pos = match + 1;\n  return true;\n}\n\nfunction math_block(state, start, end, silent) {\n  let firstLine,\n    lastLine,\n    next,\n    lastPos,\n    found = false,\n    token,\n    pos = state.bMarks[start] + state.tShift[start],\n    max = state.eMarks[start];\n\n  if (pos + 2 > max) {\n    return false;\n  }\n  if (state.src.slice(pos, pos + 2) !== \"$$\") {\n    return false;\n  }\n\n  pos += 2;\n  firstLine = state.src.slice(pos, max);\n\n  if (silent) {\n    return true;\n  }\n  if (firstLine.trim().slice(-2) === \"$$\") {\n    // Single line expression\n    firstLine = firstLine.trim().slice(0, -2);\n    found = true;\n  }\n\n  for (next = start; !found;) {\n    next++;\n\n    if (next >= end) {\n      break;\n    }\n\n    pos = state.bMarks[next] + state.tShift[next];\n    max = state.eMarks[next];\n\n    if (pos < max && state.tShift[next] < state.blkIndent) {\n      // non-empty line with negative indent should stop the list:\n      break;\n    }\n\n    if (state.src.slice(pos, max).trim().slice(-2) === \"$$\") {\n      lastPos = state.src.slice(0, max).lastIndexOf(\"$$\");\n      lastLine = state.src.slice(pos, lastPos);\n      found = true;\n    }\n  }\n\n  state.line = next + 1;\n\n  token = state.push(\"math_block\", \"math\", 0);\n  token.block = true;\n  token.content =\n    (firstLine && firstLine.trim() ? firstLine + \"\\n\" : \"\") +\n    state.getLines(start + 1, next, state.tShift[start], true) +\n    (lastLine && lastLine.trim() ? lastLine : \"\");\n  token.map = [start, state.line];\n  token.markup = \"$$\";\n  return true;\n}\n\nmodule.exports = (md, options) => {\n  options = options || {};\n  options.server = options.server || \"https://math.now.sh\";\n  options.style = options.style || \"\";\n  const purifiedURL = (latex) => {\n    return encodeURIComponent(latex).replace(\"(\", \"%28\").replace(\")\", \"%29\");\n  };\n\n  let Inline = (latex) => {\n    try {\n      return `<img src=\"${options.server}?inline=${purifiedURL(latex)}\" style=\"${options.style}display:inline-block;margin: 0;\"/>`;\n    } catch (error) {\n      console.error(error);\n      return latex;\n    }\n  };\n\n  let Block = (latex) => {\n    try {\n      return `<p style=\"${options.style}\"><img src=\"${options.server}?from=${purifiedURL(\n        latex\n      )}\" /></p>`;\n    } catch (error) {\n      console.error(error);\n      return latex;\n    }\n  };\n\n  md.inline.ruler.after(\"escape\", \"math_inline\", math_inline);\n  md.block.ruler.after(\"blockquote\", \"math_block\", math_block, {\n    alt: [\"paragraph\", \"reference\", \"blockquote\", \"list\"],\n  });\n  md.renderer.rules.math_inline = (tokens, idx) => {\n    return Inline(tokens[idx].content);\n  };\n  md.renderer.rules.math_block = (tokens, idx) => {\n    return Block(tokens[idx].content);\n  };\n};\n","module.exports = flarum.core.compat['common/components/Modal'];","// Main parser class\n\n'use strict';\n\n\nvar utils        = require('./common/utils');\nvar helpers      = require('./helpers');\nvar Renderer     = require('./renderer');\nvar ParserCore   = require('./parser_core');\nvar ParserBlock  = require('./parser_block');\nvar ParserInline = require('./parser_inline');\nvar LinkifyIt    = require('linkify-it');\nvar mdurl        = require('mdurl');\nvar punycode     = require('punycode');\n\n\nvar config = {\n  default: require('./presets/default'),\n  zero: require('./presets/zero'),\n  commonmark: require('./presets/commonmark')\n};\n\n////////////////////////////////////////////////////////////////////////////////\n//\n// This validator can prohibit more than really needed to prevent XSS. It's a\n// tradeoff to keep code simple and to be secure by default.\n//\n// If you need different setup - override validator method as you wish. Or\n// replace it with dummy function and use external sanitizer.\n//\n\nvar BAD_PROTO_RE = /^(vbscript|javascript|file|data):/;\nvar GOOD_DATA_RE = /^data:image\\/(gif|png|jpeg|webp);/;\n\nfunction validateLink(url) {\n  // url should be normalized at this point, and existing entities are decoded\n  var str = url.trim().toLowerCase();\n\n  return BAD_PROTO_RE.test(str) ? (GOOD_DATA_RE.test(str) ? true : false) : true;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar RECODE_HOSTNAME_FOR = [ 'http:', 'https:', 'mailto:' ];\n\nfunction normalizeLink(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toASCII(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  return mdurl.encode(mdurl.format(parsed));\n}\n\nfunction normalizeLinkText(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toUnicode(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  // add '%' to exclude list because of https://github.com/markdown-it/markdown-it/issues/720\n  return mdurl.decode(mdurl.format(parsed), mdurl.decode.defaultChars + '%');\n}\n\n\n/**\n * class MarkdownIt\n *\n * Main parser/renderer class.\n *\n * ##### Usage\n *\n * ```javascript\n * // node.js, \"classic\" way:\n * var MarkdownIt = require('markdown-it'),\n *     md = new MarkdownIt();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // node.js, the same, but with sugar:\n * var md = require('markdown-it')();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // browser without AMD, added to \"window\" on script load\n * // Note, there are no dash.\n * var md = window.markdownit();\n * var result = md.render('# markdown-it rulezz!');\n * ```\n *\n * Single line rendering, without paragraph wrap:\n *\n * ```javascript\n * var md = require('markdown-it')();\n * var result = md.renderInline('__markdown-it__ rulezz!');\n * ```\n **/\n\n/**\n * new MarkdownIt([presetName, options])\n * - presetName (String): optional, `commonmark` / `zero`\n * - options (Object)\n *\n * Creates parser instanse with given config. Can be called without `new`.\n *\n * ##### presetName\n *\n * MarkdownIt provides named presets as a convenience to quickly\n * enable/disable active syntax rules and options for common use cases.\n *\n * - [\"commonmark\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/commonmark.js) -\n *   configures parser to strict [CommonMark](http://commonmark.org/) mode.\n * - [default](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/default.js) -\n *   similar to GFM, used when no preset name given. Enables all available rules,\n *   but still without html, typographer & autolinker.\n * - [\"zero\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/zero.js) -\n *   all rules disabled. Useful to quickly setup your config via `.enable()`.\n *   For example, when you need only `bold` and `italic` markup and nothing else.\n *\n * ##### options:\n *\n * - __html__ - `false`. Set `true` to enable HTML tags in source. Be careful!\n *   That's not safe! You may need external sanitizer to protect output from XSS.\n *   It's better to extend features via plugins, instead of enabling HTML.\n * - __xhtmlOut__ - `false`. Set `true` to add '/' when closing single tags\n *   (`<br />`). This is needed only for full CommonMark compatibility. In real\n *   world you will need HTML output.\n * - __breaks__ - `false`. Set `true` to convert `\\n` in paragraphs into `<br>`.\n * - __langPrefix__ - `language-`. CSS language class prefix for fenced blocks.\n *   Can be useful for external highlighters.\n * - __linkify__ - `false`. Set `true` to autoconvert URL-like text to links.\n * - __typographer__  - `false`. Set `true` to enable [some language-neutral\n *   replacement](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/replacements.js) +\n *   quotes beautification (smartquotes).\n * - __quotes__ - `“”‘’`, String or Array. Double + single quotes replacement\n *   pairs, when typographer enabled and smartquotes on. For example, you can\n *   use `'«»„“'` for Russian, `'„“‚‘'` for German, and\n *   `['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›']` for French (including nbsp).\n * - __highlight__ - `null`. Highlighter function for fenced code blocks.\n *   Highlighter `function (str, lang)` should return escaped HTML. It can also\n *   return empty string if the source was not changed and should be escaped\n *   externaly. If result starts with <pre... internal wrapper is skipped.\n *\n * ##### Example\n *\n * ```javascript\n * // commonmark mode\n * var md = require('markdown-it')('commonmark');\n *\n * // default mode\n * var md = require('markdown-it')();\n *\n * // enable everything\n * var md = require('markdown-it')({\n *   html: true,\n *   linkify: true,\n *   typographer: true\n * });\n * ```\n *\n * ##### Syntax highlighting\n *\n * ```js\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return hljs.highlight(str, { language: lang, ignoreIllegals: true }).value;\n *       } catch (__) {}\n *     }\n *\n *     return ''; // use external default escaping\n *   }\n * });\n * ```\n *\n * Or with full wrapper override (if you need assign class to `<pre>`):\n *\n * ```javascript\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * // Actual default values\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return '<pre class=\"hljs\"><code>' +\n *                hljs.highlight(str, { language: lang, ignoreIllegals: true }).value +\n *                '</code></pre>';\n *       } catch (__) {}\n *     }\n *\n *     return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n *   }\n * });\n * ```\n *\n **/\nfunction MarkdownIt(presetName, options) {\n  if (!(this instanceof MarkdownIt)) {\n    return new MarkdownIt(presetName, options);\n  }\n\n  if (!options) {\n    if (!utils.isString(presetName)) {\n      options = presetName || {};\n      presetName = 'default';\n    }\n  }\n\n  /**\n   * MarkdownIt#inline -> ParserInline\n   *\n   * Instance of [[ParserInline]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.inline = new ParserInline();\n\n  /**\n   * MarkdownIt#block -> ParserBlock\n   *\n   * Instance of [[ParserBlock]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.block = new ParserBlock();\n\n  /**\n   * MarkdownIt#core -> Core\n   *\n   * Instance of [[Core]] chain executor. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.core = new ParserCore();\n\n  /**\n   * MarkdownIt#renderer -> Renderer\n   *\n   * Instance of [[Renderer]]. Use it to modify output look. Or to add rendering\n   * rules for new token types, generated by plugins.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * function myToken(tokens, idx, options, env, self) {\n   *   //...\n   *   return result;\n   * };\n   *\n   * md.renderer.rules['my_token'] = myToken\n   * ```\n   *\n   * See [[Renderer]] docs and [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js).\n   **/\n  this.renderer = new Renderer();\n\n  /**\n   * MarkdownIt#linkify -> LinkifyIt\n   *\n   * [linkify-it](https://github.com/markdown-it/linkify-it) instance.\n   * Used by [linkify](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/linkify.js)\n   * rule.\n   **/\n  this.linkify = new LinkifyIt();\n\n  /**\n   * MarkdownIt#validateLink(url) -> Boolean\n   *\n   * Link validation function. CommonMark allows too much in links. By default\n   * we disable `javascript:`, `vbscript:`, `file:` schemas, and almost all `data:...` schemas\n   * except some embedded image types.\n   *\n   * You can change this behaviour:\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   * // enable everything\n   * md.validateLink = function () { return true; }\n   * ```\n   **/\n  this.validateLink = validateLink;\n\n  /**\n   * MarkdownIt#normalizeLink(url) -> String\n   *\n   * Function used to encode link url to a machine-readable format,\n   * which includes url-encoding, punycode, etc.\n   **/\n  this.normalizeLink = normalizeLink;\n\n  /**\n   * MarkdownIt#normalizeLinkText(url) -> String\n   *\n   * Function used to decode link url to a human-readable format`\n   **/\n  this.normalizeLinkText = normalizeLinkText;\n\n\n  // Expose utils & helpers for easy acces from plugins\n\n  /**\n   * MarkdownIt#utils -> utils\n   *\n   * Assorted utility functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/common/utils.js).\n   **/\n  this.utils = utils;\n\n  /**\n   * MarkdownIt#helpers -> helpers\n   *\n   * Link components parser functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/helpers).\n   **/\n  this.helpers = utils.assign({}, helpers);\n\n\n  this.options = {};\n  this.configure(presetName);\n\n  if (options) { this.set(options); }\n}\n\n\n/** chainable\n * MarkdownIt.set(options)\n *\n * Set parser options (in the same format as in constructor). Probably, you\n * will never need it, but you can change options after constructor call.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .set({ html: true, breaks: true })\n *             .set({ typographer, true });\n * ```\n *\n * __Note:__ To achieve the best possible performance, don't modify a\n * `markdown-it` instance options on the fly. If you need multiple configurations\n * it's best to create multiple instances and initialize each with separate\n * config.\n **/\nMarkdownIt.prototype.set = function (options) {\n  utils.assign(this.options, options);\n  return this;\n};\n\n\n/** chainable, internal\n * MarkdownIt.configure(presets)\n *\n * Batch load of all options and compenent settings. This is internal method,\n * and you probably will not need it. But if you will - see available presets\n * and data structure [here](https://github.com/markdown-it/markdown-it/tree/master/lib/presets)\n *\n * We strongly recommend to use presets instead of direct config loads. That\n * will give better compatibility with next versions.\n **/\nMarkdownIt.prototype.configure = function (presets) {\n  var self = this, presetName;\n\n  if (utils.isString(presets)) {\n    presetName = presets;\n    presets = config[presetName];\n    if (!presets) { throw new Error('Wrong `markdown-it` preset \"' + presetName + '\", check name'); }\n  }\n\n  if (!presets) { throw new Error('Wrong `markdown-it` preset, can\\'t be empty'); }\n\n  if (presets.options) { self.set(presets.options); }\n\n  if (presets.components) {\n    Object.keys(presets.components).forEach(function (name) {\n      if (presets.components[name].rules) {\n        self[name].ruler.enableOnly(presets.components[name].rules);\n      }\n      if (presets.components[name].rules2) {\n        self[name].ruler2.enableOnly(presets.components[name].rules2);\n      }\n    });\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.enable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to enable\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable list or rules. It will automatically find appropriate components,\n * containing rules with given names. If rule not found, and `ignoreInvalid`\n * not set - throws exception.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .enable(['sub', 'sup'])\n *             .disable('smartquotes');\n * ```\n **/\nMarkdownIt.prototype.enable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.enable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.enable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to enable unknown rule(s): ' + missed);\n  }\n\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.disable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * The same as [[MarkdownIt.enable]], but turn specified rules off.\n **/\nMarkdownIt.prototype.disable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.disable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.disable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to disable unknown rule(s): ' + missed);\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.use(plugin, params)\n *\n * Load specified plugin with given params into current parser instance.\n * It's just a sugar to call `plugin(md, params)` with curring.\n *\n * ##### Example\n *\n * ```javascript\n * var iterator = require('markdown-it-for-inline');\n * var md = require('markdown-it')()\n *             .use(iterator, 'foo_replace', 'text', function (tokens, idx) {\n *               tokens[idx].content = tokens[idx].content.replace(/foo/g, 'bar');\n *             });\n * ```\n **/\nMarkdownIt.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\n/** internal\n * MarkdownIt.parse(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Parse input string and return list of block tokens (special token type\n * \"inline\" will contain list of inline tokens). You should not call this\n * method directly, until you write custom renderer (for example, to produce\n * AST).\n *\n * `env` is used to pass data between \"distributed\" rules and return additional\n * metadata like reference info, needed for the renderer. It also can be used to\n * inject data in specific cases. Usually, you will be ok to pass `{}`,\n * and then pass updated object to renderer.\n **/\nMarkdownIt.prototype.parse = function (src, env) {\n  if (typeof src !== 'string') {\n    throw new Error('Input data should be a String');\n  }\n\n  var state = new this.core.State(src, this, env);\n\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.render(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Render markdown string into html. It does all magic for you :).\n *\n * `env` can be used to inject additional metadata (`{}` by default).\n * But you will not need it with high probability. See also comment\n * in [[MarkdownIt.parse]].\n **/\nMarkdownIt.prototype.render = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parse(src, env), this.options, env);\n};\n\n\n/** internal\n * MarkdownIt.parseInline(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * The same as [[MarkdownIt.parse]] but skip all block rules. It returns the\n * block tokens list with the single `inline` element, containing parsed inline\n * tokens in `children` property. Also updates `env` object.\n **/\nMarkdownIt.prototype.parseInline = function (src, env) {\n  var state = new this.core.State(src, this, env);\n\n  state.inlineMode = true;\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.renderInline(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Similar to [[MarkdownIt.render]] but for single paragraph content. Result\n * will NOT be wrapped into `<p>` tags.\n **/\nMarkdownIt.prototype.renderInline = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parseInline(src, env), this.options, env);\n};\n\n\nmodule.exports = MarkdownIt;\n","\n'use strict';\n\n\nvar encodeCache = {};\n\n\n// Create a lookup array where anything but characters in `chars` string\n// and alphanumeric chars is percent-encoded.\n//\nfunction getEncodeCache(exclude) {\n  var i, ch, cache = encodeCache[exclude];\n  if (cache) { return cache; }\n\n  cache = encodeCache[exclude] = [];\n\n  for (i = 0; i < 128; i++) {\n    ch = String.fromCharCode(i);\n\n    if (/^[0-9a-z]$/i.test(ch)) {\n      // always allow unencoded alphanumeric characters\n      cache.push(ch);\n    } else {\n      cache.push('%' + ('0' + i.toString(16).toUpperCase()).slice(-2));\n    }\n  }\n\n  for (i = 0; i < exclude.length; i++) {\n    cache[exclude.charCodeAt(i)] = exclude[i];\n  }\n\n  return cache;\n}\n\n\n// Encode unsafe characters with percent-encoding, skipping already\n// encoded sequences.\n//\n//  - string       - string to encode\n//  - exclude      - list of characters to ignore (in addition to a-zA-Z0-9)\n//  - keepEscaped  - don't encode '%' in a correct escape sequence (default: true)\n//\nfunction encode(string, exclude, keepEscaped) {\n  var i, l, code, nextCode, cache,\n      result = '';\n\n  if (typeof exclude !== 'string') {\n    // encode(string, keepEscaped)\n    keepEscaped  = exclude;\n    exclude = encode.defaultChars;\n  }\n\n  if (typeof keepEscaped === 'undefined') {\n    keepEscaped = true;\n  }\n\n  cache = getEncodeCache(exclude);\n\n  for (i = 0, l = string.length; i < l; i++) {\n    code = string.charCodeAt(i);\n\n    if (keepEscaped && code === 0x25 /* % */ && i + 2 < l) {\n      if (/^[0-9a-f]{2}$/i.test(string.slice(i + 1, i + 3))) {\n        result += string.slice(i, i + 3);\n        i += 2;\n        continue;\n      }\n    }\n\n    if (code < 128) {\n      result += cache[code];\n      continue;\n    }\n\n    if (code >= 0xD800 && code <= 0xDFFF) {\n      if (code >= 0xD800 && code <= 0xDBFF && i + 1 < l) {\n        nextCode = string.charCodeAt(i + 1);\n        if (nextCode >= 0xDC00 && nextCode <= 0xDFFF) {\n          result += encodeURIComponent(string[i] + string[i + 1]);\n          i++;\n          continue;\n        }\n      }\n      result += '%EF%BF%BD';\n      continue;\n    }\n\n    result += encodeURIComponent(string[i]);\n  }\n\n  return result;\n}\n\nencode.defaultChars   = \";/?:@&=+$,-_.!~*'()#\";\nencode.componentChars = \"-_.!~*'()\";\n\n\nmodule.exports = encode;\n","\n'use strict';\n\n\n/* eslint-disable no-bitwise */\n\nvar decodeCache = {};\n\nfunction getDecodeCache(exclude) {\n  var i, ch, cache = decodeCache[exclude];\n  if (cache) { return cache; }\n\n  cache = decodeCache[exclude] = [];\n\n  for (i = 0; i < 128; i++) {\n    ch = String.fromCharCode(i);\n    cache.push(ch);\n  }\n\n  for (i = 0; i < exclude.length; i++) {\n    ch = exclude.charCodeAt(i);\n    cache[ch] = '%' + ('0' + ch.toString(16).toUpperCase()).slice(-2);\n  }\n\n  return cache;\n}\n\n\n// Decode percent-encoded string.\n//\nfunction decode(string, exclude) {\n  var cache;\n\n  if (typeof exclude !== 'string') {\n    exclude = decode.defaultChars;\n  }\n\n  cache = getDecodeCache(exclude);\n\n  return string.replace(/(%[a-f0-9]{2})+/gi, function(seq) {\n    var i, l, b1, b2, b3, b4, chr,\n        result = '';\n\n    for (i = 0, l = seq.length; i < l; i += 3) {\n      b1 = parseInt(seq.slice(i + 1, i + 3), 16);\n\n      if (b1 < 0x80) {\n        result += cache[b1];\n        continue;\n      }\n\n      if ((b1 & 0xE0) === 0xC0 && (i + 3 < l)) {\n        // 110xxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n\n        if ((b2 & 0xC0) === 0x80) {\n          chr = ((b1 << 6) & 0x7C0) | (b2 & 0x3F);\n\n          if (chr < 0x80) {\n            result += '\\ufffd\\ufffd';\n          } else {\n            result += String.fromCharCode(chr);\n          }\n\n          i += 3;\n          continue;\n        }\n      }\n\n      if ((b1 & 0xF0) === 0xE0 && (i + 6 < l)) {\n        // 1110xxxx 10xxxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n        b3 = parseInt(seq.slice(i + 7, i + 9), 16);\n\n        if ((b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n          chr = ((b1 << 12) & 0xF000) | ((b2 << 6) & 0xFC0) | (b3 & 0x3F);\n\n          if (chr < 0x800 || (chr >= 0xD800 && chr <= 0xDFFF)) {\n            result += '\\ufffd\\ufffd\\ufffd';\n          } else {\n            result += String.fromCharCode(chr);\n          }\n\n          i += 6;\n          continue;\n        }\n      }\n\n      if ((b1 & 0xF8) === 0xF0 && (i + 9 < l)) {\n        // 111110xx 10xxxxxx 10xxxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n        b3 = parseInt(seq.slice(i + 7, i + 9), 16);\n        b4 = parseInt(seq.slice(i + 10, i + 12), 16);\n\n        if ((b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80 && (b4 & 0xC0) === 0x80) {\n          chr = ((b1 << 18) & 0x1C0000) | ((b2 << 12) & 0x3F000) | ((b3 << 6) & 0xFC0) | (b4 & 0x3F);\n\n          if (chr < 0x10000 || chr > 0x10FFFF) {\n            result += '\\ufffd\\ufffd\\ufffd\\ufffd';\n          } else {\n            chr -= 0x10000;\n            result += String.fromCharCode(0xD800 + (chr >> 10), 0xDC00 + (chr & 0x3FF));\n          }\n\n          i += 9;\n          continue;\n        }\n      }\n\n      result += '\\ufffd';\n    }\n\n    return result;\n  });\n}\n\n\ndecode.defaultChars   = ';/?:@&=+$,#';\ndecode.componentChars = '';\n\n\nmodule.exports = decode;\n","\n'use strict';\n\n\nmodule.exports = function format(url) {\n  var result = '';\n\n  result += url.protocol || '';\n  result += url.slashes ? '//' : '';\n  result += url.auth ? url.auth + '@' : '';\n\n  if (url.hostname && url.hostname.indexOf(':') !== -1) {\n    // ipv6 address\n    result += '[' + url.hostname + ']';\n  } else {\n    result += url.hostname || '';\n  }\n\n  result += url.port ? ':' + url.port : '';\n  result += url.pathname || '';\n  result += url.search || '';\n  result += url.hash || '';\n\n  return result;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n//\n// Changes from joyent/node:\n//\n// 1. No leading slash in paths,\n//    e.g. in `url.parse('http://foo?bar')` pathname is ``, not `/`\n//\n// 2. Backslashes are not replaced with slashes,\n//    so `http:\\\\example.org\\` is treated like a relative path\n//\n// 3. Trailing colon is treated like a part of the path,\n//    i.e. in `http://example.org:foo` pathname is `:foo`\n//\n// 4. Nothing is URL-encoded in the resulting object,\n//    (in joyent/node some chars in auth and paths are encoded)\n//\n// 5. `url.parse()` does not have `parseQueryString` argument\n//\n// 6. Removed extraneous result properties: `host`, `path`, `query`, etc.,\n//    which can be constructed using other parts of the url.\n//\n\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.pathname = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = [ '<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t' ],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = [ '{', '}', '|', '\\\\', '^', '`' ].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = [ '\\'' ].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = [ '%', '/', '?', ';', '#' ].concat(autoEscape),\n    hostEndingChars = [ '/', '?', '#' ],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    /* eslint-disable no-script-url */\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    };\n    /* eslint-enable no-script-url */\n\nfunction urlParse(url, slashesDenoteHost) {\n  if (url && url instanceof Url) { return url; }\n\n  var u = new Url();\n  u.parse(url, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, slashesDenoteHost) {\n  var i, l, lowerProto, hec, slashes,\n      rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    lowerProto = proto.toLowerCase();\n    this.protocol = proto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (i = 0; i < hostEndingChars.length; i++) {\n      hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) {\n        hostEnd = hec;\n      }\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = auth;\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (i = 0; i < nonHostChars.length; i++) {\n      hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) {\n        hostEnd = hec;\n      }\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1) {\n      hostEnd = rest.length;\n    }\n\n    if (rest[hostEnd - 1] === ':') { hostEnd--; }\n    var host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost(host);\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) { continue; }\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    }\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n    }\n  }\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    rest = rest.slice(0, qm);\n  }\n  if (rest) { this.pathname = rest; }\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '';\n  }\n\n  return this;\n};\n\nUrl.prototype.parseHost = function(host) {\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) { this.hostname = host; }\n};\n\nmodule.exports = urlParse;\n","module.exports=/[\\xAD\\u0600-\\u0605\\u061C\\u06DD\\u070F\\u08E2\\u180E\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u2064\\u2066-\\u206F\\uFEFF\\uFFF9-\\uFFFB]|\\uD804[\\uDCBD\\uDCCD]|\\uD82F[\\uDCA0-\\uDCA3]|\\uD834[\\uDD73-\\uDD7A]|\\uDB40[\\uDC01\\uDC20-\\uDC7F]/","// Just a shortcut for bulk export\n'use strict';\n\n\nexports.parseLinkLabel       = require('./parse_link_label');\nexports.parseLinkDestination = require('./parse_link_destination');\nexports.parseLinkTitle       = require('./parse_link_title');\n","// Parse link label\n//\n// this function assumes that first character (\"[\") already matches;\n// returns the end of the label\n//\n'use strict';\n\nmodule.exports = function parseLinkLabel(state, start, disableNested) {\n  var level, found, marker, prevPos,\n      labelEnd = -1,\n      max = state.posMax,\n      oldPos = state.pos;\n\n  state.pos = start + 1;\n  level = 1;\n\n  while (state.pos < max) {\n    marker = state.src.charCodeAt(state.pos);\n    if (marker === 0x5D /* ] */) {\n      level--;\n      if (level === 0) {\n        found = true;\n        break;\n      }\n    }\n\n    prevPos = state.pos;\n    state.md.inline.skipToken(state);\n    if (marker === 0x5B /* [ */) {\n      if (prevPos === state.pos - 1) {\n        // increase level if we find text `[`, which is not a part of any token\n        level++;\n      } else if (disableNested) {\n        state.pos = oldPos;\n        return -1;\n      }\n    }\n  }\n\n  if (found) {\n    labelEnd = state.pos;\n  }\n\n  // restore old state\n  state.pos = oldPos;\n\n  return labelEnd;\n};\n","// Parse link destination\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkDestination(str, pos, max) {\n  var code, level,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (str.charCodeAt(pos) === 0x3C /* < */) {\n    pos++;\n    while (pos < max) {\n      code = str.charCodeAt(pos);\n      if (code === 0x0A /* \\n */) { return result; }\n      if (code === 0x3C /* < */) { return result; }\n      if (code === 0x3E /* > */) {\n        result.pos = pos + 1;\n        result.str = unescapeAll(str.slice(start + 1, pos));\n        result.ok = true;\n        return result;\n      }\n      if (code === 0x5C /* \\ */ && pos + 1 < max) {\n        pos += 2;\n        continue;\n      }\n\n      pos++;\n    }\n\n    // no closing '>'\n    return result;\n  }\n\n  // this should be ... } else { ... branch\n\n  level = 0;\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n\n    if (code === 0x20) { break; }\n\n    // ascii control characters\n    if (code < 0x20 || code === 0x7F) { break; }\n\n    if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      if (str.charCodeAt(pos + 1) === 0x20) { break; }\n      pos += 2;\n      continue;\n    }\n\n    if (code === 0x28 /* ( */) {\n      level++;\n      if (level > 32) { return result; }\n    }\n\n    if (code === 0x29 /* ) */) {\n      if (level === 0) { break; }\n      level--;\n    }\n\n    pos++;\n  }\n\n  if (start === pos) { return result; }\n  if (level !== 0) { return result; }\n\n  result.str = unescapeAll(str.slice(start, pos));\n  result.lines = lines;\n  result.pos = pos;\n  result.ok = true;\n  return result;\n};\n","// Parse link title\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkTitle(str, pos, max) {\n  var code,\n      marker,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (pos >= max) { return result; }\n\n  marker = str.charCodeAt(pos);\n\n  if (marker !== 0x22 /* \" */ && marker !== 0x27 /* ' */ && marker !== 0x28 /* ( */) { return result; }\n\n  pos++;\n\n  // if opening marker is \"(\", switch it to closing marker \")\"\n  if (marker === 0x28) { marker = 0x29; }\n\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n    if (code === marker) {\n      result.pos = pos + 1;\n      result.lines = lines;\n      result.str = unescapeAll(str.slice(start + 1, pos));\n      result.ok = true;\n      return result;\n    } else if (code === 0x28 /* ( */ && marker === 0x29 /* ) */) {\n      return result;\n    } else if (code === 0x0A) {\n      lines++;\n    } else if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      pos++;\n      if (str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n\n    pos++;\n  }\n\n  return result;\n};\n","/**\n * class Renderer\n *\n * Generates HTML from parsed token stream. Each instance has independent\n * copy of rules. Those can be rewritten with ease. Also, you can add new\n * rules if you create plugin and adds new token types.\n **/\n'use strict';\n\n\nvar assign          = require('./common/utils').assign;\nvar unescapeAll     = require('./common/utils').unescapeAll;\nvar escapeHtml      = require('./common/utils').escapeHtml;\n\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar default_rules = {};\n\n\ndefault_rules.code_inline = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<code' + slf.renderAttrs(token) + '>' +\n          escapeHtml(tokens[idx].content) +\n          '</code>';\n};\n\n\ndefault_rules.code_block = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<pre' + slf.renderAttrs(token) + '><code>' +\n          escapeHtml(tokens[idx].content) +\n          '</code></pre>\\n';\n};\n\n\ndefault_rules.fence = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx],\n      info = token.info ? unescapeAll(token.info).trim() : '',\n      langName = '',\n      langAttrs = '',\n      highlighted, i, arr, tmpAttrs, tmpToken;\n\n  if (info) {\n    arr = info.split(/(\\s+)/g);\n    langName = arr[0];\n    langAttrs = arr.slice(2).join('');\n  }\n\n  if (options.highlight) {\n    highlighted = options.highlight(token.content, langName, langAttrs) || escapeHtml(token.content);\n  } else {\n    highlighted = escapeHtml(token.content);\n  }\n\n  if (highlighted.indexOf('<pre') === 0) {\n    return highlighted + '\\n';\n  }\n\n  // If language exists, inject class gently, without modifying original token.\n  // May be, one day we will add .deepClone() for token and simplify this part, but\n  // now we prefer to keep things local.\n  if (info) {\n    i        = token.attrIndex('class');\n    tmpAttrs = token.attrs ? token.attrs.slice() : [];\n\n    if (i < 0) {\n      tmpAttrs.push([ 'class', options.langPrefix + langName ]);\n    } else {\n      tmpAttrs[i] = tmpAttrs[i].slice();\n      tmpAttrs[i][1] += ' ' + options.langPrefix + langName;\n    }\n\n    // Fake token just to render attributes\n    tmpToken = {\n      attrs: tmpAttrs\n    };\n\n    return  '<pre><code' + slf.renderAttrs(tmpToken) + '>'\n          + highlighted\n          + '</code></pre>\\n';\n  }\n\n\n  return  '<pre><code' + slf.renderAttrs(token) + '>'\n        + highlighted\n        + '</code></pre>\\n';\n};\n\n\ndefault_rules.image = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  // \"alt\" attr MUST be set, even if empty. Because it's mandatory and\n  // should be placed on proper position for tests.\n  //\n  // Replace content with actual value\n\n  token.attrs[token.attrIndex('alt')][1] =\n    slf.renderInlineAsText(token.children, options, env);\n\n  return slf.renderToken(tokens, idx, options);\n};\n\n\ndefault_rules.hardbreak = function (tokens, idx, options /*, env */) {\n  return options.xhtmlOut ? '<br />\\n' : '<br>\\n';\n};\ndefault_rules.softbreak = function (tokens, idx, options /*, env */) {\n  return options.breaks ? (options.xhtmlOut ? '<br />\\n' : '<br>\\n') : '\\n';\n};\n\n\ndefault_rules.text = function (tokens, idx /*, options, env */) {\n  return escapeHtml(tokens[idx].content);\n};\n\n\ndefault_rules.html_block = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\ndefault_rules.html_inline = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\n\n\n/**\n * new Renderer()\n *\n * Creates new [[Renderer]] instance and fill [[Renderer#rules]] with defaults.\n **/\nfunction Renderer() {\n\n  /**\n   * Renderer#rules -> Object\n   *\n   * Contains render rules for tokens. Can be updated and extended.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * md.renderer.rules.strong_open  = function () { return '<b>'; };\n   * md.renderer.rules.strong_close = function () { return '</b>'; };\n   *\n   * var result = md.renderInline(...);\n   * ```\n   *\n   * Each rule is called as independent static function with fixed signature:\n   *\n   * ```javascript\n   * function my_token_render(tokens, idx, options, env, renderer) {\n   *   // ...\n   *   return renderedHTML;\n   * }\n   * ```\n   *\n   * See [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js)\n   * for more details and examples.\n   **/\n  this.rules = assign({}, default_rules);\n}\n\n\n/**\n * Renderer.renderAttrs(token) -> String\n *\n * Render token attributes to string.\n **/\nRenderer.prototype.renderAttrs = function renderAttrs(token) {\n  var i, l, result;\n\n  if (!token.attrs) { return ''; }\n\n  result = '';\n\n  for (i = 0, l = token.attrs.length; i < l; i++) {\n    result += ' ' + escapeHtml(token.attrs[i][0]) + '=\"' + escapeHtml(token.attrs[i][1]) + '\"';\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.renderToken(tokens, idx, options) -> String\n * - tokens (Array): list of tokens\n * - idx (Numbed): token index to render\n * - options (Object): params of parser instance\n *\n * Default token renderer. Can be overriden by custom function\n * in [[Renderer#rules]].\n **/\nRenderer.prototype.renderToken = function renderToken(tokens, idx, options) {\n  var nextToken,\n      result = '',\n      needLf = false,\n      token = tokens[idx];\n\n  // Tight list paragraphs\n  if (token.hidden) {\n    return '';\n  }\n\n  // Insert a newline between hidden paragraph and subsequent opening\n  // block-level tag.\n  //\n  // For example, here we should insert a newline before blockquote:\n  //  - a\n  //    >\n  //\n  if (token.block && token.nesting !== -1 && idx && tokens[idx - 1].hidden) {\n    result += '\\n';\n  }\n\n  // Add token name, e.g. `<img`\n  result += (token.nesting === -1 ? '</' : '<') + token.tag;\n\n  // Encode attributes, e.g. `<img src=\"foo\"`\n  result += this.renderAttrs(token);\n\n  // Add a slash for self-closing tags, e.g. `<img src=\"foo\" /`\n  if (token.nesting === 0 && options.xhtmlOut) {\n    result += ' /';\n  }\n\n  // Check if we need to add a newline after this tag\n  if (token.block) {\n    needLf = true;\n\n    if (token.nesting === 1) {\n      if (idx + 1 < tokens.length) {\n        nextToken = tokens[idx + 1];\n\n        if (nextToken.type === 'inline' || nextToken.hidden) {\n          // Block-level tag containing an inline tag.\n          //\n          needLf = false;\n\n        } else if (nextToken.nesting === -1 && nextToken.tag === token.tag) {\n          // Opening tag + closing tag of the same type. E.g. `<li></li>`.\n          //\n          needLf = false;\n        }\n      }\n    }\n  }\n\n  result += needLf ? '>\\n' : '>';\n\n  return result;\n};\n\n\n/**\n * Renderer.renderInline(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * The same as [[Renderer.render]], but for single token of `inline` type.\n **/\nRenderer.prototype.renderInline = function (tokens, options, env) {\n  var type,\n      result = '',\n      rules = this.rules;\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (typeof rules[type] !== 'undefined') {\n      result += rules[type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options);\n    }\n  }\n\n  return result;\n};\n\n\n/** internal\n * Renderer.renderInlineAsText(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Special kludge for image `alt` attributes to conform CommonMark spec.\n * Don't try to use it! Spec requires to show `alt` content with stripped markup,\n * instead of simple escaping.\n **/\nRenderer.prototype.renderInlineAsText = function (tokens, options, env) {\n  var result = '';\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    if (tokens[i].type === 'text') {\n      result += tokens[i].content;\n    } else if (tokens[i].type === 'image') {\n      result += this.renderInlineAsText(tokens[i].children, options, env);\n    } else if (tokens[i].type === 'softbreak') {\n      result += '\\n';\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.render(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Takes token stream and generates HTML. Probably, you will never need to call\n * this method directly.\n **/\nRenderer.prototype.render = function (tokens, options, env) {\n  var i, len, type,\n      result = '',\n      rules = this.rules;\n\n  for (i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (type === 'inline') {\n      result += this.renderInline(tokens[i].children, options, env);\n    } else if (typeof rules[type] !== 'undefined') {\n      result += rules[tokens[i].type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options, env);\n    }\n  }\n\n  return result;\n};\n\nmodule.exports = Renderer;\n","/** internal\n * class Core\n *\n * Top-level rules executor. Glues block/inline parsers and does intermediate\n * transformations.\n **/\n'use strict';\n\n\nvar Ruler  = require('./ruler');\n\n\nvar _rules = [\n  [ 'normalize',      require('./rules_core/normalize')      ],\n  [ 'block',          require('./rules_core/block')          ],\n  [ 'inline',         require('./rules_core/inline')         ],\n  [ 'linkify',        require('./rules_core/linkify')        ],\n  [ 'replacements',   require('./rules_core/replacements')   ],\n  [ 'smartquotes',    require('./rules_core/smartquotes')    ]\n];\n\n\n/**\n * new Core()\n **/\nfunction Core() {\n  /**\n   * Core#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of core rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n}\n\n\n/**\n * Core.process(state)\n *\n * Executes core chain rules.\n **/\nCore.prototype.process = function (state) {\n  var i, l, rules;\n\n  rules = this.ruler.getRules('');\n\n  for (i = 0, l = rules.length; i < l; i++) {\n    rules[i](state);\n  }\n};\n\nCore.prototype.State = require('./rules_core/state_core');\n\n\nmodule.exports = Core;\n","// Normalize input string\n\n'use strict';\n\n\n// https://spec.commonmark.org/0.29/#line-ending\nvar NEWLINES_RE  = /\\r\\n?|\\n/g;\nvar NULL_RE      = /\\0/g;\n\n\nmodule.exports = function normalize(state) {\n  var str;\n\n  // Normalize newlines\n  str = state.src.replace(NEWLINES_RE, '\\n');\n\n  // Replace NULL characters\n  str = str.replace(NULL_RE, '\\uFFFD');\n\n  state.src = str;\n};\n","'use strict';\n\n\nmodule.exports = function block(state) {\n  var token;\n\n  if (state.inlineMode) {\n    token          = new state.Token('inline', '', 0);\n    token.content  = state.src;\n    token.map      = [ 0, 1 ];\n    token.children = [];\n    state.tokens.push(token);\n  } else {\n    state.md.block.parse(state.src, state.md, state.env, state.tokens);\n  }\n};\n","'use strict';\n\nmodule.exports = function inline(state) {\n  var tokens = state.tokens, tok, i, l;\n\n  // Parse inlines\n  for (i = 0, l = tokens.length; i < l; i++) {\n    tok = tokens[i];\n    if (tok.type === 'inline') {\n      state.md.inline.parse(tok.content, state.md, state.env, tok.children);\n    }\n  }\n};\n","// Replace link-like texts with link nodes.\n//\n// Currently restricted by `md.validateLink()` to http/https/ftp\n//\n'use strict';\n\n\nvar arrayReplaceAt = require('../common/utils').arrayReplaceAt;\n\n\nfunction isLinkOpen(str) {\n  return /^<a[>\\s]/i.test(str);\n}\nfunction isLinkClose(str) {\n  return /^<\\/a\\s*>/i.test(str);\n}\n\n\nmodule.exports = function linkify(state) {\n  var i, j, l, tokens, token, currentToken, nodes, ln, text, pos, lastPos,\n      level, htmlLinkLevel, url, fullUrl, urlText,\n      blockTokens = state.tokens,\n      links;\n\n  if (!state.md.options.linkify) { return; }\n\n  for (j = 0, l = blockTokens.length; j < l; j++) {\n    if (blockTokens[j].type !== 'inline' ||\n        !state.md.linkify.pretest(blockTokens[j].content)) {\n      continue;\n    }\n\n    tokens = blockTokens[j].children;\n\n    htmlLinkLevel = 0;\n\n    // We scan from the end, to keep position when new tags added.\n    // Use reversed logic in links start/end match\n    for (i = tokens.length - 1; i >= 0; i--) {\n      currentToken = tokens[i];\n\n      // Skip content of markdown links\n      if (currentToken.type === 'link_close') {\n        i--;\n        while (tokens[i].level !== currentToken.level && tokens[i].type !== 'link_open') {\n          i--;\n        }\n        continue;\n      }\n\n      // Skip content of html tag links\n      if (currentToken.type === 'html_inline') {\n        if (isLinkOpen(currentToken.content) && htmlLinkLevel > 0) {\n          htmlLinkLevel--;\n        }\n        if (isLinkClose(currentToken.content)) {\n          htmlLinkLevel++;\n        }\n      }\n      if (htmlLinkLevel > 0) { continue; }\n\n      if (currentToken.type === 'text' && state.md.linkify.test(currentToken.content)) {\n\n        text = currentToken.content;\n        links = state.md.linkify.match(text);\n\n        // Now split string to nodes\n        nodes = [];\n        level = currentToken.level;\n        lastPos = 0;\n\n        for (ln = 0; ln < links.length; ln++) {\n\n          url = links[ln].url;\n          fullUrl = state.md.normalizeLink(url);\n          if (!state.md.validateLink(fullUrl)) { continue; }\n\n          urlText = links[ln].text;\n\n          // Linkifier might send raw hostnames like \"example.com\", where url\n          // starts with domain name. So we prepend http:// in those cases,\n          // and remove it afterwards.\n          //\n          if (!links[ln].schema) {\n            urlText = state.md.normalizeLinkText('http://' + urlText).replace(/^http:\\/\\//, '');\n          } else if (links[ln].schema === 'mailto:' && !/^mailto:/i.test(urlText)) {\n            urlText = state.md.normalizeLinkText('mailto:' + urlText).replace(/^mailto:/, '');\n          } else {\n            urlText = state.md.normalizeLinkText(urlText);\n          }\n\n          pos = links[ln].index;\n\n          if (pos > lastPos) {\n            token         = new state.Token('text', '', 0);\n            token.content = text.slice(lastPos, pos);\n            token.level   = level;\n            nodes.push(token);\n          }\n\n          token         = new state.Token('link_open', 'a', 1);\n          token.attrs   = [ [ 'href', fullUrl ] ];\n          token.level   = level++;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          token         = new state.Token('text', '', 0);\n          token.content = urlText;\n          token.level   = level;\n          nodes.push(token);\n\n          token         = new state.Token('link_close', 'a', -1);\n          token.level   = --level;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          lastPos = links[ln].lastIndex;\n        }\n        if (lastPos < text.length) {\n          token         = new state.Token('text', '', 0);\n          token.content = text.slice(lastPos);\n          token.level   = level;\n          nodes.push(token);\n        }\n\n        // replace current node\n        blockTokens[j].children = tokens = arrayReplaceAt(tokens, i, nodes);\n      }\n    }\n  }\n};\n","// Simple typographic replacements\n//\n// (c) (C) → ©\n// (tm) (TM) → ™\n// (r) (R) → ®\n// +- → ±\n// (p) (P) -> §\n// ... → … (also ?.... → ?.., !.... → !..)\n// ???????? → ???, !!!!! → !!!, `,,` → `,`\n// -- → &ndash;, --- → &mdash;\n//\n'use strict';\n\n// TODO:\n// - fractionals 1/2, 1/4, 3/4 -> ½, ¼, ¾\n// - miltiplication 2 x 4 -> 2 × 4\n\nvar RARE_RE = /\\+-|\\.\\.|\\?\\?\\?\\?|!!!!|,,|--/;\n\n// Workaround for phantomjs - need regex without /g flag,\n// or root check will fail every second time\nvar SCOPED_ABBR_TEST_RE = /\\((c|tm|r|p)\\)/i;\n\nvar SCOPED_ABBR_RE = /\\((c|tm|r|p)\\)/ig;\nvar SCOPED_ABBR = {\n  c: '©',\n  r: '®',\n  p: '§',\n  tm: '™'\n};\n\nfunction replaceFn(match, name) {\n  return SCOPED_ABBR[name.toLowerCase()];\n}\n\nfunction replace_scoped(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      token.content = token.content.replace(SCOPED_ABBR_RE, replaceFn);\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\nfunction replace_rare(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      if (RARE_RE.test(token.content)) {\n        token.content = token.content\n          .replace(/\\+-/g, '±')\n          // .., ..., ....... -> …\n          // but ?..... & !..... -> ?.. & !..\n          .replace(/\\.{2,}/g, '…').replace(/([?!])…/g, '$1..')\n          .replace(/([?!]){4,}/g, '$1$1$1').replace(/,{2,}/g, ',')\n          // em-dash\n          .replace(/(^|[^-])---(?=[^-]|$)/mg, '$1\\u2014')\n          // en-dash\n          .replace(/(^|\\s)--(?=\\s|$)/mg, '$1\\u2013')\n          .replace(/(^|[^-\\s])--(?=[^-\\s]|$)/mg, '$1\\u2013');\n      }\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\n\nmodule.exports = function replace(state) {\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline') { continue; }\n\n    if (SCOPED_ABBR_TEST_RE.test(state.tokens[blkIdx].content)) {\n      replace_scoped(state.tokens[blkIdx].children);\n    }\n\n    if (RARE_RE.test(state.tokens[blkIdx].content)) {\n      replace_rare(state.tokens[blkIdx].children);\n    }\n\n  }\n};\n","// Convert straight quotation marks to typographic ones\n//\n'use strict';\n\n\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\nvar QUOTE_TEST_RE = /['\"]/;\nvar QUOTE_RE = /['\"]/g;\nvar APOSTROPHE = '\\u2019'; /* ’ */\n\n\nfunction replaceAt(str, index, ch) {\n  return str.substr(0, index) + ch + str.substr(index + 1);\n}\n\nfunction process_inlines(tokens, state) {\n  var i, token, text, t, pos, max, thisLevel, item, lastChar, nextChar,\n      isLastPunctChar, isNextPunctChar, isLastWhiteSpace, isNextWhiteSpace,\n      canOpen, canClose, j, isSingle, stack, openQuote, closeQuote;\n\n  stack = [];\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    thisLevel = tokens[i].level;\n\n    for (j = stack.length - 1; j >= 0; j--) {\n      if (stack[j].level <= thisLevel) { break; }\n    }\n    stack.length = j + 1;\n\n    if (token.type !== 'text') { continue; }\n\n    text = token.content;\n    pos = 0;\n    max = text.length;\n\n    /*eslint no-labels:0,block-scoped-var:0*/\n    OUTER:\n    while (pos < max) {\n      QUOTE_RE.lastIndex = pos;\n      t = QUOTE_RE.exec(text);\n      if (!t) { break; }\n\n      canOpen = canClose = true;\n      pos = t.index + 1;\n      isSingle = (t[0] === \"'\");\n\n      // Find previous character,\n      // default to space if it's the beginning of the line\n      //\n      lastChar = 0x20;\n\n      if (t.index - 1 >= 0) {\n        lastChar = text.charCodeAt(t.index - 1);\n      } else {\n        for (j = i - 1; j >= 0; j--) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // lastChar defaults to 0x20\n          if (!tokens[j].content) continue; // should skip all tokens except 'text', 'html_inline' or 'code_inline'\n\n          lastChar = tokens[j].content.charCodeAt(tokens[j].content.length - 1);\n          break;\n        }\n      }\n\n      // Find next character,\n      // default to space if it's the end of the line\n      //\n      nextChar = 0x20;\n\n      if (pos < max) {\n        nextChar = text.charCodeAt(pos);\n      } else {\n        for (j = i + 1; j < tokens.length; j++) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // nextChar defaults to 0x20\n          if (!tokens[j].content) continue; // should skip all tokens except 'text', 'html_inline' or 'code_inline'\n\n          nextChar = tokens[j].content.charCodeAt(0);\n          break;\n        }\n      }\n\n      isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n      isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n      isLastWhiteSpace = isWhiteSpace(lastChar);\n      isNextWhiteSpace = isWhiteSpace(nextChar);\n\n      if (isNextWhiteSpace) {\n        canOpen = false;\n      } else if (isNextPunctChar) {\n        if (!(isLastWhiteSpace || isLastPunctChar)) {\n          canOpen = false;\n        }\n      }\n\n      if (isLastWhiteSpace) {\n        canClose = false;\n      } else if (isLastPunctChar) {\n        if (!(isNextWhiteSpace || isNextPunctChar)) {\n          canClose = false;\n        }\n      }\n\n      if (nextChar === 0x22 /* \" */ && t[0] === '\"') {\n        if (lastChar >= 0x30 /* 0 */ && lastChar <= 0x39 /* 9 */) {\n          // special case: 1\"\" - count first quote as an inch\n          canClose = canOpen = false;\n        }\n      }\n\n      if (canOpen && canClose) {\n        // Replace quotes in the middle of punctuation sequence, but not\n        // in the middle of the words, i.e.:\n        //\n        // 1. foo \" bar \" baz - not replaced\n        // 2. foo-\"-bar-\"-baz - replaced\n        // 3. foo\"bar\"baz     - not replaced\n        //\n        canOpen = isLastPunctChar;\n        canClose = isNextPunctChar;\n      }\n\n      if (!canOpen && !canClose) {\n        // middle of word\n        if (isSingle) {\n          token.content = replaceAt(token.content, t.index, APOSTROPHE);\n        }\n        continue;\n      }\n\n      if (canClose) {\n        // this could be a closing quote, rewind the stack to get a match\n        for (j = stack.length - 1; j >= 0; j--) {\n          item = stack[j];\n          if (stack[j].level < thisLevel) { break; }\n          if (item.single === isSingle && stack[j].level === thisLevel) {\n            item = stack[j];\n\n            if (isSingle) {\n              openQuote = state.md.options.quotes[2];\n              closeQuote = state.md.options.quotes[3];\n            } else {\n              openQuote = state.md.options.quotes[0];\n              closeQuote = state.md.options.quotes[1];\n            }\n\n            // replace token.content *before* tokens[item.token].content,\n            // because, if they are pointing at the same token, replaceAt\n            // could mess up indices when quote length != 1\n            token.content = replaceAt(token.content, t.index, closeQuote);\n            tokens[item.token].content = replaceAt(\n              tokens[item.token].content, item.pos, openQuote);\n\n            pos += closeQuote.length - 1;\n            if (item.token === i) { pos += openQuote.length - 1; }\n\n            text = token.content;\n            max = text.length;\n\n            stack.length = j;\n            continue OUTER;\n          }\n        }\n      }\n\n      if (canOpen) {\n        stack.push({\n          token: i,\n          pos: t.index,\n          single: isSingle,\n          level: thisLevel\n        });\n      } else if (canClose && isSingle) {\n        token.content = replaceAt(token.content, t.index, APOSTROPHE);\n      }\n    }\n  }\n}\n\n\nmodule.exports = function smartquotes(state) {\n  /*eslint max-depth:0*/\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline' ||\n        !QUOTE_TEST_RE.test(state.tokens[blkIdx].content)) {\n      continue;\n    }\n\n    process_inlines(state.tokens[blkIdx].children, state);\n  }\n};\n","// Core state object\n//\n'use strict';\n\nvar Token = require('../token');\n\n\nfunction StateCore(src, md, env) {\n  this.src = src;\n  this.env = env;\n  this.tokens = [];\n  this.inlineMode = false;\n  this.md = md; // link to parser instance\n}\n\n// re-export Token class to use in core rules\nStateCore.prototype.Token = Token;\n\n\nmodule.exports = StateCore;\n","/** internal\n * class ParserBlock\n *\n * Block-level tokenizer.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\nvar _rules = [\n  // First 2 params - rule name & source. Secondary array - list of rules,\n  // which can be terminated by this one.\n  [ 'table',      require('./rules_block/table'),      [ 'paragraph', 'reference' ] ],\n  [ 'code',       require('./rules_block/code') ],\n  [ 'fence',      require('./rules_block/fence'),      [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'blockquote', require('./rules_block/blockquote'), [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'hr',         require('./rules_block/hr'),         [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'list',       require('./rules_block/list'),       [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'reference',  require('./rules_block/reference') ],\n  [ 'html_block', require('./rules_block/html_block'), [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'heading',    require('./rules_block/heading'),    [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'lheading',   require('./rules_block/lheading') ],\n  [ 'paragraph',  require('./rules_block/paragraph') ]\n];\n\n\n/**\n * new ParserBlock()\n **/\nfunction ParserBlock() {\n  /**\n   * ParserBlock#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of block rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1], { alt: (_rules[i][2] || []).slice() });\n  }\n}\n\n\n// Generate tokens for input range\n//\nParserBlock.prototype.tokenize = function (state, startLine, endLine) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      line = startLine,\n      hasEmptyLines = false,\n      maxNesting = state.md.options.maxNesting;\n\n  while (line < endLine) {\n    state.line = line = state.skipEmptyLines(line);\n    if (line >= endLine) { break; }\n\n    // Termination condition for nested calls.\n    // Nested calls currently used for blockquotes & lists\n    if (state.sCount[line] < state.blkIndent) { break; }\n\n    // If nesting level exceeded - skip tail to the end. That's not ordinary\n    // situation and we should not care about content.\n    if (state.level >= maxNesting) {\n      state.line = endLine;\n      break;\n    }\n\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.line`\n    // - update `state.tokens`\n    // - return true\n\n    for (i = 0; i < len; i++) {\n      ok = rules[i](state, line, endLine, false);\n      if (ok) { break; }\n    }\n\n    // set state.tight if we had an empty line before current tag\n    // i.e. latest empty line should not count\n    state.tight = !hasEmptyLines;\n\n    // paragraph might \"eat\" one newline after it in nested lists\n    if (state.isEmpty(state.line - 1)) {\n      hasEmptyLines = true;\n    }\n\n    line = state.line;\n\n    if (line < endLine && state.isEmpty(line)) {\n      hasEmptyLines = true;\n      line++;\n      state.line = line;\n    }\n  }\n};\n\n\n/**\n * ParserBlock.parse(str, md, env, outTokens)\n *\n * Process input string and push block tokens into `outTokens`\n **/\nParserBlock.prototype.parse = function (src, md, env, outTokens) {\n  var state;\n\n  if (!src) { return; }\n\n  state = new this.State(src, md, env, outTokens);\n\n  this.tokenize(state, state.line, state.lineMax);\n};\n\n\nParserBlock.prototype.State = require('./rules_block/state_block');\n\n\nmodule.exports = ParserBlock;\n","// GFM table, https://github.github.com/gfm/#tables-extension-\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction getLine(state, line) {\n  var pos = state.bMarks[line] + state.tShift[line],\n      max = state.eMarks[line];\n\n  return state.src.substr(pos, max - pos);\n}\n\nfunction escapedSplit(str) {\n  var result = [],\n      pos = 0,\n      max = str.length,\n      ch,\n      isEscaped = false,\n      lastPos = 0,\n      current = '';\n\n  ch  = str.charCodeAt(pos);\n\n  while (pos < max) {\n    if (ch === 0x7c/* | */) {\n      if (!isEscaped) {\n        // pipe separating cells, '|'\n        result.push(current + str.substring(lastPos, pos));\n        current = '';\n        lastPos = pos + 1;\n      } else {\n        // escaped pipe, '\\|'\n        current += str.substring(lastPos, pos - 1);\n        lastPos = pos;\n      }\n    }\n\n    isEscaped = (ch === 0x5c/* \\ */);\n    pos++;\n\n    ch = str.charCodeAt(pos);\n  }\n\n  result.push(current + str.substring(lastPos));\n\n  return result;\n}\n\n\nmodule.exports = function table(state, startLine, endLine, silent) {\n  var ch, lineText, pos, i, l, nextLine, columns, columnCount, token,\n      aligns, t, tableLines, tbodyLines, oldParentType, terminate,\n      terminatorRules, firstCh, secondCh;\n\n  // should have at least two lines\n  if (startLine + 2 > endLine) { return false; }\n\n  nextLine = startLine + 1;\n\n  if (state.sCount[nextLine] < state.blkIndent) { return false; }\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[nextLine] - state.blkIndent >= 4) { return false; }\n\n  // first character of the second line should be '|', '-', ':',\n  // and no other characters are allowed but spaces;\n  // basically, this is the equivalent of /^[-:|][-:|\\s]*$/ regexp\n\n  pos = state.bMarks[nextLine] + state.tShift[nextLine];\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  firstCh = state.src.charCodeAt(pos++);\n  if (firstCh !== 0x7C/* | */ && firstCh !== 0x2D/* - */ && firstCh !== 0x3A/* : */) { return false; }\n\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  secondCh = state.src.charCodeAt(pos++);\n  if (secondCh !== 0x7C/* | */ && secondCh !== 0x2D/* - */ && secondCh !== 0x3A/* : */ && !isSpace(secondCh)) {\n    return false;\n  }\n\n  // if first character is '-', then second character must not be a space\n  // (due to parsing ambiguity with list)\n  if (firstCh === 0x2D/* - */ && isSpace(secondCh)) { return false; }\n\n  while (pos < state.eMarks[nextLine]) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch !== 0x7C/* | */ && ch !== 0x2D/* - */ && ch !== 0x3A/* : */ && !isSpace(ch)) { return false; }\n\n    pos++;\n  }\n\n  lineText = getLine(state, startLine + 1);\n\n  columns = lineText.split('|');\n  aligns = [];\n  for (i = 0; i < columns.length; i++) {\n    t = columns[i].trim();\n    if (!t) {\n      // allow empty columns before and after table, but not in between columns;\n      // e.g. allow ` |---| `, disallow ` ---||--- `\n      if (i === 0 || i === columns.length - 1) {\n        continue;\n      } else {\n        return false;\n      }\n    }\n\n    if (!/^:?-+:?$/.test(t)) { return false; }\n    if (t.charCodeAt(t.length - 1) === 0x3A/* : */) {\n      aligns.push(t.charCodeAt(0) === 0x3A/* : */ ? 'center' : 'right');\n    } else if (t.charCodeAt(0) === 0x3A/* : */) {\n      aligns.push('left');\n    } else {\n      aligns.push('');\n    }\n  }\n\n  lineText = getLine(state, startLine).trim();\n  if (lineText.indexOf('|') === -1) { return false; }\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n  columns = escapedSplit(lineText);\n  if (columns.length && columns[0] === '') columns.shift();\n  if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n  // header row will define an amount of columns in the entire table,\n  // and align row should be exactly the same (the rest of the rows can differ)\n  columnCount = columns.length;\n  if (columnCount === 0 || columnCount !== aligns.length) { return false; }\n\n  if (silent) { return true; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'table';\n\n  // use 'blockquote' lists for termination because it's\n  // the most similar to tables\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  token     = state.push('table_open', 'table', 1);\n  token.map = tableLines = [ startLine, 0 ];\n\n  token     = state.push('thead_open', 'thead', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  token     = state.push('tr_open', 'tr', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  for (i = 0; i < columns.length; i++) {\n    token          = state.push('th_open', 'th', 1);\n    if (aligns[i]) {\n      token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n    }\n\n    token          = state.push('inline', '', 0);\n    token.content  = columns[i].trim();\n    token.children = [];\n\n    token          = state.push('th_close', 'th', -1);\n  }\n\n  token     = state.push('tr_close', 'tr', -1);\n  token     = state.push('thead_close', 'thead', -1);\n\n  for (nextLine = startLine + 2; nextLine < endLine; nextLine++) {\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) { break; }\n    lineText = getLine(state, nextLine).trim();\n    if (!lineText) { break; }\n    if (state.sCount[nextLine] - state.blkIndent >= 4) { break; }\n    columns = escapedSplit(lineText);\n    if (columns.length && columns[0] === '') columns.shift();\n    if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n    if (nextLine === startLine + 2) {\n      token     = state.push('tbody_open', 'tbody', 1);\n      token.map = tbodyLines = [ startLine + 2, 0 ];\n    }\n\n    token     = state.push('tr_open', 'tr', 1);\n    token.map = [ nextLine, nextLine + 1 ];\n\n    for (i = 0; i < columnCount; i++) {\n      token          = state.push('td_open', 'td', 1);\n      if (aligns[i]) {\n        token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n      }\n\n      token          = state.push('inline', '', 0);\n      token.content  = columns[i] ? columns[i].trim() : '';\n      token.children = [];\n\n      token          = state.push('td_close', 'td', -1);\n    }\n    token = state.push('tr_close', 'tr', -1);\n  }\n\n  if (tbodyLines) {\n    token = state.push('tbody_close', 'tbody', -1);\n    tbodyLines[1] = nextLine;\n  }\n\n  token = state.push('table_close', 'table', -1);\n  tableLines[1] = nextLine;\n\n  state.parentType = oldParentType;\n  state.line = nextLine;\n  return true;\n};\n","// Code block (4 spaces padded)\n\n'use strict';\n\n\nmodule.exports = function code(state, startLine, endLine/*, silent*/) {\n  var nextLine, last, token;\n\n  if (state.sCount[startLine] - state.blkIndent < 4) { return false; }\n\n  last = nextLine = startLine + 1;\n\n  while (nextLine < endLine) {\n    if (state.isEmpty(nextLine)) {\n      nextLine++;\n      continue;\n    }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      nextLine++;\n      last = nextLine;\n      continue;\n    }\n    break;\n  }\n\n  state.line = last;\n\n  token         = state.push('code_block', 'code', 0);\n  token.content = state.getLines(startLine, last, 4 + state.blkIndent, false) + '\\n';\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// fences (``` lang, ~~~ lang)\n\n'use strict';\n\n\nmodule.exports = function fence(state, startLine, endLine, silent) {\n  var marker, len, params, nextLine, mem, token, markup,\n      haveEndMarker = false,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (pos + 3 > max) { return false; }\n\n  marker = state.src.charCodeAt(pos);\n\n  if (marker !== 0x7E/* ~ */ && marker !== 0x60 /* ` */) {\n    return false;\n  }\n\n  // scan marker length\n  mem = pos;\n  pos = state.skipChars(pos, marker);\n\n  len = pos - mem;\n\n  if (len < 3) { return false; }\n\n  markup = state.src.slice(mem, pos);\n  params = state.src.slice(pos, max);\n\n  if (marker === 0x60 /* ` */) {\n    if (params.indexOf(String.fromCharCode(marker)) >= 0) {\n      return false;\n    }\n  }\n\n  // Since start is found, we can report success here in validation mode\n  if (silent) { return true; }\n\n  // search end of block\n  nextLine = startLine;\n\n  for (;;) {\n    nextLine++;\n    if (nextLine >= endLine) {\n      // unclosed block should be autoclosed by end of document.\n      // also block seems to be autoclosed by end of parent\n      break;\n    }\n\n    pos = mem = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos < max && state.sCount[nextLine] < state.blkIndent) {\n      // non-empty line with negative indent should stop the list:\n      // - ```\n      //  test\n      break;\n    }\n\n    if (state.src.charCodeAt(pos) !== marker) { continue; }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      // closing fence should be indented less than 4 spaces\n      continue;\n    }\n\n    pos = state.skipChars(pos, marker);\n\n    // closing code fence must be at least as long as the opening one\n    if (pos - mem < len) { continue; }\n\n    // make sure tail has spaces only\n    pos = state.skipSpaces(pos);\n\n    if (pos < max) { continue; }\n\n    haveEndMarker = true;\n    // found!\n    break;\n  }\n\n  // If a fence has heading spaces, they should be removed from its inner block\n  len = state.sCount[startLine];\n\n  state.line = nextLine + (haveEndMarker ? 1 : 0);\n\n  token         = state.push('fence', 'code', 0);\n  token.info    = params;\n  token.content = state.getLines(startLine + 1, nextLine, len, true);\n  token.markup  = markup;\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// Block quotes\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function blockquote(state, startLine, endLine, silent) {\n  var adjustTab,\n      ch,\n      i,\n      initial,\n      l,\n      lastLineEmpty,\n      lines,\n      nextLine,\n      offset,\n      oldBMarks,\n      oldBSCount,\n      oldIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      spaceAfterMarker,\n      terminate,\n      terminatorRules,\n      token,\n      isOutdented,\n      oldLineMax = state.lineMax,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // check the block quote marker\n  if (state.src.charCodeAt(pos++) !== 0x3E/* > */) { return false; }\n\n  // we know that it's going to be a valid blockquote,\n  // so no point trying to find the end of it in silent mode\n  if (silent) { return true; }\n\n  // set offset past spaces and \">\"\n  initial = offset = state.sCount[startLine] + 1;\n\n  // skip one optional space after '>'\n  if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n    // ' >   test '\n    //     ^ -- position start of line here:\n    pos++;\n    initial++;\n    offset++;\n    adjustTab = false;\n    spaceAfterMarker = true;\n  } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n    spaceAfterMarker = true;\n\n    if ((state.bsCount[startLine] + offset) % 4 === 3) {\n      // '  >\\t  test '\n      //       ^ -- position start of line here (tab has width===1)\n      pos++;\n      initial++;\n      offset++;\n      adjustTab = false;\n    } else {\n      // ' >\\t  test '\n      //    ^ -- position start of line here + shift bsCount slightly\n      //         to make extra space appear\n      adjustTab = true;\n    }\n  } else {\n    spaceAfterMarker = false;\n  }\n\n  oldBMarks = [ state.bMarks[startLine] ];\n  state.bMarks[startLine] = pos;\n\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (isSpace(ch)) {\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[startLine] + (adjustTab ? 1 : 0)) % 4;\n      } else {\n        offset++;\n      }\n    } else {\n      break;\n    }\n\n    pos++;\n  }\n\n  oldBSCount = [ state.bsCount[startLine] ];\n  state.bsCount[startLine] = state.sCount[startLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n  lastLineEmpty = pos >= max;\n\n  oldSCount = [ state.sCount[startLine] ];\n  state.sCount[startLine] = offset - initial;\n\n  oldTShift = [ state.tShift[startLine] ];\n  state.tShift[startLine] = pos - state.bMarks[startLine];\n\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  oldParentType = state.parentType;\n  state.parentType = 'blockquote';\n\n  // Search the end of the block\n  //\n  // Block ends with either:\n  //  1. an empty line outside:\n  //     ```\n  //     > test\n  //\n  //     ```\n  //  2. an empty line inside:\n  //     ```\n  //     >\n  //     test\n  //     ```\n  //  3. another tag:\n  //     ```\n  //     > test\n  //      - - -\n  //     ```\n  for (nextLine = startLine + 1; nextLine < endLine; nextLine++) {\n    // check if it's outdented, i.e. it's inside list item and indented\n    // less than said list item:\n    //\n    // ```\n    // 1. anything\n    //    > current blockquote\n    // 2. checking this line\n    // ```\n    isOutdented = state.sCount[nextLine] < state.blkIndent;\n\n    pos = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos >= max) {\n      // Case 1: line is not inside the blockquote, and this line is empty.\n      break;\n    }\n\n    if (state.src.charCodeAt(pos++) === 0x3E/* > */ && !isOutdented) {\n      // This line is inside the blockquote.\n\n      // set offset past spaces and \">\"\n      initial = offset = state.sCount[nextLine] + 1;\n\n      // skip one optional space after '>'\n      if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n        // ' >   test '\n        //     ^ -- position start of line here:\n        pos++;\n        initial++;\n        offset++;\n        adjustTab = false;\n        spaceAfterMarker = true;\n      } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n        spaceAfterMarker = true;\n\n        if ((state.bsCount[nextLine] + offset) % 4 === 3) {\n          // '  >\\t  test '\n          //       ^ -- position start of line here (tab has width===1)\n          pos++;\n          initial++;\n          offset++;\n          adjustTab = false;\n        } else {\n          // ' >\\t  test '\n          //    ^ -- position start of line here + shift bsCount slightly\n          //         to make extra space appear\n          adjustTab = true;\n        }\n      } else {\n        spaceAfterMarker = false;\n      }\n\n      oldBMarks.push(state.bMarks[nextLine]);\n      state.bMarks[nextLine] = pos;\n\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n\n        if (isSpace(ch)) {\n          if (ch === 0x09) {\n            offset += 4 - (offset + state.bsCount[nextLine] + (adjustTab ? 1 : 0)) % 4;\n          } else {\n            offset++;\n          }\n        } else {\n          break;\n        }\n\n        pos++;\n      }\n\n      lastLineEmpty = pos >= max;\n\n      oldBSCount.push(state.bsCount[nextLine]);\n      state.bsCount[nextLine] = state.sCount[nextLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n      oldSCount.push(state.sCount[nextLine]);\n      state.sCount[nextLine] = offset - initial;\n\n      oldTShift.push(state.tShift[nextLine]);\n      state.tShift[nextLine] = pos - state.bMarks[nextLine];\n      continue;\n    }\n\n    // Case 2: line is not inside the blockquote, and the last line was empty.\n    if (lastLineEmpty) { break; }\n\n    // Case 3: another tag found.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) {\n      // Quirk to enforce \"hard termination mode\" for paragraphs;\n      // normally if you call `tokenize(state, startLine, nextLine)`,\n      // paragraphs will look below nextLine for paragraph continuation,\n      // but if blockquote is terminated by another tag, they shouldn't\n      state.lineMax = nextLine;\n\n      if (state.blkIndent !== 0) {\n        // state.blkIndent was non-zero, we now set it to zero,\n        // so we need to re-calculate all offsets to appear as\n        // if indent wasn't changed\n        oldBMarks.push(state.bMarks[nextLine]);\n        oldBSCount.push(state.bsCount[nextLine]);\n        oldTShift.push(state.tShift[nextLine]);\n        oldSCount.push(state.sCount[nextLine]);\n        state.sCount[nextLine] -= state.blkIndent;\n      }\n\n      break;\n    }\n\n    oldBMarks.push(state.bMarks[nextLine]);\n    oldBSCount.push(state.bsCount[nextLine]);\n    oldTShift.push(state.tShift[nextLine]);\n    oldSCount.push(state.sCount[nextLine]);\n\n    // A negative indentation means that this is a paragraph continuation\n    //\n    state.sCount[nextLine] = -1;\n  }\n\n  oldIndent = state.blkIndent;\n  state.blkIndent = 0;\n\n  token        = state.push('blockquote_open', 'blockquote', 1);\n  token.markup = '>';\n  token.map    = lines = [ startLine, 0 ];\n\n  state.md.block.tokenize(state, startLine, nextLine);\n\n  token        = state.push('blockquote_close', 'blockquote', -1);\n  token.markup = '>';\n\n  state.lineMax = oldLineMax;\n  state.parentType = oldParentType;\n  lines[1] = state.line;\n\n  // Restore original tShift; this might not be necessary since the parser\n  // has already been here, but just to make sure we can do that.\n  for (i = 0; i < oldTShift.length; i++) {\n    state.bMarks[i + startLine] = oldBMarks[i];\n    state.tShift[i + startLine] = oldTShift[i];\n    state.sCount[i + startLine] = oldSCount[i];\n    state.bsCount[i + startLine] = oldBSCount[i];\n  }\n  state.blkIndent = oldIndent;\n\n  return true;\n};\n","// Horizontal rule\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function hr(state, startLine, endLine, silent) {\n  var marker, cnt, ch, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  marker = state.src.charCodeAt(pos++);\n\n  // Check hr marker\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x5F/* _ */) {\n    return false;\n  }\n\n  // markers can be mixed with spaces, but there should be at least 3 of them\n\n  cnt = 1;\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos++);\n    if (ch !== marker && !isSpace(ch)) { return false; }\n    if (ch === marker) { cnt++; }\n  }\n\n  if (cnt < 3) { return false; }\n\n  if (silent) { return true; }\n\n  state.line = startLine + 1;\n\n  token        = state.push('hr', 'hr', 0);\n  token.map    = [ startLine, state.line ];\n  token.markup = Array(cnt + 1).join(String.fromCharCode(marker));\n\n  return true;\n};\n","// Lists\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\n// Search `[-+*][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipBulletListMarker(state, startLine) {\n  var marker, pos, max, ch;\n\n  pos = state.bMarks[startLine] + state.tShift[startLine];\n  max = state.eMarks[startLine];\n\n  marker = state.src.charCodeAt(pos++);\n  // Check bullet\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x2B/* + */) {\n    return -1;\n  }\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" -test \" - is not a list item\n      return -1;\n    }\n  }\n\n  return pos;\n}\n\n// Search `\\d+[.)][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipOrderedListMarker(state, startLine) {\n  var ch,\n      start = state.bMarks[startLine] + state.tShift[startLine],\n      pos = start,\n      max = state.eMarks[startLine];\n\n  // List marker should have at least 2 chars (digit + dot)\n  if (pos + 1 >= max) { return -1; }\n\n  ch = state.src.charCodeAt(pos++);\n\n  if (ch < 0x30/* 0 */ || ch > 0x39/* 9 */) { return -1; }\n\n  for (;;) {\n    // EOL -> fail\n    if (pos >= max) { return -1; }\n\n    ch = state.src.charCodeAt(pos++);\n\n    if (ch >= 0x30/* 0 */ && ch <= 0x39/* 9 */) {\n\n      // List marker should have no more than 9 digits\n      // (prevents integer overflow in browsers)\n      if (pos - start >= 10) { return -1; }\n\n      continue;\n    }\n\n    // found valid marker\n    if (ch === 0x29/* ) */ || ch === 0x2e/* . */) {\n      break;\n    }\n\n    return -1;\n  }\n\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" 1.test \" - is not a list item\n      return -1;\n    }\n  }\n  return pos;\n}\n\nfunction markTightParagraphs(state, idx) {\n  var i, l,\n      level = state.level + 2;\n\n  for (i = idx + 2, l = state.tokens.length - 2; i < l; i++) {\n    if (state.tokens[i].level === level && state.tokens[i].type === 'paragraph_open') {\n      state.tokens[i + 2].hidden = true;\n      state.tokens[i].hidden = true;\n      i += 2;\n    }\n  }\n}\n\n\nmodule.exports = function list(state, startLine, endLine, silent) {\n  var ch,\n      contentStart,\n      i,\n      indent,\n      indentAfterMarker,\n      initial,\n      isOrdered,\n      itemLines,\n      l,\n      listLines,\n      listTokIdx,\n      markerCharCode,\n      markerValue,\n      max,\n      nextLine,\n      offset,\n      oldListIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      oldTight,\n      pos,\n      posAfterMarker,\n      prevEmptyEnd,\n      start,\n      terminate,\n      terminatorRules,\n      token,\n      isTerminatingParagraph = false,\n      tight = true;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // Special case:\n  //  - item 1\n  //   - item 2\n  //    - item 3\n  //     - item 4\n  //      - this one is a paragraph continuation\n  if (state.listIndent >= 0 &&\n      state.sCount[startLine] - state.listIndent >= 4 &&\n      state.sCount[startLine] < state.blkIndent) {\n    return false;\n  }\n\n  // limit conditions when list can interrupt\n  // a paragraph (validation mode only)\n  if (silent && state.parentType === 'paragraph') {\n    // Next list item should still terminate previous list item;\n    //\n    // This code can fail if plugins use blkIndent as well as lists,\n    // but I hope the spec gets fixed long before that happens.\n    //\n    if (state.sCount[startLine] >= state.blkIndent) {\n      isTerminatingParagraph = true;\n    }\n  }\n\n  // Detect list type and position after marker\n  if ((posAfterMarker = skipOrderedListMarker(state, startLine)) >= 0) {\n    isOrdered = true;\n    start = state.bMarks[startLine] + state.tShift[startLine];\n    markerValue = Number(state.src.slice(start, posAfterMarker - 1));\n\n    // If we're starting a new ordered list right after\n    // a paragraph, it should start with 1.\n    if (isTerminatingParagraph && markerValue !== 1) return false;\n\n  } else if ((posAfterMarker = skipBulletListMarker(state, startLine)) >= 0) {\n    isOrdered = false;\n\n  } else {\n    return false;\n  }\n\n  // If we're starting a new unordered list right after\n  // a paragraph, first line should not be empty.\n  if (isTerminatingParagraph) {\n    if (state.skipSpaces(posAfterMarker) >= state.eMarks[startLine]) return false;\n  }\n\n  // We should terminate list on style change. Remember first one to compare.\n  markerCharCode = state.src.charCodeAt(posAfterMarker - 1);\n\n  // For validation mode we can terminate immediately\n  if (silent) { return true; }\n\n  // Start list\n  listTokIdx = state.tokens.length;\n\n  if (isOrdered) {\n    token       = state.push('ordered_list_open', 'ol', 1);\n    if (markerValue !== 1) {\n      token.attrs = [ [ 'start', markerValue ] ];\n    }\n\n  } else {\n    token       = state.push('bullet_list_open', 'ul', 1);\n  }\n\n  token.map    = listLines = [ startLine, 0 ];\n  token.markup = String.fromCharCode(markerCharCode);\n\n  //\n  // Iterate list items\n  //\n\n  nextLine = startLine;\n  prevEmptyEnd = false;\n  terminatorRules = state.md.block.ruler.getRules('list');\n\n  oldParentType = state.parentType;\n  state.parentType = 'list';\n\n  while (nextLine < endLine) {\n    pos = posAfterMarker;\n    max = state.eMarks[nextLine];\n\n    initial = offset = state.sCount[nextLine] + posAfterMarker - (state.bMarks[startLine] + state.tShift[startLine]);\n\n    while (pos < max) {\n      ch = state.src.charCodeAt(pos);\n\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[nextLine]) % 4;\n      } else if (ch === 0x20) {\n        offset++;\n      } else {\n        break;\n      }\n\n      pos++;\n    }\n\n    contentStart = pos;\n\n    if (contentStart >= max) {\n      // trimming space in \"-    \\n  3\" case, indent is 1 here\n      indentAfterMarker = 1;\n    } else {\n      indentAfterMarker = offset - initial;\n    }\n\n    // If we have more than 4 spaces, the indent is 1\n    // (the rest is just indented code block)\n    if (indentAfterMarker > 4) { indentAfterMarker = 1; }\n\n    // \"  -  test\"\n    //  ^^^^^ - calculating total length of this thing\n    indent = initial + indentAfterMarker;\n\n    // Run subparser & write tokens\n    token        = state.push('list_item_open', 'li', 1);\n    token.markup = String.fromCharCode(markerCharCode);\n    token.map    = itemLines = [ startLine, 0 ];\n    if (isOrdered) {\n      token.info = state.src.slice(start, posAfterMarker - 1);\n    }\n\n    // change current state, then restore it after parser subcall\n    oldTight = state.tight;\n    oldTShift = state.tShift[startLine];\n    oldSCount = state.sCount[startLine];\n\n    //  - example list\n    // ^ listIndent position will be here\n    //   ^ blkIndent position will be here\n    //\n    oldListIndent = state.listIndent;\n    state.listIndent = state.blkIndent;\n    state.blkIndent = indent;\n\n    state.tight = true;\n    state.tShift[startLine] = contentStart - state.bMarks[startLine];\n    state.sCount[startLine] = offset;\n\n    if (contentStart >= max && state.isEmpty(startLine + 1)) {\n      // workaround for this case\n      // (list item is empty, list terminates before \"foo\"):\n      // ~~~~~~~~\n      //   -\n      //\n      //     foo\n      // ~~~~~~~~\n      state.line = Math.min(state.line + 2, endLine);\n    } else {\n      state.md.block.tokenize(state, startLine, endLine, true);\n    }\n\n    // If any of list item is tight, mark list as tight\n    if (!state.tight || prevEmptyEnd) {\n      tight = false;\n    }\n    // Item become loose if finish with empty line,\n    // but we should filter last element, because it means list finish\n    prevEmptyEnd = (state.line - startLine) > 1 && state.isEmpty(state.line - 1);\n\n    state.blkIndent = state.listIndent;\n    state.listIndent = oldListIndent;\n    state.tShift[startLine] = oldTShift;\n    state.sCount[startLine] = oldSCount;\n    state.tight = oldTight;\n\n    token        = state.push('list_item_close', 'li', -1);\n    token.markup = String.fromCharCode(markerCharCode);\n\n    nextLine = startLine = state.line;\n    itemLines[1] = nextLine;\n    contentStart = state.bMarks[startLine];\n\n    if (nextLine >= endLine) { break; }\n\n    //\n    // Try to check if list is terminated or continued.\n    //\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    // if it's indented more than 3 spaces, it should be a code block\n    if (state.sCount[startLine] - state.blkIndent >= 4) { break; }\n\n    // fail if terminating block found\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n\n    // fail if list has another type\n    if (isOrdered) {\n      posAfterMarker = skipOrderedListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n      start = state.bMarks[nextLine] + state.tShift[nextLine];\n    } else {\n      posAfterMarker = skipBulletListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n    }\n\n    if (markerCharCode !== state.src.charCodeAt(posAfterMarker - 1)) { break; }\n  }\n\n  // Finalize list\n  if (isOrdered) {\n    token = state.push('ordered_list_close', 'ol', -1);\n  } else {\n    token = state.push('bullet_list_close', 'ul', -1);\n  }\n  token.markup = String.fromCharCode(markerCharCode);\n\n  listLines[1] = nextLine;\n  state.line = nextLine;\n\n  state.parentType = oldParentType;\n\n  // mark paragraphs tight if needed\n  if (tight) {\n    markTightParagraphs(state, listTokIdx);\n  }\n\n  return true;\n};\n","'use strict';\n\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function reference(state, startLine, _endLine, silent) {\n  var ch,\n      destEndPos,\n      destEndLineNo,\n      endLine,\n      href,\n      i,\n      l,\n      label,\n      labelEnd,\n      oldParentType,\n      res,\n      start,\n      str,\n      terminate,\n      terminatorRules,\n      title,\n      lines = 0,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine],\n      nextLine = startLine + 1;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x5B/* [ */) { return false; }\n\n  // Simple check to quickly interrupt scan on [link](url) at the start of line.\n  // Can be useful on practice: https://github.com/markdown-it/markdown-it/issues/54\n  while (++pos < max) {\n    if (state.src.charCodeAt(pos) === 0x5D /* ] */ &&\n        state.src.charCodeAt(pos - 1) !== 0x5C/* \\ */) {\n      if (pos + 1 === max) { return false; }\n      if (state.src.charCodeAt(pos + 1) !== 0x3A/* : */) { return false; }\n      break;\n    }\n  }\n\n  endLine = state.lineMax;\n\n  // jump line-by-line until empty one or EOF\n  terminatorRules = state.md.block.ruler.getRules('reference');\n\n  oldParentType = state.parentType;\n  state.parentType = 'reference';\n\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  str = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n  max = str.length;\n\n  for (pos = 1; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x5B /* [ */) {\n      return false;\n    } else if (ch === 0x5D /* ] */) {\n      labelEnd = pos;\n      break;\n    } else if (ch === 0x0A /* \\n */) {\n      lines++;\n    } else if (ch === 0x5C /* \\ */) {\n      pos++;\n      if (pos < max && str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n  }\n\n  if (labelEnd < 0 || str.charCodeAt(labelEnd + 1) !== 0x3A/* : */) { return false; }\n\n  // [label]:   destination   'title'\n  //         ^^^ skip optional whitespace here\n  for (pos = labelEnd + 2; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //            ^^^^^^^^^^^ parse this\n  res = state.md.helpers.parseLinkDestination(str, pos, max);\n  if (!res.ok) { return false; }\n\n  href = state.md.normalizeLink(res.str);\n  if (!state.md.validateLink(href)) { return false; }\n\n  pos = res.pos;\n  lines += res.lines;\n\n  // save cursor state, we could require to rollback later\n  destEndPos = pos;\n  destEndLineNo = lines;\n\n  // [label]:   destination   'title'\n  //                       ^^^ skipping those spaces\n  start = pos;\n  for (; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //                          ^^^^^^^ parse this\n  res = state.md.helpers.parseLinkTitle(str, pos, max);\n  if (pos < max && start !== pos && res.ok) {\n    title = res.str;\n    pos = res.pos;\n    lines += res.lines;\n  } else {\n    title = '';\n    pos = destEndPos;\n    lines = destEndLineNo;\n  }\n\n  // skip trailing spaces until the rest of the line\n  while (pos < max) {\n    ch = str.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n    pos++;\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    if (title) {\n      // garbage at the end of the line after title,\n      // but it could still be a valid reference if we roll back\n      title = '';\n      pos = destEndPos;\n      lines = destEndLineNo;\n      while (pos < max) {\n        ch = str.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n    }\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    // garbage at the end of the line\n    return false;\n  }\n\n  label = normalizeReference(str.slice(1, labelEnd));\n  if (!label) {\n    // CommonMark 0.20 disallows empty labels\n    return false;\n  }\n\n  // Reference can not terminate anything. This check is for safety only.\n  /*istanbul ignore if*/\n  if (silent) { return true; }\n\n  if (typeof state.env.references === 'undefined') {\n    state.env.references = {};\n  }\n  if (typeof state.env.references[label] === 'undefined') {\n    state.env.references[label] = { title: title, href: href };\n  }\n\n  state.parentType = oldParentType;\n\n  state.line = startLine + lines + 1;\n  return true;\n};\n","// HTML block\n\n'use strict';\n\n\nvar block_names = require('../common/html_blocks');\nvar HTML_OPEN_CLOSE_TAG_RE = require('../common/html_re').HTML_OPEN_CLOSE_TAG_RE;\n\n// An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\nvar HTML_SEQUENCES = [\n  [ /^<(script|pre|style|textarea)(?=(\\s|>|$))/i, /<\\/(script|pre|style|textarea)>/i, true ],\n  [ /^<!--/,        /-->/,   true ],\n  [ /^<\\?/,         /\\?>/,   true ],\n  [ /^<![A-Z]/,     />/,     true ],\n  [ /^<!\\[CDATA\\[/, /\\]\\]>/, true ],\n  [ new RegExp('^</?(' + block_names.join('|') + ')(?=(\\\\s|/?>|$))', 'i'), /^$/, true ],\n  [ new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + '\\\\s*$'),  /^$/, false ]\n];\n\n\nmodule.exports = function html_block(state, startLine, endLine, silent) {\n  var i, nextLine, token, lineText,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (!state.md.options.html) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  lineText = state.src.slice(pos, max);\n\n  for (i = 0; i < HTML_SEQUENCES.length; i++) {\n    if (HTML_SEQUENCES[i][0].test(lineText)) { break; }\n  }\n\n  if (i === HTML_SEQUENCES.length) { return false; }\n\n  if (silent) {\n    // true if this sequence can be a terminator, false otherwise\n    return HTML_SEQUENCES[i][2];\n  }\n\n  nextLine = startLine + 1;\n\n  // If we are here - we detected HTML block.\n  // Let's roll down till block end.\n  if (!HTML_SEQUENCES[i][1].test(lineText)) {\n    for (; nextLine < endLine; nextLine++) {\n      if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n      lineText = state.src.slice(pos, max);\n\n      if (HTML_SEQUENCES[i][1].test(lineText)) {\n        if (lineText.length !== 0) { nextLine++; }\n        break;\n      }\n    }\n  }\n\n  state.line = nextLine;\n\n  token         = state.push('html_block', '', 0);\n  token.map     = [ startLine, nextLine ];\n  token.content = state.getLines(startLine, nextLine, state.blkIndent, true);\n\n  return true;\n};\n","// List of valid html blocks names, accorting to commonmark spec\n// http://jgm.github.io/CommonMark/spec.html#html-blocks\n\n'use strict';\n\n\nmodule.exports = [\n  'address',\n  'article',\n  'aside',\n  'base',\n  'basefont',\n  'blockquote',\n  'body',\n  'caption',\n  'center',\n  'col',\n  'colgroup',\n  'dd',\n  'details',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'footer',\n  'form',\n  'frame',\n  'frameset',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hr',\n  'html',\n  'iframe',\n  'legend',\n  'li',\n  'link',\n  'main',\n  'menu',\n  'menuitem',\n  'nav',\n  'noframes',\n  'ol',\n  'optgroup',\n  'option',\n  'p',\n  'param',\n  'section',\n  'source',\n  'summary',\n  'table',\n  'tbody',\n  'td',\n  'tfoot',\n  'th',\n  'thead',\n  'title',\n  'tr',\n  'track',\n  'ul'\n];\n","// heading (#, ##, ...)\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function heading(state, startLine, endLine, silent) {\n  var ch, level, tmp, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  ch  = state.src.charCodeAt(pos);\n\n  if (ch !== 0x23/* # */ || pos >= max) { return false; }\n\n  // count heading level\n  level = 1;\n  ch = state.src.charCodeAt(++pos);\n  while (ch === 0x23/* # */ && pos < max && level <= 6) {\n    level++;\n    ch = state.src.charCodeAt(++pos);\n  }\n\n  if (level > 6 || (pos < max && !isSpace(ch))) { return false; }\n\n  if (silent) { return true; }\n\n  // Let's cut tails like '    ###  ' from the end of string\n\n  max = state.skipSpacesBack(max, pos);\n  tmp = state.skipCharsBack(max, 0x23, pos); // #\n  if (tmp > pos && isSpace(state.src.charCodeAt(tmp - 1))) {\n    max = tmp;\n  }\n\n  state.line = startLine + 1;\n\n  token        = state.push('heading_open', 'h' + String(level), 1);\n  token.markup = '########'.slice(0, level);\n  token.map    = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = state.src.slice(pos, max).trim();\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token        = state.push('heading_close', 'h' + String(level), -1);\n  token.markup = '########'.slice(0, level);\n\n  return true;\n};\n","// lheading (---, ===)\n\n'use strict';\n\n\nmodule.exports = function lheading(state, startLine, endLine/*, silent*/) {\n  var content, terminate, i, l, token, pos, max, level, marker,\n      nextLine = startLine + 1, oldParentType,\n      terminatorRules = state.md.block.ruler.getRules('paragraph');\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph'; // use paragraph to match terminatorRules\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    //\n    // Check for underline in setext header\n    //\n    if (state.sCount[nextLine] >= state.blkIndent) {\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n\n      if (pos < max) {\n        marker = state.src.charCodeAt(pos);\n\n        if (marker === 0x2D/* - */ || marker === 0x3D/* = */) {\n          pos = state.skipChars(pos, marker);\n          pos = state.skipSpaces(pos);\n\n          if (pos >= max) {\n            level = (marker === 0x3D/* = */ ? 1 : 2);\n            break;\n          }\n        }\n      }\n    }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  if (!level) {\n    // Didn't find valid underline\n    return false;\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine + 1;\n\n  token          = state.push('heading_open', 'h' + String(level), 1);\n  token.markup   = String.fromCharCode(marker);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line - 1 ];\n  token.children = [];\n\n  token          = state.push('heading_close', 'h' + String(level), -1);\n  token.markup   = String.fromCharCode(marker);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// Paragraph\n\n'use strict';\n\n\nmodule.exports = function paragraph(state, startLine/*, endLine*/) {\n  var content, terminate, i, l, token, oldParentType,\n      nextLine = startLine + 1,\n      terminatorRules = state.md.block.ruler.getRules('paragraph'),\n      endLine = state.lineMax;\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph';\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine;\n\n  token          = state.push('paragraph_open', 'p', 1);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token          = state.push('paragraph_close', 'p', -1);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// Parser state class\n\n'use strict';\n\nvar Token = require('../token');\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction StateBlock(src, md, env, tokens) {\n  var ch, s, start, pos, len, indent, offset, indent_found;\n\n  this.src = src;\n\n  // link to parser instance\n  this.md     = md;\n\n  this.env = env;\n\n  //\n  // Internal state vartiables\n  //\n\n  this.tokens = tokens;\n\n  this.bMarks = [];  // line begin offsets for fast jumps\n  this.eMarks = [];  // line end offsets for fast jumps\n  this.tShift = [];  // offsets of the first non-space characters (tabs not expanded)\n  this.sCount = [];  // indents for each line (tabs expanded)\n\n  // An amount of virtual spaces (tabs expanded) between beginning\n  // of each line (bMarks) and real beginning of that line.\n  //\n  // It exists only as a hack because blockquotes override bMarks\n  // losing information in the process.\n  //\n  // It's used only when expanding tabs, you can think about it as\n  // an initial tab length, e.g. bsCount=21 applied to string `\\t123`\n  // means first tab should be expanded to 4-21%4 === 3 spaces.\n  //\n  this.bsCount = [];\n\n  // block parser variables\n  this.blkIndent  = 0; // required block content indent (for example, if we are\n                       // inside a list, it would be positioned after list marker)\n  this.line       = 0; // line index in src\n  this.lineMax    = 0; // lines count\n  this.tight      = false;  // loose/tight mode for lists\n  this.ddIndent   = -1; // indent of the current dd block (-1 if there isn't any)\n  this.listIndent = -1; // indent of the current list block (-1 if there isn't any)\n\n  // can be 'blockquote', 'list', 'root', 'paragraph' or 'reference'\n  // used in lists to determine if they interrupt a paragraph\n  this.parentType = 'root';\n\n  this.level = 0;\n\n  // renderer\n  this.result = '';\n\n  // Create caches\n  // Generate markers.\n  s = this.src;\n  indent_found = false;\n\n  for (start = pos = indent = offset = 0, len = s.length; pos < len; pos++) {\n    ch = s.charCodeAt(pos);\n\n    if (!indent_found) {\n      if (isSpace(ch)) {\n        indent++;\n\n        if (ch === 0x09) {\n          offset += 4 - offset % 4;\n        } else {\n          offset++;\n        }\n        continue;\n      } else {\n        indent_found = true;\n      }\n    }\n\n    if (ch === 0x0A || pos === len - 1) {\n      if (ch !== 0x0A) { pos++; }\n      this.bMarks.push(start);\n      this.eMarks.push(pos);\n      this.tShift.push(indent);\n      this.sCount.push(offset);\n      this.bsCount.push(0);\n\n      indent_found = false;\n      indent = 0;\n      offset = 0;\n      start = pos + 1;\n    }\n  }\n\n  // Push fake entry to simplify cache bounds checks\n  this.bMarks.push(s.length);\n  this.eMarks.push(s.length);\n  this.tShift.push(0);\n  this.sCount.push(0);\n  this.bsCount.push(0);\n\n  this.lineMax = this.bMarks.length - 1; // don't count last fake line\n}\n\n// Push new token to \"stream\".\n//\nStateBlock.prototype.push = function (type, tag, nesting) {\n  var token = new Token(type, tag, nesting);\n  token.block = true;\n\n  if (nesting < 0) this.level--; // closing tag\n  token.level = this.level;\n  if (nesting > 0) this.level++; // opening tag\n\n  this.tokens.push(token);\n  return token;\n};\n\nStateBlock.prototype.isEmpty = function isEmpty(line) {\n  return this.bMarks[line] + this.tShift[line] >= this.eMarks[line];\n};\n\nStateBlock.prototype.skipEmptyLines = function skipEmptyLines(from) {\n  for (var max = this.lineMax; from < max; from++) {\n    if (this.bMarks[from] + this.tShift[from] < this.eMarks[from]) {\n      break;\n    }\n  }\n  return from;\n};\n\n// Skip spaces from given position.\nStateBlock.prototype.skipSpaces = function skipSpaces(pos) {\n  var ch;\n\n  for (var max = this.src.length; pos < max; pos++) {\n    ch = this.src.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n  }\n  return pos;\n};\n\n// Skip spaces from given position in reverse.\nStateBlock.prototype.skipSpacesBack = function skipSpacesBack(pos, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (!isSpace(this.src.charCodeAt(--pos))) { return pos + 1; }\n  }\n  return pos;\n};\n\n// Skip char codes from given position\nStateBlock.prototype.skipChars = function skipChars(pos, code) {\n  for (var max = this.src.length; pos < max; pos++) {\n    if (this.src.charCodeAt(pos) !== code) { break; }\n  }\n  return pos;\n};\n\n// Skip char codes reverse from given position - 1\nStateBlock.prototype.skipCharsBack = function skipCharsBack(pos, code, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (code !== this.src.charCodeAt(--pos)) { return pos + 1; }\n  }\n  return pos;\n};\n\n// cut lines range from source.\nStateBlock.prototype.getLines = function getLines(begin, end, indent, keepLastLF) {\n  var i, lineIndent, ch, first, last, queue, lineStart,\n      line = begin;\n\n  if (begin >= end) {\n    return '';\n  }\n\n  queue = new Array(end - begin);\n\n  for (i = 0; line < end; line++, i++) {\n    lineIndent = 0;\n    lineStart = first = this.bMarks[line];\n\n    if (line + 1 < end || keepLastLF) {\n      // No need for bounds check because we have fake entry on tail.\n      last = this.eMarks[line] + 1;\n    } else {\n      last = this.eMarks[line];\n    }\n\n    while (first < last && lineIndent < indent) {\n      ch = this.src.charCodeAt(first);\n\n      if (isSpace(ch)) {\n        if (ch === 0x09) {\n          lineIndent += 4 - (lineIndent + this.bsCount[line]) % 4;\n        } else {\n          lineIndent++;\n        }\n      } else if (first - lineStart < this.tShift[line]) {\n        // patched tShift masked characters to look like spaces (blockquotes, list markers)\n        lineIndent++;\n      } else {\n        break;\n      }\n\n      first++;\n    }\n\n    if (lineIndent > indent) {\n      // partially expanding tabs in code blocks, e.g '\\t\\tfoobar'\n      // with indent=2 becomes '  \\tfoobar'\n      queue[i] = new Array(lineIndent - indent + 1).join(' ') + this.src.slice(first, last);\n    } else {\n      queue[i] = this.src.slice(first, last);\n    }\n  }\n\n  return queue.join('');\n};\n\n// re-export Token class to use in block rules\nStateBlock.prototype.Token = Token;\n\n\nmodule.exports = StateBlock;\n","/** internal\n * class ParserInline\n *\n * Tokenizes paragraph content.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Parser rules\n\nvar _rules = [\n  [ 'text',            require('./rules_inline/text') ],\n  [ 'newline',         require('./rules_inline/newline') ],\n  [ 'escape',          require('./rules_inline/escape') ],\n  [ 'backticks',       require('./rules_inline/backticks') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').tokenize ],\n  [ 'emphasis',        require('./rules_inline/emphasis').tokenize ],\n  [ 'link',            require('./rules_inline/link') ],\n  [ 'image',           require('./rules_inline/image') ],\n  [ 'autolink',        require('./rules_inline/autolink') ],\n  [ 'html_inline',     require('./rules_inline/html_inline') ],\n  [ 'entity',          require('./rules_inline/entity') ]\n];\n\nvar _rules2 = [\n  [ 'balance_pairs',   require('./rules_inline/balance_pairs') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').postProcess ],\n  [ 'emphasis',        require('./rules_inline/emphasis').postProcess ],\n  [ 'text_collapse',   require('./rules_inline/text_collapse') ]\n];\n\n\n/**\n * new ParserInline()\n **/\nfunction ParserInline() {\n  var i;\n\n  /**\n   * ParserInline#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of inline rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n\n  /**\n   * ParserInline#ruler2 -> Ruler\n   *\n   * [[Ruler]] instance. Second ruler used for post-processing\n   * (e.g. in emphasis-like rules).\n   **/\n  this.ruler2 = new Ruler();\n\n  for (i = 0; i < _rules2.length; i++) {\n    this.ruler2.push(_rules2[i][0], _rules2[i][1]);\n  }\n}\n\n\n// Skip single token by running all rules in validation mode;\n// returns `true` if any rule reported success\n//\nParserInline.prototype.skipToken = function (state) {\n  var ok, i, pos = state.pos,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      maxNesting = state.md.options.maxNesting,\n      cache = state.cache;\n\n\n  if (typeof cache[pos] !== 'undefined') {\n    state.pos = cache[pos];\n    return;\n  }\n\n  if (state.level < maxNesting) {\n    for (i = 0; i < len; i++) {\n      // Increment state.level and decrement it later to limit recursion.\n      // It's harmless to do here, because no tokens are created. But ideally,\n      // we'd need a separate private state variable for this purpose.\n      //\n      state.level++;\n      ok = rules[i](state, true);\n      state.level--;\n\n      if (ok) { break; }\n    }\n  } else {\n    // Too much nesting, just skip until the end of the paragraph.\n    //\n    // NOTE: this will cause links to behave incorrectly in the following case,\n    //       when an amount of `[` is exactly equal to `maxNesting + 1`:\n    //\n    //       [[[[[[[[[[[[[[[[[[[[[foo]()\n    //\n    // TODO: remove this workaround when CM standard will allow nested links\n    //       (we can replace it by preventing links from being parsed in\n    //       validation mode)\n    //\n    state.pos = state.posMax;\n  }\n\n  if (!ok) { state.pos++; }\n  cache[pos] = state.pos;\n};\n\n\n// Generate tokens for input range\n//\nParserInline.prototype.tokenize = function (state) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      end = state.posMax,\n      maxNesting = state.md.options.maxNesting;\n\n  while (state.pos < end) {\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.pos`\n    // - update `state.tokens`\n    // - return true\n\n    if (state.level < maxNesting) {\n      for (i = 0; i < len; i++) {\n        ok = rules[i](state, false);\n        if (ok) { break; }\n      }\n    }\n\n    if (ok) {\n      if (state.pos >= end) { break; }\n      continue;\n    }\n\n    state.pending += state.src[state.pos++];\n  }\n\n  if (state.pending) {\n    state.pushPending();\n  }\n};\n\n\n/**\n * ParserInline.parse(str, md, env, outTokens)\n *\n * Process input string and push inline tokens into `outTokens`\n **/\nParserInline.prototype.parse = function (str, md, env, outTokens) {\n  var i, rules, len;\n  var state = new this.State(str, md, env, outTokens);\n\n  this.tokenize(state);\n\n  rules = this.ruler2.getRules('');\n  len = rules.length;\n\n  for (i = 0; i < len; i++) {\n    rules[i](state);\n  }\n};\n\n\nParserInline.prototype.State = require('./rules_inline/state_inline');\n\n\nmodule.exports = ParserInline;\n","// Skip text characters for text token, place those to pending buffer\n// and increment current pos\n\n'use strict';\n\n\n// Rule to skip pure text\n// '{}$%@~+=:' reserved for extentions\n\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n\n// !!!! Don't confuse with \"Markdown ASCII Punctuation\" chars\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\nfunction isTerminatorChar(ch) {\n  switch (ch) {\n    case 0x0A/* \\n */:\n    case 0x21/* ! */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2D/* - */:\n    case 0x3A/* : */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos;\n\n  while (pos < state.posMax && !isTerminatorChar(state.src.charCodeAt(pos))) {\n    pos++;\n  }\n\n  if (pos === state.pos) { return false; }\n\n  if (!silent) { state.pending += state.src.slice(state.pos, pos); }\n\n  state.pos = pos;\n\n  return true;\n};\n\n// Alternative implementation, for memory.\n//\n// It costs 10% of performance, but allows extend terminators list, if place it\n// to `ParcerInline` property. Probably, will switch to it sometime, such\n// flexibility required.\n\n/*\nvar TERMINATOR_RE = /[\\n!#$%&*+\\-:<=>@[\\\\\\]^_`{}~]/;\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos,\n      idx = state.src.slice(pos).search(TERMINATOR_RE);\n\n  // first char is terminator -> empty text\n  if (idx === 0) { return false; }\n\n  // no terminator -> text till end of string\n  if (idx < 0) {\n    if (!silent) { state.pending += state.src.slice(pos); }\n    state.pos = state.src.length;\n    return true;\n  }\n\n  if (!silent) { state.pending += state.src.slice(pos, pos + idx); }\n\n  state.pos += idx;\n\n  return true;\n};*/\n","// Proceess '\\n'\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function newline(state, silent) {\n  var pmax, max, ws, pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x0A/* \\n */) { return false; }\n\n  pmax = state.pending.length - 1;\n  max = state.posMax;\n\n  // '  \\n' -> hardbreak\n  // Lookup in pending chars is bad practice! Don't copy to other rules!\n  // Pending string is stored in concat mode, indexed lookups will cause\n  // convertion to flat mode.\n  if (!silent) {\n    if (pmax >= 0 && state.pending.charCodeAt(pmax) === 0x20) {\n      if (pmax >= 1 && state.pending.charCodeAt(pmax - 1) === 0x20) {\n        // Find whitespaces tail of pending chars.\n        ws = pmax - 1;\n        while (ws >= 1 && state.pending.charCodeAt(ws - 1) === 0x20) ws--;\n\n        state.pending = state.pending.slice(0, ws);\n        state.push('hardbreak', 'br', 0);\n      } else {\n        state.pending = state.pending.slice(0, -1);\n        state.push('softbreak', 'br', 0);\n      }\n\n    } else {\n      state.push('softbreak', 'br', 0);\n    }\n  }\n\n  pos++;\n\n  // skip heading spaces for next line\n  while (pos < max && isSpace(state.src.charCodeAt(pos))) { pos++; }\n\n  state.pos = pos;\n  return true;\n};\n","// Process escaped chars and hardbreaks\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\nvar ESCAPED = [];\n\nfor (var i = 0; i < 256; i++) { ESCAPED.push(0); }\n\n'\\\\!\"#$%&\\'()*+,./:;<=>?@[]^_`{|}~-'\n  .split('').forEach(function (ch) { ESCAPED[ch.charCodeAt(0)] = 1; });\n\n\nmodule.exports = function escape(state, silent) {\n  var ch, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x5C/* \\ */) { return false; }\n\n  pos++;\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch < 256 && ESCAPED[ch] !== 0) {\n      if (!silent) { state.pending += state.src[pos]; }\n      state.pos += 2;\n      return true;\n    }\n\n    if (ch === 0x0A) {\n      if (!silent) {\n        state.push('hardbreak', 'br', 0);\n      }\n\n      pos++;\n      // skip leading whitespaces from next line\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n\n      state.pos = pos;\n      return true;\n    }\n  }\n\n  if (!silent) { state.pending += '\\\\'; }\n  state.pos++;\n  return true;\n};\n","// Parse backticks\n\n'use strict';\n\n\nmodule.exports = function backtick(state, silent) {\n  var start, max, marker, token, matchStart, matchEnd, openerLength, closerLength,\n      pos = state.pos,\n      ch = state.src.charCodeAt(pos);\n\n  if (ch !== 0x60/* ` */) { return false; }\n\n  start = pos;\n  pos++;\n  max = state.posMax;\n\n  // scan marker length\n  while (pos < max && state.src.charCodeAt(pos) === 0x60/* ` */) { pos++; }\n\n  marker = state.src.slice(start, pos);\n  openerLength = marker.length;\n\n  if (state.backticksScanned && (state.backticks[openerLength] || 0) <= start) {\n    if (!silent) state.pending += marker;\n    state.pos += openerLength;\n    return true;\n  }\n\n  matchStart = matchEnd = pos;\n\n  // Nothing found in the cache, scan until the end of the line (or until marker is found)\n  while ((matchStart = state.src.indexOf('`', matchEnd)) !== -1) {\n    matchEnd = matchStart + 1;\n\n    // scan marker length\n    while (matchEnd < max && state.src.charCodeAt(matchEnd) === 0x60/* ` */) { matchEnd++; }\n\n    closerLength = matchEnd - matchStart;\n\n    if (closerLength === openerLength) {\n      // Found matching closer length.\n      if (!silent) {\n        token     = state.push('code_inline', 'code', 0);\n        token.markup  = marker;\n        token.content = state.src.slice(pos, matchStart)\n          .replace(/\\n/g, ' ')\n          .replace(/^ (.+) $/, '$1');\n      }\n      state.pos = matchEnd;\n      return true;\n    }\n\n    // Some different length found, put it in cache as upper limit of where closer can be found\n    state.backticks[closerLength] = matchStart;\n  }\n\n  // Scanned through the end, didn't find anything\n  state.backticksScanned = true;\n\n  if (!silent) state.pending += marker;\n  state.pos += openerLength;\n  return true;\n};\n","// Process [link](<to> \"stuff\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function link(state, silent) {\n  var attrs,\n      code,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      res,\n      ref,\n      token,\n      href = '',\n      title = '',\n      oldPos = state.pos,\n      max = state.posMax,\n      start = state.pos,\n      parseReference = true;\n\n  if (state.src.charCodeAt(state.pos) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 1;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // might have found a valid shortcut link, disable reference parsing\n    parseReference = false;\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n\n      // [link](  <href>  \"title\"  )\n      //                ^^ skipping these spaces\n      start = pos;\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n\n      // [link](  <href>  \"title\"  )\n      //                  ^^^^^^^ parsing link title\n      res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n      if (pos < max && start !== pos && res.ok) {\n        title = res.str;\n        pos = res.pos;\n\n        // [link](  <href>  \"title\"  )\n        //                         ^^ skipping these spaces\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n          if (!isSpace(code) && code !== 0x0A) { break; }\n        }\n      }\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      // parsing a valid shortcut link failed, fallback to reference\n      parseReference = true;\n    }\n    pos++;\n  }\n\n  if (parseReference) {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    state.pos = labelStart;\n    state.posMax = labelEnd;\n\n    token        = state.push('link_open', 'a', 1);\n    token.attrs  = attrs = [ [ 'href', href ] ];\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n\n    state.md.inline.tokenize(state);\n\n    token        = state.push('link_close', 'a', -1);\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process ![image](<src> \"title\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function image(state, silent) {\n  var attrs,\n      code,\n      content,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      ref,\n      res,\n      title,\n      token,\n      tokens,\n      start,\n      href = '',\n      oldPos = state.pos,\n      max = state.posMax;\n\n  if (state.src.charCodeAt(state.pos) !== 0x21/* ! */) { return false; }\n  if (state.src.charCodeAt(state.pos + 1) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 2;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos + 1, false);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                ^^ skipping these spaces\n    start = pos;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                  ^^^^^^^ parsing link title\n    res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n    if (pos < max && start !== pos && res.ok) {\n      title = res.str;\n      pos = res.pos;\n\n      // [link](  <href>  \"title\"  )\n      //                         ^^ skipping these spaces\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n    } else {\n      title = '';\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      state.pos = oldPos;\n      return false;\n    }\n    pos++;\n  } else {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    content = state.src.slice(labelStart, labelEnd);\n\n    state.md.inline.parse(\n      content,\n      state.md,\n      state.env,\n      tokens = []\n    );\n\n    token          = state.push('image', 'img', 0);\n    token.attrs    = attrs = [ [ 'src', href ], [ 'alt', '' ] ];\n    token.children = tokens;\n    token.content  = content;\n\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process autolinks '<protocol:...>'\n\n'use strict';\n\n\n/*eslint max-len:0*/\nvar EMAIL_RE    = /^([a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/;\nvar AUTOLINK_RE = /^([a-zA-Z][a-zA-Z0-9+.\\-]{1,31}):([^<>\\x00-\\x20]*)$/;\n\n\nmodule.exports = function autolink(state, silent) {\n  var url, fullUrl, token, ch, start, max,\n      pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  start = state.pos;\n  max = state.posMax;\n\n  for (;;) {\n    if (++pos >= max) return false;\n\n    ch = state.src.charCodeAt(pos);\n\n    if (ch === 0x3C /* < */) return false;\n    if (ch === 0x3E /* > */) break;\n  }\n\n  url = state.src.slice(start + 1, pos);\n\n  if (AUTOLINK_RE.test(url)) {\n    fullUrl = state.md.normalizeLink(url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += url.length + 2;\n    return true;\n  }\n\n  if (EMAIL_RE.test(url)) {\n    fullUrl = state.md.normalizeLink('mailto:' + url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += url.length + 2;\n    return true;\n  }\n\n  return false;\n};\n","// Process html tags\n\n'use strict';\n\n\nvar HTML_TAG_RE = require('../common/html_re').HTML_TAG_RE;\n\n\nfunction isLetter(ch) {\n  /*eslint no-bitwise:0*/\n  var lc = ch | 0x20; // to lower case\n  return (lc >= 0x61/* a */) && (lc <= 0x7a/* z */);\n}\n\n\nmodule.exports = function html_inline(state, silent) {\n  var ch, match, max, token,\n      pos = state.pos;\n\n  if (!state.md.options.html) { return false; }\n\n  // Check start\n  max = state.posMax;\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */ ||\n      pos + 2 >= max) {\n    return false;\n  }\n\n  // Quick fail on second char\n  ch = state.src.charCodeAt(pos + 1);\n  if (ch !== 0x21/* ! */ &&\n      ch !== 0x3F/* ? */ &&\n      ch !== 0x2F/* / */ &&\n      !isLetter(ch)) {\n    return false;\n  }\n\n  match = state.src.slice(pos).match(HTML_TAG_RE);\n  if (!match) { return false; }\n\n  if (!silent) {\n    token         = state.push('html_inline', '', 0);\n    token.content = state.src.slice(pos, pos + match[0].length);\n  }\n  state.pos += match[0].length;\n  return true;\n};\n","// Process html entity - &#123;, &#xAF;, &quot;, ...\n\n'use strict';\n\nvar entities          = require('../common/entities');\nvar has               = require('../common/utils').has;\nvar isValidEntityCode = require('../common/utils').isValidEntityCode;\nvar fromCodePoint     = require('../common/utils').fromCodePoint;\n\n\nvar DIGITAL_RE = /^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i;\nvar NAMED_RE   = /^&([a-z][a-z0-9]{1,31});/i;\n\n\nmodule.exports = function entity(state, silent) {\n  var ch, code, match, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x26/* & */) { return false; }\n\n  if (pos + 1 < max) {\n    ch = state.src.charCodeAt(pos + 1);\n\n    if (ch === 0x23 /* # */) {\n      match = state.src.slice(pos).match(DIGITAL_RE);\n      if (match) {\n        if (!silent) {\n          code = match[1][0].toLowerCase() === 'x' ? parseInt(match[1].slice(1), 16) : parseInt(match[1], 10);\n          state.pending += isValidEntityCode(code) ? fromCodePoint(code) : fromCodePoint(0xFFFD);\n        }\n        state.pos += match[0].length;\n        return true;\n      }\n    } else {\n      match = state.src.slice(pos).match(NAMED_RE);\n      if (match) {\n        if (has(entities, match[1])) {\n          if (!silent) { state.pending += entities[match[1]]; }\n          state.pos += match[0].length;\n          return true;\n        }\n      }\n    }\n  }\n\n  if (!silent) { state.pending += '&'; }\n  state.pos++;\n  return true;\n};\n","// For each opening emphasis-like marker find a matching closing one\n//\n'use strict';\n\n\nfunction processDelimiters(state, delimiters) {\n  var closerIdx, openerIdx, closer, opener, minOpenerIdx, newMinOpenerIdx,\n      isOddMatch, lastJump,\n      openersBottom = {},\n      max = delimiters.length;\n\n  if (!max) return;\n\n  // headerIdx is the first delimiter of the current (where closer is) delimiter run\n  var headerIdx = 0;\n  var lastTokenIdx = -2; // needs any value lower than -1\n  var jumps = [];\n\n  for (closerIdx = 0; closerIdx < max; closerIdx++) {\n    closer = delimiters[closerIdx];\n\n    jumps.push(0);\n\n    // markers belong to same delimiter run if:\n    //  - they have adjacent tokens\n    //  - AND markers are the same\n    //\n    if (delimiters[headerIdx].marker !== closer.marker || lastTokenIdx !== closer.token - 1) {\n      headerIdx = closerIdx;\n    }\n\n    lastTokenIdx = closer.token;\n\n    // Length is only used for emphasis-specific \"rule of 3\",\n    // if it's not defined (in strikethrough or 3rd party plugins),\n    // we can default it to 0 to disable those checks.\n    //\n    closer.length = closer.length || 0;\n\n    if (!closer.close) continue;\n\n    // Previously calculated lower bounds (previous fails)\n    // for each marker, each delimiter length modulo 3,\n    // and for whether this closer can be an opener;\n    // https://github.com/commonmark/cmark/commit/34250e12ccebdc6372b8b49c44fab57c72443460\n    if (!openersBottom.hasOwnProperty(closer.marker)) {\n      openersBottom[closer.marker] = [ -1, -1, -1, -1, -1, -1 ];\n    }\n\n    minOpenerIdx = openersBottom[closer.marker][(closer.open ? 3 : 0) + (closer.length % 3)];\n\n    openerIdx = headerIdx - jumps[headerIdx] - 1;\n\n    newMinOpenerIdx = openerIdx;\n\n    for (; openerIdx > minOpenerIdx; openerIdx -= jumps[openerIdx] + 1) {\n      opener = delimiters[openerIdx];\n\n      if (opener.marker !== closer.marker) continue;\n\n      if (opener.open && opener.end < 0) {\n\n        isOddMatch = false;\n\n        // from spec:\n        //\n        // If one of the delimiters can both open and close emphasis, then the\n        // sum of the lengths of the delimiter runs containing the opening and\n        // closing delimiters must not be a multiple of 3 unless both lengths\n        // are multiples of 3.\n        //\n        if (opener.close || closer.open) {\n          if ((opener.length + closer.length) % 3 === 0) {\n            if (opener.length % 3 !== 0 || closer.length % 3 !== 0) {\n              isOddMatch = true;\n            }\n          }\n        }\n\n        if (!isOddMatch) {\n          // If previous delimiter cannot be an opener, we can safely skip\n          // the entire sequence in future checks. This is required to make\n          // sure algorithm has linear complexity (see *_*_*_*_*_... case).\n          //\n          lastJump = openerIdx > 0 && !delimiters[openerIdx - 1].open ?\n            jumps[openerIdx - 1] + 1 :\n            0;\n\n          jumps[closerIdx] = closerIdx - openerIdx + lastJump;\n          jumps[openerIdx] = lastJump;\n\n          closer.open  = false;\n          opener.end   = closerIdx;\n          opener.close = false;\n          newMinOpenerIdx = -1;\n          // treat next token as start of run,\n          // it optimizes skips in **<...>**a**<...>** pathological case\n          lastTokenIdx = -2;\n          break;\n        }\n      }\n    }\n\n    if (newMinOpenerIdx !== -1) {\n      // If match for this delimiter run failed, we want to set lower bound for\n      // future lookups. This is required to make sure algorithm has linear\n      // complexity.\n      //\n      // See details here:\n      // https://github.com/commonmark/cmark/issues/178#issuecomment-270417442\n      //\n      openersBottom[closer.marker][(closer.open ? 3 : 0) + ((closer.length || 0) % 3)] = newMinOpenerIdx;\n    }\n  }\n}\n\n\nmodule.exports = function link_pairs(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  processDelimiters(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      processDelimiters(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Clean up tokens after emphasis and strikethrough postprocessing:\n// merge adjacent text nodes into one and re-calculate all token levels\n//\n// This is necessary because initially emphasis delimiter markers (*, _, ~)\n// are treated as their own separate text tokens. Then emphasis rule either\n// leaves them as text (needed to merge with adjacent text) or turns them\n// into opening/closing tags (which messes up levels inside).\n//\n'use strict';\n\n\nmodule.exports = function text_collapse(state) {\n  var curr, last,\n      level = 0,\n      tokens = state.tokens,\n      max = state.tokens.length;\n\n  for (curr = last = 0; curr < max; curr++) {\n    // re-calculate levels after emphasis/strikethrough turns some text nodes\n    // into opening/closing tags\n    if (tokens[curr].nesting < 0) level--; // closing tag\n    tokens[curr].level = level;\n    if (tokens[curr].nesting > 0) level++; // opening tag\n\n    if (tokens[curr].type === 'text' &&\n        curr + 1 < max &&\n        tokens[curr + 1].type === 'text') {\n\n      // collapse two adjacent text nodes\n      tokens[curr + 1].content = tokens[curr].content + tokens[curr + 1].content;\n    } else {\n      if (curr !== last) { tokens[last] = tokens[curr]; }\n\n      last++;\n    }\n  }\n\n  if (curr !== last) {\n    tokens.length = last;\n  }\n};\n","// Inline parser state\n\n'use strict';\n\n\nvar Token          = require('../token');\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\n\nfunction StateInline(src, md, env, outTokens) {\n  this.src = src;\n  this.env = env;\n  this.md = md;\n  this.tokens = outTokens;\n  this.tokens_meta = Array(outTokens.length);\n\n  this.pos = 0;\n  this.posMax = this.src.length;\n  this.level = 0;\n  this.pending = '';\n  this.pendingLevel = 0;\n\n  // Stores { start: end } pairs. Useful for backtrack\n  // optimization of pairs parse (emphasis, strikes).\n  this.cache = {};\n\n  // List of emphasis-like delimiters for current tag\n  this.delimiters = [];\n\n  // Stack of delimiter lists for upper level tags\n  this._prev_delimiters = [];\n\n  // backtick length => last seen position\n  this.backticks = {};\n  this.backticksScanned = false;\n}\n\n\n// Flush pending text\n//\nStateInline.prototype.pushPending = function () {\n  var token = new Token('text', '', 0);\n  token.content = this.pending;\n  token.level = this.pendingLevel;\n  this.tokens.push(token);\n  this.pending = '';\n  return token;\n};\n\n\n// Push new token to \"stream\".\n// If pending text exists - flush it as text token\n//\nStateInline.prototype.push = function (type, tag, nesting) {\n  if (this.pending) {\n    this.pushPending();\n  }\n\n  var token = new Token(type, tag, nesting);\n  var token_meta = null;\n\n  if (nesting < 0) {\n    // closing tag\n    this.level--;\n    this.delimiters = this._prev_delimiters.pop();\n  }\n\n  token.level = this.level;\n\n  if (nesting > 0) {\n    // opening tag\n    this.level++;\n    this._prev_delimiters.push(this.delimiters);\n    this.delimiters = [];\n    token_meta = { delimiters: this.delimiters };\n  }\n\n  this.pendingLevel = this.level;\n  this.tokens.push(token);\n  this.tokens_meta.push(token_meta);\n  return token;\n};\n\n\n// Scan a sequence of emphasis-like markers, and determine whether\n// it can start an emphasis sequence or end an emphasis sequence.\n//\n//  - start - position to scan from (it should point at a valid marker);\n//  - canSplitWord - determine if these markers can be found inside a word\n//\nStateInline.prototype.scanDelims = function (start, canSplitWord) {\n  var pos = start, lastChar, nextChar, count, can_open, can_close,\n      isLastWhiteSpace, isLastPunctChar,\n      isNextWhiteSpace, isNextPunctChar,\n      left_flanking = true,\n      right_flanking = true,\n      max = this.posMax,\n      marker = this.src.charCodeAt(start);\n\n  // treat beginning of the line as a whitespace\n  lastChar = start > 0 ? this.src.charCodeAt(start - 1) : 0x20;\n\n  while (pos < max && this.src.charCodeAt(pos) === marker) { pos++; }\n\n  count = pos - start;\n\n  // treat end of the line as a whitespace\n  nextChar = pos < max ? this.src.charCodeAt(pos) : 0x20;\n\n  isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n  isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n  isLastWhiteSpace = isWhiteSpace(lastChar);\n  isNextWhiteSpace = isWhiteSpace(nextChar);\n\n  if (isNextWhiteSpace) {\n    left_flanking = false;\n  } else if (isNextPunctChar) {\n    if (!(isLastWhiteSpace || isLastPunctChar)) {\n      left_flanking = false;\n    }\n  }\n\n  if (isLastWhiteSpace) {\n    right_flanking = false;\n  } else if (isLastPunctChar) {\n    if (!(isNextWhiteSpace || isNextPunctChar)) {\n      right_flanking = false;\n    }\n  }\n\n  if (!canSplitWord) {\n    can_open  = left_flanking  && (!right_flanking || isLastPunctChar);\n    can_close = right_flanking && (!left_flanking  || isNextPunctChar);\n  } else {\n    can_open  = left_flanking;\n    can_close = right_flanking;\n  }\n\n  return {\n    can_open:  can_open,\n    can_close: can_close,\n    length:    count\n  };\n};\n\n\n// re-export Token class to use in block rules\nStateInline.prototype.Token = Token;\n\n\nmodule.exports = StateInline;\n","'use strict';\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Helpers\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\nfunction isString(obj) { return _class(obj) === '[object String]'; }\nfunction isObject(obj) { return _class(obj) === '[object Object]'; }\nfunction isRegExp(obj) { return _class(obj) === '[object RegExp]'; }\nfunction isFunction(obj) { return _class(obj) === '[object Function]'; }\n\n\nfunction escapeRE(str) { return str.replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&'); }\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar defaultOptions = {\n  fuzzyLink: true,\n  fuzzyEmail: true,\n  fuzzyIP: false\n};\n\n\nfunction isOptionsObj(obj) {\n  return Object.keys(obj || {}).reduce(function (acc, k) {\n    return acc || defaultOptions.hasOwnProperty(k);\n  }, false);\n}\n\n\nvar defaultSchemas = {\n  'http:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.http) {\n        // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.http =  new RegExp(\n          '^\\\\/\\\\/' + self.re.src_auth + self.re.src_host_port_strict + self.re.src_path, 'i'\n        );\n      }\n      if (self.re.http.test(tail)) {\n        return tail.match(self.re.http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'https:':  'http:',\n  'ftp:':    'http:',\n  '//':      {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.no_http) {\n      // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.no_http =  new RegExp(\n          '^' +\n          self.re.src_auth +\n          // Don't allow single-level domains, because of false positives like '//test'\n          // with code comments\n          '(?:localhost|(?:(?:' + self.re.src_domain + ')\\\\.)+' + self.re.src_domain_root + ')' +\n          self.re.src_port +\n          self.re.src_host_terminator +\n          self.re.src_path,\n\n          'i'\n        );\n      }\n\n      if (self.re.no_http.test(tail)) {\n        // should not be `://` & `///`, that protects from errors in protocol name\n        if (pos >= 3 && text[pos - 3] === ':') { return 0; }\n        if (pos >= 3 && text[pos - 3] === '/') { return 0; }\n        return tail.match(self.re.no_http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'mailto:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.mailto) {\n        self.re.mailto =  new RegExp(\n          '^' + self.re.src_email_name + '@' + self.re.src_host_strict, 'i'\n        );\n      }\n      if (self.re.mailto.test(tail)) {\n        return tail.match(self.re.mailto)[0].length;\n      }\n      return 0;\n    }\n  }\n};\n\n/*eslint-disable max-len*/\n\n// RE pattern for 2-character tlds (autogenerated by ./support/tlds_2char_gen.js)\nvar tlds_2ch_src_re = 'a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]';\n\n// DON'T try to make PRs with changes. Extend TLDs with LinkifyIt.tlds() instead\nvar tlds_default = 'biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф'.split('|');\n\n/*eslint-enable max-len*/\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction resetScanCache(self) {\n  self.__index__ = -1;\n  self.__text_cache__   = '';\n}\n\nfunction createValidator(re) {\n  return function (text, pos) {\n    var tail = text.slice(pos);\n\n    if (re.test(tail)) {\n      return tail.match(re)[0].length;\n    }\n    return 0;\n  };\n}\n\nfunction createNormalizer() {\n  return function (match, self) {\n    self.normalize(match);\n  };\n}\n\n// Schemas compiler. Build regexps.\n//\nfunction compile(self) {\n\n  // Load & clone RE patterns.\n  var re = self.re = require('./lib/re')(self.__opts__);\n\n  // Define dynamic patterns\n  var tlds = self.__tlds__.slice();\n\n  self.onCompile();\n\n  if (!self.__tlds_replaced__) {\n    tlds.push(tlds_2ch_src_re);\n  }\n  tlds.push(re.src_xn);\n\n  re.src_tlds = tlds.join('|');\n\n  function untpl(tpl) { return tpl.replace('%TLDS%', re.src_tlds); }\n\n  re.email_fuzzy      = RegExp(untpl(re.tpl_email_fuzzy), 'i');\n  re.link_fuzzy       = RegExp(untpl(re.tpl_link_fuzzy), 'i');\n  re.link_no_ip_fuzzy = RegExp(untpl(re.tpl_link_no_ip_fuzzy), 'i');\n  re.host_fuzzy_test  = RegExp(untpl(re.tpl_host_fuzzy_test), 'i');\n\n  //\n  // Compile each schema\n  //\n\n  var aliases = [];\n\n  self.__compiled__ = {}; // Reset compiled data\n\n  function schemaError(name, val) {\n    throw new Error('(LinkifyIt) Invalid schema \"' + name + '\": ' + val);\n  }\n\n  Object.keys(self.__schemas__).forEach(function (name) {\n    var val = self.__schemas__[name];\n\n    // skip disabled methods\n    if (val === null) { return; }\n\n    var compiled = { validate: null, link: null };\n\n    self.__compiled__[name] = compiled;\n\n    if (isObject(val)) {\n      if (isRegExp(val.validate)) {\n        compiled.validate = createValidator(val.validate);\n      } else if (isFunction(val.validate)) {\n        compiled.validate = val.validate;\n      } else {\n        schemaError(name, val);\n      }\n\n      if (isFunction(val.normalize)) {\n        compiled.normalize = val.normalize;\n      } else if (!val.normalize) {\n        compiled.normalize = createNormalizer();\n      } else {\n        schemaError(name, val);\n      }\n\n      return;\n    }\n\n    if (isString(val)) {\n      aliases.push(name);\n      return;\n    }\n\n    schemaError(name, val);\n  });\n\n  //\n  // Compile postponed aliases\n  //\n\n  aliases.forEach(function (alias) {\n    if (!self.__compiled__[self.__schemas__[alias]]) {\n      // Silently fail on missed schemas to avoid errons on disable.\n      // schemaError(alias, self.__schemas__[alias]);\n      return;\n    }\n\n    self.__compiled__[alias].validate =\n      self.__compiled__[self.__schemas__[alias]].validate;\n    self.__compiled__[alias].normalize =\n      self.__compiled__[self.__schemas__[alias]].normalize;\n  });\n\n  //\n  // Fake record for guessed links\n  //\n  self.__compiled__[''] = { validate: null, normalize: createNormalizer() };\n\n  //\n  // Build schema condition\n  //\n  var slist = Object.keys(self.__compiled__)\n                      .filter(function (name) {\n                        // Filter disabled & fake schemas\n                        return name.length > 0 && self.__compiled__[name];\n                      })\n                      .map(escapeRE)\n                      .join('|');\n  // (?!_) cause 1.5x slowdown\n  self.re.schema_test   = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'i');\n  self.re.schema_search = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'ig');\n\n  self.re.pretest = RegExp(\n    '(' + self.re.schema_test.source + ')|(' + self.re.host_fuzzy_test.source + ')|@',\n    'i'\n  );\n\n  //\n  // Cleanup\n  //\n\n  resetScanCache(self);\n}\n\n/**\n * class Match\n *\n * Match result. Single element of array, returned by [[LinkifyIt#match]]\n **/\nfunction Match(self, shift) {\n  var start = self.__index__,\n      end   = self.__last_index__,\n      text  = self.__text_cache__.slice(start, end);\n\n  /**\n   * Match#schema -> String\n   *\n   * Prefix (protocol) for matched string.\n   **/\n  this.schema    = self.__schema__.toLowerCase();\n  /**\n   * Match#index -> Number\n   *\n   * First position of matched string.\n   **/\n  this.index     = start + shift;\n  /**\n   * Match#lastIndex -> Number\n   *\n   * Next position after matched string.\n   **/\n  this.lastIndex = end + shift;\n  /**\n   * Match#raw -> String\n   *\n   * Matched string.\n   **/\n  this.raw       = text;\n  /**\n   * Match#text -> String\n   *\n   * Notmalized text of matched string.\n   **/\n  this.text      = text;\n  /**\n   * Match#url -> String\n   *\n   * Normalized url of matched string.\n   **/\n  this.url       = text;\n}\n\nfunction createMatch(self, shift) {\n  var match = new Match(self, shift);\n\n  self.__compiled__[match.schema].normalize(match, self);\n\n  return match;\n}\n\n\n/**\n * class LinkifyIt\n **/\n\n/**\n * new LinkifyIt(schemas, options)\n * - schemas (Object): Optional. Additional schemas to validate (prefix/validator)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Creates new linkifier instance with optional additional schemas.\n * Can be called without `new` keyword for convenience.\n *\n * By default understands:\n *\n * - `http(s)://...` , `ftp://...`, `mailto:...` & `//...` links\n * - \"fuzzy\" links and emails (example.com, foo@bar.com).\n *\n * `schemas` is an object, where each key/value describes protocol/rule:\n *\n * - __key__ - link prefix (usually, protocol name with `:` at the end, `skype:`\n *   for example). `linkify-it` makes shure that prefix is not preceeded with\n *   alphanumeric char and symbols. Only whitespaces and punctuation allowed.\n * - __value__ - rule to check tail after link prefix\n *   - _String_ - just alias to existing rule\n *   - _Object_\n *     - _validate_ - validator function (should return matched length on success),\n *       or `RegExp`.\n *     - _normalize_ - optional function to normalize text & url of matched result\n *       (for example, for @twitter mentions).\n *\n * `options`:\n *\n * - __fuzzyLink__ - recognige URL-s without `http(s):` prefix. Default `true`.\n * - __fuzzyIP__ - allow IPs in fuzzy links above. Can conflict with some texts\n *   like version numbers. Default `false`.\n * - __fuzzyEmail__ - recognize emails without `mailto:` prefix.\n *\n **/\nfunction LinkifyIt(schemas, options) {\n  if (!(this instanceof LinkifyIt)) {\n    return new LinkifyIt(schemas, options);\n  }\n\n  if (!options) {\n    if (isOptionsObj(schemas)) {\n      options = schemas;\n      schemas = {};\n    }\n  }\n\n  this.__opts__           = assign({}, defaultOptions, options);\n\n  // Cache last tested result. Used to skip repeating steps on next `match` call.\n  this.__index__          = -1;\n  this.__last_index__     = -1; // Next scan position\n  this.__schema__         = '';\n  this.__text_cache__     = '';\n\n  this.__schemas__        = assign({}, defaultSchemas, schemas);\n  this.__compiled__       = {};\n\n  this.__tlds__           = tlds_default;\n  this.__tlds_replaced__  = false;\n\n  this.re = {};\n\n  compile(this);\n}\n\n\n/** chainable\n * LinkifyIt#add(schema, definition)\n * - schema (String): rule name (fixed pattern prefix)\n * - definition (String|RegExp|Object): schema definition\n *\n * Add new rule definition. See constructor description for details.\n **/\nLinkifyIt.prototype.add = function add(schema, definition) {\n  this.__schemas__[schema] = definition;\n  compile(this);\n  return this;\n};\n\n\n/** chainable\n * LinkifyIt#set(options)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Set recognition options for links without schema.\n **/\nLinkifyIt.prototype.set = function set(options) {\n  this.__opts__ = assign(this.__opts__, options);\n  return this;\n};\n\n\n/**\n * LinkifyIt#test(text) -> Boolean\n *\n * Searches linkifiable pattern and returns `true` on success or `false` on fail.\n **/\nLinkifyIt.prototype.test = function test(text) {\n  // Reset scan cache\n  this.__text_cache__ = text;\n  this.__index__      = -1;\n\n  if (!text.length) { return false; }\n\n  var m, ml, me, len, shift, next, re, tld_pos, at_pos;\n\n  // try to scan for link with schema - that's the most simple rule\n  if (this.re.schema_test.test(text)) {\n    re = this.re.schema_search;\n    re.lastIndex = 0;\n    while ((m = re.exec(text)) !== null) {\n      len = this.testSchemaAt(text, m[2], re.lastIndex);\n      if (len) {\n        this.__schema__     = m[2];\n        this.__index__      = m.index + m[1].length;\n        this.__last_index__ = m.index + m[0].length + len;\n        break;\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyLink && this.__compiled__['http:']) {\n    // guess schemaless links\n    tld_pos = text.search(this.re.host_fuzzy_test);\n    if (tld_pos >= 0) {\n      // if tld is located after found link - no need to check fuzzy pattern\n      if (this.__index__ < 0 || tld_pos < this.__index__) {\n        if ((ml = text.match(this.__opts__.fuzzyIP ? this.re.link_fuzzy : this.re.link_no_ip_fuzzy)) !== null) {\n\n          shift = ml.index + ml[1].length;\n\n          if (this.__index__ < 0 || shift < this.__index__) {\n            this.__schema__     = '';\n            this.__index__      = shift;\n            this.__last_index__ = ml.index + ml[0].length;\n          }\n        }\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyEmail && this.__compiled__['mailto:']) {\n    // guess schemaless emails\n    at_pos = text.indexOf('@');\n    if (at_pos >= 0) {\n      // We can't skip this check, because this cases are possible:\n      // 192.168.1.1@gmail.com, my.in@example.com\n      if ((me = text.match(this.re.email_fuzzy)) !== null) {\n\n        shift = me.index + me[1].length;\n        next  = me.index + me[0].length;\n\n        if (this.__index__ < 0 || shift < this.__index__ ||\n            (shift === this.__index__ && next > this.__last_index__)) {\n          this.__schema__     = 'mailto:';\n          this.__index__      = shift;\n          this.__last_index__ = next;\n        }\n      }\n    }\n  }\n\n  return this.__index__ >= 0;\n};\n\n\n/**\n * LinkifyIt#pretest(text) -> Boolean\n *\n * Very quick check, that can give false positives. Returns true if link MAY BE\n * can exists. Can be used for speed optimization, when you need to check that\n * link NOT exists.\n **/\nLinkifyIt.prototype.pretest = function pretest(text) {\n  return this.re.pretest.test(text);\n};\n\n\n/**\n * LinkifyIt#testSchemaAt(text, name, position) -> Number\n * - text (String): text to scan\n * - name (String): rule (schema) name\n * - position (Number): text offset to check from\n *\n * Similar to [[LinkifyIt#test]] but checks only specific protocol tail exactly\n * at given position. Returns length of found pattern (0 on fail).\n **/\nLinkifyIt.prototype.testSchemaAt = function testSchemaAt(text, schema, pos) {\n  // If not supported schema check requested - terminate\n  if (!this.__compiled__[schema.toLowerCase()]) {\n    return 0;\n  }\n  return this.__compiled__[schema.toLowerCase()].validate(text, pos, this);\n};\n\n\n/**\n * LinkifyIt#match(text) -> Array|null\n *\n * Returns array of found link descriptions or `null` on fail. We strongly\n * recommend to use [[LinkifyIt#test]] first, for best speed.\n *\n * ##### Result match description\n *\n * - __schema__ - link schema, can be empty for fuzzy links, or `//` for\n *   protocol-neutral  links.\n * - __index__ - offset of matched text\n * - __lastIndex__ - index of next char after mathch end\n * - __raw__ - matched text\n * - __text__ - normalized text\n * - __url__ - link, generated from matched text\n **/\nLinkifyIt.prototype.match = function match(text) {\n  var shift = 0, result = [];\n\n  // Try to take previous element from cache, if .test() called before\n  if (this.__index__ >= 0 && this.__text_cache__ === text) {\n    result.push(createMatch(this, shift));\n    shift = this.__last_index__;\n  }\n\n  // Cut head if cache was used\n  var tail = shift ? text.slice(shift) : text;\n\n  // Scan string until end reached\n  while (this.test(tail)) {\n    result.push(createMatch(this, shift));\n\n    tail = tail.slice(this.__last_index__);\n    shift += this.__last_index__;\n  }\n\n  if (result.length) {\n    return result;\n  }\n\n  return null;\n};\n\n\n/** chainable\n * LinkifyIt#tlds(list [, keepOld]) -> this\n * - list (Array): list of tlds\n * - keepOld (Boolean): merge with current list if `true` (`false` by default)\n *\n * Load (or merge) new tlds list. Those are user for fuzzy links (without prefix)\n * to avoid false positives. By default this algorythm used:\n *\n * - hostname with any 2-letter root zones are ok.\n * - biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф\n *   are ok.\n * - encoded (`xn--...`) root zones are ok.\n *\n * If list is replaced, then exact match for 2-chars root zones will be checked.\n **/\nLinkifyIt.prototype.tlds = function tlds(list, keepOld) {\n  list = Array.isArray(list) ? list : [ list ];\n\n  if (!keepOld) {\n    this.__tlds__ = list.slice();\n    this.__tlds_replaced__ = true;\n    compile(this);\n    return this;\n  }\n\n  this.__tlds__ = this.__tlds__.concat(list)\n                                  .sort()\n                                  .filter(function (el, idx, arr) {\n                                    return el !== arr[idx - 1];\n                                  })\n                                  .reverse();\n\n  compile(this);\n  return this;\n};\n\n/**\n * LinkifyIt#normalize(match)\n *\n * Default normalizer (if schema does not define it's own).\n **/\nLinkifyIt.prototype.normalize = function normalize(match) {\n\n  // Do minimal possible changes by default. Need to collect feedback prior\n  // to move forward https://github.com/markdown-it/linkify-it/issues/1\n\n  if (!match.schema) { match.url = 'http://' + match.url; }\n\n  if (match.schema === 'mailto:' && !/^mailto:/i.test(match.url)) {\n    match.url = 'mailto:' + match.url;\n  }\n};\n\n\n/**\n * LinkifyIt#onCompile()\n *\n * Override to modify basic RegExp-s.\n **/\nLinkifyIt.prototype.onCompile = function onCompile() {\n};\n\n\nmodule.exports = LinkifyIt;\n","'use strict';\n\n\nmodule.exports = function (opts) {\n  var re = {};\n\n  // Use direct extract instead of `regenerate` to reduse browserified size\n  re.src_Any = require('uc.micro/properties/Any/regex').source;\n  re.src_Cc  = require('uc.micro/categories/Cc/regex').source;\n  re.src_Z   = require('uc.micro/categories/Z/regex').source;\n  re.src_P   = require('uc.micro/categories/P/regex').source;\n\n  // \\p{\\Z\\P\\Cc\\CF} (white spaces + control + format + punctuation)\n  re.src_ZPCc = [ re.src_Z, re.src_P, re.src_Cc ].join('|');\n\n  // \\p{\\Z\\Cc} (white spaces + control)\n  re.src_ZCc = [ re.src_Z, re.src_Cc ].join('|');\n\n  // Experimental. List of chars, completely prohibited in links\n  // because can separate it from other part of text\n  var text_separators = '[><\\uff5c]';\n\n  // All possible word characters (everything without punctuation, spaces & controls)\n  // Defined via punctuation & spaces to save space\n  // Should be something like \\p{\\L\\N\\S\\M} (\\w but without `_`)\n  re.src_pseudo_letter       = '(?:(?!' + text_separators + '|' + re.src_ZPCc + ')' + re.src_Any + ')';\n  // The same as abothe but without [0-9]\n  // var src_pseudo_letter_non_d = '(?:(?![0-9]|' + src_ZPCc + ')' + src_Any + ')';\n\n  ////////////////////////////////////////////////////////////////////////////////\n\n  re.src_ip4 =\n\n    '(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)';\n\n  // Prohibit any of \"@/[]()\" in user/pass to avoid wrong domain fetch.\n  re.src_auth    = '(?:(?:(?!' + re.src_ZCc + '|[@/\\\\[\\\\]()]).)+@)?';\n\n  re.src_port =\n\n    '(?::(?:6(?:[0-4]\\\\d{3}|5(?:[0-4]\\\\d{2}|5(?:[0-2]\\\\d|3[0-5])))|[1-5]?\\\\d{1,4}))?';\n\n  re.src_host_terminator =\n\n    '(?=$|' + text_separators + '|' + re.src_ZPCc + ')(?!-|_|:\\\\d|\\\\.-|\\\\.(?!$|' + re.src_ZPCc + '))';\n\n  re.src_path =\n\n    '(?:' +\n      '[/?#]' +\n        '(?:' +\n          '(?!' + re.src_ZCc + '|' + text_separators + '|[()[\\\\]{}.,\"\\'?!\\\\-;]).|' +\n          '\\\\[(?:(?!' + re.src_ZCc + '|\\\\]).)*\\\\]|' +\n          '\\\\((?:(?!' + re.src_ZCc + '|[)]).)*\\\\)|' +\n          '\\\\{(?:(?!' + re.src_ZCc + '|[}]).)*\\\\}|' +\n          '\\\\\"(?:(?!' + re.src_ZCc + '|[\"]).)+\\\\\"|' +\n          \"\\\\'(?:(?!\" + re.src_ZCc + \"|[']).)+\\\\'|\" +\n          \"\\\\'(?=\" + re.src_pseudo_letter + '|[-]).|' +  // allow `I'm_king` if no pair found\n          '\\\\.{2,}[a-zA-Z0-9%/&]|' + // google has many dots in \"google search\" links (#66, #81).\n                                     // github has ... in commit range links,\n                                     // Restrict to\n                                     // - english\n                                     // - percent-encoded\n                                     // - parts of file path\n                                     // - params separator\n                                     // until more examples found.\n          '\\\\.(?!' + re.src_ZCc + '|[.]).|' +\n          (opts && opts['---'] ?\n            '\\\\-(?!--(?:[^-]|$))(?:-*)|' // `---` => long dash, terminate\n            :\n            '\\\\-+|'\n          ) +\n          ',(?!' + re.src_ZCc + ').|' +       // allow `,,,` in paths\n          ';(?!' + re.src_ZCc + ').|' +       // allow `;` if not followed by space-like char\n          '\\\\!+(?!' + re.src_ZCc + '|[!]).|' +  // allow `!!!` in paths, but not at the end\n          '\\\\?(?!' + re.src_ZCc + '|[?]).' +\n        ')+' +\n      '|\\\\/' +\n    ')?';\n\n  // Allow anything in markdown spec, forbid quote (\") at the first position\n  // because emails enclosed in quotes are far more common\n  re.src_email_name =\n\n    '[\\\\-;:&=\\\\+\\\\$,\\\\.a-zA-Z0-9_][\\\\-;:&=\\\\+\\\\$,\\\\\"\\\\.a-zA-Z0-9_]*';\n\n  re.src_xn =\n\n    'xn--[a-z0-9\\\\-]{1,59}';\n\n  // More to read about domain names\n  // http://serverfault.com/questions/638260/\n\n  re.src_domain_root =\n\n    // Allow letters & digits (http://test1)\n    '(?:' +\n      re.src_xn +\n      '|' +\n      re.src_pseudo_letter + '{1,63}' +\n    ')';\n\n  re.src_domain =\n\n    '(?:' +\n      re.src_xn +\n      '|' +\n      '(?:' + re.src_pseudo_letter + ')' +\n      '|' +\n      '(?:' + re.src_pseudo_letter + '(?:-|' + re.src_pseudo_letter + '){0,61}' + re.src_pseudo_letter + ')' +\n    ')';\n\n  re.src_host =\n\n    '(?:' +\n    // Don't need IP check, because digits are already allowed in normal domain names\n    //   src_ip4 +\n    // '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)*' + re.src_domain/*_root*/ + ')' +\n    ')';\n\n  re.tpl_host_fuzzy =\n\n    '(?:' +\n      re.src_ip4 +\n    '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))' +\n    ')';\n\n  re.tpl_host_no_ip_fuzzy =\n\n    '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))';\n\n  re.src_host_strict =\n\n    re.src_host + re.src_host_terminator;\n\n  re.tpl_host_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_host_terminator;\n\n  re.src_host_port_strict =\n\n    re.src_host + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_no_ip_fuzzy_strict =\n\n    re.tpl_host_no_ip_fuzzy + re.src_port + re.src_host_terminator;\n\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Main rules\n\n  // Rude test fuzzy links by host, for quick deny\n  re.tpl_host_fuzzy_test =\n\n    'localhost|www\\\\.|\\\\.\\\\d{1,3}\\\\.|(?:\\\\.(?:%TLDS%)(?:' + re.src_ZPCc + '|>|$))';\n\n  re.tpl_email_fuzzy =\n\n      '(^|' + text_separators + '|\"|\\\\(|' + re.src_ZCc + ')' +\n      '(' + re.src_email_name + '@' + re.tpl_host_fuzzy_strict + ')';\n\n  re.tpl_link_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_fuzzy_strict + re.src_path + ')';\n\n  re.tpl_link_no_ip_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_no_ip_fuzzy_strict + re.src_path + ')';\n\n  return re;\n};\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// markdown-it default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   100            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {},\n    block: {},\n    inline: {}\n  }\n};\n","// \"Zero\" preset, with nothing enabled. Useful for manual configuring of simple\n// modes. For example, to parse bold/italic only.\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","// Commonmark default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         true,         // Enable HTML tags in source\n    xhtmlOut:     true,         // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'blockquote',\n        'code',\n        'fence',\n        'heading',\n        'hr',\n        'html_block',\n        'lheading',\n        'list',\n        'reference',\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'autolink',\n        'backticks',\n        'emphasis',\n        'entity',\n        'escape',\n        'html_inline',\n        'image',\n        'link',\n        'newline',\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'emphasis',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","// Main parser class\n\n'use strict';\n\n\nvar utils        = require('./common/utils');\nvar helpers      = require('./helpers');\nvar Renderer     = require('./renderer');\nvar ParserCore   = require('./parser_core');\nvar ParserBlock  = require('./parser_block');\nvar ParserInline = require('./parser_inline');\nvar LinkifyIt    = require('linkify-it');\nvar mdurl        = require('mdurl');\nvar punycode     = require('punycode');\n\n\nvar config = {\n  'default': require('./presets/default'),\n  zero: require('./presets/zero'),\n  commonmark: require('./presets/commonmark')\n};\n\n////////////////////////////////////////////////////////////////////////////////\n//\n// This validator can prohibit more than really needed to prevent XSS. It's a\n// tradeoff to keep code simple and to be secure by default.\n//\n// If you need different setup - override validator method as you wish. Or\n// replace it with dummy function and use external sanitizer.\n//\n\nvar BAD_PROTO_RE = /^(vbscript|javascript|file|data):/;\nvar GOOD_DATA_RE = /^data:image\\/(gif|png|jpeg|webp);/;\n\nfunction validateLink(url) {\n  // url should be normalized at this point, and existing entities are decoded\n  var str = url.trim().toLowerCase();\n\n  return BAD_PROTO_RE.test(str) ? (GOOD_DATA_RE.test(str) ? true : false) : true;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar RECODE_HOSTNAME_FOR = [ 'http:', 'https:', 'mailto:' ];\n\nfunction normalizeLink(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toASCII(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  return mdurl.encode(mdurl.format(parsed));\n}\n\nfunction normalizeLinkText(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toUnicode(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  return mdurl.decode(mdurl.format(parsed));\n}\n\n\n/**\n * class MarkdownIt\n *\n * Main parser/renderer class.\n *\n * ##### Usage\n *\n * ```javascript\n * // node.js, \"classic\" way:\n * var MarkdownIt = require('markdown-it'),\n *     md = new MarkdownIt();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // node.js, the same, but with sugar:\n * var md = require('markdown-it')();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // browser without AMD, added to \"window\" on script load\n * // Note, there are no dash.\n * var md = window.markdownit();\n * var result = md.render('# markdown-it rulezz!');\n * ```\n *\n * Single line rendering, without paragraph wrap:\n *\n * ```javascript\n * var md = require('markdown-it')();\n * var result = md.renderInline('__markdown-it__ rulezz!');\n * ```\n **/\n\n/**\n * new MarkdownIt([presetName, options])\n * - presetName (String): optional, `commonmark` / `zero`\n * - options (Object)\n *\n * Creates parser instanse with given config. Can be called without `new`.\n *\n * ##### presetName\n *\n * MarkdownIt provides named presets as a convenience to quickly\n * enable/disable active syntax rules and options for common use cases.\n *\n * - [\"commonmark\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/commonmark.js) -\n *   configures parser to strict [CommonMark](http://commonmark.org/) mode.\n * - [default](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/default.js) -\n *   similar to GFM, used when no preset name given. Enables all available rules,\n *   but still without html, typographer & autolinker.\n * - [\"zero\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/zero.js) -\n *   all rules disabled. Useful to quickly setup your config via `.enable()`.\n *   For example, when you need only `bold` and `italic` markup and nothing else.\n *\n * ##### options:\n *\n * - __html__ - `false`. Set `true` to enable HTML tags in source. Be careful!\n *   That's not safe! You may need external sanitizer to protect output from XSS.\n *   It's better to extend features via plugins, instead of enabling HTML.\n * - __xhtmlOut__ - `false`. Set `true` to add '/' when closing single tags\n *   (`<br />`). This is needed only for full CommonMark compatibility. In real\n *   world you will need HTML output.\n * - __breaks__ - `false`. Set `true` to convert `\\n` in paragraphs into `<br>`.\n * - __langPrefix__ - `language-`. CSS language class prefix for fenced blocks.\n *   Can be useful for external highlighters.\n * - __linkify__ - `false`. Set `true` to autoconvert URL-like text to links.\n * - __typographer__  - `false`. Set `true` to enable [some language-neutral\n *   replacement](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/replacements.js) +\n *   quotes beautification (smartquotes).\n * - __quotes__ - `“”‘’`, String or Array. Double + single quotes replacement\n *   pairs, when typographer enabled and smartquotes on. For example, you can\n *   use `'«»„“'` for Russian, `'„“‚‘'` for German, and\n *   `['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›']` for French (including nbsp).\n * - __highlight__ - `null`. Highlighter function for fenced code blocks.\n *   Highlighter `function (str, lang)` should return escaped HTML. It can also\n *   return empty string if the source was not changed and should be escaped\n *   externaly. If result starts with <pre... internal wrapper is skipped.\n *\n * ##### Example\n *\n * ```javascript\n * // commonmark mode\n * var md = require('markdown-it')('commonmark');\n *\n * // default mode\n * var md = require('markdown-it')();\n *\n * // enable everything\n * var md = require('markdown-it')({\n *   html: true,\n *   linkify: true,\n *   typographer: true\n * });\n * ```\n *\n * ##### Syntax highlighting\n *\n * ```js\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return hljs.highlight(lang, str, true).value;\n *       } catch (__) {}\n *     }\n *\n *     return ''; // use external default escaping\n *   }\n * });\n * ```\n *\n * Or with full wrapper override (if you need assign class to `<pre>`):\n *\n * ```javascript\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * // Actual default values\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return '<pre class=\"hljs\"><code>' +\n *                hljs.highlight(lang, str, true).value +\n *                '</code></pre>';\n *       } catch (__) {}\n *     }\n *\n *     return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n *   }\n * });\n * ```\n *\n **/\nfunction MarkdownIt(presetName, options) {\n  if (!(this instanceof MarkdownIt)) {\n    return new MarkdownIt(presetName, options);\n  }\n\n  if (!options) {\n    if (!utils.isString(presetName)) {\n      options = presetName || {};\n      presetName = 'default';\n    }\n  }\n\n  /**\n   * MarkdownIt#inline -> ParserInline\n   *\n   * Instance of [[ParserInline]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.inline = new ParserInline();\n\n  /**\n   * MarkdownIt#block -> ParserBlock\n   *\n   * Instance of [[ParserBlock]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.block = new ParserBlock();\n\n  /**\n   * MarkdownIt#core -> Core\n   *\n   * Instance of [[Core]] chain executor. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.core = new ParserCore();\n\n  /**\n   * MarkdownIt#renderer -> Renderer\n   *\n   * Instance of [[Renderer]]. Use it to modify output look. Or to add rendering\n   * rules for new token types, generated by plugins.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * function myToken(tokens, idx, options, env, self) {\n   *   //...\n   *   return result;\n   * };\n   *\n   * md.renderer.rules['my_token'] = myToken\n   * ```\n   *\n   * See [[Renderer]] docs and [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js).\n   **/\n  this.renderer = new Renderer();\n\n  /**\n   * MarkdownIt#linkify -> LinkifyIt\n   *\n   * [linkify-it](https://github.com/markdown-it/linkify-it) instance.\n   * Used by [linkify](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/linkify.js)\n   * rule.\n   **/\n  this.linkify = new LinkifyIt();\n\n  /**\n   * MarkdownIt#validateLink(url) -> Boolean\n   *\n   * Link validation function. CommonMark allows too much in links. By default\n   * we disable `javascript:`, `vbscript:`, `file:` schemas, and almost all `data:...` schemas\n   * except some embedded image types.\n   *\n   * You can change this behaviour:\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   * // enable everything\n   * md.validateLink = function () { return true; }\n   * ```\n   **/\n  this.validateLink = validateLink;\n\n  /**\n   * MarkdownIt#normalizeLink(url) -> String\n   *\n   * Function used to encode link url to a machine-readable format,\n   * which includes url-encoding, punycode, etc.\n   **/\n  this.normalizeLink = normalizeLink;\n\n  /**\n   * MarkdownIt#normalizeLinkText(url) -> String\n   *\n   * Function used to decode link url to a human-readable format`\n   **/\n  this.normalizeLinkText = normalizeLinkText;\n\n\n  // Expose utils & helpers for easy acces from plugins\n\n  /**\n   * MarkdownIt#utils -> utils\n   *\n   * Assorted utility functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/common/utils.js).\n   **/\n  this.utils = utils;\n\n  /**\n   * MarkdownIt#helpers -> helpers\n   *\n   * Link components parser functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/helpers).\n   **/\n  this.helpers = utils.assign({}, helpers);\n\n\n  this.options = {};\n  this.configure(presetName);\n\n  if (options) { this.set(options); }\n}\n\n\n/** chainable\n * MarkdownIt.set(options)\n *\n * Set parser options (in the same format as in constructor). Probably, you\n * will never need it, but you can change options after constructor call.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .set({ html: true, breaks: true })\n *             .set({ typographer, true });\n * ```\n *\n * __Note:__ To achieve the best possible performance, don't modify a\n * `markdown-it` instance options on the fly. If you need multiple configurations\n * it's best to create multiple instances and initialize each with separate\n * config.\n **/\nMarkdownIt.prototype.set = function (options) {\n  utils.assign(this.options, options);\n  return this;\n};\n\n\n/** chainable, internal\n * MarkdownIt.configure(presets)\n *\n * Batch load of all options and compenent settings. This is internal method,\n * and you probably will not need it. But if you with - see available presets\n * and data structure [here](https://github.com/markdown-it/markdown-it/tree/master/lib/presets)\n *\n * We strongly recommend to use presets instead of direct config loads. That\n * will give better compatibility with next versions.\n **/\nMarkdownIt.prototype.configure = function (presets) {\n  var self = this, presetName;\n\n  if (utils.isString(presets)) {\n    presetName = presets;\n    presets = config[presetName];\n    if (!presets) { throw new Error('Wrong `markdown-it` preset \"' + presetName + '\", check name'); }\n  }\n\n  if (!presets) { throw new Error('Wrong `markdown-it` preset, can\\'t be empty'); }\n\n  if (presets.options) { self.set(presets.options); }\n\n  if (presets.components) {\n    Object.keys(presets.components).forEach(function (name) {\n      if (presets.components[name].rules) {\n        self[name].ruler.enableOnly(presets.components[name].rules);\n      }\n      if (presets.components[name].rules2) {\n        self[name].ruler2.enableOnly(presets.components[name].rules2);\n      }\n    });\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.enable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to enable\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable list or rules. It will automatically find appropriate components,\n * containing rules with given names. If rule not found, and `ignoreInvalid`\n * not set - throws exception.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .enable(['sub', 'sup'])\n *             .disable('smartquotes');\n * ```\n **/\nMarkdownIt.prototype.enable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.enable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.enable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to enable unknown rule(s): ' + missed);\n  }\n\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.disable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * The same as [[MarkdownIt.enable]], but turn specified rules off.\n **/\nMarkdownIt.prototype.disable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.disable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.disable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to disable unknown rule(s): ' + missed);\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.use(plugin, params)\n *\n * Load specified plugin with given params into current parser instance.\n * It's just a sugar to call `plugin(md, params)` with curring.\n *\n * ##### Example\n *\n * ```javascript\n * var iterator = require('markdown-it-for-inline');\n * var md = require('markdown-it')()\n *             .use(iterator, 'foo_replace', 'text', function (tokens, idx) {\n *               tokens[idx].content = tokens[idx].content.replace(/foo/g, 'bar');\n *             });\n * ```\n **/\nMarkdownIt.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\n/** internal\n * MarkdownIt.parse(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Parse input string and returns list of block tokens (special token type\n * \"inline\" will contain list of inline tokens). You should not call this\n * method directly, until you write custom renderer (for example, to produce\n * AST).\n *\n * `env` is used to pass data between \"distributed\" rules and return additional\n * metadata like reference info, needed for the renderer. It also can be used to\n * inject data in specific cases. Usually, you will be ok to pass `{}`,\n * and then pass updated object to renderer.\n **/\nMarkdownIt.prototype.parse = function (src, env) {\n  if (typeof src !== 'string') {\n    throw new Error('Input data should be a String');\n  }\n\n  var state = new this.core.State(src, this, env);\n\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.render(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Render markdown string into html. It does all magic for you :).\n *\n * `env` can be used to inject additional metadata (`{}` by default).\n * But you will not need it with high probability. See also comment\n * in [[MarkdownIt.parse]].\n **/\nMarkdownIt.prototype.render = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parse(src, env), this.options, env);\n};\n\n\n/** internal\n * MarkdownIt.parseInline(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * The same as [[MarkdownIt.parse]] but skip all block rules. It returns the\n * block tokens list with the single `inline` element, containing parsed inline\n * tokens in `children` property. Also updates `env` object.\n **/\nMarkdownIt.prototype.parseInline = function (src, env) {\n  var state = new this.core.State(src, this, env);\n\n  state.inlineMode = true;\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.renderInline(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Similar to [[MarkdownIt.render]] but for single paragraph content. Result\n * will NOT be wrapped into `<p>` tags.\n **/\nMarkdownIt.prototype.renderInline = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parseInline(src, env), this.options, env);\n};\n\n\nmodule.exports = MarkdownIt;\n","// Just a shortcut for bulk export\n'use strict';\n\n\nexports.parseLinkLabel       = require('./parse_link_label');\nexports.parseLinkDestination = require('./parse_link_destination');\nexports.parseLinkTitle       = require('./parse_link_title');\n","// Parse link label\n//\n// this function assumes that first character (\"[\") already matches;\n// returns the end of the label\n//\n'use strict';\n\nmodule.exports = function parseLinkLabel(state, start, disableNested) {\n  var level, found, marker, prevPos,\n      labelEnd = -1,\n      max = state.posMax,\n      oldPos = state.pos;\n\n  state.pos = start + 1;\n  level = 1;\n\n  while (state.pos < max) {\n    marker = state.src.charCodeAt(state.pos);\n    if (marker === 0x5D /* ] */) {\n      level--;\n      if (level === 0) {\n        found = true;\n        break;\n      }\n    }\n\n    prevPos = state.pos;\n    state.md.inline.skipToken(state);\n    if (marker === 0x5B /* [ */) {\n      if (prevPos === state.pos - 1) {\n        // increase level if we find text `[`, which is not a part of any token\n        level++;\n      } else if (disableNested) {\n        state.pos = oldPos;\n        return -1;\n      }\n    }\n  }\n\n  if (found) {\n    labelEnd = state.pos;\n  }\n\n  // restore old state\n  state.pos = oldPos;\n\n  return labelEnd;\n};\n","// Parse link destination\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkDestination(str, pos, max) {\n  var code, level,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (str.charCodeAt(pos) === 0x3C /* < */) {\n    pos++;\n    while (pos < max) {\n      code = str.charCodeAt(pos);\n      if (code === 0x0A /* \\n */) { return result; }\n      if (code === 0x3E /* > */) {\n        result.pos = pos + 1;\n        result.str = unescapeAll(str.slice(start + 1, pos));\n        result.ok = true;\n        return result;\n      }\n      if (code === 0x5C /* \\ */ && pos + 1 < max) {\n        pos += 2;\n        continue;\n      }\n\n      pos++;\n    }\n\n    // no closing '>'\n    return result;\n  }\n\n  // this should be ... } else { ... branch\n\n  level = 0;\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n\n    if (code === 0x20) { break; }\n\n    // ascii control characters\n    if (code < 0x20 || code === 0x7F) { break; }\n\n    if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      pos += 2;\n      continue;\n    }\n\n    if (code === 0x28 /* ( */) {\n      level++;\n    }\n\n    if (code === 0x29 /* ) */) {\n      if (level === 0) { break; }\n      level--;\n    }\n\n    pos++;\n  }\n\n  if (start === pos) { return result; }\n  if (level !== 0) { return result; }\n\n  result.str = unescapeAll(str.slice(start, pos));\n  result.lines = lines;\n  result.pos = pos;\n  result.ok = true;\n  return result;\n};\n","// Parse link title\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkTitle(str, pos, max) {\n  var code,\n      marker,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (pos >= max) { return result; }\n\n  marker = str.charCodeAt(pos);\n\n  if (marker !== 0x22 /* \" */ && marker !== 0x27 /* ' */ && marker !== 0x28 /* ( */) { return result; }\n\n  pos++;\n\n  // if opening marker is \"(\", switch it to closing marker \")\"\n  if (marker === 0x28) { marker = 0x29; }\n\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n    if (code === marker) {\n      result.pos = pos + 1;\n      result.lines = lines;\n      result.str = unescapeAll(str.slice(start + 1, pos));\n      result.ok = true;\n      return result;\n    } else if (code === 0x0A) {\n      lines++;\n    } else if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      pos++;\n      if (str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n\n    pos++;\n  }\n\n  return result;\n};\n","/**\n * class Renderer\n *\n * Generates HTML from parsed token stream. Each instance has independent\n * copy of rules. Those can be rewritten with ease. Also, you can add new\n * rules if you create plugin and adds new token types.\n **/\n'use strict';\n\n\nvar assign          = require('./common/utils').assign;\nvar unescapeAll     = require('./common/utils').unescapeAll;\nvar escapeHtml      = require('./common/utils').escapeHtml;\n\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar default_rules = {};\n\n\ndefault_rules.code_inline = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<code' + slf.renderAttrs(token) + '>' +\n          escapeHtml(tokens[idx].content) +\n          '</code>';\n};\n\n\ndefault_rules.code_block = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<pre' + slf.renderAttrs(token) + '><code>' +\n          escapeHtml(tokens[idx].content) +\n          '</code></pre>\\n';\n};\n\n\ndefault_rules.fence = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx],\n      info = token.info ? unescapeAll(token.info).trim() : '',\n      langName = '',\n      highlighted, i, tmpAttrs, tmpToken;\n\n  if (info) {\n    langName = info.split(/\\s+/g)[0];\n  }\n\n  if (options.highlight) {\n    highlighted = options.highlight(token.content, langName) || escapeHtml(token.content);\n  } else {\n    highlighted = escapeHtml(token.content);\n  }\n\n  if (highlighted.indexOf('<pre') === 0) {\n    return highlighted + '\\n';\n  }\n\n  // If language exists, inject class gently, without modifying original token.\n  // May be, one day we will add .clone() for token and simplify this part, but\n  // now we prefer to keep things local.\n  if (info) {\n    i        = token.attrIndex('class');\n    tmpAttrs = token.attrs ? token.attrs.slice() : [];\n\n    if (i < 0) {\n      tmpAttrs.push([ 'class', options.langPrefix + langName ]);\n    } else {\n      tmpAttrs[i][1] += ' ' + options.langPrefix + langName;\n    }\n\n    // Fake token just to render attributes\n    tmpToken = {\n      attrs: tmpAttrs\n    };\n\n    return  '<pre><code' + slf.renderAttrs(tmpToken) + '>'\n          + highlighted\n          + '</code></pre>\\n';\n  }\n\n\n  return  '<pre><code' + slf.renderAttrs(token) + '>'\n        + highlighted\n        + '</code></pre>\\n';\n};\n\n\ndefault_rules.image = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  // \"alt\" attr MUST be set, even if empty. Because it's mandatory and\n  // should be placed on proper position for tests.\n  //\n  // Replace content with actual value\n\n  token.attrs[token.attrIndex('alt')][1] =\n    slf.renderInlineAsText(token.children, options, env);\n\n  return slf.renderToken(tokens, idx, options);\n};\n\n\ndefault_rules.hardbreak = function (tokens, idx, options /*, env */) {\n  return options.xhtmlOut ? '<br />\\n' : '<br>\\n';\n};\ndefault_rules.softbreak = function (tokens, idx, options /*, env */) {\n  return options.breaks ? (options.xhtmlOut ? '<br />\\n' : '<br>\\n') : '\\n';\n};\n\n\ndefault_rules.text = function (tokens, idx /*, options, env */) {\n  return escapeHtml(tokens[idx].content);\n};\n\n\ndefault_rules.html_block = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\ndefault_rules.html_inline = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\n\n\n/**\n * new Renderer()\n *\n * Creates new [[Renderer]] instance and fill [[Renderer#rules]] with defaults.\n **/\nfunction Renderer() {\n\n  /**\n   * Renderer#rules -> Object\n   *\n   * Contains render rules for tokens. Can be updated and extended.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * md.renderer.rules.strong_open  = function () { return '<b>'; };\n   * md.renderer.rules.strong_close = function () { return '</b>'; };\n   *\n   * var result = md.renderInline(...);\n   * ```\n   *\n   * Each rule is called as independent static function with fixed signature:\n   *\n   * ```javascript\n   * function my_token_render(tokens, idx, options, env, renderer) {\n   *   // ...\n   *   return renderedHTML;\n   * }\n   * ```\n   *\n   * See [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js)\n   * for more details and examples.\n   **/\n  this.rules = assign({}, default_rules);\n}\n\n\n/**\n * Renderer.renderAttrs(token) -> String\n *\n * Render token attributes to string.\n **/\nRenderer.prototype.renderAttrs = function renderAttrs(token) {\n  var i, l, result;\n\n  if (!token.attrs) { return ''; }\n\n  result = '';\n\n  for (i = 0, l = token.attrs.length; i < l; i++) {\n    result += ' ' + escapeHtml(token.attrs[i][0]) + '=\"' + escapeHtml(token.attrs[i][1]) + '\"';\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.renderToken(tokens, idx, options) -> String\n * - tokens (Array): list of tokens\n * - idx (Numbed): token index to render\n * - options (Object): params of parser instance\n *\n * Default token renderer. Can be overriden by custom function\n * in [[Renderer#rules]].\n **/\nRenderer.prototype.renderToken = function renderToken(tokens, idx, options) {\n  var nextToken,\n      result = '',\n      needLf = false,\n      token = tokens[idx];\n\n  // Tight list paragraphs\n  if (token.hidden) {\n    return '';\n  }\n\n  // Insert a newline between hidden paragraph and subsequent opening\n  // block-level tag.\n  //\n  // For example, here we should insert a newline before blockquote:\n  //  - a\n  //    >\n  //\n  if (token.block && token.nesting !== -1 && idx && tokens[idx - 1].hidden) {\n    result += '\\n';\n  }\n\n  // Add token name, e.g. `<img`\n  result += (token.nesting === -1 ? '</' : '<') + token.tag;\n\n  // Encode attributes, e.g. `<img src=\"foo\"`\n  result += this.renderAttrs(token);\n\n  // Add a slash for self-closing tags, e.g. `<img src=\"foo\" /`\n  if (token.nesting === 0 && options.xhtmlOut) {\n    result += ' /';\n  }\n\n  // Check if we need to add a newline after this tag\n  if (token.block) {\n    needLf = true;\n\n    if (token.nesting === 1) {\n      if (idx + 1 < tokens.length) {\n        nextToken = tokens[idx + 1];\n\n        if (nextToken.type === 'inline' || nextToken.hidden) {\n          // Block-level tag containing an inline tag.\n          //\n          needLf = false;\n\n        } else if (nextToken.nesting === -1 && nextToken.tag === token.tag) {\n          // Opening tag + closing tag of the same type. E.g. `<li></li>`.\n          //\n          needLf = false;\n        }\n      }\n    }\n  }\n\n  result += needLf ? '>\\n' : '>';\n\n  return result;\n};\n\n\n/**\n * Renderer.renderInline(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to renter\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * The same as [[Renderer.render]], but for single token of `inline` type.\n **/\nRenderer.prototype.renderInline = function (tokens, options, env) {\n  var type,\n      result = '',\n      rules = this.rules;\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (typeof rules[type] !== 'undefined') {\n      result += rules[type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options);\n    }\n  }\n\n  return result;\n};\n\n\n/** internal\n * Renderer.renderInlineAsText(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to renter\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Special kludge for image `alt` attributes to conform CommonMark spec.\n * Don't try to use it! Spec requires to show `alt` content with stripped markup,\n * instead of simple escaping.\n **/\nRenderer.prototype.renderInlineAsText = function (tokens, options, env) {\n  var result = '';\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    if (tokens[i].type === 'text') {\n      result += tokens[i].content;\n    } else if (tokens[i].type === 'image') {\n      result += this.renderInlineAsText(tokens[i].children, options, env);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.render(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to renter\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Takes token stream and generates HTML. Probably, you will never need to call\n * this method directly.\n **/\nRenderer.prototype.render = function (tokens, options, env) {\n  var i, len, type,\n      result = '',\n      rules = this.rules;\n\n  for (i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (type === 'inline') {\n      result += this.renderInline(tokens[i].children, options, env);\n    } else if (typeof rules[type] !== 'undefined') {\n      result += rules[tokens[i].type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options, env);\n    }\n  }\n\n  return result;\n};\n\nmodule.exports = Renderer;\n","/** internal\n * class Core\n *\n * Top-level rules executor. Glues block/inline parsers and does intermediate\n * transformations.\n **/\n'use strict';\n\n\nvar Ruler  = require('./ruler');\n\n\nvar _rules = [\n  [ 'normalize',      require('./rules_core/normalize')      ],\n  [ 'block',          require('./rules_core/block')          ],\n  [ 'inline',         require('./rules_core/inline')         ],\n  [ 'linkify',        require('./rules_core/linkify')        ],\n  [ 'replacements',   require('./rules_core/replacements')   ],\n  [ 'smartquotes',    require('./rules_core/smartquotes')    ]\n];\n\n\n/**\n * new Core()\n **/\nfunction Core() {\n  /**\n   * Core#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of core rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n}\n\n\n/**\n * Core.process(state)\n *\n * Executes core chain rules.\n **/\nCore.prototype.process = function (state) {\n  var i, l, rules;\n\n  rules = this.ruler.getRules('');\n\n  for (i = 0, l = rules.length; i < l; i++) {\n    rules[i](state);\n  }\n};\n\nCore.prototype.State = require('./rules_core/state_core');\n\n\nmodule.exports = Core;\n","// Normalize input string\n\n'use strict';\n\n\n// https://spec.commonmark.org/0.29/#line-ending\nvar NEWLINES_RE  = /\\r\\n?|\\n/g;\nvar NULL_RE      = /\\0/g;\n\n\nmodule.exports = function normalize(state) {\n  var str;\n\n  // Normalize newlines\n  str = state.src.replace(NEWLINES_RE, '\\n');\n\n  // Replace NULL characters\n  str = str.replace(NULL_RE, '\\uFFFD');\n\n  state.src = str;\n};\n","'use strict';\n\n\nmodule.exports = function block(state) {\n  var token;\n\n  if (state.inlineMode) {\n    token          = new state.Token('inline', '', 0);\n    token.content  = state.src;\n    token.map      = [ 0, 1 ];\n    token.children = [];\n    state.tokens.push(token);\n  } else {\n    state.md.block.parse(state.src, state.md, state.env, state.tokens);\n  }\n};\n","'use strict';\n\nmodule.exports = function inline(state) {\n  var tokens = state.tokens, tok, i, l;\n\n  // Parse inlines\n  for (i = 0, l = tokens.length; i < l; i++) {\n    tok = tokens[i];\n    if (tok.type === 'inline') {\n      state.md.inline.parse(tok.content, state.md, state.env, tok.children);\n    }\n  }\n};\n","// Replace link-like texts with link nodes.\n//\n// Currently restricted by `md.validateLink()` to http/https/ftp\n//\n'use strict';\n\n\nvar arrayReplaceAt = require('../common/utils').arrayReplaceAt;\n\n\nfunction isLinkOpen(str) {\n  return /^<a[>\\s]/i.test(str);\n}\nfunction isLinkClose(str) {\n  return /^<\\/a\\s*>/i.test(str);\n}\n\n\nmodule.exports = function linkify(state) {\n  var i, j, l, tokens, token, currentToken, nodes, ln, text, pos, lastPos,\n      level, htmlLinkLevel, url, fullUrl, urlText,\n      blockTokens = state.tokens,\n      links;\n\n  if (!state.md.options.linkify) { return; }\n\n  for (j = 0, l = blockTokens.length; j < l; j++) {\n    if (blockTokens[j].type !== 'inline' ||\n        !state.md.linkify.pretest(blockTokens[j].content)) {\n      continue;\n    }\n\n    tokens = blockTokens[j].children;\n\n    htmlLinkLevel = 0;\n\n    // We scan from the end, to keep position when new tags added.\n    // Use reversed logic in links start/end match\n    for (i = tokens.length - 1; i >= 0; i--) {\n      currentToken = tokens[i];\n\n      // Skip content of markdown links\n      if (currentToken.type === 'link_close') {\n        i--;\n        while (tokens[i].level !== currentToken.level && tokens[i].type !== 'link_open') {\n          i--;\n        }\n        continue;\n      }\n\n      // Skip content of html tag links\n      if (currentToken.type === 'html_inline') {\n        if (isLinkOpen(currentToken.content) && htmlLinkLevel > 0) {\n          htmlLinkLevel--;\n        }\n        if (isLinkClose(currentToken.content)) {\n          htmlLinkLevel++;\n        }\n      }\n      if (htmlLinkLevel > 0) { continue; }\n\n      if (currentToken.type === 'text' && state.md.linkify.test(currentToken.content)) {\n\n        text = currentToken.content;\n        links = state.md.linkify.match(text);\n\n        // Now split string to nodes\n        nodes = [];\n        level = currentToken.level;\n        lastPos = 0;\n\n        for (ln = 0; ln < links.length; ln++) {\n\n          url = links[ln].url;\n          fullUrl = state.md.normalizeLink(url);\n          if (!state.md.validateLink(fullUrl)) { continue; }\n\n          urlText = links[ln].text;\n\n          // Linkifier might send raw hostnames like \"example.com\", where url\n          // starts with domain name. So we prepend http:// in those cases,\n          // and remove it afterwards.\n          //\n          if (!links[ln].schema) {\n            urlText = state.md.normalizeLinkText('http://' + urlText).replace(/^http:\\/\\//, '');\n          } else if (links[ln].schema === 'mailto:' && !/^mailto:/i.test(urlText)) {\n            urlText = state.md.normalizeLinkText('mailto:' + urlText).replace(/^mailto:/, '');\n          } else {\n            urlText = state.md.normalizeLinkText(urlText);\n          }\n\n          pos = links[ln].index;\n\n          if (pos > lastPos) {\n            token         = new state.Token('text', '', 0);\n            token.content = text.slice(lastPos, pos);\n            token.level   = level;\n            nodes.push(token);\n          }\n\n          token         = new state.Token('link_open', 'a', 1);\n          token.attrs   = [ [ 'href', fullUrl ] ];\n          token.level   = level++;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          token         = new state.Token('text', '', 0);\n          token.content = urlText;\n          token.level   = level;\n          nodes.push(token);\n\n          token         = new state.Token('link_close', 'a', -1);\n          token.level   = --level;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          lastPos = links[ln].lastIndex;\n        }\n        if (lastPos < text.length) {\n          token         = new state.Token('text', '', 0);\n          token.content = text.slice(lastPos);\n          token.level   = level;\n          nodes.push(token);\n        }\n\n        // replace current node\n        blockTokens[j].children = tokens = arrayReplaceAt(tokens, i, nodes);\n      }\n    }\n  }\n};\n","// Simple typographic replacements\n//\n// (c) (C) → ©\n// (tm) (TM) → ™\n// (r) (R) → ®\n// +- → ±\n// (p) (P) -> §\n// ... → … (also ?.... → ?.., !.... → !..)\n// ???????? → ???, !!!!! → !!!, `,,` → `,`\n// -- → &ndash;, --- → &mdash;\n//\n'use strict';\n\n// TODO:\n// - fractionals 1/2, 1/4, 3/4 -> ½, ¼, ¾\n// - miltiplication 2 x 4 -> 2 × 4\n\nvar RARE_RE = /\\+-|\\.\\.|\\?\\?\\?\\?|!!!!|,,|--/;\n\n// Workaround for phantomjs - need regex without /g flag,\n// or root check will fail every second time\nvar SCOPED_ABBR_TEST_RE = /\\((c|tm|r|p)\\)/i;\n\nvar SCOPED_ABBR_RE = /\\((c|tm|r|p)\\)/ig;\nvar SCOPED_ABBR = {\n  c: '©',\n  r: '®',\n  p: '§',\n  tm: '™'\n};\n\nfunction replaceFn(match, name) {\n  return SCOPED_ABBR[name.toLowerCase()];\n}\n\nfunction replace_scoped(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      token.content = token.content.replace(SCOPED_ABBR_RE, replaceFn);\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\nfunction replace_rare(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      if (RARE_RE.test(token.content)) {\n        token.content = token.content\n          .replace(/\\+-/g, '±')\n          // .., ..., ....... -> …\n          // but ?..... & !..... -> ?.. & !..\n          .replace(/\\.{2,}/g, '…').replace(/([?!])…/g, '$1..')\n          .replace(/([?!]){4,}/g, '$1$1$1').replace(/,{2,}/g, ',')\n          // em-dash\n          .replace(/(^|[^-])---([^-]|$)/mg, '$1\\u2014$2')\n          // en-dash\n          .replace(/(^|\\s)--(\\s|$)/mg, '$1\\u2013$2')\n          .replace(/(^|[^-\\s])--([^-\\s]|$)/mg, '$1\\u2013$2');\n      }\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\n\nmodule.exports = function replace(state) {\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline') { continue; }\n\n    if (SCOPED_ABBR_TEST_RE.test(state.tokens[blkIdx].content)) {\n      replace_scoped(state.tokens[blkIdx].children);\n    }\n\n    if (RARE_RE.test(state.tokens[blkIdx].content)) {\n      replace_rare(state.tokens[blkIdx].children);\n    }\n\n  }\n};\n","// Convert straight quotation marks to typographic ones\n//\n'use strict';\n\n\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\nvar QUOTE_TEST_RE = /['\"]/;\nvar QUOTE_RE = /['\"]/g;\nvar APOSTROPHE = '\\u2019'; /* ’ */\n\n\nfunction replaceAt(str, index, ch) {\n  return str.substr(0, index) + ch + str.substr(index + 1);\n}\n\nfunction process_inlines(tokens, state) {\n  var i, token, text, t, pos, max, thisLevel, item, lastChar, nextChar,\n      isLastPunctChar, isNextPunctChar, isLastWhiteSpace, isNextWhiteSpace,\n      canOpen, canClose, j, isSingle, stack, openQuote, closeQuote;\n\n  stack = [];\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    thisLevel = tokens[i].level;\n\n    for (j = stack.length - 1; j >= 0; j--) {\n      if (stack[j].level <= thisLevel) { break; }\n    }\n    stack.length = j + 1;\n\n    if (token.type !== 'text') { continue; }\n\n    text = token.content;\n    pos = 0;\n    max = text.length;\n\n    /*eslint no-labels:0,block-scoped-var:0*/\n    OUTER:\n    while (pos < max) {\n      QUOTE_RE.lastIndex = pos;\n      t = QUOTE_RE.exec(text);\n      if (!t) { break; }\n\n      canOpen = canClose = true;\n      pos = t.index + 1;\n      isSingle = (t[0] === \"'\");\n\n      // Find previous character,\n      // default to space if it's the beginning of the line\n      //\n      lastChar = 0x20;\n\n      if (t.index - 1 >= 0) {\n        lastChar = text.charCodeAt(t.index - 1);\n      } else {\n        for (j = i - 1; j >= 0; j--) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // lastChar defaults to 0x20\n          if (tokens[j].type !== 'text') continue;\n\n          lastChar = tokens[j].content.charCodeAt(tokens[j].content.length - 1);\n          break;\n        }\n      }\n\n      // Find next character,\n      // default to space if it's the end of the line\n      //\n      nextChar = 0x20;\n\n      if (pos < max) {\n        nextChar = text.charCodeAt(pos);\n      } else {\n        for (j = i + 1; j < tokens.length; j++) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // nextChar defaults to 0x20\n          if (tokens[j].type !== 'text') continue;\n\n          nextChar = tokens[j].content.charCodeAt(0);\n          break;\n        }\n      }\n\n      isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n      isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n      isLastWhiteSpace = isWhiteSpace(lastChar);\n      isNextWhiteSpace = isWhiteSpace(nextChar);\n\n      if (isNextWhiteSpace) {\n        canOpen = false;\n      } else if (isNextPunctChar) {\n        if (!(isLastWhiteSpace || isLastPunctChar)) {\n          canOpen = false;\n        }\n      }\n\n      if (isLastWhiteSpace) {\n        canClose = false;\n      } else if (isLastPunctChar) {\n        if (!(isNextWhiteSpace || isNextPunctChar)) {\n          canClose = false;\n        }\n      }\n\n      if (nextChar === 0x22 /* \" */ && t[0] === '\"') {\n        if (lastChar >= 0x30 /* 0 */ && lastChar <= 0x39 /* 9 */) {\n          // special case: 1\"\" - count first quote as an inch\n          canClose = canOpen = false;\n        }\n      }\n\n      if (canOpen && canClose) {\n        // treat this as the middle of the word\n        canOpen = false;\n        canClose = isNextPunctChar;\n      }\n\n      if (!canOpen && !canClose) {\n        // middle of word\n        if (isSingle) {\n          token.content = replaceAt(token.content, t.index, APOSTROPHE);\n        }\n        continue;\n      }\n\n      if (canClose) {\n        // this could be a closing quote, rewind the stack to get a match\n        for (j = stack.length - 1; j >= 0; j--) {\n          item = stack[j];\n          if (stack[j].level < thisLevel) { break; }\n          if (item.single === isSingle && stack[j].level === thisLevel) {\n            item = stack[j];\n\n            if (isSingle) {\n              openQuote = state.md.options.quotes[2];\n              closeQuote = state.md.options.quotes[3];\n            } else {\n              openQuote = state.md.options.quotes[0];\n              closeQuote = state.md.options.quotes[1];\n            }\n\n            // replace token.content *before* tokens[item.token].content,\n            // because, if they are pointing at the same token, replaceAt\n            // could mess up indices when quote length != 1\n            token.content = replaceAt(token.content, t.index, closeQuote);\n            tokens[item.token].content = replaceAt(\n              tokens[item.token].content, item.pos, openQuote);\n\n            pos += closeQuote.length - 1;\n            if (item.token === i) { pos += openQuote.length - 1; }\n\n            text = token.content;\n            max = text.length;\n\n            stack.length = j;\n            continue OUTER;\n          }\n        }\n      }\n\n      if (canOpen) {\n        stack.push({\n          token: i,\n          pos: t.index,\n          single: isSingle,\n          level: thisLevel\n        });\n      } else if (canClose && isSingle) {\n        token.content = replaceAt(token.content, t.index, APOSTROPHE);\n      }\n    }\n  }\n}\n\n\nmodule.exports = function smartquotes(state) {\n  /*eslint max-depth:0*/\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline' ||\n        !QUOTE_TEST_RE.test(state.tokens[blkIdx].content)) {\n      continue;\n    }\n\n    process_inlines(state.tokens[blkIdx].children, state);\n  }\n};\n","// Core state object\n//\n'use strict';\n\nvar Token = require('../token');\n\n\nfunction StateCore(src, md, env) {\n  this.src = src;\n  this.env = env;\n  this.tokens = [];\n  this.inlineMode = false;\n  this.md = md; // link to parser instance\n}\n\n// re-export Token class to use in core rules\nStateCore.prototype.Token = Token;\n\n\nmodule.exports = StateCore;\n","/** internal\n * class ParserBlock\n *\n * Block-level tokenizer.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\nvar _rules = [\n  // First 2 params - rule name & source. Secondary array - list of rules,\n  // which can be terminated by this one.\n  [ 'table',      require('./rules_block/table'),      [ 'paragraph', 'reference' ] ],\n  [ 'code',       require('./rules_block/code') ],\n  [ 'fence',      require('./rules_block/fence'),      [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'blockquote', require('./rules_block/blockquote'), [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'hr',         require('./rules_block/hr'),         [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'list',       require('./rules_block/list'),       [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'reference',  require('./rules_block/reference') ],\n  [ 'heading',    require('./rules_block/heading'),    [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'lheading',   require('./rules_block/lheading') ],\n  [ 'html_block', require('./rules_block/html_block'), [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'paragraph',  require('./rules_block/paragraph') ]\n];\n\n\n/**\n * new ParserBlock()\n **/\nfunction ParserBlock() {\n  /**\n   * ParserBlock#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of block rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1], { alt: (_rules[i][2] || []).slice() });\n  }\n}\n\n\n// Generate tokens for input range\n//\nParserBlock.prototype.tokenize = function (state, startLine, endLine) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      line = startLine,\n      hasEmptyLines = false,\n      maxNesting = state.md.options.maxNesting;\n\n  while (line < endLine) {\n    state.line = line = state.skipEmptyLines(line);\n    if (line >= endLine) { break; }\n\n    // Termination condition for nested calls.\n    // Nested calls currently used for blockquotes & lists\n    if (state.sCount[line] < state.blkIndent) { break; }\n\n    // If nesting level exceeded - skip tail to the end. That's not ordinary\n    // situation and we should not care about content.\n    if (state.level >= maxNesting) {\n      state.line = endLine;\n      break;\n    }\n\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.line`\n    // - update `state.tokens`\n    // - return true\n\n    for (i = 0; i < len; i++) {\n      ok = rules[i](state, line, endLine, false);\n      if (ok) { break; }\n    }\n\n    // set state.tight if we had an empty line before current tag\n    // i.e. latest empty line should not count\n    state.tight = !hasEmptyLines;\n\n    // paragraph might \"eat\" one newline after it in nested lists\n    if (state.isEmpty(state.line - 1)) {\n      hasEmptyLines = true;\n    }\n\n    line = state.line;\n\n    if (line < endLine && state.isEmpty(line)) {\n      hasEmptyLines = true;\n      line++;\n      state.line = line;\n    }\n  }\n};\n\n\n/**\n * ParserBlock.parse(str, md, env, outTokens)\n *\n * Process input string and push block tokens into `outTokens`\n **/\nParserBlock.prototype.parse = function (src, md, env, outTokens) {\n  var state;\n\n  if (!src) { return; }\n\n  state = new this.State(src, md, env, outTokens);\n\n  this.tokenize(state, state.line, state.lineMax);\n};\n\n\nParserBlock.prototype.State = require('./rules_block/state_block');\n\n\nmodule.exports = ParserBlock;\n","// GFM table, non-standard\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction getLine(state, line) {\n  var pos = state.bMarks[line] + state.blkIndent,\n      max = state.eMarks[line];\n\n  return state.src.substr(pos, max - pos);\n}\n\nfunction escapedSplit(str) {\n  var result = [],\n      pos = 0,\n      max = str.length,\n      ch,\n      escapes = 0,\n      lastPos = 0,\n      backTicked = false,\n      lastBackTick = 0;\n\n  ch  = str.charCodeAt(pos);\n\n  while (pos < max) {\n    if (ch === 0x60/* ` */) {\n      if (backTicked) {\n        // make \\` close code sequence, but not open it;\n        // the reason is: `\\` is correct code block\n        backTicked = false;\n        lastBackTick = pos;\n      } else if (escapes % 2 === 0) {\n        backTicked = true;\n        lastBackTick = pos;\n      }\n    } else if (ch === 0x7c/* | */ && (escapes % 2 === 0) && !backTicked) {\n      result.push(str.substring(lastPos, pos));\n      lastPos = pos + 1;\n    }\n\n    if (ch === 0x5c/* \\ */) {\n      escapes++;\n    } else {\n      escapes = 0;\n    }\n\n    pos++;\n\n    // If there was an un-closed backtick, go back to just after\n    // the last backtick, but as if it was a normal character\n    if (pos === max && backTicked) {\n      backTicked = false;\n      pos = lastBackTick + 1;\n    }\n\n    ch = str.charCodeAt(pos);\n  }\n\n  result.push(str.substring(lastPos));\n\n  return result;\n}\n\n\nmodule.exports = function table(state, startLine, endLine, silent) {\n  var ch, lineText, pos, i, nextLine, columns, columnCount, token,\n      aligns, t, tableLines, tbodyLines;\n\n  // should have at least two lines\n  if (startLine + 2 > endLine) { return false; }\n\n  nextLine = startLine + 1;\n\n  if (state.sCount[nextLine] < state.blkIndent) { return false; }\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[nextLine] - state.blkIndent >= 4) { return false; }\n\n  // first character of the second line should be '|', '-', ':',\n  // and no other characters are allowed but spaces;\n  // basically, this is the equivalent of /^[-:|][-:|\\s]*$/ regexp\n\n  pos = state.bMarks[nextLine] + state.tShift[nextLine];\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  ch = state.src.charCodeAt(pos++);\n  if (ch !== 0x7C/* | */ && ch !== 0x2D/* - */ && ch !== 0x3A/* : */) { return false; }\n\n  while (pos < state.eMarks[nextLine]) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch !== 0x7C/* | */ && ch !== 0x2D/* - */ && ch !== 0x3A/* : */ && !isSpace(ch)) { return false; }\n\n    pos++;\n  }\n\n  lineText = getLine(state, startLine + 1);\n\n  columns = lineText.split('|');\n  aligns = [];\n  for (i = 0; i < columns.length; i++) {\n    t = columns[i].trim();\n    if (!t) {\n      // allow empty columns before and after table, but not in between columns;\n      // e.g. allow ` |---| `, disallow ` ---||--- `\n      if (i === 0 || i === columns.length - 1) {\n        continue;\n      } else {\n        return false;\n      }\n    }\n\n    if (!/^:?-+:?$/.test(t)) { return false; }\n    if (t.charCodeAt(t.length - 1) === 0x3A/* : */) {\n      aligns.push(t.charCodeAt(0) === 0x3A/* : */ ? 'center' : 'right');\n    } else if (t.charCodeAt(0) === 0x3A/* : */) {\n      aligns.push('left');\n    } else {\n      aligns.push('');\n    }\n  }\n\n  lineText = getLine(state, startLine).trim();\n  if (lineText.indexOf('|') === -1) { return false; }\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n  columns = escapedSplit(lineText.replace(/^\\||\\|$/g, ''));\n\n  // header row will define an amount of columns in the entire table,\n  // and align row shouldn't be smaller than that (the rest of the rows can)\n  columnCount = columns.length;\n  if (columnCount > aligns.length) { return false; }\n\n  if (silent) { return true; }\n\n  token     = state.push('table_open', 'table', 1);\n  token.map = tableLines = [ startLine, 0 ];\n\n  token     = state.push('thead_open', 'thead', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  token     = state.push('tr_open', 'tr', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  for (i = 0; i < columns.length; i++) {\n    token          = state.push('th_open', 'th', 1);\n    token.map      = [ startLine, startLine + 1 ];\n    if (aligns[i]) {\n      token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n    }\n\n    token          = state.push('inline', '', 0);\n    token.content  = columns[i].trim();\n    token.map      = [ startLine, startLine + 1 ];\n    token.children = [];\n\n    token          = state.push('th_close', 'th', -1);\n  }\n\n  token     = state.push('tr_close', 'tr', -1);\n  token     = state.push('thead_close', 'thead', -1);\n\n  token     = state.push('tbody_open', 'tbody', 1);\n  token.map = tbodyLines = [ startLine + 2, 0 ];\n\n  for (nextLine = startLine + 2; nextLine < endLine; nextLine++) {\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    lineText = getLine(state, nextLine).trim();\n    if (lineText.indexOf('|') === -1) { break; }\n    if (state.sCount[nextLine] - state.blkIndent >= 4) { break; }\n    columns = escapedSplit(lineText.replace(/^\\||\\|$/g, ''));\n\n    token = state.push('tr_open', 'tr', 1);\n    for (i = 0; i < columnCount; i++) {\n      token          = state.push('td_open', 'td', 1);\n      if (aligns[i]) {\n        token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n      }\n\n      token          = state.push('inline', '', 0);\n      token.content  = columns[i] ? columns[i].trim() : '';\n      token.children = [];\n\n      token          = state.push('td_close', 'td', -1);\n    }\n    token = state.push('tr_close', 'tr', -1);\n  }\n  token = state.push('tbody_close', 'tbody', -1);\n  token = state.push('table_close', 'table', -1);\n\n  tableLines[1] = tbodyLines[1] = nextLine;\n  state.line = nextLine;\n  return true;\n};\n","// Code block (4 spaces padded)\n\n'use strict';\n\n\nmodule.exports = function code(state, startLine, endLine/*, silent*/) {\n  var nextLine, last, token;\n\n  if (state.sCount[startLine] - state.blkIndent < 4) { return false; }\n\n  last = nextLine = startLine + 1;\n\n  while (nextLine < endLine) {\n    if (state.isEmpty(nextLine)) {\n      nextLine++;\n      continue;\n    }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      nextLine++;\n      last = nextLine;\n      continue;\n    }\n    break;\n  }\n\n  state.line = last;\n\n  token         = state.push('code_block', 'code', 0);\n  token.content = state.getLines(startLine, last, 4 + state.blkIndent, true);\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// fences (``` lang, ~~~ lang)\n\n'use strict';\n\n\nmodule.exports = function fence(state, startLine, endLine, silent) {\n  var marker, len, params, nextLine, mem, token, markup,\n      haveEndMarker = false,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (pos + 3 > max) { return false; }\n\n  marker = state.src.charCodeAt(pos);\n\n  if (marker !== 0x7E/* ~ */ && marker !== 0x60 /* ` */) {\n    return false;\n  }\n\n  // scan marker length\n  mem = pos;\n  pos = state.skipChars(pos, marker);\n\n  len = pos - mem;\n\n  if (len < 3) { return false; }\n\n  markup = state.src.slice(mem, pos);\n  params = state.src.slice(pos, max);\n\n  if (marker === 0x60 /* ` */) {\n    if (params.indexOf(String.fromCharCode(marker)) >= 0) {\n      return false;\n    }\n  }\n\n  // Since start is found, we can report success here in validation mode\n  if (silent) { return true; }\n\n  // search end of block\n  nextLine = startLine;\n\n  for (;;) {\n    nextLine++;\n    if (nextLine >= endLine) {\n      // unclosed block should be autoclosed by end of document.\n      // also block seems to be autoclosed by end of parent\n      break;\n    }\n\n    pos = mem = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos < max && state.sCount[nextLine] < state.blkIndent) {\n      // non-empty line with negative indent should stop the list:\n      // - ```\n      //  test\n      break;\n    }\n\n    if (state.src.charCodeAt(pos) !== marker) { continue; }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      // closing fence should be indented less than 4 spaces\n      continue;\n    }\n\n    pos = state.skipChars(pos, marker);\n\n    // closing code fence must be at least as long as the opening one\n    if (pos - mem < len) { continue; }\n\n    // make sure tail has spaces only\n    pos = state.skipSpaces(pos);\n\n    if (pos < max) { continue; }\n\n    haveEndMarker = true;\n    // found!\n    break;\n  }\n\n  // If a fence has heading spaces, they should be removed from its inner block\n  len = state.sCount[startLine];\n\n  state.line = nextLine + (haveEndMarker ? 1 : 0);\n\n  token         = state.push('fence', 'code', 0);\n  token.info    = params;\n  token.content = state.getLines(startLine + 1, nextLine, len, true);\n  token.markup  = markup;\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// Block quotes\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function blockquote(state, startLine, endLine, silent) {\n  var adjustTab,\n      ch,\n      i,\n      initial,\n      l,\n      lastLineEmpty,\n      lines,\n      nextLine,\n      offset,\n      oldBMarks,\n      oldBSCount,\n      oldIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      spaceAfterMarker,\n      terminate,\n      terminatorRules,\n      token,\n      wasOutdented,\n      oldLineMax = state.lineMax,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // check the block quote marker\n  if (state.src.charCodeAt(pos++) !== 0x3E/* > */) { return false; }\n\n  // we know that it's going to be a valid blockquote,\n  // so no point trying to find the end of it in silent mode\n  if (silent) { return true; }\n\n  // skip spaces after \">\" and re-calculate offset\n  initial = offset = state.sCount[startLine] + pos - (state.bMarks[startLine] + state.tShift[startLine]);\n\n  // skip one optional space after '>'\n  if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n    // ' >   test '\n    //     ^ -- position start of line here:\n    pos++;\n    initial++;\n    offset++;\n    adjustTab = false;\n    spaceAfterMarker = true;\n  } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n    spaceAfterMarker = true;\n\n    if ((state.bsCount[startLine] + offset) % 4 === 3) {\n      // '  >\\t  test '\n      //       ^ -- position start of line here (tab has width===1)\n      pos++;\n      initial++;\n      offset++;\n      adjustTab = false;\n    } else {\n      // ' >\\t  test '\n      //    ^ -- position start of line here + shift bsCount slightly\n      //         to make extra space appear\n      adjustTab = true;\n    }\n  } else {\n    spaceAfterMarker = false;\n  }\n\n  oldBMarks = [ state.bMarks[startLine] ];\n  state.bMarks[startLine] = pos;\n\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (isSpace(ch)) {\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[startLine] + (adjustTab ? 1 : 0)) % 4;\n      } else {\n        offset++;\n      }\n    } else {\n      break;\n    }\n\n    pos++;\n  }\n\n  oldBSCount = [ state.bsCount[startLine] ];\n  state.bsCount[startLine] = state.sCount[startLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n  lastLineEmpty = pos >= max;\n\n  oldSCount = [ state.sCount[startLine] ];\n  state.sCount[startLine] = offset - initial;\n\n  oldTShift = [ state.tShift[startLine] ];\n  state.tShift[startLine] = pos - state.bMarks[startLine];\n\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  oldParentType = state.parentType;\n  state.parentType = 'blockquote';\n  wasOutdented = false;\n\n  // Search the end of the block\n  //\n  // Block ends with either:\n  //  1. an empty line outside:\n  //     ```\n  //     > test\n  //\n  //     ```\n  //  2. an empty line inside:\n  //     ```\n  //     >\n  //     test\n  //     ```\n  //  3. another tag:\n  //     ```\n  //     > test\n  //      - - -\n  //     ```\n  for (nextLine = startLine + 1; nextLine < endLine; nextLine++) {\n    // check if it's outdented, i.e. it's inside list item and indented\n    // less than said list item:\n    //\n    // ```\n    // 1. anything\n    //    > current blockquote\n    // 2. checking this line\n    // ```\n    if (state.sCount[nextLine] < state.blkIndent) wasOutdented = true;\n\n    pos = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos >= max) {\n      // Case 1: line is not inside the blockquote, and this line is empty.\n      break;\n    }\n\n    if (state.src.charCodeAt(pos++) === 0x3E/* > */ && !wasOutdented) {\n      // This line is inside the blockquote.\n\n      // skip spaces after \">\" and re-calculate offset\n      initial = offset = state.sCount[nextLine] + pos - (state.bMarks[nextLine] + state.tShift[nextLine]);\n\n      // skip one optional space after '>'\n      if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n        // ' >   test '\n        //     ^ -- position start of line here:\n        pos++;\n        initial++;\n        offset++;\n        adjustTab = false;\n        spaceAfterMarker = true;\n      } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n        spaceAfterMarker = true;\n\n        if ((state.bsCount[nextLine] + offset) % 4 === 3) {\n          // '  >\\t  test '\n          //       ^ -- position start of line here (tab has width===1)\n          pos++;\n          initial++;\n          offset++;\n          adjustTab = false;\n        } else {\n          // ' >\\t  test '\n          //    ^ -- position start of line here + shift bsCount slightly\n          //         to make extra space appear\n          adjustTab = true;\n        }\n      } else {\n        spaceAfterMarker = false;\n      }\n\n      oldBMarks.push(state.bMarks[nextLine]);\n      state.bMarks[nextLine] = pos;\n\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n\n        if (isSpace(ch)) {\n          if (ch === 0x09) {\n            offset += 4 - (offset + state.bsCount[nextLine] + (adjustTab ? 1 : 0)) % 4;\n          } else {\n            offset++;\n          }\n        } else {\n          break;\n        }\n\n        pos++;\n      }\n\n      lastLineEmpty = pos >= max;\n\n      oldBSCount.push(state.bsCount[nextLine]);\n      state.bsCount[nextLine] = state.sCount[nextLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n      oldSCount.push(state.sCount[nextLine]);\n      state.sCount[nextLine] = offset - initial;\n\n      oldTShift.push(state.tShift[nextLine]);\n      state.tShift[nextLine] = pos - state.bMarks[nextLine];\n      continue;\n    }\n\n    // Case 2: line is not inside the blockquote, and the last line was empty.\n    if (lastLineEmpty) { break; }\n\n    // Case 3: another tag found.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) {\n      // Quirk to enforce \"hard termination mode\" for paragraphs;\n      // normally if you call `tokenize(state, startLine, nextLine)`,\n      // paragraphs will look below nextLine for paragraph continuation,\n      // but if blockquote is terminated by another tag, they shouldn't\n      state.lineMax = nextLine;\n\n      if (state.blkIndent !== 0) {\n        // state.blkIndent was non-zero, we now set it to zero,\n        // so we need to re-calculate all offsets to appear as\n        // if indent wasn't changed\n        oldBMarks.push(state.bMarks[nextLine]);\n        oldBSCount.push(state.bsCount[nextLine]);\n        oldTShift.push(state.tShift[nextLine]);\n        oldSCount.push(state.sCount[nextLine]);\n        state.sCount[nextLine] -= state.blkIndent;\n      }\n\n      break;\n    }\n\n    oldBMarks.push(state.bMarks[nextLine]);\n    oldBSCount.push(state.bsCount[nextLine]);\n    oldTShift.push(state.tShift[nextLine]);\n    oldSCount.push(state.sCount[nextLine]);\n\n    // A negative indentation means that this is a paragraph continuation\n    //\n    state.sCount[nextLine] = -1;\n  }\n\n  oldIndent = state.blkIndent;\n  state.blkIndent = 0;\n\n  token        = state.push('blockquote_open', 'blockquote', 1);\n  token.markup = '>';\n  token.map    = lines = [ startLine, 0 ];\n\n  state.md.block.tokenize(state, startLine, nextLine);\n\n  token        = state.push('blockquote_close', 'blockquote', -1);\n  token.markup = '>';\n\n  state.lineMax = oldLineMax;\n  state.parentType = oldParentType;\n  lines[1] = state.line;\n\n  // Restore original tShift; this might not be necessary since the parser\n  // has already been here, but just to make sure we can do that.\n  for (i = 0; i < oldTShift.length; i++) {\n    state.bMarks[i + startLine] = oldBMarks[i];\n    state.tShift[i + startLine] = oldTShift[i];\n    state.sCount[i + startLine] = oldSCount[i];\n    state.bsCount[i + startLine] = oldBSCount[i];\n  }\n  state.blkIndent = oldIndent;\n\n  return true;\n};\n","// Horizontal rule\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function hr(state, startLine, endLine, silent) {\n  var marker, cnt, ch, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  marker = state.src.charCodeAt(pos++);\n\n  // Check hr marker\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x5F/* _ */) {\n    return false;\n  }\n\n  // markers can be mixed with spaces, but there should be at least 3 of them\n\n  cnt = 1;\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos++);\n    if (ch !== marker && !isSpace(ch)) { return false; }\n    if (ch === marker) { cnt++; }\n  }\n\n  if (cnt < 3) { return false; }\n\n  if (silent) { return true; }\n\n  state.line = startLine + 1;\n\n  token        = state.push('hr', 'hr', 0);\n  token.map    = [ startLine, state.line ];\n  token.markup = Array(cnt + 1).join(String.fromCharCode(marker));\n\n  return true;\n};\n","// Lists\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\n// Search `[-+*][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipBulletListMarker(state, startLine) {\n  var marker, pos, max, ch;\n\n  pos = state.bMarks[startLine] + state.tShift[startLine];\n  max = state.eMarks[startLine];\n\n  marker = state.src.charCodeAt(pos++);\n  // Check bullet\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x2B/* + */) {\n    return -1;\n  }\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" -test \" - is not a list item\n      return -1;\n    }\n  }\n\n  return pos;\n}\n\n// Search `\\d+[.)][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipOrderedListMarker(state, startLine) {\n  var ch,\n      start = state.bMarks[startLine] + state.tShift[startLine],\n      pos = start,\n      max = state.eMarks[startLine];\n\n  // List marker should have at least 2 chars (digit + dot)\n  if (pos + 1 >= max) { return -1; }\n\n  ch = state.src.charCodeAt(pos++);\n\n  if (ch < 0x30/* 0 */ || ch > 0x39/* 9 */) { return -1; }\n\n  for (;;) {\n    // EOL -> fail\n    if (pos >= max) { return -1; }\n\n    ch = state.src.charCodeAt(pos++);\n\n    if (ch >= 0x30/* 0 */ && ch <= 0x39/* 9 */) {\n\n      // List marker should have no more than 9 digits\n      // (prevents integer overflow in browsers)\n      if (pos - start >= 10) { return -1; }\n\n      continue;\n    }\n\n    // found valid marker\n    if (ch === 0x29/* ) */ || ch === 0x2e/* . */) {\n      break;\n    }\n\n    return -1;\n  }\n\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" 1.test \" - is not a list item\n      return -1;\n    }\n  }\n  return pos;\n}\n\nfunction markTightParagraphs(state, idx) {\n  var i, l,\n      level = state.level + 2;\n\n  for (i = idx + 2, l = state.tokens.length - 2; i < l; i++) {\n    if (state.tokens[i].level === level && state.tokens[i].type === 'paragraph_open') {\n      state.tokens[i + 2].hidden = true;\n      state.tokens[i].hidden = true;\n      i += 2;\n    }\n  }\n}\n\n\nmodule.exports = function list(state, startLine, endLine, silent) {\n  var ch,\n      contentStart,\n      i,\n      indent,\n      indentAfterMarker,\n      initial,\n      isOrdered,\n      itemLines,\n      l,\n      listLines,\n      listTokIdx,\n      markerCharCode,\n      markerValue,\n      max,\n      nextLine,\n      offset,\n      oldListIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      oldTight,\n      pos,\n      posAfterMarker,\n      prevEmptyEnd,\n      start,\n      terminate,\n      terminatorRules,\n      token,\n      isTerminatingParagraph = false,\n      tight = true;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // Special case:\n  //  - item 1\n  //   - item 2\n  //    - item 3\n  //     - item 4\n  //      - this one is a paragraph continuation\n  if (state.listIndent >= 0 &&\n      state.sCount[startLine] - state.listIndent >= 4 &&\n      state.sCount[startLine] < state.blkIndent) {\n    return false;\n  }\n\n  // limit conditions when list can interrupt\n  // a paragraph (validation mode only)\n  if (silent && state.parentType === 'paragraph') {\n    // Next list item should still terminate previous list item;\n    //\n    // This code can fail if plugins use blkIndent as well as lists,\n    // but I hope the spec gets fixed long before that happens.\n    //\n    if (state.tShift[startLine] >= state.blkIndent) {\n      isTerminatingParagraph = true;\n    }\n  }\n\n  // Detect list type and position after marker\n  if ((posAfterMarker = skipOrderedListMarker(state, startLine)) >= 0) {\n    isOrdered = true;\n    start = state.bMarks[startLine] + state.tShift[startLine];\n    markerValue = Number(state.src.substr(start, posAfterMarker - start - 1));\n\n    // If we're starting a new ordered list right after\n    // a paragraph, it should start with 1.\n    if (isTerminatingParagraph && markerValue !== 1) return false;\n\n  } else if ((posAfterMarker = skipBulletListMarker(state, startLine)) >= 0) {\n    isOrdered = false;\n\n  } else {\n    return false;\n  }\n\n  // If we're starting a new unordered list right after\n  // a paragraph, first line should not be empty.\n  if (isTerminatingParagraph) {\n    if (state.skipSpaces(posAfterMarker) >= state.eMarks[startLine]) return false;\n  }\n\n  // We should terminate list on style change. Remember first one to compare.\n  markerCharCode = state.src.charCodeAt(posAfterMarker - 1);\n\n  // For validation mode we can terminate immediately\n  if (silent) { return true; }\n\n  // Start list\n  listTokIdx = state.tokens.length;\n\n  if (isOrdered) {\n    token       = state.push('ordered_list_open', 'ol', 1);\n    if (markerValue !== 1) {\n      token.attrs = [ [ 'start', markerValue ] ];\n    }\n\n  } else {\n    token       = state.push('bullet_list_open', 'ul', 1);\n  }\n\n  token.map    = listLines = [ startLine, 0 ];\n  token.markup = String.fromCharCode(markerCharCode);\n\n  //\n  // Iterate list items\n  //\n\n  nextLine = startLine;\n  prevEmptyEnd = false;\n  terminatorRules = state.md.block.ruler.getRules('list');\n\n  oldParentType = state.parentType;\n  state.parentType = 'list';\n\n  while (nextLine < endLine) {\n    pos = posAfterMarker;\n    max = state.eMarks[nextLine];\n\n    initial = offset = state.sCount[nextLine] + posAfterMarker - (state.bMarks[startLine] + state.tShift[startLine]);\n\n    while (pos < max) {\n      ch = state.src.charCodeAt(pos);\n\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[nextLine]) % 4;\n      } else if (ch === 0x20) {\n        offset++;\n      } else {\n        break;\n      }\n\n      pos++;\n    }\n\n    contentStart = pos;\n\n    if (contentStart >= max) {\n      // trimming space in \"-    \\n  3\" case, indent is 1 here\n      indentAfterMarker = 1;\n    } else {\n      indentAfterMarker = offset - initial;\n    }\n\n    // If we have more than 4 spaces, the indent is 1\n    // (the rest is just indented code block)\n    if (indentAfterMarker > 4) { indentAfterMarker = 1; }\n\n    // \"  -  test\"\n    //  ^^^^^ - calculating total length of this thing\n    indent = initial + indentAfterMarker;\n\n    // Run subparser & write tokens\n    token        = state.push('list_item_open', 'li', 1);\n    token.markup = String.fromCharCode(markerCharCode);\n    token.map    = itemLines = [ startLine, 0 ];\n\n    // change current state, then restore it after parser subcall\n    oldTight = state.tight;\n    oldTShift = state.tShift[startLine];\n    oldSCount = state.sCount[startLine];\n\n    //  - example list\n    // ^ listIndent position will be here\n    //   ^ blkIndent position will be here\n    //\n    oldListIndent = state.listIndent;\n    state.listIndent = state.blkIndent;\n    state.blkIndent = indent;\n\n    state.tight = true;\n    state.tShift[startLine] = contentStart - state.bMarks[startLine];\n    state.sCount[startLine] = offset;\n\n    if (contentStart >= max && state.isEmpty(startLine + 1)) {\n      // workaround for this case\n      // (list item is empty, list terminates before \"foo\"):\n      // ~~~~~~~~\n      //   -\n      //\n      //     foo\n      // ~~~~~~~~\n      state.line = Math.min(state.line + 2, endLine);\n    } else {\n      state.md.block.tokenize(state, startLine, endLine, true);\n    }\n\n    // If any of list item is tight, mark list as tight\n    if (!state.tight || prevEmptyEnd) {\n      tight = false;\n    }\n    // Item become loose if finish with empty line,\n    // but we should filter last element, because it means list finish\n    prevEmptyEnd = (state.line - startLine) > 1 && state.isEmpty(state.line - 1);\n\n    state.blkIndent = state.listIndent;\n    state.listIndent = oldListIndent;\n    state.tShift[startLine] = oldTShift;\n    state.sCount[startLine] = oldSCount;\n    state.tight = oldTight;\n\n    token        = state.push('list_item_close', 'li', -1);\n    token.markup = String.fromCharCode(markerCharCode);\n\n    nextLine = startLine = state.line;\n    itemLines[1] = nextLine;\n    contentStart = state.bMarks[startLine];\n\n    if (nextLine >= endLine) { break; }\n\n    //\n    // Try to check if list is terminated or continued.\n    //\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    // if it's indented more than 3 spaces, it should be a code block\n    if (state.sCount[startLine] - state.blkIndent >= 4) { break; }\n\n    // fail if terminating block found\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n\n    // fail if list has another type\n    if (isOrdered) {\n      posAfterMarker = skipOrderedListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n    } else {\n      posAfterMarker = skipBulletListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n    }\n\n    if (markerCharCode !== state.src.charCodeAt(posAfterMarker - 1)) { break; }\n  }\n\n  // Finalize list\n  if (isOrdered) {\n    token = state.push('ordered_list_close', 'ol', -1);\n  } else {\n    token = state.push('bullet_list_close', 'ul', -1);\n  }\n  token.markup = String.fromCharCode(markerCharCode);\n\n  listLines[1] = nextLine;\n  state.line = nextLine;\n\n  state.parentType = oldParentType;\n\n  // mark paragraphs tight if needed\n  if (tight) {\n    markTightParagraphs(state, listTokIdx);\n  }\n\n  return true;\n};\n","'use strict';\n\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function reference(state, startLine, _endLine, silent) {\n  var ch,\n      destEndPos,\n      destEndLineNo,\n      endLine,\n      href,\n      i,\n      l,\n      label,\n      labelEnd,\n      oldParentType,\n      res,\n      start,\n      str,\n      terminate,\n      terminatorRules,\n      title,\n      lines = 0,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine],\n      nextLine = startLine + 1;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x5B/* [ */) { return false; }\n\n  // Simple check to quickly interrupt scan on [link](url) at the start of line.\n  // Can be useful on practice: https://github.com/markdown-it/markdown-it/issues/54\n  while (++pos < max) {\n    if (state.src.charCodeAt(pos) === 0x5D /* ] */ &&\n        state.src.charCodeAt(pos - 1) !== 0x5C/* \\ */) {\n      if (pos + 1 === max) { return false; }\n      if (state.src.charCodeAt(pos + 1) !== 0x3A/* : */) { return false; }\n      break;\n    }\n  }\n\n  endLine = state.lineMax;\n\n  // jump line-by-line until empty one or EOF\n  terminatorRules = state.md.block.ruler.getRules('reference');\n\n  oldParentType = state.parentType;\n  state.parentType = 'reference';\n\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  str = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n  max = str.length;\n\n  for (pos = 1; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x5B /* [ */) {\n      return false;\n    } else if (ch === 0x5D /* ] */) {\n      labelEnd = pos;\n      break;\n    } else if (ch === 0x0A /* \\n */) {\n      lines++;\n    } else if (ch === 0x5C /* \\ */) {\n      pos++;\n      if (pos < max && str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n  }\n\n  if (labelEnd < 0 || str.charCodeAt(labelEnd + 1) !== 0x3A/* : */) { return false; }\n\n  // [label]:   destination   'title'\n  //         ^^^ skip optional whitespace here\n  for (pos = labelEnd + 2; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //            ^^^^^^^^^^^ parse this\n  res = state.md.helpers.parseLinkDestination(str, pos, max);\n  if (!res.ok) { return false; }\n\n  href = state.md.normalizeLink(res.str);\n  if (!state.md.validateLink(href)) { return false; }\n\n  pos = res.pos;\n  lines += res.lines;\n\n  // save cursor state, we could require to rollback later\n  destEndPos = pos;\n  destEndLineNo = lines;\n\n  // [label]:   destination   'title'\n  //                       ^^^ skipping those spaces\n  start = pos;\n  for (; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //                          ^^^^^^^ parse this\n  res = state.md.helpers.parseLinkTitle(str, pos, max);\n  if (pos < max && start !== pos && res.ok) {\n    title = res.str;\n    pos = res.pos;\n    lines += res.lines;\n  } else {\n    title = '';\n    pos = destEndPos;\n    lines = destEndLineNo;\n  }\n\n  // skip trailing spaces until the rest of the line\n  while (pos < max) {\n    ch = str.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n    pos++;\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    if (title) {\n      // garbage at the end of the line after title,\n      // but it could still be a valid reference if we roll back\n      title = '';\n      pos = destEndPos;\n      lines = destEndLineNo;\n      while (pos < max) {\n        ch = str.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n    }\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    // garbage at the end of the line\n    return false;\n  }\n\n  label = normalizeReference(str.slice(1, labelEnd));\n  if (!label) {\n    // CommonMark 0.20 disallows empty labels\n    return false;\n  }\n\n  // Reference can not terminate anything. This check is for safety only.\n  /*istanbul ignore if*/\n  if (silent) { return true; }\n\n  if (typeof state.env.references === 'undefined') {\n    state.env.references = {};\n  }\n  if (typeof state.env.references[label] === 'undefined') {\n    state.env.references[label] = { title: title, href: href };\n  }\n\n  state.parentType = oldParentType;\n\n  state.line = startLine + lines + 1;\n  return true;\n};\n","// heading (#, ##, ...)\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function heading(state, startLine, endLine, silent) {\n  var ch, level, tmp, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  ch  = state.src.charCodeAt(pos);\n\n  if (ch !== 0x23/* # */ || pos >= max) { return false; }\n\n  // count heading level\n  level = 1;\n  ch = state.src.charCodeAt(++pos);\n  while (ch === 0x23/* # */ && pos < max && level <= 6) {\n    level++;\n    ch = state.src.charCodeAt(++pos);\n  }\n\n  if (level > 6 || (pos < max && !isSpace(ch))) { return false; }\n\n  if (silent) { return true; }\n\n  // Let's cut tails like '    ###  ' from the end of string\n\n  max = state.skipSpacesBack(max, pos);\n  tmp = state.skipCharsBack(max, 0x23, pos); // #\n  if (tmp > pos && isSpace(state.src.charCodeAt(tmp - 1))) {\n    max = tmp;\n  }\n\n  state.line = startLine + 1;\n\n  token        = state.push('heading_open', 'h' + String(level), 1);\n  token.markup = '########'.slice(0, level);\n  token.map    = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = state.src.slice(pos, max).trim();\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token        = state.push('heading_close', 'h' + String(level), -1);\n  token.markup = '########'.slice(0, level);\n\n  return true;\n};\n","// lheading (---, ===)\n\n'use strict';\n\n\nmodule.exports = function lheading(state, startLine, endLine/*, silent*/) {\n  var content, terminate, i, l, token, pos, max, level, marker,\n      nextLine = startLine + 1, oldParentType,\n      terminatorRules = state.md.block.ruler.getRules('paragraph');\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph'; // use paragraph to match terminatorRules\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    //\n    // Check for underline in setext header\n    //\n    if (state.sCount[nextLine] >= state.blkIndent) {\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n\n      if (pos < max) {\n        marker = state.src.charCodeAt(pos);\n\n        if (marker === 0x2D/* - */ || marker === 0x3D/* = */) {\n          pos = state.skipChars(pos, marker);\n          pos = state.skipSpaces(pos);\n\n          if (pos >= max) {\n            level = (marker === 0x3D/* = */ ? 1 : 2);\n            break;\n          }\n        }\n      }\n    }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  if (!level) {\n    // Didn't find valid underline\n    return false;\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine + 1;\n\n  token          = state.push('heading_open', 'h' + String(level), 1);\n  token.markup   = String.fromCharCode(marker);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line - 1 ];\n  token.children = [];\n\n  token          = state.push('heading_close', 'h' + String(level), -1);\n  token.markup   = String.fromCharCode(marker);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// HTML block\n\n'use strict';\n\n\nvar block_names = require('../common/html_blocks');\nvar HTML_OPEN_CLOSE_TAG_RE = require('../common/html_re').HTML_OPEN_CLOSE_TAG_RE;\n\n// An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\nvar HTML_SEQUENCES = [\n  [ /^<(script|pre|style)(?=(\\s|>|$))/i, /<\\/(script|pre|style)>/i, true ],\n  [ /^<!--/,        /-->/,   true ],\n  [ /^<\\?/,         /\\?>/,   true ],\n  [ /^<![A-Z]/,     />/,     true ],\n  [ /^<!\\[CDATA\\[/, /\\]\\]>/, true ],\n  [ new RegExp('^</?(' + block_names.join('|') + ')(?=(\\\\s|/?>|$))', 'i'), /^$/, true ],\n  [ new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + '\\\\s*$'),  /^$/, false ]\n];\n\n\nmodule.exports = function html_block(state, startLine, endLine, silent) {\n  var i, nextLine, token, lineText,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (!state.md.options.html) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  lineText = state.src.slice(pos, max);\n\n  for (i = 0; i < HTML_SEQUENCES.length; i++) {\n    if (HTML_SEQUENCES[i][0].test(lineText)) { break; }\n  }\n\n  if (i === HTML_SEQUENCES.length) { return false; }\n\n  if (silent) {\n    // true if this sequence can be a terminator, false otherwise\n    return HTML_SEQUENCES[i][2];\n  }\n\n  nextLine = startLine + 1;\n\n  // If we are here - we detected HTML block.\n  // Let's roll down till block end.\n  if (!HTML_SEQUENCES[i][1].test(lineText)) {\n    for (; nextLine < endLine; nextLine++) {\n      if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n      lineText = state.src.slice(pos, max);\n\n      if (HTML_SEQUENCES[i][1].test(lineText)) {\n        if (lineText.length !== 0) { nextLine++; }\n        break;\n      }\n    }\n  }\n\n  state.line = nextLine;\n\n  token         = state.push('html_block', '', 0);\n  token.map     = [ startLine, nextLine ];\n  token.content = state.getLines(startLine, nextLine, state.blkIndent, true);\n\n  return true;\n};\n","// List of valid html blocks names, accorting to commonmark spec\n// http://jgm.github.io/CommonMark/spec.html#html-blocks\n\n'use strict';\n\n\nmodule.exports = [\n  'address',\n  'article',\n  'aside',\n  'base',\n  'basefont',\n  'blockquote',\n  'body',\n  'caption',\n  'center',\n  'col',\n  'colgroup',\n  'dd',\n  'details',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'footer',\n  'form',\n  'frame',\n  'frameset',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hr',\n  'html',\n  'iframe',\n  'legend',\n  'li',\n  'link',\n  'main',\n  'menu',\n  'menuitem',\n  'meta',\n  'nav',\n  'noframes',\n  'ol',\n  'optgroup',\n  'option',\n  'p',\n  'param',\n  'section',\n  'source',\n  'summary',\n  'table',\n  'tbody',\n  'td',\n  'tfoot',\n  'th',\n  'thead',\n  'title',\n  'tr',\n  'track',\n  'ul'\n];\n","// Paragraph\n\n'use strict';\n\n\nmodule.exports = function paragraph(state, startLine/*, endLine*/) {\n  var content, terminate, i, l, token, oldParentType,\n      nextLine = startLine + 1,\n      terminatorRules = state.md.block.ruler.getRules('paragraph'),\n      endLine = state.lineMax;\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph';\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine;\n\n  token          = state.push('paragraph_open', 'p', 1);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token          = state.push('paragraph_close', 'p', -1);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// Parser state class\n\n'use strict';\n\nvar Token = require('../token');\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction StateBlock(src, md, env, tokens) {\n  var ch, s, start, pos, len, indent, offset, indent_found;\n\n  this.src = src;\n\n  // link to parser instance\n  this.md     = md;\n\n  this.env = env;\n\n  //\n  // Internal state vartiables\n  //\n\n  this.tokens = tokens;\n\n  this.bMarks = [];  // line begin offsets for fast jumps\n  this.eMarks = [];  // line end offsets for fast jumps\n  this.tShift = [];  // offsets of the first non-space characters (tabs not expanded)\n  this.sCount = [];  // indents for each line (tabs expanded)\n\n  // An amount of virtual spaces (tabs expanded) between beginning\n  // of each line (bMarks) and real beginning of that line.\n  //\n  // It exists only as a hack because blockquotes override bMarks\n  // losing information in the process.\n  //\n  // It's used only when expanding tabs, you can think about it as\n  // an initial tab length, e.g. bsCount=21 applied to string `\\t123`\n  // means first tab should be expanded to 4-21%4 === 3 spaces.\n  //\n  this.bsCount = [];\n\n  // block parser variables\n  this.blkIndent  = 0; // required block content indent (for example, if we are\n                       // inside a list, it would be positioned after list marker)\n  this.line       = 0; // line index in src\n  this.lineMax    = 0; // lines count\n  this.tight      = false;  // loose/tight mode for lists\n  this.ddIndent   = -1; // indent of the current dd block (-1 if there isn't any)\n  this.listIndent = -1; // indent of the current list block (-1 if there isn't any)\n\n  // can be 'blockquote', 'list', 'root', 'paragraph' or 'reference'\n  // used in lists to determine if they interrupt a paragraph\n  this.parentType = 'root';\n\n  this.level = 0;\n\n  // renderer\n  this.result = '';\n\n  // Create caches\n  // Generate markers.\n  s = this.src;\n  indent_found = false;\n\n  for (start = pos = indent = offset = 0, len = s.length; pos < len; pos++) {\n    ch = s.charCodeAt(pos);\n\n    if (!indent_found) {\n      if (isSpace(ch)) {\n        indent++;\n\n        if (ch === 0x09) {\n          offset += 4 - offset % 4;\n        } else {\n          offset++;\n        }\n        continue;\n      } else {\n        indent_found = true;\n      }\n    }\n\n    if (ch === 0x0A || pos === len - 1) {\n      if (ch !== 0x0A) { pos++; }\n      this.bMarks.push(start);\n      this.eMarks.push(pos);\n      this.tShift.push(indent);\n      this.sCount.push(offset);\n      this.bsCount.push(0);\n\n      indent_found = false;\n      indent = 0;\n      offset = 0;\n      start = pos + 1;\n    }\n  }\n\n  // Push fake entry to simplify cache bounds checks\n  this.bMarks.push(s.length);\n  this.eMarks.push(s.length);\n  this.tShift.push(0);\n  this.sCount.push(0);\n  this.bsCount.push(0);\n\n  this.lineMax = this.bMarks.length - 1; // don't count last fake line\n}\n\n// Push new token to \"stream\".\n//\nStateBlock.prototype.push = function (type, tag, nesting) {\n  var token = new Token(type, tag, nesting);\n  token.block = true;\n\n  if (nesting < 0) this.level--; // closing tag\n  token.level = this.level;\n  if (nesting > 0) this.level++; // opening tag\n\n  this.tokens.push(token);\n  return token;\n};\n\nStateBlock.prototype.isEmpty = function isEmpty(line) {\n  return this.bMarks[line] + this.tShift[line] >= this.eMarks[line];\n};\n\nStateBlock.prototype.skipEmptyLines = function skipEmptyLines(from) {\n  for (var max = this.lineMax; from < max; from++) {\n    if (this.bMarks[from] + this.tShift[from] < this.eMarks[from]) {\n      break;\n    }\n  }\n  return from;\n};\n\n// Skip spaces from given position.\nStateBlock.prototype.skipSpaces = function skipSpaces(pos) {\n  var ch;\n\n  for (var max = this.src.length; pos < max; pos++) {\n    ch = this.src.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n  }\n  return pos;\n};\n\n// Skip spaces from given position in reverse.\nStateBlock.prototype.skipSpacesBack = function skipSpacesBack(pos, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (!isSpace(this.src.charCodeAt(--pos))) { return pos + 1; }\n  }\n  return pos;\n};\n\n// Skip char codes from given position\nStateBlock.prototype.skipChars = function skipChars(pos, code) {\n  for (var max = this.src.length; pos < max; pos++) {\n    if (this.src.charCodeAt(pos) !== code) { break; }\n  }\n  return pos;\n};\n\n// Skip char codes reverse from given position - 1\nStateBlock.prototype.skipCharsBack = function skipCharsBack(pos, code, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (code !== this.src.charCodeAt(--pos)) { return pos + 1; }\n  }\n  return pos;\n};\n\n// cut lines range from source.\nStateBlock.prototype.getLines = function getLines(begin, end, indent, keepLastLF) {\n  var i, lineIndent, ch, first, last, queue, lineStart,\n      line = begin;\n\n  if (begin >= end) {\n    return '';\n  }\n\n  queue = new Array(end - begin);\n\n  for (i = 0; line < end; line++, i++) {\n    lineIndent = 0;\n    lineStart = first = this.bMarks[line];\n\n    if (line + 1 < end || keepLastLF) {\n      // No need for bounds check because we have fake entry on tail.\n      last = this.eMarks[line] + 1;\n    } else {\n      last = this.eMarks[line];\n    }\n\n    while (first < last && lineIndent < indent) {\n      ch = this.src.charCodeAt(first);\n\n      if (isSpace(ch)) {\n        if (ch === 0x09) {\n          lineIndent += 4 - (lineIndent + this.bsCount[line]) % 4;\n        } else {\n          lineIndent++;\n        }\n      } else if (first - lineStart < this.tShift[line]) {\n        // patched tShift masked characters to look like spaces (blockquotes, list markers)\n        lineIndent++;\n      } else {\n        break;\n      }\n\n      first++;\n    }\n\n    if (lineIndent > indent) {\n      // partially expanding tabs in code blocks, e.g '\\t\\tfoobar'\n      // with indent=2 becomes '  \\tfoobar'\n      queue[i] = new Array(lineIndent - indent + 1).join(' ') + this.src.slice(first, last);\n    } else {\n      queue[i] = this.src.slice(first, last);\n    }\n  }\n\n  return queue.join('');\n};\n\n// re-export Token class to use in block rules\nStateBlock.prototype.Token = Token;\n\n\nmodule.exports = StateBlock;\n","/** internal\n * class ParserInline\n *\n * Tokenizes paragraph content.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Parser rules\n\nvar _rules = [\n  [ 'text',            require('./rules_inline/text') ],\n  [ 'newline',         require('./rules_inline/newline') ],\n  [ 'escape',          require('./rules_inline/escape') ],\n  [ 'backticks',       require('./rules_inline/backticks') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').tokenize ],\n  [ 'emphasis',        require('./rules_inline/emphasis').tokenize ],\n  [ 'link',            require('./rules_inline/link') ],\n  [ 'image',           require('./rules_inline/image') ],\n  [ 'autolink',        require('./rules_inline/autolink') ],\n  [ 'html_inline',     require('./rules_inline/html_inline') ],\n  [ 'entity',          require('./rules_inline/entity') ]\n];\n\nvar _rules2 = [\n  [ 'balance_pairs',   require('./rules_inline/balance_pairs') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').postProcess ],\n  [ 'emphasis',        require('./rules_inline/emphasis').postProcess ],\n  [ 'text_collapse',   require('./rules_inline/text_collapse') ]\n];\n\n\n/**\n * new ParserInline()\n **/\nfunction ParserInline() {\n  var i;\n\n  /**\n   * ParserInline#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of inline rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n\n  /**\n   * ParserInline#ruler2 -> Ruler\n   *\n   * [[Ruler]] instance. Second ruler used for post-processing\n   * (e.g. in emphasis-like rules).\n   **/\n  this.ruler2 = new Ruler();\n\n  for (i = 0; i < _rules2.length; i++) {\n    this.ruler2.push(_rules2[i][0], _rules2[i][1]);\n  }\n}\n\n\n// Skip single token by running all rules in validation mode;\n// returns `true` if any rule reported success\n//\nParserInline.prototype.skipToken = function (state) {\n  var ok, i, pos = state.pos,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      maxNesting = state.md.options.maxNesting,\n      cache = state.cache;\n\n\n  if (typeof cache[pos] !== 'undefined') {\n    state.pos = cache[pos];\n    return;\n  }\n\n  if (state.level < maxNesting) {\n    for (i = 0; i < len; i++) {\n      // Increment state.level and decrement it later to limit recursion.\n      // It's harmless to do here, because no tokens are created. But ideally,\n      // we'd need a separate private state variable for this purpose.\n      //\n      state.level++;\n      ok = rules[i](state, true);\n      state.level--;\n\n      if (ok) { break; }\n    }\n  } else {\n    // Too much nesting, just skip until the end of the paragraph.\n    //\n    // NOTE: this will cause links to behave incorrectly in the following case,\n    //       when an amount of `[` is exactly equal to `maxNesting + 1`:\n    //\n    //       [[[[[[[[[[[[[[[[[[[[[foo]()\n    //\n    // TODO: remove this workaround when CM standard will allow nested links\n    //       (we can replace it by preventing links from being parsed in\n    //       validation mode)\n    //\n    state.pos = state.posMax;\n  }\n\n  if (!ok) { state.pos++; }\n  cache[pos] = state.pos;\n};\n\n\n// Generate tokens for input range\n//\nParserInline.prototype.tokenize = function (state) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      end = state.posMax,\n      maxNesting = state.md.options.maxNesting;\n\n  while (state.pos < end) {\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.pos`\n    // - update `state.tokens`\n    // - return true\n\n    if (state.level < maxNesting) {\n      for (i = 0; i < len; i++) {\n        ok = rules[i](state, false);\n        if (ok) { break; }\n      }\n    }\n\n    if (ok) {\n      if (state.pos >= end) { break; }\n      continue;\n    }\n\n    state.pending += state.src[state.pos++];\n  }\n\n  if (state.pending) {\n    state.pushPending();\n  }\n};\n\n\n/**\n * ParserInline.parse(str, md, env, outTokens)\n *\n * Process input string and push inline tokens into `outTokens`\n **/\nParserInline.prototype.parse = function (str, md, env, outTokens) {\n  var i, rules, len;\n  var state = new this.State(str, md, env, outTokens);\n\n  this.tokenize(state);\n\n  rules = this.ruler2.getRules('');\n  len = rules.length;\n\n  for (i = 0; i < len; i++) {\n    rules[i](state);\n  }\n};\n\n\nParserInline.prototype.State = require('./rules_inline/state_inline');\n\n\nmodule.exports = ParserInline;\n","// Skip text characters for text token, place those to pending buffer\n// and increment current pos\n\n'use strict';\n\n\n// Rule to skip pure text\n// '{}$%@~+=:' reserved for extentions\n\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n\n// !!!! Don't confuse with \"Markdown ASCII Punctuation\" chars\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\nfunction isTerminatorChar(ch) {\n  switch (ch) {\n    case 0x0A/* \\n */:\n    case 0x21/* ! */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2D/* - */:\n    case 0x3A/* : */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos;\n\n  while (pos < state.posMax && !isTerminatorChar(state.src.charCodeAt(pos))) {\n    pos++;\n  }\n\n  if (pos === state.pos) { return false; }\n\n  if (!silent) { state.pending += state.src.slice(state.pos, pos); }\n\n  state.pos = pos;\n\n  return true;\n};\n\n// Alternative implementation, for memory.\n//\n// It costs 10% of performance, but allows extend terminators list, if place it\n// to `ParcerInline` property. Probably, will switch to it sometime, such\n// flexibility required.\n\n/*\nvar TERMINATOR_RE = /[\\n!#$%&*+\\-:<=>@[\\\\\\]^_`{}~]/;\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos,\n      idx = state.src.slice(pos).search(TERMINATOR_RE);\n\n  // first char is terminator -> empty text\n  if (idx === 0) { return false; }\n\n  // no terminator -> text till end of string\n  if (idx < 0) {\n    if (!silent) { state.pending += state.src.slice(pos); }\n    state.pos = state.src.length;\n    return true;\n  }\n\n  if (!silent) { state.pending += state.src.slice(pos, pos + idx); }\n\n  state.pos += idx;\n\n  return true;\n};*/\n","// Proceess '\\n'\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function newline(state, silent) {\n  var pmax, max, pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x0A/* \\n */) { return false; }\n\n  pmax = state.pending.length - 1;\n  max = state.posMax;\n\n  // '  \\n' -> hardbreak\n  // Lookup in pending chars is bad practice! Don't copy to other rules!\n  // Pending string is stored in concat mode, indexed lookups will cause\n  // convertion to flat mode.\n  if (!silent) {\n    if (pmax >= 0 && state.pending.charCodeAt(pmax) === 0x20) {\n      if (pmax >= 1 && state.pending.charCodeAt(pmax - 1) === 0x20) {\n        state.pending = state.pending.replace(/ +$/, '');\n        state.push('hardbreak', 'br', 0);\n      } else {\n        state.pending = state.pending.slice(0, -1);\n        state.push('softbreak', 'br', 0);\n      }\n\n    } else {\n      state.push('softbreak', 'br', 0);\n    }\n  }\n\n  pos++;\n\n  // skip heading spaces for next line\n  while (pos < max && isSpace(state.src.charCodeAt(pos))) { pos++; }\n\n  state.pos = pos;\n  return true;\n};\n","// Process escaped chars and hardbreaks\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\nvar ESCAPED = [];\n\nfor (var i = 0; i < 256; i++) { ESCAPED.push(0); }\n\n'\\\\!\"#$%&\\'()*+,./:;<=>?@[]^_`{|}~-'\n  .split('').forEach(function (ch) { ESCAPED[ch.charCodeAt(0)] = 1; });\n\n\nmodule.exports = function escape(state, silent) {\n  var ch, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x5C/* \\ */) { return false; }\n\n  pos++;\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch < 256 && ESCAPED[ch] !== 0) {\n      if (!silent) { state.pending += state.src[pos]; }\n      state.pos += 2;\n      return true;\n    }\n\n    if (ch === 0x0A) {\n      if (!silent) {\n        state.push('hardbreak', 'br', 0);\n      }\n\n      pos++;\n      // skip leading whitespaces from next line\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n\n      state.pos = pos;\n      return true;\n    }\n  }\n\n  if (!silent) { state.pending += '\\\\'; }\n  state.pos++;\n  return true;\n};\n","// Parse backticks\n\n'use strict';\n\nmodule.exports = function backtick(state, silent) {\n  var start, max, marker, matchStart, matchEnd, token,\n      pos = state.pos,\n      ch = state.src.charCodeAt(pos);\n\n  if (ch !== 0x60/* ` */) { return false; }\n\n  start = pos;\n  pos++;\n  max = state.posMax;\n\n  while (pos < max && state.src.charCodeAt(pos) === 0x60/* ` */) { pos++; }\n\n  marker = state.src.slice(start, pos);\n\n  matchStart = matchEnd = pos;\n\n  while ((matchStart = state.src.indexOf('`', matchEnd)) !== -1) {\n    matchEnd = matchStart + 1;\n\n    while (matchEnd < max && state.src.charCodeAt(matchEnd) === 0x60/* ` */) { matchEnd++; }\n\n    if (matchEnd - matchStart === marker.length) {\n      if (!silent) {\n        token         = state.push('code_inline', 'code', 0);\n        token.markup  = marker;\n        token.content = state.src.slice(pos, matchStart)\n          .replace(/\\n/g, ' ')\n          .replace(/^ (.+) $/, '$1');\n      }\n      state.pos = matchEnd;\n      return true;\n    }\n  }\n\n  if (!silent) { state.pending += marker; }\n  state.pos += marker.length;\n  return true;\n};\n","// Process [link](<to> \"stuff\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function link(state, silent) {\n  var attrs,\n      code,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      res,\n      ref,\n      title,\n      token,\n      href = '',\n      oldPos = state.pos,\n      max = state.posMax,\n      start = state.pos,\n      parseReference = true;\n\n  if (state.src.charCodeAt(state.pos) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 1;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // might have found a valid shortcut link, disable reference parsing\n    parseReference = false;\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                ^^ skipping these spaces\n    start = pos;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                  ^^^^^^^ parsing link title\n    res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n    if (pos < max && start !== pos && res.ok) {\n      title = res.str;\n      pos = res.pos;\n\n      // [link](  <href>  \"title\"  )\n      //                         ^^ skipping these spaces\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n    } else {\n      title = '';\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      // parsing a valid shortcut link failed, fallback to reference\n      parseReference = true;\n    }\n    pos++;\n  }\n\n  if (parseReference) {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    state.pos = labelStart;\n    state.posMax = labelEnd;\n\n    token        = state.push('link_open', 'a', 1);\n    token.attrs  = attrs = [ [ 'href', href ] ];\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n\n    state.md.inline.tokenize(state);\n\n    token        = state.push('link_close', 'a', -1);\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process ![image](<src> \"title\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function image(state, silent) {\n  var attrs,\n      code,\n      content,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      ref,\n      res,\n      title,\n      token,\n      tokens,\n      start,\n      href = '',\n      oldPos = state.pos,\n      max = state.posMax;\n\n  if (state.src.charCodeAt(state.pos) !== 0x21/* ! */) { return false; }\n  if (state.src.charCodeAt(state.pos + 1) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 2;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos + 1, false);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                ^^ skipping these spaces\n    start = pos;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                  ^^^^^^^ parsing link title\n    res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n    if (pos < max && start !== pos && res.ok) {\n      title = res.str;\n      pos = res.pos;\n\n      // [link](  <href>  \"title\"  )\n      //                         ^^ skipping these spaces\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n    } else {\n      title = '';\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      state.pos = oldPos;\n      return false;\n    }\n    pos++;\n  } else {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    content = state.src.slice(labelStart, labelEnd);\n\n    state.md.inline.parse(\n      content,\n      state.md,\n      state.env,\n      tokens = []\n    );\n\n    token          = state.push('image', 'img', 0);\n    token.attrs    = attrs = [ [ 'src', href ], [ 'alt', '' ] ];\n    token.children = tokens;\n    token.content  = content;\n\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process autolinks '<protocol:...>'\n\n'use strict';\n\n\n/*eslint max-len:0*/\nvar EMAIL_RE    = /^<([a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/;\nvar AUTOLINK_RE = /^<([a-zA-Z][a-zA-Z0-9+.\\-]{1,31}):([^<>\\x00-\\x20]*)>/;\n\n\nmodule.exports = function autolink(state, silent) {\n  var tail, linkMatch, emailMatch, url, fullUrl, token,\n      pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  tail = state.src.slice(pos);\n\n  if (tail.indexOf('>') < 0) { return false; }\n\n  if (AUTOLINK_RE.test(tail)) {\n    linkMatch = tail.match(AUTOLINK_RE);\n\n    url = linkMatch[0].slice(1, -1);\n    fullUrl = state.md.normalizeLink(url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += linkMatch[0].length;\n    return true;\n  }\n\n  if (EMAIL_RE.test(tail)) {\n    emailMatch = tail.match(EMAIL_RE);\n\n    url = emailMatch[0].slice(1, -1);\n    fullUrl = state.md.normalizeLink('mailto:' + url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += emailMatch[0].length;\n    return true;\n  }\n\n  return false;\n};\n","// Process html tags\n\n'use strict';\n\n\nvar HTML_TAG_RE = require('../common/html_re').HTML_TAG_RE;\n\n\nfunction isLetter(ch) {\n  /*eslint no-bitwise:0*/\n  var lc = ch | 0x20; // to lower case\n  return (lc >= 0x61/* a */) && (lc <= 0x7a/* z */);\n}\n\n\nmodule.exports = function html_inline(state, silent) {\n  var ch, match, max, token,\n      pos = state.pos;\n\n  if (!state.md.options.html) { return false; }\n\n  // Check start\n  max = state.posMax;\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */ ||\n      pos + 2 >= max) {\n    return false;\n  }\n\n  // Quick fail on second char\n  ch = state.src.charCodeAt(pos + 1);\n  if (ch !== 0x21/* ! */ &&\n      ch !== 0x3F/* ? */ &&\n      ch !== 0x2F/* / */ &&\n      !isLetter(ch)) {\n    return false;\n  }\n\n  match = state.src.slice(pos).match(HTML_TAG_RE);\n  if (!match) { return false; }\n\n  if (!silent) {\n    token         = state.push('html_inline', '', 0);\n    token.content = state.src.slice(pos, pos + match[0].length);\n  }\n  state.pos += match[0].length;\n  return true;\n};\n","// Process html entity - &#123;, &#xAF;, &quot;, ...\n\n'use strict';\n\nvar entities          = require('../common/entities');\nvar has               = require('../common/utils').has;\nvar isValidEntityCode = require('../common/utils').isValidEntityCode;\nvar fromCodePoint     = require('../common/utils').fromCodePoint;\n\n\nvar DIGITAL_RE = /^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i;\nvar NAMED_RE   = /^&([a-z][a-z0-9]{1,31});/i;\n\n\nmodule.exports = function entity(state, silent) {\n  var ch, code, match, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x26/* & */) { return false; }\n\n  if (pos + 1 < max) {\n    ch = state.src.charCodeAt(pos + 1);\n\n    if (ch === 0x23 /* # */) {\n      match = state.src.slice(pos).match(DIGITAL_RE);\n      if (match) {\n        if (!silent) {\n          code = match[1][0].toLowerCase() === 'x' ? parseInt(match[1].slice(1), 16) : parseInt(match[1], 10);\n          state.pending += isValidEntityCode(code) ? fromCodePoint(code) : fromCodePoint(0xFFFD);\n        }\n        state.pos += match[0].length;\n        return true;\n      }\n    } else {\n      match = state.src.slice(pos).match(NAMED_RE);\n      if (match) {\n        if (has(entities, match[1])) {\n          if (!silent) { state.pending += entities[match[1]]; }\n          state.pos += match[0].length;\n          return true;\n        }\n      }\n    }\n  }\n\n  if (!silent) { state.pending += '&'; }\n  state.pos++;\n  return true;\n};\n","// For each opening emphasis-like marker find a matching closing one\n//\n'use strict';\n\n\nfunction processDelimiters(state, delimiters) {\n  var closerIdx, openerIdx, closer, opener, minOpenerIdx, newMinOpenerIdx,\n      isOddMatch, lastJump,\n      openersBottom = {},\n      max = delimiters.length;\n\n  for (closerIdx = 0; closerIdx < max; closerIdx++) {\n    closer = delimiters[closerIdx];\n\n    // Length is only used for emphasis-specific \"rule of 3\",\n    // if it's not defined (in strikethrough or 3rd party plugins),\n    // we can default it to 0 to disable those checks.\n    //\n    closer.length = closer.length || 0;\n\n    if (!closer.close) continue;\n\n    // Previously calculated lower bounds (previous fails)\n    // for each marker and each delimiter length modulo 3.\n    if (!openersBottom.hasOwnProperty(closer.marker)) {\n      openersBottom[closer.marker] = [ -1, -1, -1 ];\n    }\n\n    minOpenerIdx = openersBottom[closer.marker][closer.length % 3];\n    newMinOpenerIdx = -1;\n\n    openerIdx = closerIdx - closer.jump - 1;\n\n    for (; openerIdx > minOpenerIdx; openerIdx -= opener.jump + 1) {\n      opener = delimiters[openerIdx];\n\n      if (opener.marker !== closer.marker) continue;\n\n      if (newMinOpenerIdx === -1) newMinOpenerIdx = openerIdx;\n\n      if (opener.open &&\n          opener.end < 0 &&\n          opener.level === closer.level) {\n\n        isOddMatch = false;\n\n        // from spec:\n        //\n        // If one of the delimiters can both open and close emphasis, then the\n        // sum of the lengths of the delimiter runs containing the opening and\n        // closing delimiters must not be a multiple of 3 unless both lengths\n        // are multiples of 3.\n        //\n        if (opener.close || closer.open) {\n          if ((opener.length + closer.length) % 3 === 0) {\n            if (opener.length % 3 !== 0 || closer.length % 3 !== 0) {\n              isOddMatch = true;\n            }\n          }\n        }\n\n        if (!isOddMatch) {\n          // If previous delimiter cannot be an opener, we can safely skip\n          // the entire sequence in future checks. This is required to make\n          // sure algorithm has linear complexity (see *_*_*_*_*_... case).\n          //\n          lastJump = openerIdx > 0 && !delimiters[openerIdx - 1].open ?\n            delimiters[openerIdx - 1].jump + 1 :\n            0;\n\n          closer.jump  = closerIdx - openerIdx + lastJump;\n          closer.open  = false;\n          opener.end   = closerIdx;\n          opener.jump  = lastJump;\n          opener.close = false;\n          newMinOpenerIdx = -1;\n          break;\n        }\n      }\n    }\n\n    if (newMinOpenerIdx !== -1) {\n      // If match for this delimiter run failed, we want to set lower bound for\n      // future lookups. This is required to make sure algorithm has linear\n      // complexity.\n      //\n      // See details here:\n      // https://github.com/commonmark/cmark/issues/178#issuecomment-270417442\n      //\n      openersBottom[closer.marker][(closer.length || 0) % 3] = newMinOpenerIdx;\n    }\n  }\n}\n\n\nmodule.exports = function link_pairs(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  processDelimiters(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      processDelimiters(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Clean up tokens after emphasis and strikethrough postprocessing:\n// merge adjacent text nodes into one and re-calculate all token levels\n//\n// This is necessary because initially emphasis delimiter markers (*, _, ~)\n// are treated as their own separate text tokens. Then emphasis rule either\n// leaves them as text (needed to merge with adjacent text) or turns them\n// into opening/closing tags (which messes up levels inside).\n//\n'use strict';\n\n\nmodule.exports = function text_collapse(state) {\n  var curr, last,\n      level = 0,\n      tokens = state.tokens,\n      max = state.tokens.length;\n\n  for (curr = last = 0; curr < max; curr++) {\n    // re-calculate levels after emphasis/strikethrough turns some text nodes\n    // into opening/closing tags\n    if (tokens[curr].nesting < 0) level--; // closing tag\n    tokens[curr].level = level;\n    if (tokens[curr].nesting > 0) level++; // opening tag\n\n    if (tokens[curr].type === 'text' &&\n        curr + 1 < max &&\n        tokens[curr + 1].type === 'text') {\n\n      // collapse two adjacent text nodes\n      tokens[curr + 1].content = tokens[curr].content + tokens[curr + 1].content;\n    } else {\n      if (curr !== last) { tokens[last] = tokens[curr]; }\n\n      last++;\n    }\n  }\n\n  if (curr !== last) {\n    tokens.length = last;\n  }\n};\n","// Inline parser state\n\n'use strict';\n\n\nvar Token          = require('../token');\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\n\nfunction StateInline(src, md, env, outTokens) {\n  this.src = src;\n  this.env = env;\n  this.md = md;\n  this.tokens = outTokens;\n  this.tokens_meta = Array(outTokens.length);\n\n  this.pos = 0;\n  this.posMax = this.src.length;\n  this.level = 0;\n  this.pending = '';\n  this.pendingLevel = 0;\n\n  // Stores { start: end } pairs. Useful for backtrack\n  // optimization of pairs parse (emphasis, strikes).\n  this.cache = {};\n\n  // List of emphasis-like delimiters for current tag\n  this.delimiters = [];\n\n  // Stack of delimiter lists for upper level tags\n  this._prev_delimiters = [];\n}\n\n\n// Flush pending text\n//\nStateInline.prototype.pushPending = function () {\n  var token = new Token('text', '', 0);\n  token.content = this.pending;\n  token.level = this.pendingLevel;\n  this.tokens.push(token);\n  this.pending = '';\n  return token;\n};\n\n\n// Push new token to \"stream\".\n// If pending text exists - flush it as text token\n//\nStateInline.prototype.push = function (type, tag, nesting) {\n  if (this.pending) {\n    this.pushPending();\n  }\n\n  var token = new Token(type, tag, nesting);\n  var token_meta = null;\n\n  if (nesting < 0) {\n    // closing tag\n    this.level--;\n    this.delimiters = this._prev_delimiters.pop();\n  }\n\n  token.level = this.level;\n\n  if (nesting > 0) {\n    // opening tag\n    this.level++;\n    this._prev_delimiters.push(this.delimiters);\n    this.delimiters = [];\n    token_meta = { delimiters: this.delimiters };\n  }\n\n  this.pendingLevel = this.level;\n  this.tokens.push(token);\n  this.tokens_meta.push(token_meta);\n  return token;\n};\n\n\n// Scan a sequence of emphasis-like markers, and determine whether\n// it can start an emphasis sequence or end an emphasis sequence.\n//\n//  - start - position to scan from (it should point at a valid marker);\n//  - canSplitWord - determine if these markers can be found inside a word\n//\nStateInline.prototype.scanDelims = function (start, canSplitWord) {\n  var pos = start, lastChar, nextChar, count, can_open, can_close,\n      isLastWhiteSpace, isLastPunctChar,\n      isNextWhiteSpace, isNextPunctChar,\n      left_flanking = true,\n      right_flanking = true,\n      max = this.posMax,\n      marker = this.src.charCodeAt(start);\n\n  // treat beginning of the line as a whitespace\n  lastChar = start > 0 ? this.src.charCodeAt(start - 1) : 0x20;\n\n  while (pos < max && this.src.charCodeAt(pos) === marker) { pos++; }\n\n  count = pos - start;\n\n  // treat end of the line as a whitespace\n  nextChar = pos < max ? this.src.charCodeAt(pos) : 0x20;\n\n  isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n  isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n  isLastWhiteSpace = isWhiteSpace(lastChar);\n  isNextWhiteSpace = isWhiteSpace(nextChar);\n\n  if (isNextWhiteSpace) {\n    left_flanking = false;\n  } else if (isNextPunctChar) {\n    if (!(isLastWhiteSpace || isLastPunctChar)) {\n      left_flanking = false;\n    }\n  }\n\n  if (isLastWhiteSpace) {\n    right_flanking = false;\n  } else if (isLastPunctChar) {\n    if (!(isNextWhiteSpace || isNextPunctChar)) {\n      right_flanking = false;\n    }\n  }\n\n  if (!canSplitWord) {\n    can_open  = left_flanking  && (!right_flanking || isLastPunctChar);\n    can_close = right_flanking && (!left_flanking  || isNextPunctChar);\n  } else {\n    can_open  = left_flanking;\n    can_close = right_flanking;\n  }\n\n  return {\n    can_open:  can_open,\n    can_close: can_close,\n    length:    count\n  };\n};\n\n\n// re-export Token class to use in block rules\nStateInline.prototype.Token = Token;\n\n\nmodule.exports = StateInline;\n","'use strict';\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Helpers\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\nfunction isString(obj) { return _class(obj) === '[object String]'; }\nfunction isObject(obj) { return _class(obj) === '[object Object]'; }\nfunction isRegExp(obj) { return _class(obj) === '[object RegExp]'; }\nfunction isFunction(obj) { return _class(obj) === '[object Function]'; }\n\n\nfunction escapeRE(str) { return str.replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&'); }\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar defaultOptions = {\n  fuzzyLink: true,\n  fuzzyEmail: true,\n  fuzzyIP: false\n};\n\n\nfunction isOptionsObj(obj) {\n  return Object.keys(obj || {}).reduce(function (acc, k) {\n    return acc || defaultOptions.hasOwnProperty(k);\n  }, false);\n}\n\n\nvar defaultSchemas = {\n  'http:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.http) {\n        // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.http =  new RegExp(\n          '^\\\\/\\\\/' + self.re.src_auth + self.re.src_host_port_strict + self.re.src_path, 'i'\n        );\n      }\n      if (self.re.http.test(tail)) {\n        return tail.match(self.re.http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'https:':  'http:',\n  'ftp:':    'http:',\n  '//':      {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.no_http) {\n      // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.no_http =  new RegExp(\n          '^' +\n          self.re.src_auth +\n          // Don't allow single-level domains, because of false positives like '//test'\n          // with code comments\n          '(?:localhost|(?:(?:' + self.re.src_domain + ')\\\\.)+' + self.re.src_domain_root + ')' +\n          self.re.src_port +\n          self.re.src_host_terminator +\n          self.re.src_path,\n\n          'i'\n        );\n      }\n\n      if (self.re.no_http.test(tail)) {\n        // should not be `://` & `///`, that protects from errors in protocol name\n        if (pos >= 3 && text[pos - 3] === ':') { return 0; }\n        if (pos >= 3 && text[pos - 3] === '/') { return 0; }\n        return tail.match(self.re.no_http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'mailto:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.mailto) {\n        self.re.mailto =  new RegExp(\n          '^' + self.re.src_email_name + '@' + self.re.src_host_strict, 'i'\n        );\n      }\n      if (self.re.mailto.test(tail)) {\n        return tail.match(self.re.mailto)[0].length;\n      }\n      return 0;\n    }\n  }\n};\n\n/*eslint-disable max-len*/\n\n// RE pattern for 2-character tlds (autogenerated by ./support/tlds_2char_gen.js)\nvar tlds_2ch_src_re = 'a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]';\n\n// DON'T try to make PRs with changes. Extend TLDs with LinkifyIt.tlds() instead\nvar tlds_default = 'biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф'.split('|');\n\n/*eslint-enable max-len*/\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction resetScanCache(self) {\n  self.__index__ = -1;\n  self.__text_cache__   = '';\n}\n\nfunction createValidator(re) {\n  return function (text, pos) {\n    var tail = text.slice(pos);\n\n    if (re.test(tail)) {\n      return tail.match(re)[0].length;\n    }\n    return 0;\n  };\n}\n\nfunction createNormalizer() {\n  return function (match, self) {\n    self.normalize(match);\n  };\n}\n\n// Schemas compiler. Build regexps.\n//\nfunction compile(self) {\n\n  // Load & clone RE patterns.\n  var re = self.re = require('./lib/re')(self.__opts__);\n\n  // Define dynamic patterns\n  var tlds = self.__tlds__.slice();\n\n  self.onCompile();\n\n  if (!self.__tlds_replaced__) {\n    tlds.push(tlds_2ch_src_re);\n  }\n  tlds.push(re.src_xn);\n\n  re.src_tlds = tlds.join('|');\n\n  function untpl(tpl) { return tpl.replace('%TLDS%', re.src_tlds); }\n\n  re.email_fuzzy      = RegExp(untpl(re.tpl_email_fuzzy), 'i');\n  re.link_fuzzy       = RegExp(untpl(re.tpl_link_fuzzy), 'i');\n  re.link_no_ip_fuzzy = RegExp(untpl(re.tpl_link_no_ip_fuzzy), 'i');\n  re.host_fuzzy_test  = RegExp(untpl(re.tpl_host_fuzzy_test), 'i');\n\n  //\n  // Compile each schema\n  //\n\n  var aliases = [];\n\n  self.__compiled__ = {}; // Reset compiled data\n\n  function schemaError(name, val) {\n    throw new Error('(LinkifyIt) Invalid schema \"' + name + '\": ' + val);\n  }\n\n  Object.keys(self.__schemas__).forEach(function (name) {\n    var val = self.__schemas__[name];\n\n    // skip disabled methods\n    if (val === null) { return; }\n\n    var compiled = { validate: null, link: null };\n\n    self.__compiled__[name] = compiled;\n\n    if (isObject(val)) {\n      if (isRegExp(val.validate)) {\n        compiled.validate = createValidator(val.validate);\n      } else if (isFunction(val.validate)) {\n        compiled.validate = val.validate;\n      } else {\n        schemaError(name, val);\n      }\n\n      if (isFunction(val.normalize)) {\n        compiled.normalize = val.normalize;\n      } else if (!val.normalize) {\n        compiled.normalize = createNormalizer();\n      } else {\n        schemaError(name, val);\n      }\n\n      return;\n    }\n\n    if (isString(val)) {\n      aliases.push(name);\n      return;\n    }\n\n    schemaError(name, val);\n  });\n\n  //\n  // Compile postponed aliases\n  //\n\n  aliases.forEach(function (alias) {\n    if (!self.__compiled__[self.__schemas__[alias]]) {\n      // Silently fail on missed schemas to avoid errons on disable.\n      // schemaError(alias, self.__schemas__[alias]);\n      return;\n    }\n\n    self.__compiled__[alias].validate =\n      self.__compiled__[self.__schemas__[alias]].validate;\n    self.__compiled__[alias].normalize =\n      self.__compiled__[self.__schemas__[alias]].normalize;\n  });\n\n  //\n  // Fake record for guessed links\n  //\n  self.__compiled__[''] = { validate: null, normalize: createNormalizer() };\n\n  //\n  // Build schema condition\n  //\n  var slist = Object.keys(self.__compiled__)\n                      .filter(function (name) {\n                        // Filter disabled & fake schemas\n                        return name.length > 0 && self.__compiled__[name];\n                      })\n                      .map(escapeRE)\n                      .join('|');\n  // (?!_) cause 1.5x slowdown\n  self.re.schema_test   = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'i');\n  self.re.schema_search = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'ig');\n\n  self.re.pretest = RegExp(\n    '(' + self.re.schema_test.source + ')|(' + self.re.host_fuzzy_test.source + ')|@',\n    'i'\n  );\n\n  //\n  // Cleanup\n  //\n\n  resetScanCache(self);\n}\n\n/**\n * class Match\n *\n * Match result. Single element of array, returned by [[LinkifyIt#match]]\n **/\nfunction Match(self, shift) {\n  var start = self.__index__,\n      end   = self.__last_index__,\n      text  = self.__text_cache__.slice(start, end);\n\n  /**\n   * Match#schema -> String\n   *\n   * Prefix (protocol) for matched string.\n   **/\n  this.schema    = self.__schema__.toLowerCase();\n  /**\n   * Match#index -> Number\n   *\n   * First position of matched string.\n   **/\n  this.index     = start + shift;\n  /**\n   * Match#lastIndex -> Number\n   *\n   * Next position after matched string.\n   **/\n  this.lastIndex = end + shift;\n  /**\n   * Match#raw -> String\n   *\n   * Matched string.\n   **/\n  this.raw       = text;\n  /**\n   * Match#text -> String\n   *\n   * Notmalized text of matched string.\n   **/\n  this.text      = text;\n  /**\n   * Match#url -> String\n   *\n   * Normalized url of matched string.\n   **/\n  this.url       = text;\n}\n\nfunction createMatch(self, shift) {\n  var match = new Match(self, shift);\n\n  self.__compiled__[match.schema].normalize(match, self);\n\n  return match;\n}\n\n\n/**\n * class LinkifyIt\n **/\n\n/**\n * new LinkifyIt(schemas, options)\n * - schemas (Object): Optional. Additional schemas to validate (prefix/validator)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Creates new linkifier instance with optional additional schemas.\n * Can be called without `new` keyword for convenience.\n *\n * By default understands:\n *\n * - `http(s)://...` , `ftp://...`, `mailto:...` & `//...` links\n * - \"fuzzy\" links and emails (example.com, foo@bar.com).\n *\n * `schemas` is an object, where each key/value describes protocol/rule:\n *\n * - __key__ - link prefix (usually, protocol name with `:` at the end, `skype:`\n *   for example). `linkify-it` makes shure that prefix is not preceeded with\n *   alphanumeric char and symbols. Only whitespaces and punctuation allowed.\n * - __value__ - rule to check tail after link prefix\n *   - _String_ - just alias to existing rule\n *   - _Object_\n *     - _validate_ - validator function (should return matched length on success),\n *       or `RegExp`.\n *     - _normalize_ - optional function to normalize text & url of matched result\n *       (for example, for @twitter mentions).\n *\n * `options`:\n *\n * - __fuzzyLink__ - recognige URL-s without `http(s):` prefix. Default `true`.\n * - __fuzzyIP__ - allow IPs in fuzzy links above. Can conflict with some texts\n *   like version numbers. Default `false`.\n * - __fuzzyEmail__ - recognize emails without `mailto:` prefix.\n *\n **/\nfunction LinkifyIt(schemas, options) {\n  if (!(this instanceof LinkifyIt)) {\n    return new LinkifyIt(schemas, options);\n  }\n\n  if (!options) {\n    if (isOptionsObj(schemas)) {\n      options = schemas;\n      schemas = {};\n    }\n  }\n\n  this.__opts__           = assign({}, defaultOptions, options);\n\n  // Cache last tested result. Used to skip repeating steps on next `match` call.\n  this.__index__          = -1;\n  this.__last_index__     = -1; // Next scan position\n  this.__schema__         = '';\n  this.__text_cache__     = '';\n\n  this.__schemas__        = assign({}, defaultSchemas, schemas);\n  this.__compiled__       = {};\n\n  this.__tlds__           = tlds_default;\n  this.__tlds_replaced__  = false;\n\n  this.re = {};\n\n  compile(this);\n}\n\n\n/** chainable\n * LinkifyIt#add(schema, definition)\n * - schema (String): rule name (fixed pattern prefix)\n * - definition (String|RegExp|Object): schema definition\n *\n * Add new rule definition. See constructor description for details.\n **/\nLinkifyIt.prototype.add = function add(schema, definition) {\n  this.__schemas__[schema] = definition;\n  compile(this);\n  return this;\n};\n\n\n/** chainable\n * LinkifyIt#set(options)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Set recognition options for links without schema.\n **/\nLinkifyIt.prototype.set = function set(options) {\n  this.__opts__ = assign(this.__opts__, options);\n  return this;\n};\n\n\n/**\n * LinkifyIt#test(text) -> Boolean\n *\n * Searches linkifiable pattern and returns `true` on success or `false` on fail.\n **/\nLinkifyIt.prototype.test = function test(text) {\n  // Reset scan cache\n  this.__text_cache__ = text;\n  this.__index__      = -1;\n\n  if (!text.length) { return false; }\n\n  var m, ml, me, len, shift, next, re, tld_pos, at_pos;\n\n  // try to scan for link with schema - that's the most simple rule\n  if (this.re.schema_test.test(text)) {\n    re = this.re.schema_search;\n    re.lastIndex = 0;\n    while ((m = re.exec(text)) !== null) {\n      len = this.testSchemaAt(text, m[2], re.lastIndex);\n      if (len) {\n        this.__schema__     = m[2];\n        this.__index__      = m.index + m[1].length;\n        this.__last_index__ = m.index + m[0].length + len;\n        break;\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyLink && this.__compiled__['http:']) {\n    // guess schemaless links\n    tld_pos = text.search(this.re.host_fuzzy_test);\n    if (tld_pos >= 0) {\n      // if tld is located after found link - no need to check fuzzy pattern\n      if (this.__index__ < 0 || tld_pos < this.__index__) {\n        if ((ml = text.match(this.__opts__.fuzzyIP ? this.re.link_fuzzy : this.re.link_no_ip_fuzzy)) !== null) {\n\n          shift = ml.index + ml[1].length;\n\n          if (this.__index__ < 0 || shift < this.__index__) {\n            this.__schema__     = '';\n            this.__index__      = shift;\n            this.__last_index__ = ml.index + ml[0].length;\n          }\n        }\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyEmail && this.__compiled__['mailto:']) {\n    // guess schemaless emails\n    at_pos = text.indexOf('@');\n    if (at_pos >= 0) {\n      // We can't skip this check, because this cases are possible:\n      // 192.168.1.1@gmail.com, my.in@example.com\n      if ((me = text.match(this.re.email_fuzzy)) !== null) {\n\n        shift = me.index + me[1].length;\n        next  = me.index + me[0].length;\n\n        if (this.__index__ < 0 || shift < this.__index__ ||\n            (shift === this.__index__ && next > this.__last_index__)) {\n          this.__schema__     = 'mailto:';\n          this.__index__      = shift;\n          this.__last_index__ = next;\n        }\n      }\n    }\n  }\n\n  return this.__index__ >= 0;\n};\n\n\n/**\n * LinkifyIt#pretest(text) -> Boolean\n *\n * Very quick check, that can give false positives. Returns true if link MAY BE\n * can exists. Can be used for speed optimization, when you need to check that\n * link NOT exists.\n **/\nLinkifyIt.prototype.pretest = function pretest(text) {\n  return this.re.pretest.test(text);\n};\n\n\n/**\n * LinkifyIt#testSchemaAt(text, name, position) -> Number\n * - text (String): text to scan\n * - name (String): rule (schema) name\n * - position (Number): text offset to check from\n *\n * Similar to [[LinkifyIt#test]] but checks only specific protocol tail exactly\n * at given position. Returns length of found pattern (0 on fail).\n **/\nLinkifyIt.prototype.testSchemaAt = function testSchemaAt(text, schema, pos) {\n  // If not supported schema check requested - terminate\n  if (!this.__compiled__[schema.toLowerCase()]) {\n    return 0;\n  }\n  return this.__compiled__[schema.toLowerCase()].validate(text, pos, this);\n};\n\n\n/**\n * LinkifyIt#match(text) -> Array|null\n *\n * Returns array of found link descriptions or `null` on fail. We strongly\n * recommend to use [[LinkifyIt#test]] first, for best speed.\n *\n * ##### Result match description\n *\n * - __schema__ - link schema, can be empty for fuzzy links, or `//` for\n *   protocol-neutral  links.\n * - __index__ - offset of matched text\n * - __lastIndex__ - index of next char after mathch end\n * - __raw__ - matched text\n * - __text__ - normalized text\n * - __url__ - link, generated from matched text\n **/\nLinkifyIt.prototype.match = function match(text) {\n  var shift = 0, result = [];\n\n  // Try to take previous element from cache, if .test() called before\n  if (this.__index__ >= 0 && this.__text_cache__ === text) {\n    result.push(createMatch(this, shift));\n    shift = this.__last_index__;\n  }\n\n  // Cut head if cache was used\n  var tail = shift ? text.slice(shift) : text;\n\n  // Scan string until end reached\n  while (this.test(tail)) {\n    result.push(createMatch(this, shift));\n\n    tail = tail.slice(this.__last_index__);\n    shift += this.__last_index__;\n  }\n\n  if (result.length) {\n    return result;\n  }\n\n  return null;\n};\n\n\n/** chainable\n * LinkifyIt#tlds(list [, keepOld]) -> this\n * - list (Array): list of tlds\n * - keepOld (Boolean): merge with current list if `true` (`false` by default)\n *\n * Load (or merge) new tlds list. Those are user for fuzzy links (without prefix)\n * to avoid false positives. By default this algorythm used:\n *\n * - hostname with any 2-letter root zones are ok.\n * - biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф\n *   are ok.\n * - encoded (`xn--...`) root zones are ok.\n *\n * If list is replaced, then exact match for 2-chars root zones will be checked.\n **/\nLinkifyIt.prototype.tlds = function tlds(list, keepOld) {\n  list = Array.isArray(list) ? list : [ list ];\n\n  if (!keepOld) {\n    this.__tlds__ = list.slice();\n    this.__tlds_replaced__ = true;\n    compile(this);\n    return this;\n  }\n\n  this.__tlds__ = this.__tlds__.concat(list)\n                                  .sort()\n                                  .filter(function (el, idx, arr) {\n                                    return el !== arr[idx - 1];\n                                  })\n                                  .reverse();\n\n  compile(this);\n  return this;\n};\n\n/**\n * LinkifyIt#normalize(match)\n *\n * Default normalizer (if schema does not define it's own).\n **/\nLinkifyIt.prototype.normalize = function normalize(match) {\n\n  // Do minimal possible changes by default. Need to collect feedback prior\n  // to move forward https://github.com/markdown-it/linkify-it/issues/1\n\n  if (!match.schema) { match.url = 'http://' + match.url; }\n\n  if (match.schema === 'mailto:' && !/^mailto:/i.test(match.url)) {\n    match.url = 'mailto:' + match.url;\n  }\n};\n\n\n/**\n * LinkifyIt#onCompile()\n *\n * Override to modify basic RegExp-s.\n **/\nLinkifyIt.prototype.onCompile = function onCompile() {\n};\n\n\nmodule.exports = LinkifyIt;\n","'use strict';\n\n\nmodule.exports = function (opts) {\n  var re = {};\n\n  // Use direct extract instead of `regenerate` to reduse browserified size\n  re.src_Any = require('uc.micro/properties/Any/regex').source;\n  re.src_Cc  = require('uc.micro/categories/Cc/regex').source;\n  re.src_Z   = require('uc.micro/categories/Z/regex').source;\n  re.src_P   = require('uc.micro/categories/P/regex').source;\n\n  // \\p{\\Z\\P\\Cc\\CF} (white spaces + control + format + punctuation)\n  re.src_ZPCc = [ re.src_Z, re.src_P, re.src_Cc ].join('|');\n\n  // \\p{\\Z\\Cc} (white spaces + control)\n  re.src_ZCc = [ re.src_Z, re.src_Cc ].join('|');\n\n  // Experimental. List of chars, completely prohibited in links\n  // because can separate it from other part of text\n  var text_separators = '[><\\uff5c]';\n\n  // All possible word characters (everything without punctuation, spaces & controls)\n  // Defined via punctuation & spaces to save space\n  // Should be something like \\p{\\L\\N\\S\\M} (\\w but without `_`)\n  re.src_pseudo_letter       = '(?:(?!' + text_separators + '|' + re.src_ZPCc + ')' + re.src_Any + ')';\n  // The same as abothe but without [0-9]\n  // var src_pseudo_letter_non_d = '(?:(?![0-9]|' + src_ZPCc + ')' + src_Any + ')';\n\n  ////////////////////////////////////////////////////////////////////////////////\n\n  re.src_ip4 =\n\n    '(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)';\n\n  // Prohibit any of \"@/[]()\" in user/pass to avoid wrong domain fetch.\n  re.src_auth    = '(?:(?:(?!' + re.src_ZCc + '|[@/\\\\[\\\\]()]).)+@)?';\n\n  re.src_port =\n\n    '(?::(?:6(?:[0-4]\\\\d{3}|5(?:[0-4]\\\\d{2}|5(?:[0-2]\\\\d|3[0-5])))|[1-5]?\\\\d{1,4}))?';\n\n  re.src_host_terminator =\n\n    '(?=$|' + text_separators + '|' + re.src_ZPCc + ')(?!-|_|:\\\\d|\\\\.-|\\\\.(?!$|' + re.src_ZPCc + '))';\n\n  re.src_path =\n\n    '(?:' +\n      '[/?#]' +\n        '(?:' +\n          '(?!' + re.src_ZCc + '|' + text_separators + '|[()[\\\\]{}.,\"\\'?!\\\\-]).|' +\n          '\\\\[(?:(?!' + re.src_ZCc + '|\\\\]).)*\\\\]|' +\n          '\\\\((?:(?!' + re.src_ZCc + '|[)]).)*\\\\)|' +\n          '\\\\{(?:(?!' + re.src_ZCc + '|[}]).)*\\\\}|' +\n          '\\\\\"(?:(?!' + re.src_ZCc + '|[\"]).)+\\\\\"|' +\n          \"\\\\'(?:(?!\" + re.src_ZCc + \"|[']).)+\\\\'|\" +\n          \"\\\\'(?=\" + re.src_pseudo_letter + '|[-]).|' +  // allow `I'm_king` if no pair found\n          '\\\\.{2,4}[a-zA-Z0-9%/]|' + // github has ... in commit range links,\n                                     // google has .... in links (issue #66)\n                                     // Restrict to\n                                     // - english\n                                     // - percent-encoded\n                                     // - parts of file path\n                                     // until more examples found.\n          '\\\\.(?!' + re.src_ZCc + '|[.]).|' +\n          (opts && opts['---'] ?\n            '\\\\-(?!--(?:[^-]|$))(?:-*)|' // `---` => long dash, terminate\n            :\n            '\\\\-+|'\n          ) +\n          '\\\\,(?!' + re.src_ZCc + ').|' +      // allow `,,,` in paths\n          '\\\\!(?!' + re.src_ZCc + '|[!]).|' +\n          '\\\\?(?!' + re.src_ZCc + '|[?]).' +\n        ')+' +\n      '|\\\\/' +\n    ')?';\n\n  // Allow anything in markdown spec, forbid quote (\") at the first position\n  // because emails enclosed in quotes are far more common\n  re.src_email_name =\n\n    '[\\\\-;:&=\\\\+\\\\$,\\\\.a-zA-Z0-9_][\\\\-;:&=\\\\+\\\\$,\\\\\"\\\\.a-zA-Z0-9_]*';\n\n  re.src_xn =\n\n    'xn--[a-z0-9\\\\-]{1,59}';\n\n  // More to read about domain names\n  // http://serverfault.com/questions/638260/\n\n  re.src_domain_root =\n\n    // Allow letters & digits (http://test1)\n    '(?:' +\n      re.src_xn +\n      '|' +\n      re.src_pseudo_letter + '{1,63}' +\n    ')';\n\n  re.src_domain =\n\n    '(?:' +\n      re.src_xn +\n      '|' +\n      '(?:' + re.src_pseudo_letter + ')' +\n      '|' +\n      '(?:' + re.src_pseudo_letter + '(?:-|' + re.src_pseudo_letter + '){0,61}' + re.src_pseudo_letter + ')' +\n    ')';\n\n  re.src_host =\n\n    '(?:' +\n    // Don't need IP check, because digits are already allowed in normal domain names\n    //   src_ip4 +\n    // '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)*' + re.src_domain/*_root*/ + ')' +\n    ')';\n\n  re.tpl_host_fuzzy =\n\n    '(?:' +\n      re.src_ip4 +\n    '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))' +\n    ')';\n\n  re.tpl_host_no_ip_fuzzy =\n\n    '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))';\n\n  re.src_host_strict =\n\n    re.src_host + re.src_host_terminator;\n\n  re.tpl_host_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_host_terminator;\n\n  re.src_host_port_strict =\n\n    re.src_host + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_no_ip_fuzzy_strict =\n\n    re.tpl_host_no_ip_fuzzy + re.src_port + re.src_host_terminator;\n\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Main rules\n\n  // Rude test fuzzy links by host, for quick deny\n  re.tpl_host_fuzzy_test =\n\n    'localhost|www\\\\.|\\\\.\\\\d{1,3}\\\\.|(?:\\\\.(?:%TLDS%)(?:' + re.src_ZPCc + '|>|$))';\n\n  re.tpl_email_fuzzy =\n\n      '(^|' + text_separators + '|\"|\\\\(|' + re.src_ZCc + ')' +\n      '(' + re.src_email_name + '@' + re.tpl_host_fuzzy_strict + ')';\n\n  re.tpl_link_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_fuzzy_strict + re.src_path + ')';\n\n  re.tpl_link_no_ip_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_no_ip_fuzzy_strict + re.src_path + ')';\n\n  return re;\n};\n","// markdown-it default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   100            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {},\n    block: {},\n    inline: {}\n  }\n};\n","// \"Zero\" preset, with nothing enabled. Useful for manual configuring of simple\n// modes. For example, to parse bold/italic only.\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","// Commonmark default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         true,         // Enable HTML tags in source\n    xhtmlOut:     true,         // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'blockquote',\n        'code',\n        'fence',\n        'heading',\n        'hr',\n        'html_block',\n        'lheading',\n        'list',\n        'reference',\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'autolink',\n        'backticks',\n        'emphasis',\n        'entity',\n        'escape',\n        'html_inline',\n        'image',\n        'link',\n        'newline',\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'emphasis',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","import applyEditor from '../common/applyEditor';\n\napp.initializers.add('askvortsov/flarum-rich-text', () => {\n  applyEditor();\n  app.extensionData.for('askvortsov-rich-text').registerSetting({\n    setting: 'askvortsov-rich-text.toggle_on_editor',\n    type: 'boolean',\n    label: app.translator.trans('askvortsov-rich-text.admin.settings.toggle_on_editor'),\n  });\n});\n\nexport * from '../common/index';\n"],"sourceRoot":""}